*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="_datepicker.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS frmdatepicker AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="oleMonthViewCtrl" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: movepicker
		*p: oparent
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .T.
	BorderStyle = 2
	Caption = "DatePicker"
	DoCreate = .T.
	Height = 178
	Name = "frmDatePicker"
	oparent = .NULL.
	ShowInTaskBar = .F.
	TitleBar = 0
	Width = 166

	ADD OBJECT 'oleMonthViewCtrl' AS olemonthview WITH ;
		DefHeight = , ;
		DefWidth = , ;
		Name = "oleMonthViewCtrl"
		*< END OBJECT: ClassLib="..\libs\_lvisual.vcx" BaseClass="olecontrol" OLEObject="c:\windows\syswow64\mscomct2.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIDr58JCn84BAwAAAIABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v///wUAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9qRS4jw4fREYvjAAD4dU2hIUM0EggAAAAoEQAAZhIAABqxX8AAAAYAHAAAAIoQAADVBwwAAAAXAAAAAAAAAAAAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2NTFBODk0MC04N0M1LTExZDEtOEJFMy0wMDAwRjg3NTREQTEzADIALgBvAGMAeAAAAE0AaQBjAHIAbwBzAG8AZgB0ACAAUwABAACAZABlAHIAIABDAG8AbgB0AHIAbwBsACwAIAB2AGUAcgBzAGkAbwBuACAANQAuADAAIAAoAFMAUAAyACkADycMAAUAHwAAAAAAAAAAANkGAQABAAEAAAAAAAAAAADVBwwABQAXAAkAHwA3AP0C1QcMAAUAFwAJAB8ANwD9AgAABwAAAAAAAe/NqwAABQBwKbMABgAdAAAAAADs6dgAAAAAAB/e7L0BAAUAeN8YAG0AMwAyAFwAYwBvAG0AYwB0AGwAMwAyAC4AbwBjAHgAAABNAGkAYwByAG8AcwBvAGYAdAAgAFQAYQBiAFMAdAByAGkAcAAgAEMAbwBuAHQAcgBvAGwALAAgAHYAZQByAHMAaQBvAG4AIAA1AC4AMAAgACgAUwBQADIAKQAJAHsAOQBFAEQAOQA0ADQANAAwAA==" />
	
	PROCEDURE Deactivate
		this.Release()
	ENDPROC

	PROCEDURE Init
		LPARAMETERS toDateCtrl
		
		IF PCOUNT() = 1
			this.Width = this.oleMonthViewCtrl.Width
			this.Height = this.oleMonthViewCtrl.Height
			this.oParent = toDateCtrl
			this.oleMonthViewCtrl.oParent = toDateCtrl
			this.MovePicker()
			BINDEVENT(this.oParent.oForm, "Moved", this, "MovePicker")
		ELSE
			this.Release()
		ENDIF
	ENDPROC

	PROCEDURE movepicker
		LOCAL lnTop, lnLeft, lnFormTop, lnFormLeft, lnDPHeight, lnDPWidth
		
		lnFormTop = this.oParent.oForm.Top+SYSMETRIC(4)+SYSMETRIC(9)
		lnFormLeft = this.oParent.oForm.Left+SYSMETRIC(3)
		lnDPHeight = this.Height+2*SYSMETRIC(13)
		lnDPWidth = this.Width+2*SYSMETRIC(12)
		lnTop = lnFormTop + OBJTOCLIENT(this.oParent,1) + IIF(lnFormTop + OBJTOCLIENT(this.oParent,1) + this.oParent.Height + lnDPHeight > _screen.Height, -lnDPHeight, this.oParent.Height)
		lnLeft = lnFormLeft + OBJTOCLIENT(this.oParent,2)
		
		this.Top = MAX(0, MIN(_screen.Height - lnDPHeight, lnTop))
		this.Left = MAX(0, MIN(_screen.Width - lnDPWidth, lnLeft))
	ENDPROC

	PROCEDURE Unload
		IF NOT ISNULL(this.oParent.oForm)
			UNBINDEVENTS(this.oParent.oForm, "Moved", this, "MovePicker")
		ENDIF
		this.oParent.lDatePickerActive = .F.
	ENDPROC

ENDDEFINE

*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="noteformformat.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS noteformformat AS tform OF "..\libs\main.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkcopynote" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="obrowser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdBold" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdItalic" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdUnderline" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="tmrLoadContent" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdFont" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdPaste" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCut" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCopy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdJustifyLeft" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdJustifyCenter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdJustifyRight" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdUndo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdRedo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdDelete" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdForeColor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdBackColor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdFind" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: browsersetfocus
		*m: initializebrowser
		*m: onbackcolor
		*m: onbold
		*m: oncut
		*m: onfind
		*m: onfont
		*m: onforecolor
		*m: onitalic
		*m: onjustifycenter
		*m: onjustifyleft
		*m: onjustifyright
		*m: onpaste
		*m: onredo
		*m: onunderline
		*m: toggleselectedbutton
		*p: chtmlfile		&& Path and name of html file for browser
		*p: p_note		&& Stores Note Text
	*</DefinedPropArrayMethod>

	Caption = "BudgetNoteForm"
	chtmlfile = 		&& Path and name of html file for browser
	ControlBox = .T.
	DoCreate = .T.
	Height = 450
	Icon = ..\bitmap\icons\note16.ico
	KeyPreview = .T.
	Name = "noteformformat"
	nmaxfont = 14
	p_note = 		&& Stores Note Text
	saveformsize = .T.
	ShowTips = .T.
	Width = 795
	WindowType = 1

	ADD OBJECT 'chkcopynote' AS tcheckbox WITH ;
		Alignment = 0, ;
		Anchor = 6, ;
		Height = 17, ;
		Left = 13, ;
		Name = "chkcopynote", ;
		TabIndex = 18, ;
		Top = 424, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 275
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'cmdBackColor' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 339, ;
		Name = "cmdBackColor", ;
		Picture = ..\bitmap\toolbar\backcolor.gif, ;
		PicturePosition = 14, ;
		TabIndex = 15, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdBold' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 219, ;
		Name = "cmdBold", ;
		Picture = ..\bitmap\toolbar\bld.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 10, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCancel' AS tcommandbutton WITH ;
		Anchor = 36, ;
		Caption = "cmdCancel", ;
		Left = 409, ;
		Name = "cmdCancel", ;
		TabIndex = 20, ;
		Top = 421
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCopy' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 51, ;
		Name = "cmdCopy", ;
		Picture = ..\bitmap\toolbar\copyf.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 3, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCut' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 27, ;
		Name = "cmdCut", ;
		Picture = ..\bitmap\toolbar\cut.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 2, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdDelete' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 123, ;
		Name = "cmdDelete", ;
		Picture = ..\bitmap\toolbar\deletef.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 6, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdFind' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 363, ;
		Name = "cmdFind", ;
		Picture = ..\bitmap\toolbar\find.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 16, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdFont' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 291, ;
		Name = "cmdFont", ;
		Picture = ..\bitmap\toolbar\wordundr.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 13, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdForeColor' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 315, ;
		Name = "cmdForeColor", ;
		Picture = ..\bitmap\toolbar\forecolor.gif, ;
		PicturePosition = 14, ;
		TabIndex = 14, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdItalic' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 243, ;
		Name = "cmdItalic", ;
		Picture = ..\bitmap\toolbar\itl.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 11, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdJustifyCenter' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 171, ;
		Name = "cmdJustifyCenter", ;
		Picture = ..\bitmap\toolbar\cnt.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 8, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdJustifyLeft' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 147, ;
		Name = "cmdJustifyLeft", ;
		Picture = ..\bitmap\toolbar\lft.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 7, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdJustifyRight' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 195, ;
		Name = "cmdJustifyRight", ;
		Picture = ..\bitmap\toolbar\rt.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 9, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdOK' AS tcommandbutton WITH ;
		Anchor = 132, ;
		Caption = "cmdOK", ;
		Left = 301, ;
		Name = "cmdOK", ;
		TabIndex = 19, ;
		Top = 421
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdPaste' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 3, ;
		Name = "cmdPaste", ;
		Picture = ..\bitmap\toolbar\paste.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 1, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdRedo' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 99, ;
		Name = "cmdRedo", ;
		Picture = ..\bitmap\toolbar\redo.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 5, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdUnderline' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 267, ;
		Name = "cmdUnderline", ;
		Picture = ..\bitmap\toolbar\undrln.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 12, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdUndo' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 75, ;
		Name = "cmdUndo", ;
		Picture = ..\bitmap\toolbar\undof.bmp, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'obrowser' AS olecontrol WITH ;
		Anchor = 15, ;
		Height = 390, ;
		Left = 0, ;
		Name = "obrowser", ;
		TabIndex = 17, ;
		Top = 28, ;
		Width = 795
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\ieframe.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGDZientkNIBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAACpSAABPKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'tmrLoadContent' AS timer WITH ;
		Enabled = .F., ;
		Height = 23, ;
		Interval = 100, ;
		Left = 756, ;
		Name = "tmrLoadContent", ;
		Top = 0, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />
	
	PROCEDURE assigncaption
		this.cmdPaste.ToolTipText = GetText("MENU","MNU_PASTE",,.T.)
		this.cmdCut.ToolTipText = GetText("NFORMAT","TXT_CUT")
		this.cmdCopy.ToolTipText = GetText("MENU","MNU_COPY",,.T.)
		this.cmdUndo.ToolTipText = GetText("ADDRESS","T_UNDO",,.T.)
		this.cmdRedo.ToolTipText = GetText("NFORMAT","TXT_REDO",,.T.)
		this.cmdDelete.ToolTipText = GetText("NFORMAT","TXT_DELETE_SELECTION")
		this.cmdJustifyLeft.ToolTipText = GetText("NFORMAT","TXT_LEFT_ALIGN")
		this.cmdJustifyCenter.ToolTipText = GetText("NFORMAT","TXT_ALIGN_CENTER")
		this.cmdJustifyRight.ToolTipText = GetText("NFORMAT","TXT_RIGHT_ALIGN")
		this.cmdBold.ToolTipText = GetText("NFORMAT","TXT_BOLD")
		this.cmdItalic.ToolTipText = GetText("NFORMAT","TXT_ITALIC")
		this.cmdUnderline.ToolTipText = GetText("NFORMAT","TXT_UNDERLINED")
		this.cmdFont.ToolTipText = GetText("NFORMAT","TXT_FONTS")
		this.cmdForeColor.ToolTipText = GetText("NFORMAT","TXT_FORECOLOR")
		this.cmdBackColor.ToolTipText = GetText("NFORMAT","TXT_BACKCOLOR")
		this.cmdFind.ToolTipText = GetText("COMMON","TXT_FIND")
		this.cmdOk.Caption = GetLangText("COMMON", "TXT_OK")
		this.cmdCancel.Caption = GetLangText("COMMON", "TXT_CANCEL")
	ENDPROC

	PROCEDURE browsersetfocus
		this.obrowser.document.getElementbyId("oDiv").focus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE Init
		LPARAMETERS plcNote, plcCaptionText
		DODEFAULT()
		IF EMPTY(plcNote)
			this.p_note = ""
		ELSE
			this.p_note = plcNote
		ENDIF
		IF EMPTY(plcCaptionText)
			this.Caption = ""
		ELSE
			this.Caption = plcCaptionText
		ENDIF
		
		this.assigncaption()
		
		RETURN .T.
	ENDPROC

	PROCEDURE initializebrowser
		LOCAL l_cInitBrowser
		
		TEXT TO l_cInitBrowser TEXTMERGE NOSHOW
		<HTML>
		<HEAD>
		<TITLE>HTML Editor</TITLE>
		
		<SCRIPT>
		window.onload=doInit
		function doInit(){
		// Ensure that all document elements except the content editable DIV are unselectable.
		for (i=0; i<document.all.length; i++)
		 document.all(i).unselectable = "on";
		oDiv.unselectable = "off";
		// Clear any text in the Document window and set the focus.
		oDiv.innerHTML="";
		oDiv.focus();
		}
		</SCRIPT>
		</HEAD>
		<BODY STYLE="overflow:hidden; margin:0px"  oncontextmenu="return false;" scroll="yes">
		<DIV  ID="oContainer" STYLE="background-color:threedface; border:1px solid #cccccc position:relative; height:100%; top:0;">
		<DIV ID="oDiv" CONTENTEDITABLE STYLE="height:100%;background-color:white; overflow:auto; width:100%;"> </DIV>
		</DIV>
		</BODY>
		</HTML>
		ENDTEXT
		
		thisform.chtmlfile = FileTemp('html')
		STRTOFILE(l_cInitBrowser, thisform.chtmlfile, 0)
		
		RETURN .T.
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			NODEFAULT
			this.cmdCancel.Click()
		ENDIF
	ENDPROC

	PROCEDURE Load
		DODEFAULT()
		
		this.Initializebrowser()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onbackcolor
		LOCAL xbackcolor
		xbackcolor = GETCOLOR()
		IF xbackcolor#-1
			this.obrowser.document.execCommand("Backcolor",.f.,m.xbackcolor)
		ENDIF
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onbold
		this.obrowser.document.execCommand("bold")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE oncopy
		this.obrowser.document.execCommand("copy")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE oncut
		this.obrowser.document.execCommand("cut")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE ondelete
		this.obrowser.document.execCommand("delete")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onfind
		#DEFINE OLECMDID_FIND  32
		#DEFINE OLECMDEXECOPT_PROMPTUSER  1
		
		this.obrowser.execwb(OLECMDID_FIND,OLECMDID_FIND)
		
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onfirststart
		IF NOT this.lOnFirstActivate
			this.lOnFirstActivate = .T.
			IF TYPE("plCopyNoteToRateArti") = "L"
				this.chkCopyNote.ControlSource = "plCopyNoteToRateArti"
				this.chkCopyNote.Caption = GetLangText("MANAGER","TXT_COPY_TO") + " " + GetLangText("MGRFINAN","TXT_T_SPLIT")
				this.chkCopyNote.Visible = .T.
			ENDIF
		
			this.obrowser.navigate(thisform.chtmlfile)
			this.tmrLoadContent.Enabled = .T.
		ENDIF
	ENDPROC

	PROCEDURE onfont
		LOCAL xfont,xfontname,xfontsize,xfontstyle
		LOCAL xpoint as integer
		
		xfont=getfont("Arial",12)
		if not empty(xfont)
		xfontname=getwordnum(xfont,1,",")
		xfontsize=getwordnum(xfont,2,",")
		xfontsize=int(val(getwordnum(xfont,2,",")))   && Required. Integer or String that specifies the font size. This must be a value between 1 and 7, inclusive.
		xfontStyle=getwordnum(xfont,3,",")  
		this.obrowser.document.execCommand("FontName",.f., xfontname)
		
		
		do case
			case xfontsize<=9
				xpoint=1
			case between(xfontsize,10,11)
				xpoint=2
			case between(xfontsize,12,18)
				xpoint=3
			case between(xfontsize,19,23)
				xpoint=4
			case between(xfontsize,24,31)  &&29
				xpoint=5
			case between(xfontsize,32,45)
				xpoint=6
			case xfontsize>=46
				xpoint=7
		endcase
		this.obrowser.document.execCommand("FontSize",.f., m.xPOINT)     &&attention fontsize converted ~ to  points ( 1 to 7)
		if "B" $ xfontstyle
			this.obrowser.document.execCommand("Bold",.t.)
		endi
		IF "I" $ xfontstyle
			this.obrowser.document.execCommand("Italic",.t.)
		endi
			this.obrowser.document.getElementbyID("oDiv").focus()
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE onforecolor
		LOCAL xforecolor
		xforecolor = GETCOLOR()
		IF xforecolor#-1
			this.obrowser.document.execCommand("Forecolor",.f.,m.xforecolor)
		ENDIF
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onitalic
		this.obrowser.document.execCommand("italic")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onjustifycenter
		this.obrowser.document.execCommand("JustifyCenter")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onjustifyleft
		this.obrowser.document.execCommand("justifyleft")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onjustifyright
		this.obrowser.document.execCommand("justifyRight")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onpaste
		this.obrowser.document.execCommand("paste")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onredo
		this.obrowser.document.execCommand("redo")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onsave
		LOCAL l_cFormatedText
		l_cFormatedText = this.obrowser.document.getElementbyId("oDiv").innerHTML
		this.p_note = l_cFormatedText
		
		this.Release()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onunderline
		this.obrowser.document.execCommand("underline")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onundo
		this.obrowser.document.execCommand("undo")
		this.BrowserSetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE QueryUnload
		NODEFAULT
		this.cmdCancel.Click()
	ENDPROC

	PROCEDURE Resize
		LPARAMETERS nwidth,nheight
		* Override resize. Anchor is used because of refresh problem.
		* When form is resized, content is deleted from browser control.
	ENDPROC

	PROCEDURE toggleselectedbutton
		LPARAMETERS lp_oButton AS CommandButton
		LOCAL l_nDefaultColor, l_nSelectedColor
		
		* For now, dont change color of selected button, because, button should be selected also
		* when user clicks into text which is already bold etc.
		
		RETURN .T.
		
		*!*	l_nDefaultColor = RGB(240,240,240)
		*!*	l_nSelectedColor = RGB(255,255,0)
		
		*!*	IF lp_oButton.BackColor = l_nDefaultColor
		*!*		lp_oButton.BackColor = l_nSelectedColor
		*!*	ELSE
		*!*		lp_oButton.BackColor = l_nDefaultColor
		*!*	ENDIF
		
		*!*	RETURN .T.
	ENDPROC

	PROCEDURE Unload
		RETURN thisform.p_note
	ENDPROC

	PROCEDURE cmdBackColor.Click
		thisform.OnBackColor()
		thisform.ToggleSelectedButton(this)
	ENDPROC

	PROCEDURE cmdBold.Click
		thisform.OnBold()
		thisform.ToggleSelectedButton(this)
	ENDPROC

	PROCEDURE cmdCancel.Click
		thisform.p_note = NULL
		thisform.Release()
	ENDPROC

	PROCEDURE cmdCopy.Click
		thisform.OnCopy()
	ENDPROC

	PROCEDURE cmdCut.Click
		thisform.OnCut()
	ENDPROC

	PROCEDURE cmdDelete.Click
		thisform.OnDelete()
	ENDPROC

	PROCEDURE cmdFind.Click
		thisform.OnFind()
	ENDPROC

	PROCEDURE cmdFont.Click
		thisform.OnFont()
	ENDPROC

	PROCEDURE cmdForeColor.Click
		thisform.OnForeColor()
		thisform.ToggleSelectedButton(this)
	ENDPROC

	PROCEDURE cmdItalic.Click
		thisform.OnItalic()
		thisform.ToggleSelectedButton(this)
	ENDPROC

	PROCEDURE cmdJustifyCenter.Click
		thisform.OnJustifyCenter()
	ENDPROC

	PROCEDURE cmdJustifyLeft.Click
		thisform.OnJustifyLeft()
	ENDPROC

	PROCEDURE cmdJustifyRight.Click
		thisform.OnJustifyRight()
	ENDPROC

	PROCEDURE cmdOK.Click
		thisform.OnSave()
	ENDPROC

	PROCEDURE cmdPaste.Click
		thisform.OnPaste()
	ENDPROC

	PROCEDURE cmdRedo.Click
		thisform.OnRedo()
	ENDPROC

	PROCEDURE cmdUnderline.Click
		thisform.OnUnderline()
		thisform.ToggleSelectedButton(this)
	ENDPROC

	PROCEDURE cmdUndo.Click
		thisform.OnUndo()
	ENDPROC

	PROCEDURE tmrLoadContent.Timer
		this.Enabled = .F.
		
		IF NOT EMPTY(thisform.p_note)
			thisform.Obrowser.Document.getElementbyId("oDiv").innerHTML = thisform.p_note
		ENDIF
		
		RETURN .T.
	ENDPROC

ENDDEFINE

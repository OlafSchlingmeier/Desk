*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="addressmask.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\constdefines.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor38" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor39" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor40" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor43" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor44" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor45" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor46" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor47" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor49" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor50" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor51" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor52" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor53" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor54" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor55" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor56" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor57" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor58" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor59" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor60" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor48" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor61" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor62" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor63" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor64" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor65" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 906
	InitialSelectedAlias = "address"
	Left = 253
	Name = "Dataenvironment"
	Top = -18
	Width = 815

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "address", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\address.dbf, ;
		Height = 95, ;
		Left = 8, ;
		Name = "Cursor1", ;
		Top = 14, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "histpost", ;
		CursorSource = ..\data\histpost.dbf, ;
		Height = 1, ;
		Left = 137, ;
		Name = "Cursor10", ;
		Top = 316, ;
		Width = 111
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "ledgpost", ;
		CursorSource = ..\data\ledgpost.dbf, ;
		Height = 1, ;
		Left = 137, ;
		Name = "Cursor11", ;
		Top = 343, ;
		Width = 110
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "post", ;
		CursorSource = ..\data\post.dbf, ;
		Height = 1, ;
		Left = 134, ;
		Name = "Cursor12", ;
		Top = 139, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "voucher", ;
		CursorSource = ..\data\voucher.dbf, ;
		Height = 1, ;
		Left = 409, ;
		Name = "Cursor13", ;
		Top = 316, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "aracct", ;
		CursorSource = ..\data\aracct.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor14", ;
		Top = 428, ;
		Width = 110
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "action", ;
		CursorSource = ..\data\action.dbf, ;
		Height = 1, ;
		Left = 270, ;
		Name = "Cursor15", ;
		Top = 315, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "picklist", ;
		CursorSource = ..\data\picklist.dbf, ;
		Height = 1, ;
		Left = 414, ;
		Name = "Cursor16", ;
		Order = "TAG1", ;
		Tag = "R", ;
		Top = 134, ;
		Width = 89
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "zipcode", ;
		CursorSource = ..\data\zipcode.dbf, ;
		Height = 1, ;
		Left = 13, ;
		Name = "Cursor17", ;
		Tag = "R", ;
		Top = 429, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "roomtype", ;
		CursorSource = ..\data\roomtype.dbf, ;
		Height = 1, ;
		Left = 11, ;
		Name = "Cursor18", ;
		Order = "tag1", ;
		Tag = "R", ;
		Top = 457, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "althead", ;
		CursorSource = ..\data\althead.dbf, ;
		Height = 1, ;
		Left = 409, ;
		Name = "Cursor19", ;
		Tag = "R", ;
		Top = 288, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "document", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\document.dbf, ;
		Height = 1, ;
		Left = 131, ;
		Name = "Cursor2", ;
		Order = "", ;
		Top = 17, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "pswindow", ;
		CursorSource = ..\data\pswindow.dbf, ;
		Height = 1, ;
		Left = 409, ;
		Name = "Cursor20", ;
		Top = 387, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "group", ;
		CursorSource = ..\data\group.dbf, ;
		Height = 1, ;
		Left = 408, ;
		Name = "Cursor21", ;
		Tag = "R", ;
		Top = 259, ;
		Width = 99
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "title", ;
		CursorSource = ..\data\title.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor22", ;
		Tag = "R", ;
		Top = 112, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor23' AS cursor WITH ;
		Alias = "ratecode", ;
		CursorSource = ..\data\ratecode.dbf, ;
		Height = 1, ;
		Left = 137, ;
		Name = "Cursor23", ;
		Tag = "R", ;
		Top = 228, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor24' AS cursor WITH ;
		Alias = "address1", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor24", ;
		Top = 19, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor25' AS cursor WITH ;
		Alias = "roomplan", ;
		CursorSource = ..\data\roomplan.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor25", ;
		Tag = "R", ;
		Top = 196, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor26' AS cursor WITH ;
		Alias = "room", ;
		CursorSource = ..\data\room.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor26", ;
		Tag = "R", ;
		Top = 371, ;
		Width = 92
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor27' AS cursor WITH ;
		Alias = "availab", ;
		CursorSource = ..\data\availab.dbf, ;
		Height = 1, ;
		Left = 135, ;
		Name = "Cursor27", ;
		Order = "tag1", ;
		Tag = "R", ;
		Top = 167, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor28' AS cursor WITH ;
		Alias = "apartner1", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 1, ;
		Left = 591, ;
		Name = "Cursor28", ;
		Top = 20, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor29' AS cursor WITH ;
		Alias = "address2", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 425, ;
		Name = "Cursor29", ;
		Top = 18, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "apartner", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\apartner.dbf, ;
		Filter = "ap_apid <> -9999", ;
		Height = 1, ;
		Left = 131, ;
		Name = "Cursor3", ;
		Order = "", ;
		Top = 49, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor30' AS cursor WITH ;
		Alias = "user", ;
		CursorSource = ..\data\user.dbf, ;
		Height = 1, ;
		Left = 270, ;
		Name = "Cursor30", ;
		Tag = "R", ;
		Top = 346, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor31' AS cursor WITH ;
		Alias = "document1", ;
		CursorSource = ..\data\document.dbf, ;
		Height = 1, ;
		Left = 408, ;
		Name = "Cursor31", ;
		Top = 436, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor32' AS cursor WITH ;
		Alias = "hpwindow", ;
		CursorSource = ..\data\hpwindow.dbf, ;
		Height = 1, ;
		Left = 539, ;
		Name = "Cursor32", ;
		Top = 400, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor33' AS cursor WITH ;
		Alias = "adrtores", ;
		CursorSource = ..\data\adrtores.dbf, ;
		Height = 1, ;
		Left = 408, ;
		Name = "Cursor33", ;
		Tag = "R", ;
		Top = 343, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor34' AS cursor WITH ;
		Alias = "adrfeat", ;
		CursorSource = ..\data\adrfeat.dbf, ;
		Height = 1, ;
		Left = 694, ;
		Name = "Cursor34", ;
		Top = 443, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor35' AS cursor WITH ;
		Alias = "apartner2", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 1, ;
		Left = 426, ;
		Name = "Cursor35", ;
		Order = "tag3", ;
		Top = 64, ;
		Width = 143
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor36' AS cursor WITH ;
		Alias = "astat", ;
		CursorSource = ..\data\astat.dbf, ;
		Height = 1, ;
		Left = 268, ;
		Name = "Cursor36", ;
		Order = "tag2", ;
		Tag = "R", ;
		Top = 400, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor37' AS cursor WITH ;
		Alias = "histstat", ;
		CursorSource = ..\data\histstat.dbf, ;
		Height = 1, ;
		Left = 268, ;
		Name = "Cursor37", ;
		Order = "tag2", ;
		Tag = "R", ;
		Top = 426, ;
		Width = 109
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor38' AS cursor WITH ;
		Alias = "laststay", ;
		CursorSource = ..\data\laststay.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor38", ;
		Order = "tag1", ;
		Top = 372, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor39' AS cursor WITH ;
		Alias = "referral", ;
		CursorSource = ..\data\referral.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor39", ;
		Top = 229, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "arpost", ;
		CursorSource = ..\data\arpost.dbf, ;
		Height = 1, ;
		Left = 695, ;
		Name = "Cursor4", ;
		Order = "tag1", ;
		Top = 407, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor40' AS cursor WITH ;
		Alias = "picklist4", ;
		CursorSource = ..\data\picklist.dbf, ;
		Height = 1, ;
		Left = 408, ;
		Name = "Cursor40", ;
		Order = "tag4", ;
		Tag = "R", ;
		Top = 207, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor41' AS cursor WITH ;
		Alias = "address3", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 270, ;
		Name = "Cursor41", ;
		Order = "tag1", ;
		Top = 50, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor42' AS cursor WITH ;
		Alias = "picklist3", ;
		CursorSource = ..\data\picklist.dbf, ;
		Height = 1, ;
		Left = 410, ;
		Name = "Cursor42", ;
		Tag = "R", ;
		Top = 174, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor43' AS cursor WITH ;
		Alias = "referral1", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\referral.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor43", ;
		Order = "tag1", ;
		Top = 258, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor44' AS cursor WITH ;
		Alias = "phnote", ;
		CursorSource = ..\data\phnote.dbf, ;
		Height = 1, ;
		Left = 10, ;
		Name = "Cursor44", ;
		Top = 398, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor45' AS cursor WITH ;
		Alias = "lists", ;
		CursorSource = ..\data\lists.dbf, ;
		Height = 1, ;
		Left = 137, ;
		Name = "Cursor45", ;
		Tag = "R", ;
		Top = 286, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor46' AS cursor WITH ;
		Alias = "billnum", ;
		CursorSource = ..\data\billnum.dbf, ;
		Height = 1, ;
		Left = 268, ;
		Name = "Cursor46", ;
		Top = 456, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor47' AS cursor WITH ;
		Alias = "ratearti", ;
		CursorSource = ..\data\ratearti.dbf, ;
		Height = 1, ;
		Left = 536, ;
		Name = "Cursor47", ;
		Order = "tag1", ;
		Top = 195, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor48' AS cursor WITH ;
		Alias = "resrate", ;
		CursorSource = ..\data\resrate.dbf, ;
		Height = 1, ;
		Left = 535, ;
		Name = "Cursor48", ;
		Top = 170, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor49' AS cursor WITH ;
		Alias = "resfix", ;
		CursorSource = ..\data\resfix.dbf, ;
		Height = 1, ;
		Left = 534, ;
		Name = "Cursor49", ;
		Order = "tag1", ;
		Top = 144, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "argenrem", ;
		CursorSource = ..\data\argenrem.dbf, ;
		Height = 1, ;
		Left = 697, ;
		Name = "Cursor5", ;
		Order = "tag1", ;
		Top = 340, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor50' AS cursor WITH ;
		Alias = "paymetho", ;
		CursorSource = ..\data\paymetho.dbf, ;
		Height = 1, ;
		Left = 538, ;
		Name = "Cursor50", ;
		Order = "tag1", ;
		Tag = "R", ;
		Top = 219, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor51' AS cursor WITH ;
		Alias = "adintrst", ;
		CursorSource = ..\data\adintrst.dbf, ;
		Height = 1, ;
		Left = 537, ;
		Name = "Cursor51", ;
		Top = 280, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor52' AS cursor WITH ;
		Alias = "adrstint", ;
		CursorSource = ..\data\adrstint.dbf, ;
		Height = 1, ;
		Left = 537, ;
		Name = "Cursor52", ;
		Top = 307, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor53' AS cursor WITH ;
		Alias = "adrtoin", ;
		CursorSource = ..\data\adrtoin.dbf, ;
		Height = 1, ;
		Left = 536, ;
		Name = "Cursor53", ;
		Top = 255, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor54' AS cursor WITH ;
		Alias = "adrtosi", ;
		CursorSource = ..\data\adrtosi.dbf, ;
		Height = 1, ;
		Left = 538, ;
		Name = "Cursor54", ;
		Top = 333, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor55' AS cursor WITH ;
		Alias = "adrrates", ;
		CursorSource = ..\data\adrrates.dbf, ;
		Height = 1, ;
		Left = 537, ;
		Name = "Cursor55", ;
		Top = 359, ;
		Width = 92
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor56' AS cursor WITH ;
		Alias = "einbox", ;
		CursorSource = ..\data\einbox.dbf, ;
		Height = 1, ;
		Left = 693, ;
		Name = "Cursor56", ;
		Top = 77, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor57' AS cursor WITH ;
		Alias = "einboxsn", ;
		CursorSource = ..\data\einboxsn.dbf, ;
		Height = 1, ;
		Left = 694, ;
		Name = "Cursor57", ;
		Top = 104, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor58' AS cursor WITH ;
		Alias = "esent", ;
		CursorSource = ..\data\esent.dbf, ;
		Height = 1, ;
		Left = 695, ;
		Name = "Cursor58", ;
		Top = 133, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor59' AS cursor WITH ;
		Alias = "esentrcp", ;
		CursorSource = ..\data\esentrcp.dbf, ;
		Height = 1, ;
		Left = 696, ;
		Name = "Cursor59", ;
		Top = 161, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "arremlet", ;
		CursorSource = ..\data\arremlet.dbf, ;
		Height = 1, ;
		Left = 695, ;
		Name = "Cursor6", ;
		Order = "tag1", ;
		Top = 373, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor60' AS cursor WITH ;
		Alias = "emprop", ;
		CursorSource = ..\data\emprop.dbf, ;
		Height = 1, ;
		Left = 694, ;
		Name = "Cursor60", ;
		Top = 187, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor61' AS cursor WITH ;
		Alias = "eattachm", ;
		CursorSource = ..\data\eattachm.dbf, ;
		Height = 1, ;
		Left = 696, ;
		Name = "Cursor61", ;
		Top = 213, ;
		Width = 88
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor62' AS cursor WITH ;
		Alias = "events", ;
		CursorSource = ..\data\events.dbf, ;
		Height = 1, ;
		Left = 697, ;
		Name = "Cursor62", ;
		Top = 259, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor63' AS cursor WITH ;
		Alias = "evint", ;
		CursorSource = ..\data\evint.dbf, ;
		Height = 1, ;
		Left = 696, ;
		Name = "Cursor63", ;
		Top = 288, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor64' AS cursor WITH ;
		Alias = "adrprvcy", ;
		CursorSource = ..\data\adrprvcy.dbf, ;
		Height = 1, ;
		Left = 139, ;
		Name = "Cursor64", ;
		Top = 467, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor65' AS cursor WITH ;
		Alias = "saddress", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 267, ;
		Name = "Cursor65", ;
		Top = 154, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "reservat", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "ressplit", ;
		CursorSource = ..\data\ressplit.dbf, ;
		Height = 1, ;
		Left = 535, ;
		Name = "Cursor8", ;
		Top = 105, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "histres", ;
		CursorSource = ..\data\histres.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor9", ;
		Tag = "R", ;
		Top = 111, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "apartner", ;
		ChildOrder = "tag1", ;
		Name = "Relation1", ;
		ParentAlias = "address", ;
		RelationalExpr = "ad_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation3' AS relation WITH ;
		ChildAlias = "address2", ;
		ChildOrder = "tag1", ;
		Name = "Relation3", ;
		ParentAlias = "apartner1", ;
		RelationalExpr = "ap_addrid"
		*< END OBJECT: BaseClass="relation" />
	
	PROCEDURE BeforeOpenTables
		IF thisformset.lodbc
			this.user.cFilterClause = "us_id = " + SqlCnv(PADR(g_userid,10),.T.)
			this.group.cFilterClause = "gr_group = " + SqlCnv(PADR(g_Usergroup,10),.T.)
		ENDIF
	ENDPROC

ENDDEFINE

DEFINE CLASS formset1 AS fs OF "..\libs\main.vcx" 
 	*< CLASSDATA: Baseclass="formset" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="FAddressMask" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.Shape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.Shape6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Addrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Addrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Company" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Company" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Departm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Departm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Lname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Fname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Fname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lbAD_Lang" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Lang" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.ocbotitle" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lbAD_titcod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtti_attn" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtad_title" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Compnum" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Compnum" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lbAD_Compkey" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Compkey" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Salute" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Salute" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Street" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Street" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_Street2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Street2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_State" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_State" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_City" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Country" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_Zip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtAd_City" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Phone" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Phone2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Fax" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Fax" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Email" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Email" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnMail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_website" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_website" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnBrowse" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_save" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_ustidnr" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_ustidnr" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_novat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Mail1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnCall" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Ratecod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Ratecod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Billins" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Billins" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Feat1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Feat1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblWishRoom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.cboRoomname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Birth" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Birth" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.ChkNomail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Member" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Member" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Memdat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Memdat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblCollectedPoints" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtCollectedPoints" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblTotalPoints" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtTotalPoints" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblbmsaccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtbmsaccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblad_webpass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtad_webpass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column8.Tcheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column13.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.btnMail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.Edit1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.lblAd_Created" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.lblAd_Updated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Userid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Created" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Updated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Tchkgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokEdit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokNew" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokDel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcChange" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcPhoneNote" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnMail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnReply" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnNewExternalDocument" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column13.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutEdit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutNew" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutDel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.cmdFutAlt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageFree.tcbCallBankForm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column13.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column14.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column14.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column15.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column15.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.BHistPrint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdShowReservation" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdCopyReservation" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdSearchReservation" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdBillPreview" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRNew" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BREdit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRDelete" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRGoto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.cmdshowreferrals" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRatecode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRatecode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPrice" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastPrice" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRoomtype" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRoomtype" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRoom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRoom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastStay" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastStayArr" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastStayDep" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntil" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblOpenBalance" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOpenBalance" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem0" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem0" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_market" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRemX" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_source" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRemX" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblForecast" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblExpectedRevOcc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntilMonthEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblNext30days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntilYearEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblNext365Days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtExpectedRev" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtExpectedOcc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevUntilMonthEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccUntilMonthEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevNext30days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccNext30days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevUntilYearEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccUntilYearEnd" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevNext365Days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccNext365Days" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblIntrests" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblResIntervals" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinLargeHorizontal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.linLargeVertical" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArHorizontal2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArHorizontal1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRatecode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRatecode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastContact" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtContactDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastContactType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtContactType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLast" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblMarket" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtMarket" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSource" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtSource" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_market" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_source" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.linFcHorizontal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_discnt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.edtIntrests" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.edtResIntervals" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdIntrests" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdReIntervals" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdRates" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_discnt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacypolicy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.chkAd_Vip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.chkAd_Vip2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_adrtype" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.cboAdrType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.ad_vipstat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblAd_vipstat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.txtad_adid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageAddress.lblad_adid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Tchkgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column14.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column14.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column15.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.MainPage.PageGridAddress.AddressGrid.Column15.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.Mail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.Timer1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.Timer2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FAddressMask.oProcAddress" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.Shape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Title" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Title" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Fname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Fname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Lname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Lname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Phone1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Phone1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Phone2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Phone2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Fax" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Fax" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Email" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Email" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Gebdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Gebdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_User1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_User1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_User2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_User2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_User3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_User3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Vip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.CAp_Vip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.COk" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.CCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.CUndo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_apid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_apid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.TAp_Salute" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.LAp_Salute" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChangeApartnerDialog.Combo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm.MCodeGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm.MCodeGrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm.MCodeGrid.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm.MCodeGrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="SelectForm.MCodeGrid.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LFirma" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_company" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LSuchname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_compkey" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LSuchnummer" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_compnum" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_lname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.FName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_fname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LOrt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_city" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LMemberNumber" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_member" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LAddressType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_adrtype" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LEMail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_email" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LPhone" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TPhone" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LAddrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TAd_addrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LUsr10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.txtAd_usr10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.Tcheckbox10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.LSearchAll" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.TSearchAll" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.chapartner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.chexactsearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.chkmainserver" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.CSearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="AddressSearchDialog.CCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tform1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tform1.Tlistbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tform1.Tcommandbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TeditNotes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TcbInsert" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TlText" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TlFrom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TlTo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TlFromCombo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TlToCombo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TcLinkCompany" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TcLinkInvoice" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.ttFrom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.ttTo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.TcMainAddress" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.tcombofrom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageData.tcomboto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.Sh1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.Sh2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelMessage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlCreated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlUpdated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelTime" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUserValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelDateValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelTimeValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdUser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdTime" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdUserValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdDateValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TpageMain.PageInfo.TlabelUpdTimeValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TcbCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ReferralForm.TcbOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NewDocument" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NewDocument.TlabelDocumentType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NewDocument.ToDocumentType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NewDocument.TcbOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NewDocument.TcbCancel" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: addresscopyfromadrmain
		*m: addresscopynew
		*m: addressdelete
		*m: addressdeleteafter
		*m: addressedit
		*m: addressexit
		*m: addressfieldsdisable
		*m: addressfieldsenable
		*m: addressfromadrmainselected
		*m: addressgetusrchkvals
		*m: addressgobottom
		*m: addressgoto
		*m: addressgotop
		*m: addressmaskvisiblefirsttime
		*m: addressnew
		*m: addressnext
		*m: addressprevious
		*m: addresssave
		*m: addresssaveafter
		*m: addresssearch
		*m: addressstate_assign
		*m: addresstransfer
		*m: addressundo
		*m: apartnerdelete
		*m: apartneredit
		*m: apartnernew
		*m: apartnersave
		*m: checkattachmentstext
		*m: definecontrolsource
		*m: doapartner
		*m: docdelete
		*m: finishsearch_assign
		*m: firstaddressinreferrals
		*m: futureresdelete
		*m: getcheckboxvalue		&& When Checkbox is used in FreePage, then transform String Values into Logical
		*m: getreferral
		*m: lforbidenrem4_assign
		*m: mainentrypoint
		*m: mainexitpoint
		*m: maintablerevert
		*m: makeformavailable
		*m: makeformunreachable
		*m: m_adjustaddressstring
		*m: m_cancel_state_for_new_referral		&& When user canceled adding of new address for new referral
		*m: m_connectreferraltoreservation
		*m: m_documentchoose		&& Calls Form for creating new document, or to choose which type of document to see in Document Grid
		*m: m_documentgettypetext
		*m: m_editreferral		&& Calls Form for editing one record in referral.dbf
		*m: m_findnewaddress
		*m: m_getselectedaddress
		*m: m_gettooltipforaddress
		*m: m_linkres		&& Creates string,based on checkbox setting, which is writen in referral.re_linkres field.
		*m: m_newforreferral
		*m: m_onemailcmd
		*m: m_onemailreplycmd
		*m: m_onnewexternaldocumentcmd
		*m: m_phonenote		&& Calls Phone Note form
		*m: m_referral_checkvalid_linkres		&& Checks if for selected address allready set property to automaticly enter company and invoice data in reservat.prg
		*m: m_referral_checkvalid_mainaddress
		*m: m_selectreferral		&& New address is selected for referral, now go back to source address
		*m: m_set_state_for_referral_search		&& Change form behavior when new address for referral ist searched
		*m: onhistory
		*m: onjumptoaddress
		*m: onselect
		*m: onselectaddress
		*m: onselectedaddresses
		*m: onselectedaddressesok
		*m: onselectedreferrals
		*m: onselectreferral
		*m: putcheckboxvalue		&& Put a string value from logical checkbox into user field
		*m: referral_goto		&& Jump to address record
		*m: refreshaddressgrid
		*m: refreshdocpage
		*m: refreshfuturepage
		*m: refreshgrid
		*m: refresholdrespage
		*m: refreshprivacypage
		*m: refreshreferralgrid
		*m: refreshsalespage
		*m: refreshstatistics		&& Method that recalculates statistics and shows it in Revnue.
		*m: searchaddresstable
		*m: searchaddresstablecustom
		*m: searchengine
		*m: selectaddress
		*m: selectformexit
		*m: setaddressgridsource
		*m: setapartnergridsource
		*m: setbonuspoints
		*m: setcontrolsourcetogrid		&& Set stored settings to grid object
		*m: takecontrolsource		&& Store Grid deginition to array, for later restore
		*p: addresscall
		*p: addressdeletestate
		*p: addresseditenabled
		*p: addressid
		*p: addressstart
		*p: addressstate
		*p: addresstempcreated
		*p: addresstext
		*p: apart
		*p: apartnerlostfocus
		*p: apartneropen
		*p: apartnerstate
		*p: aracctopen
		*p: cdocumentsfilter
		*p: cfilter
		*p: closeselectform
		*p: cno
		*p: cscope
		*p: cscopeap
		*p: cscopewhile
		*p: cyes
		*p: datacopy
		*p: datacopypp
		*p: deloldorder
		*p: documentopen
		*p: ds
		*p: emptycity
		*p: emptyfax
		*p: emptyphone1
		*p: emptyphone2
		*p: emptyphone3
		*p: emptystate
		*p: emptyzip
		*p: finishsearch
		*p: firstsearch
		*p: fullaccess
		*p: futurefilename
		*p: gridtableopen
		*p: historyfilename
		*p: histresopen
		*p: justonce
		*p: laddressesfordeleteselected		&& Used in searchadr mode. When .T., user has selected addresses to delete.
		*p: ldebitorrecivables
		*p: ldocumentsemail
		*p: ldontchangedatacopy
		*p: lfirststart
		*p: lforbidenrem4
		*p: lodbc
		*p: lrefreshingdocpage
		*p: lrequeryallreferralscur
		*p: lstartedfirsttime
		*p: nfirstlastrecord		&& bit0 = 1 -first record; bit1 = 1 -last record
		*p: norder
		*p: nrecno
		*p: nrecnobeforeeditmode
		*p: oldactivpage
		*p: oldresfilename
		*p: oparam		&& lp_oParam
		*p: oreferencetocallingobject
		*p: p_disablereferral		&& Disabling use of CommandButtons on Referral Page, when .T.
		*p: r
		*p: resdialog
		*p: scaleheight
		*p: scalewidth
		*p: searchactive
		*p: selectedtable
		*p: tabchange
		*p: tempaddressgridfirsttime
		*p: tpypahd
		*p: useoldversion		&& .T. when used in old 9.02 Version!
		*p: voucheropen
		*p: whenlostfocus
		*p: zipcodeopen
		*a: aaraccountdata[6,0]
		*a: aforecastdata[10,0]
		*a: apagesalesdata[12,0]
		*a: ausedaliases[1,0]
		*a: p_referralparams[6,0]		&& Parameters for adding new address to new referral. Valid Values are: 1 - .T. when address state is changed for adding new referral; 2 - Ad_addrid for source address; 3 - Order of address table when process started; 4 - New Ad_addrid for referral
	*</DefinedPropArrayMethod>

	AutoRelease = .T.
	cno = No
	cyes = Yes
	DataSession = 2
	finishsearch = .T.
	lfirststart = .T.
	lodbc = .F.
	lrequeryallreferralscur = .T.
	Name = "Formset1"
	nfirstlastrecord = 0		&& bit0 = 1 -first record; bit1 = 1 -last record
	nrecnobeforeeditmode = 0
	oldactivpage = 2
	oparam = .NULL.		&& lp_oParam
	oreferencetocallingobject = .NULL.
	WindowType = 0
	Tform12.DoCreate = .T.
	Tform12.Name = "Tform12"

	ADD OBJECT 'AddressSearchDialog' AS tform WITH ;
		AlwaysOnTop = .T., ;
		AutoCenter = .T., ;
		BorderStyle = 2, ;
		Caption = "", ;
		Closable = .T., ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = address, ;
		Height = 521, ;
		Icon = ..\bitmap\icons\binoculr.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Movable = .T., ;
		Name = "AddressSearchDialog", ;
		Width = 379, ;
		WindowState = 0, ;
		WindowType = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'AddressSearchDialog.CCancel' AS tcommandbutton WITH ;
		Caption = "CCancel", ;
		Height = 26, ;
		Left = 295, ;
		Name = "CCancel", ;
		Top = 48, ;
		Width = 74, ;
		ZOrderSet = 69
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'AddressSearchDialog.chapartner' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chapartner", ;
		Height = 17, ;
		Left = 13, ;
		Name = "chapartner", ;
		Top = 479, ;
		Width = 191, ;
		ZOrderSet = 65
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.chexactsearch' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chexactsearch", ;
		Height = 17, ;
		Left = 207, ;
		Name = "chexactsearch", ;
		Top = 479, ;
		Value = 1, ;
		Width = 165, ;
		ZOrderSet = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.chkmainserver' AS tcheckbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "chkmainserver", ;
		Height = 17, ;
		Left = 13, ;
		Name = "chkmainserver", ;
		Top = 500, ;
		Value = .T., ;
		Width = 99, ;
		ZOrderSet = 67
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.CSearch' AS tcommandbutton WITH ;
		Caption = "CSearch", ;
		Height = 26, ;
		Left = 295, ;
		Name = "CSearch", ;
		Top = 16, ;
		Width = 74, ;
		ZOrderSet = 68
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'AddressSearchDialog.FName' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "FName", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "FName", ;
		Top = 95, ;
		Width = 81, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LAddressType' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAddressType", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 12, ;
		Name = "LAddressType", ;
		Top = 158, ;
		Width = 81, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LAddrid' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAddrid", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LAddrid", ;
		Top = 221, ;
		Width = 81, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LEMail' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LEMail", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LEMail", ;
		Top = 179, ;
		Width = 81, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LFirma' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LFirma", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LFirma", ;
		Top = 11, ;
		Width = 81, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LMemberNumber' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LMember Number", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LMemberNumber", ;
		Top = 137, ;
		Width = 81, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LName' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LName", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LName", ;
		Top = 74, ;
		Width = 81, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LOrt' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LOrt", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LOrt", ;
		Top = 116, ;
		Width = 81, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LPhone' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LPhone", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LPhone", ;
		Top = 200, ;
		Width = 81, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LSearchAll' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "Suche in alle Felder", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LSearchAll", ;
		Top = 457, ;
		Width = 105, ;
		ZOrderSet = 63
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LSuchname' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LSuchname", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LSuchname", ;
		Top = 32, ;
		Width = 81, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LSuchnummer' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LSuchnummer", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LSuchnummer", ;
		Top = 53, ;
		Width = 81, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr1' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr1", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr1", ;
		Top = 242, ;
		Width = 81, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr10' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr10", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr10", ;
		Top = 431, ;
		Width = 81, ;
		ZOrderSet = 59
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr2' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr2", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr2", ;
		Top = 263, ;
		Width = 81, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr3' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr3", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr3", ;
		Top = 284, ;
		Width = 81, ;
		ZOrderSet = 31
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr4' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr4", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr4", ;
		Top = 305, ;
		Width = 81, ;
		ZOrderSet = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr5' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr5", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr5", ;
		Top = 326, ;
		Width = 81, ;
		ZOrderSet = 39
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr6' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr6", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr6", ;
		Top = 347, ;
		Width = 81, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr7' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr7", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr7", ;
		Top = 368, ;
		Width = 81, ;
		ZOrderSet = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr8' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr8", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr8", ;
		Top = 389, ;
		Width = 81, ;
		ZOrderSet = 51
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.LUsr9' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LUsr9", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "LUsr9", ;
		Top = 410, ;
		Width = 81, ;
		ZOrderSet = 55
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'AddressSearchDialog.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		Height = 519, ;
		Left = 1, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 2, ;
		Width = 377, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'AddressSearchDialog.TAd_addrid' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_addrid", ;
		SelectOnEntry = .T., ;
		Top = 217, ;
		Width = 185, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_adrtype' AS jcombobox WITH ;
		ColumnLines = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		jboundcolumn = 2, ;
		jcolumncount = 2, ;
		jcolumnwidths = 150,40, ;
		Left = 97, ;
		Name = "TAd_adrtype", ;
		SelectOnEntry = .T., ;
		Top = 154, ;
		Width = 185, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\libs\jbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'AddressSearchDialog.TAd_city' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_city", ;
		SelectOnEntry = .T., ;
		Top = 112, ;
		Width = 185, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_company' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_company", ;
		SelectOnEntry = .T., ;
		Top = 7, ;
		Width = 185, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_compkey' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_compkey", ;
		SelectOnEntry = .T., ;
		Top = 28, ;
		Width = 185, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_compnum' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_compnum", ;
		SelectOnEntry = .T., ;
		Top = 49, ;
		Width = 185, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_email' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_email", ;
		SelectOnEntry = .T., ;
		Top = 175, ;
		Width = 185, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_fname' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_fname", ;
		SelectOnEntry = .T., ;
		Top = 91, ;
		Width = 185, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_lname' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_lname", ;
		SelectOnEntry = .T., ;
		Top = 70, ;
		Width = 185, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TAd_member' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TAd_member", ;
		SelectOnEntry = .T., ;
		Top = 133, ;
		Width = 185, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox1' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox1", ;
		Top = 238, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox10' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox10", ;
		Top = 427, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 62
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox11' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox11", ;
		Top = 238, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 25
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox12' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox12", ;
		Top = 259, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 29
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox13' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox13", ;
		Top = 280, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 33
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox14' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox14", ;
		Top = 301, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox15' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox15", ;
		Top = 322, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 41
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox16' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox16", ;
		Top = 343, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox17' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox17", ;
		Top = 364, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 49
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox18' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox18", ;
		Top = 385, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox19' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox19", ;
		Top = 406, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 57
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox2' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox2", ;
		Top = 259, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 30
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox20' AS tcheckbox WITH ;
		Alignment = 0, ;
		Height = 21, ;
		Left = 97, ;
		Name = "Tcheckbox20", ;
		Top = 427, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 105, ;
		ZOrderSet = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox3' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox3", ;
		Top = 280, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox4' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox4", ;
		Top = 301, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 38
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox5' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox5", ;
		Top = 322, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 42
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox6' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox6", ;
		Top = 343, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox7' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox7", ;
		Top = 364, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 50
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox8' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox8", ;
		Top = 385, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 54
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.Tcheckbox9' AS tcheckbox WITH ;
		Alignment = 0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 204, ;
		Name = "Tcheckbox9", ;
		Top = 406, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 17, ;
		ZOrderSet = 58
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'AddressSearchDialog.TPhone' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "TPhone", ;
		SelectOnEntry = .T., ;
		Top = 196, ;
		Width = 185, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.TSearchAll' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "KR!", ;
		Left = 126, ;
		Name = "TSearchAll", ;
		SelectOnEntry = .T., ;
		Top = 453, ;
		Width = 156, ;
		ZOrderSet = 64
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr1' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr1", ;
		SelectOnEntry = .T., ;
		Top = 238, ;
		Width = 185, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr10' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr10", ;
		SelectOnEntry = .T., ;
		Top = 427, ;
		Width = 185, ;
		ZOrderSet = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr2' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr2", ;
		SelectOnEntry = .T., ;
		Top = 259, ;
		Width = 185, ;
		ZOrderSet = 28
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr3' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr3", ;
		SelectOnEntry = .T., ;
		Top = 280, ;
		Width = 185, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr4' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr4", ;
		SelectOnEntry = .T., ;
		Top = 301, ;
		Width = 185, ;
		ZOrderSet = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr5' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr5", ;
		SelectOnEntry = .T., ;
		Top = 322, ;
		Width = 185, ;
		ZOrderSet = 40
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr6' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr6", ;
		SelectOnEntry = .T., ;
		Top = 343, ;
		Width = 185, ;
		ZOrderSet = 44
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr7' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr7", ;
		SelectOnEntry = .T., ;
		Top = 364, ;
		Width = 185, ;
		ZOrderSet = 48
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr8' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr8", ;
		SelectOnEntry = .T., ;
		Top = 385, ;
		Width = 185, ;
		ZOrderSet = 52
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'AddressSearchDialog.txtAd_usr9' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 97, ;
		Name = "txtAd_usr9", ;
		SelectOnEntry = .T., ;
		Top = 406, ;
		Width = 185, ;
		ZOrderSet = 56
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog' AS tform WITH ;
		AlwaysOnTop = .T., ;
		AutoCenter = .T., ;
		BorderStyle = 2, ;
		Caption = "", ;
		Closable = .F., ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		Height = 250, ;
		Icon = ..\bitmap\icons\note16.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "ChangeApartnerDialog", ;
		Visible = .F., ;
		Width = 634, ;
		WindowState = 0, ;
		WindowType = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'ChangeApartnerDialog.CAp_Vip1' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Height = 20, ;
		Left = 386, ;
		Name = "CAp_Vip1", ;
		TabIndex = 10, ;
		Top = 62, ;
		Width = 25
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ChangeApartnerDialog.CCancel' AS tcommandbutton WITH ;
		Caption = "Cancel", ;
		Height = 25, ;
		Left = 364, ;
		Name = "CCancel", ;
		TabIndex = 17, ;
		Top = 214, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ChangeApartnerDialog.COk' AS tcommandbutton WITH ;
		Caption = "OK", ;
		Height = 25, ;
		Left = 188, ;
		Name = "COk", ;
		TabIndex = 15, ;
		Top = 214, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ChangeApartnerDialog.Combo1' AS ccbotitle WITH ;
		ctablelnamefield = thisformset.ChangeApartnerDialog.DataCopy.ap_lname, ;
		ctablesalutefield = thisformset.ChangeApartnerDialog.DataCopy.ap_salute, ;
		ctabletitlefield = thisformset.ChangeApartnerDialog.DataCopy.ap_title, ;
		Height = 21, ;
		Left = 93, ;
		Name = "Combo1", ;
		TabIndex = 3, ;
		Top = 82, ;
		Width = 55
		*< END OBJECT: ClassLib="..\libs\cit_address.vcx" BaseClass="combobox" />

	ADD OBJECT 'ChangeApartnerDialog.CUndo' AS tcommandbutton WITH ;
		Caption = "Undo", ;
		Height = 25, ;
		Left = 276, ;
		Name = "CUndo", ;
		TabIndex = 16, ;
		Top = 214, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_apid' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_apid", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_apid", ;
		TabIndex = 32, ;
		Top = 9, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Email' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Email", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_Email", ;
		TabIndex = 27, ;
		Top = 41, ;
		Width = 44
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Fax' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Fax", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Fax", ;
		TabIndex = 25, ;
		Top = 151, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Fname' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Fname", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Fname", ;
		TabIndex = 21, ;
		Top = 63, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Gebdate' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Gebdate", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_Gebdate", ;
		TabIndex = 28, ;
		Top = 85, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Lname' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Lname", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Lname", ;
		TabIndex = 22, ;
		Top = 41, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Phone1' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Phone1", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Phone1", ;
		TabIndex = 23, ;
		Top = 107, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Phone2' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Phone2", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Phone2", ;
		TabIndex = 24, ;
		Top = 129, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Salute' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Salute", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Salute", ;
		TabIndex = 26, ;
		Top = 174, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Title' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Title", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 12, ;
		Name = "LAp_Title", ;
		TabIndex = 20, ;
		Top = 85, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_User1' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_User1", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_User1", ;
		TabIndex = 29, ;
		Top = 107, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_User2' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_User2", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_User2", ;
		TabIndex = 30, ;
		Top = 129, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_User3' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_User3", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_User3", ;
		TabIndex = 31, ;
		Top = 151, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.LAp_Vip1' AS tlabel WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "LAp_Vip1", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 304, ;
		Name = "LAp_Vip1", ;
		TabIndex = 18, ;
		Top = 63, ;
		Width = 81
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ChangeApartnerDialog.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		BorderStyle = 1, ;
		Height = 175, ;
		Left = 3, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 29, ;
		Width = 297
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'ChangeApartnerDialog.Shape2' AS sh WITH ;
		BackStyle = 0, ;
		BorderStyle = 1, ;
		Height = 175, ;
		Left = 300, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 29, ;
		Width = 331
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'ChangeApartnerDialog.Shape3' AS sh WITH ;
		BackStyle = 0, ;
		Height = 250, ;
		Left = 0, ;
		Name = "Shape3", ;
		SpecialEffect = 0, ;
		Top = 0, ;
		Width = 634
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_apid' AS ttext WITH ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 93, ;
		Name = "TAp_apid", ;
		SelectOnEntry = .T., ;
		TabIndex = 19, ;
		Top = 5, ;
		Width = 102
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Email' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",60)), ;
		Left = 350, ;
		Name = "TAp_Email", ;
		SelectOnEntry = .T., ;
		TabIndex = 9, ;
		Top = 38, ;
		Width = 278
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Fax' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",100)), ;
		Left = 93, ;
		Name = "TAp_Fax", ;
		SelectOnEntry = .T., ;
		TabIndex = 7, ;
		Top = 148, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Fname' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",20)), ;
		Left = 93, ;
		Name = "TAp_Fname", ;
		SelectOnEntry = .T., ;
		TabIndex = 2, ;
		Top = 60, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Gebdate' AS ttext WITH ;
		FontSize = 8, ;
		Format = "K", ;
		Height = 21, ;
		Left = 385, ;
		Name = "TAp_Gebdate", ;
		SelectOnEntry = .T., ;
		TabIndex = 11, ;
		Top = 82, ;
		Width = 95
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Lname' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",30)), ;
		Left = 93, ;
		Name = "TAp_Lname", ;
		SelectOnEntry = .T., ;
		TabIndex = 1, ;
		Top = 38, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Phone1' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",20)), ;
		Left = 93, ;
		Name = "TAp_Phone1", ;
		SelectOnEntry = .T., ;
		TabIndex = 5, ;
		Top = 104, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Phone2' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",20)), ;
		Left = 93, ;
		Name = "TAp_Phone2", ;
		SelectOnEntry = .T., ;
		TabIndex = 6, ;
		Top = 126, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Salute' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",50)), ;
		Left = 93, ;
		Name = "TAp_Salute", ;
		SelectOnEntry = .T., ;
		TabIndex = 8, ;
		Top = 170, ;
		Width = 205
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_Title' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",20)), ;
		Left = 156, ;
		Name = "TAp_Title", ;
		SelectOnEntry = .T., ;
		TabIndex = 4, ;
		Top = 82, ;
		Width = 142
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_User1' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",30)), ;
		Left = 385, ;
		Name = "TAp_User1", ;
		SelectOnEntry = .T., ;
		TabIndex = 12, ;
		Top = 104, ;
		Width = 203
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_User2' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",30)), ;
		Left = 385, ;
		Name = "TAp_User2", ;
		SelectOnEntry = .T., ;
		TabIndex = 13, ;
		Top = 126, ;
		Width = 203
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'ChangeApartnerDialog.TAp_User3' AS ttext WITH ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("X",30)), ;
		Left = 385, ;
		Name = "TAp_User3", ;
		SelectOnEntry = .T., ;
		TabIndex = 14, ;
		Top = 148, ;
		Width = 203
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask' AS tform WITH ;
		AlwaysOnTop = .T., ;
		BorderStyle = 3, ;
		Caption = "", ;
		cformlabel = ADDRBOOK, ;
		ControlBox = .T., ;
		ctbrclass = cTbrAddress, ;
		DoCreate = .T., ;
		ForeColor = 192,192,192, ;
		formname = addressmask, ;
		Height = 481, ;
		Icon = ..\bitmap\icons\crdfle03.ico, ;
		KeyPreview = .T., ;
		MaxButton = .T., ;
		MinButton = .T., ;
		MinHeight = 100, ;
		MinWidth = 100, ;
		MouseIcon = ..\bitmap\cursors\drum.ani, ;
		Name = "FAddressMask", ;
		saveformsize = .T., ;
		savegridwidths = .T., ;
		ShowTips = .T., ;
		TabIndex = 1, ;
		TabStop = .T., ;
		Visible = .F., ;
		Width = 795, ;
		WindowState = 0, ;
		WindowType = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FAddressMask.Mail' AS hyperlink WITH ;
		Height = 22, ;
		Left = 12, ;
		Name = "Mail", ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: BaseClass="hyperlink" />

	ADD OBJECT 'FAddressMask.MainPage' AS tpageframe WITH ;
		ErasePage = .T., ;
		Height = 480, ;
		Left = 0, ;
		Name = "MainPage", ;
		PageCount = 2, ;
		RightToLeft = .T., ;
		Tabs = .T., ;
		TabStop = .T., ;
		Top = 1, ;
		Width = 796, ;
		ZOrderSet = 17, ;
		Page1.Caption = "Adressen", ;
		Page1.FontBold = .T., ;
		Page1.FontSize = 8, ;
		Page1.Name = "PageAddress", ;
		Page1.PageOrder = 1, ;
		Page2.Caption = "Adresen Überblick", ;
		Page2.FontBold = .T., ;
		Page2.FontSize = 8, ;
		Page2.Name = "PageGridAddress", ;
		Page2.PageOrder = 2
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.ad_vipstat' AS cad_vipstat WITH ;
		ColumnLines = .F., ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 516, ;
		Name = "ad_vipstat", ;
		TabIndex = 34, ;
		Top = 203, ;
		Width = 74
		*< END OBJECT: ClassLib="..\libs\cit_address.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.cboAdrType' AS jcombobox WITH ;
		ColumnLines = .F., ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 516, ;
		Name = "cboAdrType", ;
		TabIndex = 36, ;
		Top = 225, ;
		Width = 136
		*< END OBJECT: ClassLib="..\libs\jbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.chkAd_Vip' AS tcheckbox WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		Caption = "VIP", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Left = 744, ;
		Name = "chkAd_Vip", ;
		TabIndex = 37, ;
		Top = 204, ;
		Width = 40
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.chkAd_Vip2' AS tcheckbox WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		Caption = "VIP 2", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 740, ;
		Name = "chkAd_Vip2", ;
		SpecialEffect = 0, ;
		TabIndex = 38, ;
		Top = 228, ;
		Width = 44
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage' AS tpageframe WITH ;
		ErasePage = .T., ;
		Height = 194, ;
		Left = 436, ;
		Name = "InfoPage", ;
		PageCount = 2, ;
		Top = 3, ;
		Width = 355, ;
		Page1.Caption = "pagCommunication", ;
		Page1.Name = "pagCommunication", ;
		Page2.Caption = "pagGuestInfo", ;
		Page2.Name = "pagGuestInfo"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnBrowse' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 22, ;
		Left = 213, ;
		Name = "btnBrowse", ;
		Picture = ..\bitmap\toolbar\web16.png, ;
		ToolTipText = "Internet Seite in Browser öffnen", ;
		Top = 92, ;
		Width = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnCall' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 22, ;
		Left = 325, ;
		Name = "btnCall", ;
		Picture = ..\bitmap\toolbar\phone_2.png, ;
		PicturePosition = 13, ;
		Top = 4, ;
		Width = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnMail' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 22, ;
		Left = 325, ;
		Name = "btnMail", ;
		Picture = ..\bitmap\toolbar\mail.png, ;
		Top = 71, ;
		Visible = .F., ;
		Width = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_novat' AS tcheckbox WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		Caption = "chkad_novat", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Left = 258, ;
		Name = "chkad_novat", ;
		SpecialEffect = 0, ;
		Top = 117, ;
		Width = 88
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_save' AS tcheckbox WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		Caption = "chkad_save", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Left = 234, ;
		Name = "chkad_save", ;
		SpecialEffect = 0, ;
		Top = 95, ;
		Width = 112
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Email' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Email", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Email", ;
		Top = 74, ;
		Width = 56
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Fax' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Fax", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Fax", ;
		Top = 52, ;
		Width = 50
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Mail1' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Mail1", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Mail1", ;
		Top = 140, ;
		Width = 56
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Phone' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Phone", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Phone", ;
		Top = 8, ;
		Width = 62
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_Phone2' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Phone2", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Phone2", ;
		Top = 30, ;
		Width = 68
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_ustidnr' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_ustidnr", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_ustidnr", ;
		Top = 118, ;
		Width = 65
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.lblAd_website' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_website", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_website", ;
		Top = 96, ;
		Width = 71
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Email' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 80, ;
		MaxLength = 100, ;
		Name = "txtAd_Email", ;
		Top = 71, ;
		Width = 245
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Fax' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 80, ;
		MaxLength = 100, ;
		Name = "txtAd_Fax", ;
		Top = 49, ;
		Width = 266
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail1' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 80, ;
		Name = "txtAd_Mail1", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 137, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail2' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 134, ;
		Name = "txtAd_Mail2", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 137, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail3' AS tcombobox WITH ;
		BorderColor = 0,0,0, ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 188, ;
		Name = "txtAd_Mail3", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 137, ;
		Width = 52
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail4' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 241, ;
		Name = "txtAd_Mail4", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 137, ;
		Width = 52
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail5' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 294, ;
		Name = "txtAd_Mail5", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 137, ;
		Width = 52
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 80, ;
		MaxLength = 20, ;
		Name = "txtAd_Phone", ;
		Top = 5, ;
		Width = 245
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone2' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 80, ;
		MaxLength = 20, ;
		Name = "txtAd_Phone2", ;
		Top = 27, ;
		Width = 133
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone3' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 214, ;
		MaxLength = 20, ;
		Name = "txtAd_Phone3", ;
		Top = 27, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_ustidnr' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = "XXXXXXXXXXXXXXXXXXXX", ;
		Left = 80, ;
		Name = "txtad_ustidnr", ;
		Top = 115, ;
		Width = 178
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_website' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 80, ;
		MaxLength = 60, ;
		Name = "txtad_website", ;
		Top = 93, ;
		Width = 133
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.cboRoomname' AS cboroomname WITH ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 271, ;
		Name = "cboRoomname", ;
		Top = 27, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\cit_ctrl.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.ChkNomail' AS tcheckbox WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		Caption = "ChkNomail", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Left = 186, ;
		Name = "ChkNomail", ;
		SpecialEffect = 0, ;
		Top = 51, ;
		Width = 160
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Birth' AS tdatectrl WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		InputMask = "K", ;
		Left = 80, ;
		Name = "dtxtAd_Birth", ;
		Top = 49
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Memdat' AS tdatectrl WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		InputMask = "K", ;
		Left = 251, ;
		Name = "dtxtAd_Memdat", ;
		Top = 71, ;
		Width = 95
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Billins' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Billins", ;
		FontSize = 8, ;
		Left = 183, ;
		Name = "lblAd_Billins", ;
		Top = 8, ;
		Width = 59
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Birth' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Birth", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Birth", ;
		Top = 52, ;
		Width = 54
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Feat1' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Feat1", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Feat1", ;
		Top = 30, ;
		Width = 59
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Member' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Member", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Member", ;
		Top = 74, ;
		Width = 70
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Memdat' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Memdat", ;
		FontSize = 8, ;
		Left = 162, ;
		Name = "lblAd_Memdat", ;
		Top = 74, ;
		Width = 69
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblAd_Ratecod' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_Ratecod", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblAd_Ratecod", ;
		Top = 8, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblad_webpass' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblad_website", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblad_webpass", ;
		Top = 140, ;
		Width = 69
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblbmsaccount' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblbmsaccount", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblbmsaccount", ;
		Top = 96, ;
		Width = 71
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblCollectedPoints' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblCollectedPoints", ;
		FontSize = 8, ;
		Left = 162, ;
		Name = "lblCollectedPoints", ;
		Top = 96, ;
		Width = 85
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblTotalPoints' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblTotalPoints", ;
		FontSize = 8, ;
		Left = 6, ;
		Name = "lblTotalPoints", ;
		Top = 118, ;
		Width = 64
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.lblWishRoom' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblWishRoom", ;
		FontSize = 8, ;
		Left = 242, ;
		Name = "lblWishRoom", ;
		Top = 30, ;
		Width = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature' AS tselectctrl WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 80, ;
		Name = "stxtFeature", ;
		Top = 27, ;
		Width = 100, ;
		ZOrderSet = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Billins' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 246, ;
		Name = "txtAd_Billins", ;
		Top = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Feat1' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 186, ;
		Name = "txtAd_Feat1", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 134, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Member' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "K!", ;
		Height = 21, ;
		Left = 80, ;
		Name = "txtAd_Member", ;
		Top = 71, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Ratecod' AS tcombobox WITH ;
		ColumnCount = 5, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130,85,85,120", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 80, ;
		Name = "txtAd_Ratecod", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 5, ;
		Width = 100
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtad_webpass' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = "XXXXXX", ;
		Left = 80, ;
		MaxLength = 6, ;
		Name = "txtad_webpass", ;
		Top = 137, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtbmsaccount' AS ttext WITH ;
		Alignment = 3, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "K!", ;
		Height = 21, ;
		Left = 80, ;
		Name = "txtbmsaccount", ;
		Top = 93, ;
		Value = 0, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtCollectedPoints' AS ttext WITH ;
		Alignment = 3, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "K!", ;
		Height = 21, ;
		Left = 251, ;
		Name = "txtCollectedPoints", ;
		Top = 93, ;
		Value = 0, ;
		Width = 95
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtTotalPoints' AS ttext WITH ;
		Alignment = 3, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "K!", ;
		Height = 21, ;
		Left = 80, ;
		Name = "txtTotalPoints", ;
		Top = 115, ;
		Value = 0, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lbAD_Compkey' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lbAD_Compkey", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 197, ;
		Name = "lbAD_Compkey", ;
		Top = 121, ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lbAD_Lang' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lbAD_Lang", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lbAD_Lang", ;
		Top = 99, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lbAD_titcod' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lbAD_titcod", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 197, ;
		Name = "lbAD_titcod", ;
		Top = 99, ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Addrid' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Addrid", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Addrid", ;
		Top = 11, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblad_adid' AS tlabel WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "lblad_adid", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 167, ;
		Name = "lblad_adid", ;
		Top = 11, ;
		Visible = .F., ;
		Width = 50
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_adrtype' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_adrtype", ;
		FontSize = 8, ;
		Left = 442, ;
		Name = "lblAd_adrtype", ;
		Top = 228, ;
		Width = 69
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_City' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_City", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_City", ;
		Top = 238, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Company' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Company", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Company", ;
		Top = 33, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Compnum' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Compnum", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Compnum", ;
		Top = 121, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Departm' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Departm", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Departm", ;
		Top = 55, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Fname' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Fname", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 232, ;
		Name = "lblAd_Fname", ;
		Top = 77, ;
		Width = 65
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Salute' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Salute", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Salute", ;
		Top = 150, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_State' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_State", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_State", ;
		Top = 216, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Street' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Street", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Street", ;
		Top = 172, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_Street2' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Street2", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblAd_Street2", ;
		Top = 194, ;
		Width = 83
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblAd_vipstat' AS tlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "lblAd_vipstat", ;
		FontSize = 8, ;
		Left = 442, ;
		Name = "lblAd_vipstat", ;
		Top = 206, ;
		Width = 64
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.lblName' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblName", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 10, ;
		Name = "lblName", ;
		Top = 77, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.ocbotitle' AS ccbotitle WITH ;
		ColumnLines = .F., ;
		ctablelangfield = thisformset.datacopy.ad_lang, ;
		ctablelnamefield = thisformset.datacopy.ad_lname, ;
		ctablesalutefield = thisformset.datacopy.ad_salute, ;
		ctabletitlefield = thisformset.datacopy.ad_title, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 146, ;
		Name = "ocbotitle", ;
		Top = 95, ;
		Width = 48
		*< END OBJECT: ClassLib="..\libs\cit_address.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		Height = 139, ;
		Left = 3, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 3, ;
		Width = 433
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.Shape2' AS sh WITH ;
		BackStyle = 0, ;
		Height = 117, ;
		Left = 3, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 142, ;
		Width = 433
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.Shape3' AS sh WITH ;
		Height = 258, ;
		Left = 1, ;
		Name = "Shape3", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 790
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.Shape6' AS sh WITH ;
		BackStyle = 0, ;
		Enabled = .F., ;
		FillStyle = 1, ;
		Height = 195, ;
		Left = 1, ;
		Name = "Shape6", ;
		SpecialEffect = 0, ;
		Top = 259, ;
		Visible = .T., ;
		Width = 790
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage' AS tpageframe WITH ;
		ErasePage = .T., ;
		Height = 188, ;
		Left = 2, ;
		Name = "SlavePage", ;
		PageCount = 10, ;
		TabIndex = 39, ;
		Top = 260, ;
		Width = 789, ;
		Page1.Caption = "\<Ansprech Partner", ;
		Page1.FontSize = 8, ;
		Page1.Name = "PageApartner", ;
		Page1.PageOrder = 1, ;
		Page1.ToolTipText = "Ansprech Partner (STRG + A)", ;
		Page10.Caption = "Datenschutzerklärung", ;
		Page10.FontSize = 8, ;
		Page10.Name = "PagePrivacyPolicy", ;
		Page10.PageOrder = 10, ;
		Page10.ToolTipText = "Datenschutzerklärung (STRG + SHIFT + G)", ;
		Page2.Caption = "No\<tiz", ;
		Page2.FontSize = 8, ;
		Page2.Name = "PageNote", ;
		Page2.PageOrder = 2, ;
		Page2.ToolTipText = "Notiz (STRG + T)", ;
		Page3.Caption = "Doku\<ment", ;
		Page3.FontSize = 8, ;
		Page3.Name = "PageDokument", ;
		Page3.PageOrder = 3, ;
		Page3.ToolTipText = "Dokument (STRG + M)", ;
		Page4.Caption = "\<History", ;
		Page4.FontSize = 8, ;
		Page4.Name = "PageHistory", ;
		Page4.PageOrder = 4, ;
		Page4.ToolTipText = "History (STRG + H)", ;
		Page5.Caption = "Zu\<kunft", ;
		Page5.FontSize = 8, ;
		Page5.Name = "PageFuture", ;
		Page5.PageOrder = 5, ;
		Page5.ToolTipText = "Zukunft (STRG + K)", ;
		Page6.Caption = "\<Info", ;
		Page6.FontSize = 8, ;
		Page6.Name = "PageFree", ;
		Page6.PageOrder = 7, ;
		Page6.ToolTipText = "Info (STRG + I)", ;
		Page7.Caption = "Revenue", ;
		Page7.FontSize = 8, ;
		Page7.Name = "PageRevnue", ;
		Page7.PageOrder = 6, ;
		Page7.ToolTipText = "Umsatz (STRG + J)", ;
		Page8.Caption = "Referrals", ;
		Page8.FontSize = 8, ;
		Page8.Name = "PageReferral", ;
		Page8.PageOrder = 8, ;
		Page8.ToolTipText = "Adressverknüpfungen (STRG + G)", ;
		Page9.Caption = "PageSales", ;
		Page9.FontSize = 8, ;
		Page9.Name = "PageSales", ;
		Page9.PageOrder = 9, ;
		Page9.ToolTipText = "Sales (STRG + U)"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid' AS tgrid WITH ;
		AllowRowSizing = .F., ;
		ColumnCount = 13, ;
		DeleteMark = .F., ;
		DragMode = 0, ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		GridLines = 3, ;
		GridLineWidth = 1, ;
		HeaderHeight = 20, ;
		Height = 124, ;
		HighlightRow = .F., ;
		Left = 6, ;
		LinkMaster = "", ;
		lresizecolumns = .F., ;
		luseudpopupmenu = .T., ;
		Name = "ApartnerGrid", ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		ScrollBars = 3, ;
		setcolumns = .T., ;
		SplitBar = .T., ;
		TabIndex = 5, ;
		Top = 29, ;
		Width = 774, ;
		Column1.ControlSource = "", ;
		Column1.CurrentControl = "Tbgrid1", ;
		Column1.FontSize = 8, ;
		Column1.Movable = .F., ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 50, ;
		Column10.Enabled = .T., ;
		Column10.FontSize = 8, ;
		Column10.Movable = .F., ;
		Column10.Name = "Column10", ;
		Column10.ReadOnly = .T., ;
		Column10.Visible = .T., ;
		Column10.Width = 62, ;
		Column11.Enabled = .T., ;
		Column11.FontSize = 8, ;
		Column11.Movable = .F., ;
		Column11.Name = "Column11", ;
		Column11.ReadOnly = .T., ;
		Column11.Visible = .T., ;
		Column11.Width = 62, ;
		Column12.Enabled = .T., ;
		Column12.FontSize = 8, ;
		Column12.Movable = .F., ;
		Column12.Name = "Column12", ;
		Column12.ReadOnly = .T., ;
		Column12.Visible = .T., ;
		Column12.Width = 62, ;
		Column13.FontSize = 8, ;
		Column13.Movable = .F., ;
		Column13.Name = "Column13", ;
		Column13.ReadOnly = .T., ;
		Column2.Enabled = .T., ;
		Column2.FontSize = 8, ;
		Column2.Movable = .F., ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 75, ;
		Column3.Enabled = .T., ;
		Column3.FontSize = 8, ;
		Column3.Movable = .F., ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 75, ;
		Column4.Enabled = .T., ;
		Column4.FontSize = 8, ;
		Column4.Movable = .F., ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Visible = .T., ;
		Column4.Width = 70, ;
		Column5.Enabled = .T., ;
		Column5.FontSize = 8, ;
		Column5.Movable = .F., ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Visible = .T., ;
		Column5.Width = 70, ;
		Column6.Enabled = .T., ;
		Column6.FontSize = 8, ;
		Column6.Movable = .F., ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Visible = .T., ;
		Column6.Width = 70, ;
		Column7.Enabled = .T., ;
		Column7.FontSize = 8, ;
		Column7.Movable = .F., ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column7.Visible = .T., ;
		Column7.Width = 65, ;
		Column8.Alignment = 3, ;
		Column8.Bound = .T., ;
		Column8.ControlSource = "", ;
		Column8.CurrentControl = "Tcheckbox1", ;
		Column8.Enabled = .T., ;
		Column8.FontSize = 8, ;
		Column8.Movable = .F., ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Sparse = .F., ;
		Column8.Visible = .T., ;
		Column8.Width = 20, ;
		Column9.Enabled = .T., ;
		Column9.FontSize = 8, ;
		Column9.Movable = .F., ;
		Column9.Name = "Column9", ;
		Column9.ReadOnly = .T., ;
		Column9.Visible = .T., ;
		Column9.Width = 50
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column1.Header1' AS header WITH ;
		Caption = "hedAnrede", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column10.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column10.Tbgrid1' AS tbgrid WITH ;
		Left = 35, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column11.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column11.Tbgrid1' AS tbgrid WITH ;
		Left = 32, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column12.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column12.Tbgrid1' AS tbgrid WITH ;
		Left = 29, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column13.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column13.Tbgrid1' AS tbgrid WITH ;
		Left = 2, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column2.Header1' AS header WITH ;
		Caption = "hedName", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Left = 34, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column3.Header1' AS header WITH ;
		Caption = "hedVorname", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 27, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column6.Tbgrid1' AS tbgrid WITH ;
		Left = 16, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 17, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column8.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column8.Tcheckbox1' AS tcheckbox WITH ;
		Alignment = 0, ;
		Left = 11, ;
		Name = "Tcheckbox1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column9.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Column9.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.btnMail' AS tcommandbutton WITH ;
		Caption = "Mail", ;
		Height = 23, ;
		Left = 92, ;
		Name = "btnMail", ;
		Picture = ..\bitmap\toolbar\mail.png, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 4, ;
		Visible = .F., ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart' AS tcommandbutton WITH ;
		Caption = "Delete", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 54, ;
		Name = "cmdDelPart", ;
		Picture = ..\bitmap\toolbar\delete.png, ;
		PicturePosition = 14, ;
		TabIndex = 3, ;
		ToolTipText = "Ansprechpartner löschen", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart' AS tcommandbutton WITH ;
		Caption = "New", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 6, ;
		Name = "cmdNewAPart", ;
		Picture = ..\bitmap\toolbar\new.png, ;
		PicturePosition = 14, ;
		SpecialEffect = 0, ;
		TabIndex = 1, ;
		ToolTipText = "Neuen Ansprechpartner ", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner' AS tcommandbutton WITH ;
		Caption = "Edit", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 30, ;
		Name = "CUpdateApartner", ;
		Picture = ..\bitmap\toolbar\edit.png, ;
		PicturePosition = 14, ;
		TabIndex = 2, ;
		ToolTipText = "Ansprechpartner ändern", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		FillStyle = 1, ;
		Height = 158, ;
		Left = 2, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 781
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokDel' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 155, ;
		Name = "BDokDel", ;
		Picture = ..\bitmap\toolbar\delete.png, ;
		PicturePosition = 14, ;
		TabIndex = 7, ;
		ToolTipText = "Löschen", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokEdit' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 131, ;
		Name = "BDokEdit", ;
		Picture = ..\bitmap\toolbar\edit.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 6, ;
		ToolTipText = "Bearbeiten", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokNew' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 6, ;
		Name = "BDokNew", ;
		Picture = ..\bitmap\toolbar\new.png, ;
		PicturePosition = 14, ;
		SpecialEffect = 0, ;
		TabIndex = 2, ;
		ToolTipText = "Neu (F7)", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnMail' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 54, ;
		Name = "btnMail", ;
		Picture = ..\bitmap\toolbar\mail.png, ;
		PicturePosition = 14, ;
		TabIndex = 5, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnNewExternalDocument' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 104, ;
		Name = "btnNewExternalDocument", ;
		Picture = ..\bitmap\toolbar\zoomin.png, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnReply' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 79, ;
		Name = "btnReply", ;
		Picture = ..\bitmap\toolbar\mailreply.png, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid' AS tgrid WITH ;
		AllowHeaderSizing = .F., ;
		AllowRowSizing = .F., ;
		ColumnCount = 9, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 124, ;
		HighlightRow = .F., ;
		Left = 6, ;
		lresizecolumns = .F., ;
		luseudpopupmenu = .T., ;
		Name = "DokumentGrid", ;
		RecordMark = .F., ;
		RowHeight = 17, ;
		ScrollBars = 3, ;
		setcolumns = .T., ;
		TabIndex = 1, ;
		Top = 29, ;
		Width = 774, ;
		Column1.FontSize = 8, ;
		Column1.Movable = .F., ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 120, ;
		Column2.FontSize = 8, ;
		Column2.Movable = .F., ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 300, ;
		Column3.FontSize = 8, ;
		Column3.Movable = .F., ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 70, ;
		Column4.FontSize = 8, ;
		Column4.Movable = .F., ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 70, ;
		Column5.FontSize = 8, ;
		Column5.Movable = .F., ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 70, ;
		Column6.FontSize = 8, ;
		Column6.Movable = .F., ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column7.FontSize = 8, ;
		Column7.Movable = .F., ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column8.FontSize = 8, ;
		Column8.Movable = .F., ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column9.FontSize = 8, ;
		Column9.Movable = .F., ;
		Column9.Name = "Column9", ;
		Column9.ReadOnly = .F., ;
		Column9.Sparse = .F.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column1.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Left = 49, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column2.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Left = 204, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column3.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Left = 23, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 51
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Left = 36, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 51
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 13, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column6.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column8.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column8.Tbgrid1' AS tbgrid WITH ;
		Height = 72, ;
		Left = 8, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 27, ;
		Width = 48
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Tchkgrid1' AS tchkgrid WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Height = 72, ;
		Left = 16, ;
		Name = "Tchkgrid1", ;
		ReadOnly = .F., ;
		Top = 27, ;
		Width = 48
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		FillStyle = 1, ;
		Height = 154, ;
		Left = 2, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 781
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcChange' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 186, ;
		Name = "TcChange", ;
		Picture = ..\bitmap\toolbar\camcord.png, ;
		PicturePosition = 14, ;
		SpecialEffect = 0, ;
		TabIndex = 8, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcPhoneNote' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 30, ;
		Name = "TcPhoneNote", ;
		Picture = ..\bitmap\toolbar\phone01.png, ;
		PicturePosition = 14, ;
		SpecialEffect = 0, ;
		TabIndex = 3, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText1' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 153, ;
		Name = "FreeText1", ;
		TabIndex = 2, ;
		Top = 16, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText10' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 552, ;
		Name = "FreeText10", ;
		TabIndex = 21, ;
		Top = 113, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText2' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 153, ;
		Name = "FreeText2", ;
		TabIndex = 4, ;
		Top = 40, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText3' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 153, ;
		Name = "FreeText3", ;
		TabIndex = 6, ;
		Top = 64, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText4' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 153, ;
		Name = "FreeText4", ;
		TabIndex = 8, ;
		Top = 88, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText5' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 153, ;
		Name = "FreeText5", ;
		TabIndex = 10, ;
		Top = 112, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText6' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 552, ;
		Name = "FreeText6", ;
		TabIndex = 12, ;
		Top = 17, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText7' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 552, ;
		Name = "FreeText7", ;
		TabIndex = 14, ;
		Top = 41, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 552, ;
		Name = "FreeText8", ;
		TabIndex = 17, ;
		Top = 65, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText9' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 552, ;
		Name = "FreeText9", ;
		TabIndex = 19, ;
		Top = 89, ;
		Width = 220
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree1' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 1", ;
		Height = 17, ;
		Left = 8, ;
		Name = "LFree1", ;
		TabIndex = 21, ;
		Top = 19, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree10' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "LFree10", ;
		Height = 17, ;
		Left = 407, ;
		Name = "LFree10", ;
		TabIndex = 29, ;
		Top = 116, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree2' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 2", ;
		Height = 17, ;
		Left = 8, ;
		Name = "LFree2", ;
		TabIndex = 22, ;
		Top = 43, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree3' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 3", ;
		Height = 17, ;
		Left = 8, ;
		Name = "LFree3", ;
		TabIndex = 23, ;
		Top = 67, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree4' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 4", ;
		Height = 17, ;
		Left = 8, ;
		Name = "LFree4", ;
		TabIndex = 24, ;
		Top = 91, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree5' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 5", ;
		Height = 17, ;
		Left = 8, ;
		Name = "LFree5", ;
		TabIndex = 30, ;
		Top = 115, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree6' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "Frei 6", ;
		Height = 17, ;
		Left = 407, ;
		Name = "LFree6", ;
		TabIndex = 28, ;
		Top = 20, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree7' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "LFree7", ;
		Height = 17, ;
		Left = 407, ;
		Name = "LFree7", ;
		TabIndex = 26, ;
		Top = 44, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree8' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "LFree8", ;
		Height = 17, ;
		Left = 407, ;
		Name = "LFree8", ;
		TabIndex = 25, ;
		Top = 68, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.LFree9' AS tlabel WITH ;
		AutoSize = .F., ;
		Caption = "LFree9", ;
		Height = 17, ;
		Left = 407, ;
		Name = "LFree9", ;
		TabIndex = 27, ;
		Top = 92, ;
		Width = 140
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.tcbCallBankForm' AS tcommandbutton WITH ;
		Caption = "...", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 530, ;
		Name = "tcbCallBankForm", ;
		TabIndex = 15, ;
		Top = 67, ;
		Visible = .F., ;
		Width = 21
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox1' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 153, ;
		Name = "Tcheckbox1", ;
		TabIndex = 1, ;
		Top = 16, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox10' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 552, ;
		Name = "Tcheckbox10", ;
		TabIndex = 20, ;
		Top = 113, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox2' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 153, ;
		Name = "Tcheckbox2", ;
		TabIndex = 3, ;
		Top = 40, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox3' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 153, ;
		Name = "Tcheckbox3", ;
		TabIndex = 5, ;
		Top = 64, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox4' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 153, ;
		Name = "Tcheckbox4", ;
		TabIndex = 7, ;
		Top = 88, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox5' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 153, ;
		Name = "Tcheckbox5", ;
		TabIndex = 9, ;
		Top = 112, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox6' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 552, ;
		Name = "Tcheckbox6", ;
		TabIndex = 11, ;
		Top = 17, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox7' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 552, ;
		Name = "Tcheckbox7", ;
		TabIndex = 13, ;
		Top = 41, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox8' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 552, ;
		Name = "Tcheckbox8", ;
		TabIndex = 16, ;
		Top = 65, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Tcheckbox9' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Height = 17, ;
		Left = 552, ;
		Name = "Tcheckbox9", ;
		TabIndex = 18, ;
		Top = 89, ;
		Value = .F., ;
		Visible = .F., ;
		Width = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutDel' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 54, ;
		Name = "BFutDel", ;
		Picture = ..\bitmap\toolbar\delete.png, ;
		PicturePosition = 14, ;
		TabIndex = 3, ;
		ToolTipText = "Löschen", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutEdit' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 30, ;
		Name = "BFutEdit", ;
		Picture = ..\bitmap\toolbar\edit.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 2, ;
		ToolTipText = "Bearbeiten", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutNew' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 6, ;
		Name = "BFutNew", ;
		Picture = ..\bitmap\toolbar\new.png, ;
		PicturePosition = 14, ;
		SpecialEffect = 0, ;
		TabIndex = 1, ;
		ToolTipText = "Neu", ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.cmdFutAlt' AS tcommandbutton WITH ;
		Caption = "", ;
		FontName = "Arial", ;
		FontSize = 9, ;
		Height = 23, ;
		Left = 84, ;
		Name = "cmdFutAlt", ;
		Picture = ..\bitmap\toolbar\allott.png, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid' AS tgrid WITH ;
		ColumnCount = 13, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 124, ;
		HighlightRow = .F., ;
		Left = 6, ;
		lresizecolumns = .F., ;
		luseudpopupmenu = .T., ;
		Name = "FutureGrid", ;
		RecordMark = .F., ;
		RowHeight = 17, ;
		ScrollBars = 3, ;
		setcolumns = .T., ;
		Top = 29, ;
		Width = 774, ;
		Column1.FontSize = 8, ;
		Column1.Movable = .F., ;
		Column1.Name = "Column1", ;
		Column1.Width = 58, ;
		Column10.FontSize = 8, ;
		Column10.Movable = .F., ;
		Column10.Name = "Column10", ;
		Column10.Width = 58, ;
		Column11.FontSize = 8, ;
		Column11.Movable = .F., ;
		Column11.Name = "Column11", ;
		Column11.Width = 58, ;
		Column12.FontSize = 8, ;
		Column12.Movable = .F., ;
		Column12.Name = "Column12", ;
		Column12.Width = 58, ;
		Column13.FontSize = 8, ;
		Column13.Name = "Column13", ;
		Column2.FontSize = 8, ;
		Column2.Movable = .F., ;
		Column2.Name = "Column2", ;
		Column2.Width = 58, ;
		Column3.FontSize = 8, ;
		Column3.Movable = .F., ;
		Column3.Name = "Column3", ;
		Column3.Width = 58, ;
		Column4.FontSize = 8, ;
		Column4.Movable = .F., ;
		Column4.Name = "Column4", ;
		Column4.Width = 58, ;
		Column5.FontSize = 8, ;
		Column5.Movable = .F., ;
		Column5.Name = "Column5", ;
		Column5.Width = 58, ;
		Column6.FontSize = 8, ;
		Column6.Movable = .F., ;
		Column6.Name = "Column6", ;
		Column6.Width = 58, ;
		Column7.FontSize = 8, ;
		Column7.Movable = .F., ;
		Column7.Name = "Column7", ;
		Column7.Width = 58, ;
		Column8.FontSize = 8, ;
		Column8.Movable = .F., ;
		Column8.Name = "Column8", ;
		Column8.Width = 58, ;
		Column9.FontSize = 8, ;
		Column9.Movable = .F., ;
		Column9.Name = "Column9", ;
		Column9.Width = 58
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column1.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column10.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column10.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column11.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column11.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column12.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column12.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column13.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column13.Tbgrid1' AS tbgrid WITH ;
		FontSize = 8, ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column2.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column3.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column6.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column8.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column8.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column9.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Column9.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		FillStyle = 1, ;
		Height = 154, ;
		Left = 2, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 781
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.Edit1' AS teditbox WITH ;
		DisabledForeColor = 0,0,0, ;
		Height = 145, ;
		Left = 4, ;
		Name = "Edit1", ;
		ReadOnly = .T., ;
		ScrollBars = 2, ;
		SelectOnEntry = .T., ;
		Top = 5, ;
		Width = 520
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.lblAd_Created' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Created", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 528, ;
		Name = "lblAd_Created", ;
		TabIndex = 48, ;
		Top = 8, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.lblAd_Updated' AS tlabel WITH ;
		BackStyle = 0, ;
		Caption = "lblAd_Updated", ;
		FontSize = 8, ;
		Height = 14, ;
		Left = 528, ;
		Name = "lblAd_Updated", ;
		TabIndex = 75, ;
		Top = 30, ;
		Width = 80
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Created' AS ttext WITH ;
		Alignment = 2, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 615, ;
		Name = "txtAd_Created", ;
		TabIndex = 44, ;
		Top = 4, ;
		Width = 92
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Updated' AS ttext WITH ;
		Alignment = 2, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 705, ;
		Name = "txtAd_Updated", ;
		TabIndex = 45, ;
		Top = 26, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageNote.txtAd_Userid' AS ttext WITH ;
		Alignment = 2, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 615, ;
		Name = "txtAd_Userid", ;
		TabIndex = 45, ;
		Top = 26, ;
		Width = 89
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacypolicy' AS privacypolicy WITH ;
		cdatavar = thisformset.DataCopyPp, ;
		Height = 165, ;
		Left = 32, ;
		Name = "oPrivacypolicy", ;
		Top = -6, ;
		cboAp_consent.Name = "cboAp_consent", ;
		chkAp_nomail.Alignment = 0, ;
		chkAp_nomail.Name = "chkAp_nomail", ;
		chkAp_user1.Alignment = 0, ;
		chkAp_user1.Name = "chkAp_user1", ;
		chkAp_user2.Alignment = 0, ;
		chkAp_user2.Name = "chkAp_user2", ;
		chkAp_user3.Alignment = 0, ;
		chkAp_user3.Name = "chkAp_user3", ;
		chkAp_user4.Alignment = 0, ;
		chkAp_user4.Name = "chkAp_user4", ;
		chkAp_user5.Alignment = 0, ;
		chkAp_user5.Name = "chkAp_user5", ;
		cmdAddressHistory.Name = "cmdAddressHistory", ;
		cmdConsent.Name = "cmdConsent", ;
		cmdDeleteConfirmation.Name = "cmdDeleteConfirmation", ;
		cmdDownload.Name = "cmdDownload", ;
		cmdPreview.Name = "cmdPreview", ;
		cmdRemove.Name = "cmdRemove", ;
		cmdSave.Name = "cmdSave", ;
		cmdSave.Visible = .F., ;
		cmdUpload.Name = "cmdUpload", ;
		dtxtAp_issued.Name = "dtxtAp_issued", ;
		dtxtAp_user1.Name = "dtxtAp_user1", ;
		dtxtAp_user2.Name = "dtxtAp_user2", ;
		dtxtAp_user3.Name = "dtxtAp_user3", ;
		dtxtAp_user4.Name = "dtxtAp_user4", ;
		dtxtAp_user5.Name = "dtxtAp_user5", ;
		lblAp_cnfalas.Name = "lblAp_cnfalas", ;
		lblAp_consent.Name = "lblAp_consent", ;
		lblAp_issudby.Name = "lblAp_issudby", ;
		lblAp_issued.Name = "lblAp_issued", ;
		lblAp_note.Name = "lblAp_note", ;
		lblAp_user1.Name = "lblAp_user1", ;
		lblAp_user2.Name = "lblAp_user2", ;
		lblAp_user3.Name = "lblAp_user3", ;
		lblAp_user4.Name = "lblAp_user4", ;
		lblAp_user5.Name = "lblAp_user5", ;
		lblAp_userid.Name = "lblAp_userid", ;
		txtAp_cnfalas.Name = "txtAp_cnfalas", ;
		txtAp_issudby.Name = "txtAp_issudby", ;
		txtAp_note.Name = "txtAp_note", ;
		txtAp_user1.Name = "txtAp_user1", ;
		txtAp_user2.Name = "txtAp_user2", ;
		txtAp_user3.Name = "txtAp_user3", ;
		txtAp_user4.Name = "txtAp_user4", ;
		txtAp_user5.Name = "txtAp_user5", ;
		txtAp_userid.Name = "txtAp_userid"
		*< END OBJECT: ClassLib="..\libs\cit_address.vcx" BaseClass="container" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRDelete' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 58, ;
		Name = "BRDelete", ;
		Picture = ..\bitmap\toolbar\delete.png, ;
		PicturePosition = 14, ;
		TabIndex = 3, ;
		Top = 5, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BREdit' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 32, ;
		Name = "BREdit", ;
		Picture = ..\bitmap\toolbar\edit.png, ;
		PicturePosition = 14, ;
		TabIndex = 2, ;
		Top = 5, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRGoto' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 103, ;
		Name = "BRGoto", ;
		Picture = ..\bitmap\toolbar\jump.png, ;
		PicturePosition = 14, ;
		TabIndex = 4, ;
		Top = 5, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRNew' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 6, ;
		Name = "BRNew", ;
		Picture = ..\bitmap\toolbar\new.png, ;
		PicturePosition = 14, ;
		TabIndex = 1, ;
		Top = 5, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.cmdshowreferrals' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 131, ;
		Name = "cmdshowreferrals", ;
		Picture = ..\bitmap\toolbar\camcord.png, ;
		PicturePosition = 14, ;
		TabIndex = 5, ;
		Top = 5, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral' AS tgrid WITH ;
		ColumnCount = 7, ;
		DeleteMark = .F., ;
		GridLineColor = 192,192,192, ;
		Height = 119, ;
		Left = 5, ;
		lresizecolumns = .F., ;
		luseudpopupmenu = .T., ;
		Name = "TgridReferral", ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RowHeight = 18, ;
		ScrollBars = 2, ;
		setcolumns = .T., ;
		TabIndex = 6, ;
		Top = 34, ;
		Width = 771, ;
		Column1.FontSize = 9, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 52, ;
		Column2.FontSize = 9, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 52, ;
		Column3.FontSize = 9, ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 52, ;
		Column4.FontSize = 9, ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 52, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 170, ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column1.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 9, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column1.Tbgrid1' AS tbgrid WITH ;
		FontSize = 9, ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column2.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 9, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column2.Tbgrid1' AS tbgrid WITH ;
		FontSize = 9, ;
		Left = 16, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column3.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 9, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column3.Tbgrid1' AS tbgrid WITH ;
		FontSize = 9, ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 9, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column4.Tbgrid1' AS tbgrid WITH ;
		FontSize = 9, ;
		Left = 32, ;
		Name = "Tbgrid1", ;
		ReadOnly = .T., ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column6.Tbgrid1' AS tbgrid WITH ;
		Left = 50, ;
		Name = "Tbgrid1", ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 47, ;
		Name = "Tbgrid1", ;
		Top = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.BHistPrint' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 7, ;
		Name = "BHistPrint", ;
		Picture = ..\bitmap\toolbar\print.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 1, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdBillPreview' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 103, ;
		Name = "cmdBillPreview", ;
		Picture = ..\bitmap\toolbar\bill-hist.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 5, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdCopyReservation' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 55, ;
		Name = "cmdCopyReservation", ;
		Picture = ..\bitmap\toolbar\copy.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 3, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdSearchReservation' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 79, ;
		Name = "cmdSearchReservation", ;
		Picture = ..\bitmap\toolbar\search.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 4, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdShowReservation' AS tcommandbutton WITH ;
		Caption = "", ;
		Height = 23, ;
		Left = 31, ;
		Name = "cmdShowReservation", ;
		Picture = ..\bitmap\toolbar\preview.png, ;
		PicturePosition = 14, ;
		Style = 0, ;
		TabIndex = 2, ;
		Top = 4, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid' AS tgrid WITH ;
		ColumnCount = 15, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 124, ;
		HighlightRow = .F., ;
		Left = 6, ;
		lresizecolumns = .F., ;
		luseudpopupmenu = .T., ;
		Name = "RevnueGrid", ;
		RecordMark = .F., ;
		RowHeight = 17, ;
		ScrollBars = 3, ;
		setcolumns = .T., ;
		TabIndex = 5, ;
		Top = 29, ;
		Width = 774, ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.Width = 58, ;
		Column10.FontSize = 8, ;
		Column10.Name = "Column10", ;
		Column10.Width = 58, ;
		Column11.FontSize = 8, ;
		Column11.Name = "Column11", ;
		Column11.Width = 58, ;
		Column12.FontSize = 8, ;
		Column12.Name = "Column12", ;
		Column12.Width = 58, ;
		Column13.FontSize = 8, ;
		Column13.Name = "Column13", ;
		Column13.Width = 58, ;
		Column14.FontSize = 8, ;
		Column14.Name = "Column14", ;
		Column14.Width = 58, ;
		Column15.FontSize = 8, ;
		Column15.Name = "Column15", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.Width = 58, ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.Width = 58, ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column4", ;
		Column4.Width = 58, ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column5", ;
		Column5.Width = 58, ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column6", ;
		Column6.Width = 58, ;
		Column7.FontSize = 8, ;
		Column7.Name = "Column7", ;
		Column7.Width = 58, ;
		Column8.FontSize = 8, ;
		Column8.Name = "Column8", ;
		Column8.Width = 58, ;
		Column9.FontSize = 8, ;
		Column9.Name = "Column9", ;
		Column9.Width = 58
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column1.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column10.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column10.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column11.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column11.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column12.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column12.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column13.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column13.Tbgrid1' AS tbgrid WITH ;
		Left = 24, ;
		Name = "Tbgrid1", ;
		Top = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column14.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column14.Tbgrid1' AS tbgrid WITH ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 29
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column15.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column15.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1", ;
		ReadOnly = .F.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column2.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column3.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column6.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column8.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column8.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column9.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column9.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		FillStyle = 1, ;
		Height = 154, ;
		Left = 2, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 781
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_discnt' AS jcbomain WITH ;
		cwhere = pl_label = 'DISCOUNT  ' AND NOT pl_inactiv, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		lappendblank = .F., ;
		Left = 719, ;
		Name = "cboAd_discnt", ;
		TabIndex = 8, ;
		Top = 54, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\jbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_market' AS jcbomarket WITH ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		lappendblank = .F., ;
		Left = 478, ;
		Name = "cboAd_market", ;
		TabIndex = 6, ;
		Top = 54, ;
		Width = 60, ;
		ZOrderSet = 34
		*< END OBJECT: ClassLib="..\libs\cit_ctrl.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cboAd_source' AS jcbosource WITH ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		lappendblank = .F., ;
		Left = 598, ;
		Name = "cboAd_source", ;
		TabIndex = 7, ;
		Top = 54, ;
		Width = 60, ;
		ZOrderSet = 36
		*< END OBJECT: ClassLib="..\libs\cit_ctrl.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdIntrests' AS tcommandbutton WITH ;
		Caption = "...", ;
		Height = 17, ;
		Left = 8, ;
		Name = "cmdIntrests", ;
		TabIndex = 2, ;
		Top = 100, ;
		Width = 21
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdRates' AS tcommandbutton WITH ;
		Caption = "...", ;
		Height = 17, ;
		Left = 8, ;
		Name = "cmdRates", ;
		TabIndex = 1, ;
		Top = 32, ;
		Width = 21
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdReIntervals' AS tcommandbutton WITH ;
		Caption = "...", ;
		Height = 17, ;
		Left = 215, ;
		Name = "cmdReIntervals", ;
		TabIndex = 4, ;
		Top = 100, ;
		Width = 21
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.edtIntrests' AS teditbox WITH ;
		BackStyle = 0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 40, ;
		Left = 8, ;
		Name = "edtIntrests", ;
		ReadOnly = .T., ;
		TabIndex = 3, ;
		Top = 118, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.edtResIntervals' AS teditbox WITH ;
		BackStyle = 0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 40, ;
		Left = 215, ;
		Name = "edtResIntervals", ;
		ReadOnly = .T., ;
		TabIndex = 5, ;
		Top = 118, ;
		Width = 192
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_discnt' AS tlabel WITH ;
		Caption = "lblAd_discnt", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 669, ;
		Name = "lblAd_discnt", ;
		TabIndex = 85, ;
		Top = 57, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_market' AS tlabel WITH ;
		Caption = "lblAd_market", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 428, ;
		Name = "lblAd_market", ;
		TabIndex = 84, ;
		Top = 57, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblAd_source' AS tlabel WITH ;
		Caption = "lblAd_source", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 548, ;
		Name = "lblAd_source", ;
		TabIndex = 86, ;
		Top = 57, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblExpectedRevOcc' AS tlabel WITH ;
		Caption = "lblExpectedRevOcc", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblExpectedRevOcc", ;
		TabIndex = 46, ;
		Top = 92, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblForecast' AS tlabel WITH ;
		Caption = "lblForecast", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblForecast", ;
		TabIndex = 45, ;
		Top = 80, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblIntrests' AS tlabel WITH ;
		Caption = "lblIntrests", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 32, ;
		Name = "lblIntrests", ;
		TabIndex = 71, ;
		Top = 102, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLast' AS tlabel WITH ;
		Caption = "lblLast", ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblLast", ;
		TabIndex = 79, ;
		Top = 53, ;
		Width = 48
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastContact' AS tlabel WITH ;
		Caption = "lblLastContact", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblLastContact", ;
		TabIndex = 75, ;
		Top = 83, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastContactType' AS tlabel WITH ;
		Caption = "lblLastContactType", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 170, ;
		Name = "lblLastContactType", ;
		TabIndex = 77, ;
		Top = 83, ;
		Width = 79
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPrice' AS tlabel WITH ;
		Caption = "lblLastPrice", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 173, ;
		Name = "lblLastPrice", ;
		TabIndex = 11, ;
		Top = 0, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild1' AS tlabel WITH ;
		Caption = "lblLastPriceChild1", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 291, ;
		Name = "lblLastPriceChild1", ;
		TabIndex = 19, ;
		Top = 12, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild2' AS tlabel WITH ;
		Caption = "lblLastPriceChild2", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 291, ;
		Name = "lblLastPriceChild2", ;
		TabIndex = 21, ;
		Top = 24, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastPriceChild3' AS tlabel WITH ;
		Caption = "lblLastPriceChild3", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 291, ;
		Name = "lblLastPriceChild3", ;
		TabIndex = 23, ;
		Top = 36, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRatecode' AS tlabel WITH ;
		Caption = "lblLastRatecode", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblLastRatecode", ;
		TabIndex = 9, ;
		Top = 0, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRoom' AS tlabel WITH ;
		Caption = "lblLastRoom", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 176, ;
		Name = "lblLastRoom", ;
		TabIndex = 27, ;
		Top = 53, ;
		Width = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastRoomtype' AS tlabel WITH ;
		Caption = "lblLastRoomtype", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 56, ;
		Name = "lblLastRoomtype", ;
		TabIndex = 25, ;
		Top = 53, ;
		Width = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblLastStay' AS tlabel WITH ;
		Caption = "lblLastStay", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblLastStay", ;
		TabIndex = 29, ;
		Top = 68, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblMarket' AS tlabel WITH ;
		Caption = "lblMarket", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 292, ;
		Name = "lblMarket", ;
		TabIndex = 80, ;
		Top = 53, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblNext30days' AS tlabel WITH ;
		Caption = "lblNext30days", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblNext30days", ;
		TabIndex = 48, ;
		Top = 116, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblNext365Days' AS tlabel WITH ;
		Caption = "lblNext365Days", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblNext365Days", ;
		TabIndex = 50, ;
		Top = 140, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblOpenBalance' AS tlabel WITH ;
		Caption = "lblOpenBalance", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 429, ;
		Name = "lblOpenBalance", ;
		TabIndex = 33, ;
		Top = 0, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult1' AS tlabel WITH ;
		Caption = "lblPriceAdult1", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 173, ;
		Name = "lblPriceAdult1", ;
		TabIndex = 13, ;
		Top = 12, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult2' AS tlabel WITH ;
		Caption = "lblPriceAdult2", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 173, ;
		Name = "lblPriceAdult2", ;
		TabIndex = 15, ;
		Top = 24, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblPriceAdult3' AS tlabel WITH ;
		Caption = "lblPriceAdult3", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 173, ;
		Name = "lblPriceAdult3", ;
		TabIndex = 17, ;
		Top = 36, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRatecode' AS tlabel WITH ;
		Caption = "lblRatecode", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblRatecode", ;
		TabIndex = 73, ;
		Top = 12, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem0' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lblRem1", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 417, ;
		Name = "lblRem0", ;
		TabIndex = 35, ;
		Top = 19, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem1' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lblRem1", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 489, ;
		Name = "lblRem1", ;
		TabIndex = 36, ;
		Top = 19, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem2' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lblRem2", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 562, ;
		Name = "lblRem2", ;
		TabIndex = 37, ;
		Top = 19, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRem3' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lblRem3", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 633, ;
		Name = "lblRem3", ;
		TabIndex = 38, ;
		Top = 19, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRemX' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lblRemX", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 706, ;
		Name = "lblRemX", ;
		TabIndex = 43, ;
		Top = 19, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblResIntervals' AS tlabel WITH ;
		Caption = "lblResIntervals", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 239, ;
		Name = "lblResIntervals", ;
		TabIndex = 72, ;
		Top = 102, ;
		Width = 141
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom1' AS tlabel WITH ;
		Caption = "lblRoom1", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 720, ;
		Name = "lblRoom1", ;
		TabIndex = 66, ;
		Top = 92, ;
		Width = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom2' AS tlabel WITH ;
		Caption = "lblRoom2", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 720, ;
		Name = "lblRoom2", ;
		TabIndex = 67, ;
		Top = 104, ;
		Width = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom3' AS tlabel WITH ;
		Caption = "lblRoom3", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 720, ;
		Name = "lblRoom3", ;
		TabIndex = 68, ;
		Top = 116, ;
		Width = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom4' AS tlabel WITH ;
		Caption = "lblRoom4", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 720, ;
		Name = "lblRoom4", ;
		TabIndex = 69, ;
		Top = 128, ;
		Width = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRoom5' AS tlabel WITH ;
		Caption = "lblRoom5", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 720, ;
		Name = "lblRoom5", ;
		TabIndex = 70, ;
		Top = 140, ;
		Width = 46
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash1' AS tlabel WITH ;
		Caption = "/", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 642, ;
		Name = "lblSlash1", ;
		TabIndex = 61, ;
		Top = 92, ;
		Width = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash2' AS tlabel WITH ;
		Caption = "/", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 642, ;
		Name = "lblSlash2", ;
		TabIndex = 62, ;
		Top = 104, ;
		Width = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash3' AS tlabel WITH ;
		Caption = "/", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 642, ;
		Name = "lblSlash3", ;
		TabIndex = 63, ;
		Top = 116, ;
		Width = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash4' AS tlabel WITH ;
		Caption = "/", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 642, ;
		Name = "lblSlash4", ;
		TabIndex = 64, ;
		Top = 128, ;
		Width = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSlash5' AS tlabel WITH ;
		Caption = "/", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 642, ;
		Name = "lblSlash5", ;
		TabIndex = 65, ;
		Top = 140, ;
		Width = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblSource' AS tlabel WITH ;
		Caption = "lblSource", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 292, ;
		Name = "lblSource", ;
		TabIndex = 82, ;
		Top = 68, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntil' AS tlabel WITH ;
		Caption = "-", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 17, ;
		Left = 130, ;
		Name = "lblUntil", ;
		TabIndex = 32, ;
		Top = 68, ;
		Width = 9
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntilMonthEnd' AS tlabel WITH ;
		Caption = "lblUntilMonthEnd", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblUntilMonthEnd", ;
		TabIndex = 47, ;
		Top = 104, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblUntilYearEnd' AS tlabel WITH ;
		Caption = "lblUntilYearEnd", ;
		DisabledForeColor = 0,0,0, ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 428, ;
		Name = "lblUntilYearEnd", ;
		TabIndex = 49, ;
		Top = 128, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArHorizontal1' AS ln WITH ;
		Height = 0, ;
		Left = 416, ;
		Name = "LinArHorizontal1", ;
		Top = 18, ;
		Width = 362
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArHorizontal2' AS ln WITH ;
		Height = 0, ;
		Left = 416, ;
		Name = "LinArHorizontal2", ;
		Top = 35, ;
		Width = 362
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical1' AS ln WITH ;
		Height = 35, ;
		Left = 486, ;
		Name = "LinArVertical1", ;
		Top = 18, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical2' AS ln WITH ;
		Height = 35, ;
		Left = 559, ;
		Name = "LinArVertical2", ;
		Top = 18, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical3' AS ln WITH ;
		Height = 35, ;
		Left = 630, ;
		Name = "LinArVertical3", ;
		Top = 18, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical4' AS ln WITH ;
		Height = 35, ;
		Left = 702, ;
		Name = "LinArVertical4", ;
		Top = 18, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinArVertical5' AS ln WITH ;
		Height = 35, ;
		Left = 778, ;
		Name = "LinArVertical5", ;
		Top = 18, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.linFcHorizontal' AS ln WITH ;
		Height = 0, ;
		Left = 416, ;
		Name = "linFcHorizontal", ;
		Top = 77, ;
		Width = 362
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.LinLargeHorizontal' AS ln WITH ;
		Height = 0, ;
		Left = 8, ;
		Name = "LinLargeHorizontal", ;
		Top = 52, ;
		Width = 770
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.linLargeVertical' AS ln WITH ;
		Height = 155, ;
		Left = 415, ;
		Name = "linLargeVertical", ;
		Top = 3, ;
		Width = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtContactDate' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 70, ;
		Name = "txtContactDate", ;
		TabIndex = 76, ;
		Top = 81, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtContactType' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 252, ;
		Name = "txtContactType", ;
		TabIndex = 78, ;
		Top = 81, ;
		Width = 48
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtExpectedOcc' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 667, ;
		Name = "txtExpectedOcc", ;
		TabIndex = 52, ;
		Top = 90, ;
		Width = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtExpectedRev' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 559, ;
		Name = "txtExpectedRev", ;
		TabIndex = 51, ;
		Top = 90, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastPrice' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 240, ;
		Name = "txtLastPrice", ;
		TabIndex = 12, ;
		Top = -2, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRatecode' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 94, ;
		Name = "txtLastRatecode", ;
		TabIndex = 10, ;
		Top = -2, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRoom' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 213, ;
		Name = "txtLastRoom", ;
		TabIndex = 28, ;
		Top = 51, ;
		Width = 38
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastRoomtype' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 94, ;
		Name = "txtLastRoomtype", ;
		TabIndex = 26, ;
		Top = 51, ;
		Width = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastStayArr' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 73, ;
		Name = "txtLastStayArr", ;
		TabIndex = 30, ;
		Top = 66, ;
		Width = 55
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtLastStayDep' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 140, ;
		Name = "txtLastStayDep", ;
		TabIndex = 31, ;
		Top = 66, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtMarket' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 345, ;
		Name = "txtMarket", ;
		TabIndex = 81, ;
		Top = 51, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccNext30days' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 667, ;
		Name = "txtOccNext30days", ;
		TabIndex = 56, ;
		Top = 114, ;
		Width = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccNext365Days' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 667, ;
		Name = "txtOccNext365Days", ;
		TabIndex = 60, ;
		Top = 138, ;
		Width = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccUntilMonthEnd' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 667, ;
		Name = "txtOccUntilMonthEnd", ;
		TabIndex = 54, ;
		Top = 102, ;
		Width = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOccUntilYearEnd' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 667, ;
		Name = "txtOccUntilYearEnd", ;
		TabIndex = 58, ;
		Top = 126, ;
		Width = 37
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtOpenBalance' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 508, ;
		Name = "txtOpenBalance", ;
		TabIndex = 34, ;
		Top = -2, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults1' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 240, ;
		Name = "txtPriceAdults1", ;
		TabIndex = 14, ;
		Top = 10, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults2' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 240, ;
		Name = "txtPriceAdults2", ;
		TabIndex = 16, ;
		Top = 22, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceAdults3' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 240, ;
		Name = "txtPriceAdults3", ;
		TabIndex = 18, ;
		Top = 34, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild1' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 358, ;
		Name = "txtPriceChild1", ;
		TabIndex = 20, ;
		Top = 10, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild2' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 358, ;
		Name = "txtPriceChild2", ;
		TabIndex = 22, ;
		Top = 22, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtPriceChild3' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 358, ;
		Name = "txtPriceChild3", ;
		TabIndex = 24, ;
		Top = 34, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRatecode' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 94, ;
		Name = "txtRatecode", ;
		TabIndex = 74, ;
		Top = 10, ;
		Width = 75
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem0' AS ttext WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 421, ;
		Name = "txtRem0", ;
		TabIndex = 39, ;
		Top = 34, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem1' AS ttext WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 493, ;
		Name = "txtRem1", ;
		TabIndex = 40, ;
		Top = 34, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem2' AS ttext WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 566, ;
		Name = "txtRem2", ;
		TabIndex = 41, ;
		Top = 34, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRem3' AS ttext WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 637, ;
		Name = "txtRem3", ;
		TabIndex = 42, ;
		Top = 34, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRemX' AS ttext WITH ;
		Alignment = 1, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 710, ;
		Name = "txtRemX", ;
		TabIndex = 44, ;
		Top = 34, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevNext30days' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 559, ;
		Name = "txtRevNext30days", ;
		TabIndex = 55, ;
		Top = 114, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevNext365Days' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 559, ;
		Name = "txtRevNext365Days", ;
		TabIndex = 59, ;
		Top = 138, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevUntilMonthEnd' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 559, ;
		Name = "txtRevUntilMonthEnd", ;
		TabIndex = 53, ;
		Top = 102, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRevUntilYearEnd' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Left = 559, ;
		Name = "txtRevUntilYearEnd", ;
		TabIndex = 57, ;
		Top = 126, ;
		Width = 66
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtSource' AS ttext WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontName = "Arial Narrow", ;
		FontSize = 8, ;
		Height = 23, ;
		Left = 345, ;
		Name = "txtSource", ;
		TabIndex = 83, ;
		Top = 66, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Addrid' AS ttext WITH ;
		Alignment = 1, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 90, ;
		Name = "txtAd_Addrid", ;
		Top = 7, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtad_adid' AS ttext WITH ;
		Alignment = 1, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 219, ;
		Name = "txtad_adid", ;
		Top = 7, ;
		Visible = .F., ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_City' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 270, ;
		MaxLength = 30, ;
		Name = "txtAd_City", ;
		Top = 234, ;
		Width = 157
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Company' AS ttext WITH ;
		Alignment = 3, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 50, ;
		Name = "txtAd_Company", ;
		Top = 29, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Compkey' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 270, ;
		MaxLength = 15, ;
		Name = "txtAd_Compkey", ;
		Top = 117, ;
		Width = 157
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Compnum' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		InputMask = (REPLICATE("9",10)), ;
		Left = 90, ;
		Name = "txtAd_Compnum", ;
		Top = 117, ;
		Width = 88
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Country' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		InputMask = "", ;
		Left = 90, ;
		Name = "txtAd_Country", ;
		RowSource = "", ;
		RowSourceType = 6, ;
		Top = 234, ;
		Width = 55
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Departm' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 50, ;
		Name = "txtAd_Departm", ;
		Top = 51, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Fname' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 298, ;
		MaxLength = 20, ;
		Name = "txtAd_Fname", ;
		Top = 73, ;
		Width = 129
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Lang' AS tcombobox WITH ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "50,130", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Format = "KR!", ;
		Height = 21, ;
		Left = 90, ;
		Name = "txtAd_Lang", ;
		RowSourceType = 6, ;
		Style = 0, ;
		Top = 95, ;
		Width = 55
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Lname' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 30, ;
		Name = "txtAd_Lname", ;
		Top = 73, ;
		Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Salute' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 50, ;
		Name = "txtAd_Salute", ;
		Top = 146, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_State' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 30, ;
		Name = "txtAd_State", ;
		Top = 212, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Street' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 100, ;
		Name = "txtAd_Street", ;
		Top = 168, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Street2' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 90, ;
		MaxLength = 100, ;
		Name = "txtAd_Street2", ;
		Top = 190, ;
		Width = 337
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtad_title' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "K", ;
		Height = 21, ;
		Left = 326, ;
		MaxLength = 20, ;
		Name = "txtad_title", ;
		Top = 95, ;
		Width = 101
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtAd_Zip' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 145, ;
		Name = "txtAd_Zip", ;
		Top = 234, ;
		Width = 117
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageAddress.txtti_attn' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "KR", ;
		Height = 21, ;
		Left = 270, ;
		Name = "txtti_attn", ;
		Top = 95, ;
		Width = 45
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid' AS grdbase WITH ;
		AllowHeaderSizing = .F., ;
		AllowRowSizing = .F., ;
		ColumnCount = 15, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		GridLineWidth = 1, ;
		HeaderHeight = 17, ;
		Height = 437, ;
		HighlightRow = .F., ;
		lcolumnsort = .T., ;
		Left = 4, ;
		lresizecolumns = .F., ;
		Name = "AddressGrid", ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RecordSource = "", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		setcolumns = .T., ;
		TabIndex = 1, ;
		Top = 5, ;
		Width = 783, ;
		Column1.ControlSource = "", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.SelectOnEntry = .T., ;
		Column1.Width = 50, ;
		Column10.FontSize = 8, ;
		Column10.Name = "Column10", ;
		Column10.ReadOnly = .T., ;
		Column11.FontSize = 8, ;
		Column11.Name = "Column11", ;
		Column11.ReadOnly = .T., ;
		Column12.FontSize = 8, ;
		Column12.Name = "Column12", ;
		Column12.ReadOnly = .T., ;
		Column13.FontSize = 8, ;
		Column13.Name = "Column13", ;
		Column13.ReadOnly = .T., ;
		Column13.Sparse = .F., ;
		Column14.FontSize = 8, ;
		Column14.Name = "Column14", ;
		Column14.ReadOnly = .T., ;
		Column14.Width = 60, ;
		Column15.FontSize = 8, ;
		Column15.Name = "Column15", ;
		Column15.ReadOnly = .T., ;
		Column2.ControlSource = "", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.SelectOnEntry = .T., ;
		Column2.Width = 110, ;
		Column3.ControlSource = "", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.SelectOnEntry = .T., ;
		Column3.Width = 140, ;
		Column4.ControlSource = "", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 50, ;
		Column5.ControlSource = "", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 130, ;
		Column6.ControlSource = "", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 60, ;
		Column7.ControlSource = "", ;
		Column7.FontSize = 8, ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column7.Width = 90, ;
		Column8.ControlSource = "", ;
		Column8.FontSize = 8, ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Width = 60, ;
		Column9.FontSize = 8, ;
		Column9.Name = "Column9", ;
		Column9.ReadOnly = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column1.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column10.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column10.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 27, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column11.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column11.Tbgrid1' AS tbgrid WITH ;
		Left = 50, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column12.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column12.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 15
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Tchkgrid1' AS tchkgrid WITH ;
		Alignment = 0, ;
		Left = 30, ;
		Name = "Tchkgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column14.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column14.Tbgrid1' AS tbgrid WITH ;
		Name = "Tbgrid1"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column15.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column15.Tbgrid1' AS tbgrid WITH ;
		Left = 24, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column2.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Left = 14, ;
		Name = "Tbgrid1", ;
		Top = 15
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column3.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Left = 34, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column4.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column5.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column6.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column6.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column7.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column8.Header1' AS header WITH ;
		Caption = "Header1", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column8.Tbgrid1' AS tbgrid WITH ;
		Left = 14, ;
		Name = "Tbgrid1", ;
		Top = 27
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column9.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.AddressGrid.Column9.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 27, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FAddressMask.MainPage.PageGridAddress.Shape1' AS sh WITH ;
		BackStyle = 0, ;
		BorderStyle = 1, ;
		Height = 445, ;
		Left = 1, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 790
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.oProcAddress' AS procaddress WITH ;
		lautocommit = .F., ;
		Left = 84, ;
		Name = "oProcAddress", ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: ClassLib="..\libs\proc_address.vcx" BaseClass="custom" />

	ADD OBJECT 'FAddressMask.Shape1' AS sh WITH ;
		BackStyle = 1, ;
		Enabled = .F., ;
		Height = 37, ;
		Left = 0, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 0, ;
		Visible = .F., ;
		Width = 385, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.Shape2' AS sh WITH ;
		BackStyle = 1, ;
		Height = 37, ;
		Left = 385, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 0, ;
		Visible = .F., ;
		Width = 409, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'FAddressMask.Timer1' AS timer WITH ;
		Enabled = .F., ;
		Height = 23, ;
		Interval = 900, ;
		Left = 36, ;
		Name = "Timer1", ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />

	ADD OBJECT 'FAddressMask.Timer2' AS timer WITH ;
		Enabled = .F., ;
		Height = 23, ;
		Interval = 900, ;
		Left = 60, ;
		Name = "Timer2", ;
		Top = 3, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />

	ADD OBJECT 'NewDocument' AS tform WITH ;
		Caption = "NewDocument", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		Height = 256, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "NewDocument", ;
		Visible = .F., ;
		Width = 252
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'NewDocument.TcbCancel' AS tcommandbutton WITH ;
		Caption = "TcbCancel", ;
		Left = 132, ;
		Name = "TcbCancel", ;
		Top = 226
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'NewDocument.TcbOK' AS tcommandbutton WITH ;
		Caption = "TcbOK", ;
		Left = 36, ;
		Name = "TcbOK", ;
		Top = 226
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'NewDocument.TlabelDocumentType' AS tlabel WITH ;
		AutoSize = .T., ;
		Caption = "TlabelDocumentType", ;
		Left = 12, ;
		Name = "TlabelDocumentType", ;
		Top = 8, ;
		Width = 119
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'NewDocument.ToDocumentType' AS toptiongroup WITH ;
		ButtonCount = 10, ;
		Height = 197, ;
		Left = 12, ;
		Name = "ToDocumentType", ;
		Top = 24, ;
		Width = 228, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "optionAll", ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "optionAll", ;
		Option1.TabIndex = 1, ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 65, ;
		Option10.AutoSize = .T., ;
		Option10.Caption = "optionEXTERNAL", ;
		Option10.Height = 17, ;
		Option10.Left = 5, ;
		Option10.Name = "optionEXTERNAL", ;
		Option10.Top = 176, ;
		Option10.Width = 114, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "optionDOC", ;
		Option2.Height = 17, ;
		Option2.Left = 5, ;
		Option2.Name = "optionDOC", ;
		Option2.TabIndex = 2, ;
		Option2.Top = 24, ;
		Option2.Width = 79, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "optionEXCEL", ;
		Option3.Height = 17, ;
		Option3.Left = 5, ;
		Option3.Name = "optionEXCEL", ;
		Option3.TabIndex = 3, ;
		Option3.Top = 43, ;
		Option3.Width = 91, ;
		Option4.AutoSize = .T., ;
		Option4.Caption = "optionNOTE", ;
		Option4.Height = 17, ;
		Option4.Left = 5, ;
		Option4.Name = "optionNOTE", ;
		Option4.TabIndex = 4, ;
		Option4.Top = 62, ;
		Option4.Width = 85, ;
		Option5.AutoSize = .T., ;
		Option5.Caption = "optionEMAIL", ;
		Option5.Height = 17, ;
		Option5.Left = 5, ;
		Option5.Name = "optionEMAIL", ;
		Option5.TabIndex = 5, ;
		Option5.Top = 81, ;
		Option5.Width = 86, ;
		Option6.AutoSize = .T., ;
		Option6.Caption = "optionRECIVABLES", ;
		Option6.Height = 17, ;
		Option6.Left = 5, ;
		Option6.Name = "optionRECIVABLES", ;
		Option6.TabIndex = 6, ;
		Option6.Top = 100, ;
		Option6.Width = 126, ;
		Option7.AutoSize = .T., ;
		Option7.Caption = "optionWRITER", ;
		Option7.Height = 17, ;
		Option7.Left = 5, ;
		Option7.Name = "optionWRITER", ;
		Option7.TabIndex = 7, ;
		Option7.Top = 119, ;
		Option7.Width = 99, ;
		Option8.AutoSize = .T., ;
		Option8.Caption = "optionCALC", ;
		Option8.Height = 17, ;
		Option8.Left = 5, ;
		Option8.Name = "optionCALC", ;
		Option8.Top = 138, ;
		Option8.Width = 84, ;
		Option9.AutoSize = .T., ;
		Option9.Caption = "optionPDF", ;
		Option9.Height = 17, ;
		Option9.Left = 5, ;
		Option9.Name = "optionPDF", ;
		Option9.Top = 157, ;
		Option9.Width = 76
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'ReferralForm' AS tform WITH ;
		Caption = "ReferralForm", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		Height = 365, ;
		Icon = ..\bitmap\icons\crdfle06.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "ReferralForm", ;
		ShowTips = .T., ;
		Visible = .F., ;
		Width = 481
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'ReferralForm.TcbCancel' AS tcommandbutton WITH ;
		Caption = "TcbCancel", ;
		Left = 390, ;
		Name = "TcbCancel", ;
		TabIndex = 3, ;
		Top = 317, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ReferralForm.TcbOK' AS tcommandbutton WITH ;
		Caption = "TcbOK", ;
		Left = 390, ;
		Name = "TcbOK", ;
		TabIndex = 2, ;
		Top = 281, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ReferralForm.TpageMain' AS tpageframe WITH ;
		ErasePage = .T., ;
		Height = 365, ;
		Left = 1, ;
		Name = "TpageMain", ;
		PageCount = 2, ;
		TabIndex = 1, ;
		Top = 1, ;
		Width = 480, ;
		ZOrderSet = 0, ;
		Page1.Caption = "PageData", ;
		Page1.Name = "PageData", ;
		Page2.Caption = "PageInfo", ;
		Page2.Name = "PageInfo"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TcbInsert' AS tcommandbutton WITH ;
		Caption = "TcbInsert", ;
		Left = 13, ;
		Name = "TcbInsert", ;
		TabIndex = 13, ;
		Top = 217, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TcLinkCompany' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "TcLinkCompany", ;
		Enabled = .F., ;
		Height = 17, ;
		Left = 10, ;
		Name = "TcLinkCompany", ;
		TabIndex = 10, ;
		Top = 156, ;
		Value = .F., ;
		Width = 456
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TcLinkInvoice' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "TcLinkInvoice", ;
		Enabled = .F., ;
		Height = 17, ;
		Left = 10, ;
		Name = "TcLinkInvoice", ;
		TabIndex = 11, ;
		Top = 177, ;
		Value = .F., ;
		Width = 456
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TcMainAddress' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "TcMainAddress", ;
		Enabled = .T., ;
		Height = 17, ;
		Left = 10, ;
		Name = "TcMainAddress", ;
		TabIndex = 12, ;
		Top = 198, ;
		Value = .F., ;
		Width = 456
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.tcombofrom' AS jcombobox WITH ;
		Left = 10, ;
		Name = "tcombofrom", ;
		TabIndex = 8, ;
		Top = 133, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\jbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.tcomboto' AS jcombobox WITH ;
		Left = 250, ;
		Name = "tcomboto", ;
		TabIndex = 9, ;
		Top = 133, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\jbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TeditNotes' AS teditbox WITH ;
		Height = 84, ;
		Left = 13, ;
		Name = "TeditNotes", ;
		TabIndex = 14, ;
		Top = 247, ;
		Width = 312
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TlFrom' AS tlabel WITH ;
		Caption = "TlFrom", ;
		Height = 17, ;
		Left = 12, ;
		Name = "TlFrom", ;
		TabIndex = 2, ;
		Top = 23, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TlFromCombo' AS tlabel WITH ;
		Caption = "TlFromCombo", ;
		Left = 11, ;
		Name = "TlFromCombo", ;
		TabIndex = 6, ;
		Top = 115
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TlText' AS tlabel WITH ;
		Caption = "TlText", ;
		Height = 17, ;
		Left = 12, ;
		Name = "TlText", ;
		TabIndex = 1, ;
		Top = 4, ;
		Width = 454
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TlTo' AS tlabel WITH ;
		Caption = "TlTo", ;
		Height = 17, ;
		Left = 247, ;
		Name = "TlTo", ;
		TabIndex = 3, ;
		Top = 24, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.TlToCombo' AS tlabel WITH ;
		Caption = "TlToCombo", ;
		Left = 247, ;
		Name = "TlToCombo", ;
		TabIndex = 7, ;
		Top = 113
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.ttFrom' AS teditbox WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 55, ;
		Left = 10, ;
		Name = "ttFrom", ;
		TabIndex = 4, ;
		Top = 55, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageData.ttTo' AS teditbox WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 55, ;
		Left = 246, ;
		Name = "ttTo", ;
		TabIndex = 5, ;
		Top = 55, ;
		Width = 228
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="editbox" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.Sh1' AS sh WITH ;
		Height = 108, ;
		Left = 257, ;
		Name = "Sh1", ;
		Top = 53, ;
		Width = 216
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.Sh2' AS sh WITH ;
		Height = 108, ;
		Left = 3, ;
		Name = "Sh2", ;
		Top = 53, ;
		Width = 216
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="shape" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelDate' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 10, ;
		Name = "TlabelDate", ;
		Top = 110, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelDateValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 118, ;
		Name = "TlabelDateValue", ;
		Top = 110, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelMessage' AS tlabel WITH ;
		Caption = "TlabelMessage", ;
		Height = 17, ;
		Left = 11, ;
		Name = "TlabelMessage", ;
		Top = 19, ;
		Width = 455
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelTime' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 10, ;
		Name = "TlabelTime", ;
		Top = 129, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelTimeValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 118, ;
		Name = "TlabelTimeValue", ;
		Top = 129, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdDate' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 262, ;
		Name = "TlabelUpdDate", ;
		Top = 110, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdDateValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 370, ;
		Name = "TlabelUpdDateValue", ;
		Top = 110, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdTime' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 262, ;
		Name = "TlabelUpdTime", ;
		Top = 129, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdTimeValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 370, ;
		Name = "TlabelUpdTimeValue", ;
		Top = 129, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdUser' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 262, ;
		Name = "TlabelUpdUser", ;
		Top = 91, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUpdUserValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 370, ;
		Name = "TlabelUpdUserValue", ;
		Top = 91, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUser' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 10, ;
		Name = "TlabelUser", ;
		Top = 91, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlabelUserValue' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 118, ;
		Name = "TlabelUserValue", ;
		Top = 91, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlCreated' AS tlabel WITH ;
		Caption = "TlCreated", ;
		Height = 17, ;
		Left = 10, ;
		Name = "TlCreated", ;
		Top = 67, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'ReferralForm.TpageMain.PageInfo.TlUpdated' AS tlabel WITH ;
		Caption = "TlUpdated", ;
		Height = 17, ;
		Left = 262, ;
		Name = "TlUpdated", ;
		Top = 67, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'SelectForm' AS tform WITH ;
		AlwaysOnTop = .T., ;
		BorderStyle = 2, ;
		Caption = "", ;
		Closable = .F., ;
		DoCreate = .T., ;
		Height = 110, ;
		Icon = ..\bitmap\icons\w95mbx03.ico, ;
		KeyPreview = .T., ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "SelectForm", ;
		TabIndex = 6, ;
		TabStop = .F., ;
		TitleBar = 0, ;
		Visible = .F., ;
		Width = 320
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'SelectForm.MCodeGrid' AS tgrid WITH ;
		AllowHeaderSizing = .F., ;
		AllowRowSizing = .F., ;
		ColumnCount = 2, ;
		DeleteMark = .F., ;
		HeaderHeight = 0, ;
		Height = 110, ;
		Left = 0, ;
		Name = "MCodeGrid", ;
		ReadOnly = .T., ;
		ScrollBars = 2, ;
		SplitBar = .F., ;
		TabIndex = 1, ;
		Top = 0, ;
		Width = 320, ;
		Column1.Alignment = 3, ;
		Column1.ControlSource = "", ;
		Column1.Movable = .F., ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Resizable = .F., ;
		Column1.Visible = .T., ;
		Column1.Width = 116, ;
		Column2.ControlSource = "", ;
		Column2.Movable = .F., ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 170
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'SelectForm.MCodeGrid.Column1.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'SelectForm.MCodeGrid.Column1.Text1' AS ttext WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'SelectForm.MCodeGrid.Column2.Header1' AS header WITH ;
		Caption = "", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'SelectForm.MCodeGrid.Column2.Text1' AS ttext WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		TabStop = .F., ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'Tform1' AS tform WITH ;
		AlwaysOnTop = .F., ;
		Caption = "Tform1", ;
		Closable = .F., ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		Height = 175, ;
		Icon = ..\bitmap\icons\msgbox04.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "Tform1", ;
		Visible = .F., ;
		Width = 762, ;
		WindowState = 0, ;
		WindowType = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'Tform1.Tcommandbutton1' AS tcommandbutton WITH ;
		Left = 336, ;
		Name = "Tcommandbutton1", ;
		TabIndex = 2, ;
		Top = 146
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tform1.Tlistbox1' AS tlistbox WITH ;
		ColumnCount = 0, ;
		ColumnLines = .F., ;
		ColumnWidths = "0", ;
		ControlSource = "", ;
		FontName = "Courier", ;
		FontSize = 8, ;
		Height = 142, ;
		Left = 3, ;
		Name = "Tlistbox1", ;
		RowSourceType = 0, ;
		TabIndex = 1, ;
		Top = 1, ;
		Width = 756
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="listbox" />
	
	PROCEDURE addresscopyfromadrmain
		LOCAL l_lCopied
		IF USED("addr1") AND EMPTY(addr1.ad_addrid) AND NOT EMPTY(addr1.ad_adid)
			l_lCopied= thisformset.fAddressMask.oProcAddress.AddressCopyFromAddrmain(this.DataCopy, addr1.ad_adid, IIF(_screen.oGlobal.lmainserverremote,"adrmacl19q","adrmain"))
		ENDIF
		
		RETURN l_lCopied
	ENDPROC

	PROCEDURE addresscopynew
		if this.FAddressMask.MainPage.ActivePage = 2 
			this.FAddressMask.MainPage.ActivePage = 1
			this.FAddressMask.MainPage.PageGridAddress.enabled = .F.
		ENDIF
		
		this.FAddressMask.oProcAddress.AddressCopy(address.ad_addrid)
		this.DataCopy = this.FAddressMask.oProcAddress.AddressGet()
		this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
		this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
		this.fAddressMask.MainPage.PageAddress.txtAd_addrid.Value = EVL(this.DataCopy.ad_addrid,"N/A")
		this.fAddressMask.MainPage.PageAddress.txtAd_adid.Value = EVL(this.DataCopy.ad_adid,"N/A")
		this.SetBonusPoints()
		
		This.addressfieldsenable()
		Thisformset.AddressState = 2
		Select addressTAlias
		*With THIS.FAddressMask.MainPage.PageAddress.SLAVEPAGE
		*	.PAGEAPARTNER.ENABLED=.F.
		*	.PAGENOTE.ENABLED=.T.
		*	.ACTIVEPAGE=2
		*	.PAGEHISTORY.ENABLED=.F.
		*	.PAGEFUTURE.ENABLED=.F.
		*	.PAGEFREE.ENABLED=.T.
		*	.PAGEDOKUMENT.ENABLED=.F.
		*	.PAGEREVNUE.ENABLED = .F.
		*Endwith
		This.FAddressMask.MainPage.PageAddress.slavepage.pageNote.txtAd_Userid.value = g_userid
		This.FAddressMask.MainPage.PageAddress.SLAVEPAGE.PAGEAPARTNER.CUpdateApartner.enabled = .F.
		This.FAddressMask.MainPage.PageAddress.SLAVEPAGE.PAGEAPARTNER.cmdDelPart.enabled = .F.
		This.FAddressMask.MainPage.PageAddress.SLAVEPAGE.PAGEAPARTNER.cmdNewAPart.enabled = .F.
		
		IF this.searchactive
			SELECT (this.selectedtable)
		ELSE
			SELECT AddressTAlias
		ENDIF
		this.nRecNoBeforeEditMode = RECNO()
		GO BOTTOM
		*Skip
		This.FAddressMask.MainPage.PageAddress.Refresh()
	ENDPROC

	PROCEDURE addressdelete
		LOCAL l_nAddrId, l_nMainAddrId, ccOmpany, clName, cmSg, l_lGoNext
		l_nAddrId = address.ad_addrid
		l_nMainAddrId = this.FAddressMask.oProcAddress.naddressunknownid
		
		IF this.FAddressMask.MainPage.ActivePage = 2
			this.FAddressMask.MainPage.ActivePage = 1
		ENDIF
		
		IF this.FAddressMask.oProcAddress.Addressdeleteallowed(l_nAddrId, l_nMainAddrId)
			IF dlocate("address1","ad_addrid = " + sqlcnv(l_nMainAddrId))
				ccOmpany = upper(address1.ad_company)
				clName = upper(address1.ad_lname)
				cmSg = alltrim(trim(address1.ad_company)+iif( .not.  ;
						empty(address1.ad_company), ", ", " ")+trim(address1.ad_lname))
		
				IF yeSno(strtran(GetLangText("MRGADDR","TA_SURE1")+" "+GetLangText("MRGADDR", ;
								"TA_SURE2"), "%s", cmSg)+"@2")
		
					IF this.FAddressMask.oProcAddress.AddressDelete(l_nAddrId, l_nMainAddrId)
					
						l_lGoNext = .T.
						this.AddressDeleteAfter(l_nAddrId, l_lGoNext)
		
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE addressdeleteafter
		LPARAMETERS lp_nAddrId AS Integer, lp_lGoNext AS Logical
		LOCAL l_nSelect, lnRecNoAddrCursor
		l_nSelect = SELECT()
		IF this.searchactive
			SELECT addr1
			LOCATE FOR ad_addrid = lp_nAddrId
			DELETE
			SKIP 1
			SKIP -1
			lnRecNoAddrCursor = RECNO()
			LOCATE FOR NOT DELETED()
			IF NOT FOUND()
				this.searchactive = .F.
				this.selectedtable = 'address'
				SET ORDER TO tag1 IN address
				this.SetAddressGridSource('address')
				this.AddressGoTop()
				lp_lGoNext = .F.
			ELSE
				GO lnRecNoAddrCursor IN addr1
			ENDIF
		ENDIF
		IF lp_lGoNext
			this.addressnext()
		ENDIF
		this.refreshaddressgrid()
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE addressedit
		this.refreshaddressgrid()
		
		IF this.AddressFromAdrMainSelected()
			IF yesno(GetLangText("ADDRESS","TXT_COPY_ADDRESS_FROM_MAIN_SRV"))
		
				thisformset.faddressMask.oProcAddress.AddressNew()
				thisformset.faddressMask.oProcAddress.AddressCopyFromAddrmain(.NULL.,addr1.ad_adid, IIF(_screen.oGlobal.lmainserverremote,"adrmacl19q","adrmain"))
				this.DataCopy = this.FAddressMask.oProcAddress.AddressGet()
				this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
				this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
		
				this.FAddressMask.Refresh()
				
				* Ugly workaround. Use this property, to prevent refreshaddressgrid method
				* to overwrite our just saved data in DataCopy scatter object.
				* Happened, when user searched on address in adrmain, and clicked Edit button, 
				* without to change active page.
				this.lDontChangeDataCopy = .T.
			ELSE
				this.AddressState = 0
				RETURN .F.
			ENDIF
		ELSE
			this.FAddressMask.oProcAddress.AddressEdit(address.ad_addrid)
			this.DataCopy = this.FAddressMask.oProcAddress.AddressGet()
			this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
			this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
		ENDIF
		
		this.fAddressMask.MainPage.PageAddress.txtAd_addrid.Value = EVL(this.DataCopy.ad_addrid,"N/A")
		this.fAddressMask.MainPage.PageAddress.txtAd_adid.Value = EVL(this.DataCopy.ad_adid,"N/A")
		
		this.SetBonusPoints()
		
		IF this.searchactive
			SELECT (this.selectedtable)
		ELSE
			SELECT AddressTAlias
		ENDIF
		this.nRecNoBeforeEditMode = RECNO()
		
		if this.FAddressMask.MainPage.ActivePage = 2 
			this.FAddressMask.MainPage.ActivePage = 1
			this.FAddressMask.MainPage.PageGridAddress.enabled = .F.
		ENDIF
		
		IF this.lDontChangeDataCopy
			* When we used this property to prevent call of method refreshaddressgrid,
			* now make sure, that property is off.
			this.lDontChangeDataCopy = .F.
		ENDIF
		
		this.addressfieldsenable()
		thisformset.AddressState = 3
	ENDPROC

	PROCEDURE addressexit
		LOCAL EditEnabled, LExit
		
		this.SelectForm.Visible = .F.
		
		IF !(this.addressstate = 0) then
			IF MESSAGEBOX( GetLangText("RESERVAT","TA_LOSECHANGES"), 52, GetLangText("FUNC","TXT_QUESTION")) = 6
				IF NOT EMPTY(this.nRecNoBeforeEditMode)
					IF this.searchactive
						GO (this.nRecNoBeforeEditMode) IN (this.selectedtable)
					ELSE
						GO (this.nRecNoBeforeEditMode) IN AddressTAlias
					ENDIF
					this.nRecNoBeforeEditMode = 0
				ENDIF
				this.faddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Fax.SetFocus
		*		IF this.AddressState = 1 OR this.AddressState = 2
		*			this.addressfieldsdisable()
		*			this.AddressState = 0
		*			this.addressprevious()
		*			With THIS.FAddressMask.MainPage.PageAddress.SLAVEPAGE
		*				.PAGEAPARTNER.ENABLED=.T.
		*				.PAGENOTE.ENABLED=.T.
		*				.ACTIVEPAGE=1
		*				.PAGEHISTORY.ENABLED=.T.
		*				IF paRights(104)
		*					.PAGEFUTURE.ENABLED=.T.
		*				ENDIF
		*				.PAGEFREE.ENABLED=.T.
		*				.PAGEDOKUMENT.ENABLED=.T.
		*				IF paRights(103)
		*					.PAGEREVNUE.ENABLED = .T.
		*				ENDIF
		*			Endwith
		*		ELSE
					this.addressfieldsdisable()
					this.AddressState = 0
		*		ENDIF
				this.refreshaddressgrid()
			ENDIF
			RETURN
		ELSE
			*IF this.AddressStart <> 'NORMAL' AND this.AddressFromAdrMainSelected()
			* If adrmain address selected then on exit don't automaticaly copy adrmain to address for now.
			*	this.fAddressMask.oProcAddress.AdrMainGetAddress(addr1.ad_adid, .T.)
			*ENDIF
			IF inlist(thisformset.AddressStart,'BRWL','BRWC','EDITC')
				*this.tpypahd = .T.
				IF (thisformset.AddressStart = 'BRWC' OR thisformset.AddressStart = 'EDITC') AND !EMPTY(apartner.ap_addrid) ;
					AND (this.addresscall= "RSC" OR this.addresscall= "RSI" OR (TYPE("this.mode")="N" AND this.mode = 11))
					*thisformset.faddressmask.mainPage.pageAddress.slAVEPAGE.pageApartner.SetFocus()
					thisformset.faddressmask.visible = .F.
					this.doapartner()
			*		this.selectForm.MCodeGrid.RecordSource = ""
					THIS.Tform1.Visible = .t.
					*this.tform1.AlwaysOnTop = .T.
					this.tform1.Tlistbox1.SetFocus()
					*thisformset.faddressmask.release()
					*thisformset.selectform.release()
		
			*	ELSE
			*		thisformset.Visible = .F.
					*thisformset.faddressmask.visible = .F.
					*thisformset.faddressmask.LostFocus()
			*		thisformset.closeselectform = .F.
					*thisformset.tform1.Release()
					*thisformset.killtoolbar = .T.
					*THIS.Tform1.Visible = .t.
					*this.tform1.Tlistbox1.SetFocus()
					*this.tform1.tcommandbutton1.SetFocus()
					*WAIT "" TIMEOUT 1
					*this.tform1.tcommandbutton1.Click()
					*this.tform1.Release()
			*		this.selectForm.MCodeGrid.RecordSource = ""
			*		this.faddressmask.release()
			*		this.selectform.release()
				endif
			*ELSE
			*	this.faddressmask.release()
			ENDIF
			thisformset.MainExitPoint()
		ENDIF
		
	ENDPROC

	PROCEDURE addressfieldsdisable
		*this.FAddressMask.Closable = .T.
		IF !this.FAddressMask.mainPage.Tabs
			this.FAddressMask.mainPage.Tabs = .T.
		ENDIF
		With THIS.FAddressMask.MainPage.PageAddress.SLAVEPAGE
			.PAGEAPARTNER.ENABLED=parights(109)
			.PAGENOTE.ENABLED=parights(110)
			IF .ACTIVEPAGE<>10
				.ACTIVEPAGE=1
			ENDIF
			.PAGEHISTORY.ENABLED=parights(108)
			IF paRights(104)
				.PAGEFUTURE.ENABLED=.T.
			ENDIF
			.PAGEFREE.ENABLED=parights(112)
			.PAGEDOKUMENT.ENABLED=parights(111)
			IF paRights(103)
				.PAGEREVNUE.ENABLED = .T.
			ENDIF
			.pageReferral.Enabled = parights(129)
		Endwith
		WITH this.FAddressMask.MainPage.PageAddress
		.txtAd_Company.enabled = .F.
		.txtAd_Departm.enabled = .F.
		.txtAd_Lname.enabled = .F.
		.txtAD_Lang.enabled = .F.
		.txtAd_Compnum.enabled = .F.
		.txtAd_Salute.enabled = .F.
		.txtAd_Street.enabled = .F.
		.txtAd_Street2.enabled = .F.
		.txtAd_State.enabled = .F.
		.txtAd_City.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Phone.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Phone2.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Phone3.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Fax.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Email.enabled = .F.
		.InfoPage.pagCommunication.txtAd_website.enabled = .F.
		.InfoPage.pagCommunication.txtad_ustidnr.enabled = .F.
		.InfoPage.pagCommunication.chkad_novat.enabled = .F.
		.InfoPage.pagCommunication.chkad_save.enabled = .f.
		.InfoPage.pagCommunication.txtAd_Mail1.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Mail2.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Mail3.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Mail4.enabled = .F.
		.InfoPage.pagCommunication.txtAd_Mail5.enabled = .F.
		.InfoPage.pagGuestInfo.txtAd_Ratecod.enabled = .F.
		.txtAd_Fname.enabled = .F.
		.txtti_attn.enabled = .F.
		.InfoPage.pagGuestInfo.txtAd_Billins.enabled = .F.
		.InfoPage.pagGuestInfo.txtAd_Member.enabled = .F.
		.InfoPage.pagGuestInfo.txtAd_webpass.enabled = .F.
		.InfoPage.pagGuestInfo.dtxtAd_Memdat.enabled = .F.
		.txtAd_Compkey.enabled = .F.
		.txtAd_Zip.enabled = .F.
		.txtAd_Country.enabled = .F.
		.InfoPage.pagGuestInfo.stxtFeature.enabled = .F.
		.InfoPage.pagGuestInfo.cboroomname.enabled = .F.
		.ocbotitle.enabled = .F.
		.cboadrtype.enabled = .F.
		.ad_vipstat.enabled = .F.
		.txtad_title.enabled = .F.
		.chkAd_Vip.enabled = .F.
		.InfoPage.pagGuestInfo.dtxtAd_Birth.enabled = .F.
		.InfoPage.pagGuestInfo.ChkNomail.enabled = .f.
		.chkAd_Vip2.enabled = .f.
		.SlavePage.PageFree.FreeText1.enabled = .F.
		.SlavePage.PageFree.FreeText2.enabled = .F.
		.SlavePage.PageFree.FreeText3.enabled = .F.
		.SlavePage.PageFree.FreeText4.enabled = .F.
		.SlavePage.PageFree.FreeText5.enabled = .F.
		.SlavePage.PageFree.FreeText6.enabled = .F.
		.SlavePage.PageFree.FreeText7.enabled = .F.
		.SlavePage.PageFree.FreeText8.enabled = .F.
		.SlavePage.PageFree.FreeText9.enabled = .F.
		.SlavePage.PageFree.FreeText10.enabled = .f.
		.SlavePage.PageFree.Tcheckbox1.enabled = .f.
		.SlavePage.PageFree.Tcheckbox2.enabled = .f.
		.SlavePage.PageFree.Tcheckbox3.enabled = .f.
		.SlavePage.PageFree.Tcheckbox4.enabled = .f.
		.SlavePage.PageFree.Tcheckbox5.enabled = .f.
		.SlavePage.PageFree.Tcheckbox6.enabled = .f.
		.SlavePage.PageFree.Tcheckbox7.enabled = .f.
		.SlavePage.PageFree.Tcheckbox8.enabled = .f.
		.SlavePage.PageFree.Tcheckbox9.enabled = .f.
		.SlavePage.PageFree.Tcheckbox10.enabled = .f.
		.SlavePage.PageFree.tcbCallBankForm.enabled = .f.
		.SlavePage.PageNote.Edit1.readonly = .t.
		.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
		.SlavePage.PageSales.cboAd_market.Enabled = .F.
		.SlavePage.PageSales.cboAd_source.Enabled = .F.
		.SlavePage.PageSales.cboAd_discnt.Enabled = .F.
		
		IF .SlavePage.PagePrivacyPolicy.Enabled
			.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.DisableFields()
		ENDIF
		
		ENDWITH
		
		this.AddressEditEnabled = .F.
		
		WITH this.FAddressMask.MainPage
		IF thisformset.AddressStart<>'EDITR'
			.PageGridAddress.enabled = .T.
		endif
		.PageAddress.InfoPage.pagCommunication.btnMail.Enabled = NOT EMPTY(AddressTAlias.ad_email)
		.PageAddress.InfoPage.pagCommunication.btnBrowse.Enabled = NOT EMPTY(AddressTAlias.ad_website)
		.PageAddress.InfoPage.pagCommunication.btnCall.Enabled = .T.
		
		*.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .T.
		*.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .T.
		*.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = .T.
		
		.PageAddress.SlavePage.PageApartner.ApartnerGrid.enabled = .T.
		ENDWITH
		
		*IF thisformset.FAddressMask.alwaysontop =.t.
			*this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
			*this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
			*this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = .F.
		*	this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .T.
		*	this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .T.
		*	this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = .T.
		
		*ELSE
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
		*ENDIF
		
	ENDPROC

	PROCEDURE addressfieldsenable
		With THIS.FAddressMask.MainPage.PageAddress.SLAVEPAGE
			.PAGEAPARTNER.ENABLED=.F.
			.PAGENOTE.ENABLED=parights(110)
			IF .ACTIVEPAGE<>10
				.ACTIVEPAGE=2
			ENDIF
			.PAGEHISTORY.ENABLED=.F.
			.PAGEFUTURE.ENABLED=.F.
			.PAGEFREE.ENABLED=parights(112)
			.PAGEDOKUMENT.ENABLED=.F.
			.PAGEREVNUE.ENABLED = .F.
			.pageReferral.Enabled = .F.	
		Endwith
		
		WITH this.FAddressMask.MainPage.PageAddress
		.txtAd_Company.enabled = .T.
		.txtAd_Departm.enabled = .T.
		.txtAd_Lname.enabled = .T.
		.txtAD_Lang.enabled = .T.
		.txtAd_Compnum.enabled = .T.
		.txtAd_Salute.enabled = .T.
		.txtAd_Street.enabled = .T.
		.txtAd_Street2.enabled = .T.
		.txtAd_State.enabled = .T.
		.txtAd_City.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Phone.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Phone2.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Phone3.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Fax.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Email.enabled = .T.
		.InfoPage.pagCommunication.txtAd_website.enabled = .T.
		.InfoPage.pagCommunication.txtad_ustidnr.enabled = .T.
		.InfoPage.pagCommunication.chkad_novat.enabled = .T.
		.InfoPage.pagCommunication.chkad_save.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Mail1.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Mail2.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Mail3.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Mail4.enabled = .T.
		.InfoPage.pagCommunication.txtAd_Mail5.enabled = .T.
		.InfoPage.pagGuestInfo.txtAd_Ratecod.enabled = .T.
		.txtAd_Fname.enabled = .T.
		.InfoPage.pagGuestInfo.txtAd_Billins.enabled = .T.
		.InfoPage.pagGuestInfo.txtAd_Member.enabled = .T.
		.InfoPage.pagGuestInfo.txtAd_webpass.enabled = .T.
		.InfoPage.pagGuestInfo.dtxtAd_Memdat.enabled = .T.
		.txtAd_Compkey.enabled = .T.
		.txtAd_Zip.enabled = .T.
		.txtAd_Country.enabled = .T.
		.InfoPage.pagGuestInfo.stxtFeature.enabled = .T.
		.InfoPage.pagGuestInfo.cboroomname.enabled = .T.
		.ocbotitle.enabled = .T.
		.cboadrtype.enabled = .T.
		.ad_vipstat.enabled = .T.
		.txtad_title.enabled = .T.
		.chkAd_Vip.enabled = .T.
		.InfoPage.pagGuestInfo.dtxtAd_Birth.enabled = .T.
		.InfoPage.pagGuestInfo.ChkNomail.enabled = .T.
		.chkAd_Vip2.enabled = .T.
		.SlavePage.PageFree.FreeText1.enabled = parights(112)
		.SlavePage.PageFree.FreeText2.enabled = parights(112)
		.SlavePage.PageFree.FreeText3.enabled = parights(112)
		.SlavePage.PageFree.FreeText4.enabled = parights(112)
		.SlavePage.PageFree.FreeText5.enabled = parights(112)
		.SlavePage.PageFree.FreeText6.enabled = parights(112)
		.SlavePage.PageFree.FreeText7.enabled = parights(112)
		.SlavePage.PageFree.FreeText8.enabled = parights(112)
		.SlavePage.PageFree.FreeText9.enabled = parights(112)
		.SlavePage.PageFree.FreeText10.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox1.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox2.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox3.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox4.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox5.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox6.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox7.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox8.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox9.enabled = parights(112)
		.SlavePage.PageFree.Tcheckbox10.enabled = parights(112)
		.SlavePage.PageFree.tcbCallBankForm.Enabled = parights(112)
		.SlavePage.PageNote.Edit1.readonly = .F.
		.SlavePage.PageSales.cboAd_market.Enabled = .T.
		.SlavePage.PageSales.cboAd_source.Enabled = .T.
		.SlavePage.PageSales.cboAd_discnt.Enabled = .T.
		
		this.FAddressMask.MainPage.PageGridAddress.enabled = .F.
		.SlavePage.PageApartner.cmdNewAPart.enabled = .F.
		ENDWITH
		
		this.AddressEditEnabled = .T.
		
		WITH this.FAddressMask.MainPage.PageAddress
		.InfoPage.pagCommunication.btnMail.Enabled = .F.
		.InfoPage.pagCommunication.btnBrowse.enabled = .F.
		.InfoPage.pagCommunication.btnCall.enabled = .F.
		.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
		.SlavePage.PageApartner.cmdDelPart.enabled = .F.
		.SlavePage.PageApartner.cmdNewAPart.enabled = .F.
		.SlavePage.PageApartner.ApartnerGrid.enabled = .F.
		*if thisformset.AddressStart="NORMAL" OR thisformset.tpypahd
		
		IF .SlavePage.PagePrivacyPolicy.Enabled
			.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.EnableFields()
		ENDIF
		
		if thisformset.tpypahd
			.txtAd_Company.setfocus
			*WAIT WINDOW NOWAIT "sETFOCUS" TIMEOUT 3
		ENDIF
		IF !thisformset.tpypahd
			thisformset.tpypahd = .T.
		ENDIF
		ENDWITH
	ENDPROC

	PROCEDURE addressfromadrmainselected
		IF _screen.oGlobal.lUseMainServer AND USED("addr1") AND EMPTY(addr1.ad_addrid) AND NOT EMPTY(addr1.ad_adid)
			RETURN .T.
		ELSE
			RETURN .F.
		ENDIF
	ENDPROC

	PROCEDURE addressgetusrchkvals
		WITH this.fAddressMask.mainPage.pageAddress.slavePage.pageFree
			IF .tcheckbox1.Visible
				thisformset.DataCopy.ad_usr1 = this.putcheckboxvalue(.tcheckbox1.Value)
			ENDIF
			IF .tcheckbox2.Visible
				thisformset.DataCopy.ad_usr2 = this.putcheckboxvalue(.tcheckbox2.Value)
			ENDIF
			IF .tcheckbox3.Visible
				thisformset.DataCopy.ad_usr3 = this.putcheckboxvalue(.tcheckbox3.Value)
			ENDIF
			IF .tcheckbox4.Visible
				thisformset.DataCopy.ad_usr4 = this.putcheckboxvalue(.tcheckbox4.Value)
			ENDIF
			IF .tcheckbox5.Visible
				thisformset.DataCopy.ad_usr5 = this.putcheckboxvalue(.tcheckbox5.Value)
			ENDIF
			IF .tcheckbox6.Visible
				thisformset.DataCopy.ad_usr6 = this.putcheckboxvalue(.tcheckbox6.Value)
			ENDIF
			IF .tcheckbox7.Visible
				thisformset.DataCopy.ad_usr7 = this.putcheckboxvalue(.tcheckbox7.Value)
			ENDIF
			IF .tcheckbox8.Visible
				thisformset.DataCopy.ad_usr8 = this.putcheckboxvalue(.tcheckbox8.Value)
			ENDIF
			IF .tcheckbox9.Visible
				thisformset.DataCopy.ad_usr9 = this.putcheckboxvalue(.tcheckbox9.Value)
			ENDIF
			IF .tcheckbox10.Visible
				thisformset.DataCopy.ad_usr10 = this.putcheckboxvalue(.tcheckbox10.Value)
			ENDIF
		ENDWITH
	ENDPROC

	PROCEDURE addressgobottom
		if this.searchactive
			select (this.selectedtable)
		else
			select AddressTAlias	
		endif	
		if thisformset.AddressState = 0 then
			goto bottom
			this.SelectAddress()
			if this.FAddressMask.MainPage.activepage = 2
				with this.FAddressMask.MainPage.PageGridAddress.AddressGrid
					.refresh
					.setfocus
				endwith
			else
				this.refreshaddressgrid()
			endif
		endif
		
	ENDPROC

	PROCEDURE addressgoto
		if this.searchactive
			select (this.selectedtable)
		else
			select AddressTAlias	
		endif	
		if thisformset.AddressState = 0 then
			this.SelectAddress()
			if this.FAddressMask.MainPage.activepage = 2
				with this.FAddressMask.MainPage.PageGridAddress.AddressGrid
					.refresh
					.setfocus
				endwith
			else
				this.refreshaddressgrid()
			endif
		endif
		
	ENDPROC

	PROCEDURE addressgotop
		if this.searchactive
			select (this.selectedtable)
		else
			select AddressTAlias
		endif	
		if thisformset.AddressState = 0 then
			goto top
			this.SelectAddress()
			if  Ad_Addrid = thisformset.fAddressMask.oProcAddress.nAddressUnknownID
				this.addressnext()
			endif
			if this.FAddressMask.MainPage.activepage = 2
				with this.FAddressMask.MainPage.PageGridAddress.AddressGrid
					.refresh
					.setfocus
				endwith
			else
				this.refreshaddressgrid()
			endif
		endif
		
	ENDPROC

	PROCEDURE addressmaskvisiblefirsttime
		IF NOT this.lStartedFirstTime
			this.lStartedFirstTime = .T.
			IF _screen.oGlobal.lUseMainServer
				WITH this.FAddressMask.MainPage.PageAddress
					IF NOT .txtAd_Adid.Visible
						.txtAd_Adid.Visible = .T.
					ENDIF
					IF NOT .lblAd_Adid.Visible
						.lblAd_Adid.Visible = .T.
					ENDIF
				ENDWITH
			ENDIF
			this.FAddressMask.oProcAddress.AdrMainChanges()
		ENDIF
	ENDPROC

	PROCEDURE addressnew
		LOCAL l_oAddress
		
		If this.FAddressMask.MainPage.ActivePage = 2
			this.FAddressMask.MainPage.ActivePage = 1
			This.FAddressMask.MainPage.PageGridAddress.enabled = .F.
		Endif
		This.addressfieldsenable()
		Thisformset.AddressState = 1
		IF this.searchactive
			SELECT (this.selectedtable)
		ELSE
			SELECT AddressTAlias
		ENDIF
		this.nRecNoBeforeEditMode = RECNO()
		GO BOTTOM
		*Skip
		
		this.FAddressMask.oProcAddress.AddressNew()
		this.DataCopy = this.FAddressMask.oProcAddress.AddressGet()
		this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
		this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
		this.fAddressMask.MainPage.PageAddress.txtAd_addrid.Value = EVL(this.DataCopy.ad_addrid,"N/A")
		this.fAddressMask.MainPage.PageAddress.txtAd_adid.Value = EVL(this.DataCopy.ad_adid,"N/A")
		this.fAddressMask.oProcAddress.AddressSetFeatures(this.DataCopy.ad_addrid, this.fAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.curSelect, .T.)
		this.fAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.RefreshValue()
		this.SetBonusPoints()
		
		Do case
			Case thisformset.AddressStart = "EDITL" OR thisformset.AddressStart = "EDITQ"
				IF this.mode=29
					IF NOT EMPTY(thisformset.oParam.Item("PHONE_NUMBER"))
						thisformset.DataCopy.ad_phone = thisformset.oParam.Item("PHONE_NUMBER")
						thisformset.oParam.Remove("PHONE_NUMBER")
						thisformset.oParam.Add("","PHONE_NUMBER")
					ENDIF
				ENDIF
		*		_a = AT("-", this.AddressText, 1)
		*		_s = SUBSTR(this.AddressText, _a+1,1)
		*		IF _s == " "
		*			 _a = _a+1
		*			_s = SUBSTR(this.AddressText, _a+1,1)
		*		ENDIF
		*		IF EMPTY(_s)
		*			_s = ""
		*		ENDIF
		*		_t = STUFF(this.AddressText, _a+1, 1, UPPER(_s))
				thisformset.DataCopy.Ad_Lname = thisformset.AddressText &&_t
			Case thisformset.AddressStart = "EDITC"
				thisformset.DataCopy.Ad_Company = thisformset.AddressText
		Endcase
		IF TYPE("this.oReferenceToCallingObject.oAddress") <> "U"
			l_oAddress = this.oReferenceToCallingObject.oAddress
			DO CASE
				CASE TYPE("this.oReferenceToCallingObject.oInvoice") = "U"
				CASE This.MODe=4
					IF NOT EMPTY(this.oReferenceToCallingObject.oInvoice.ad_company)
						l_oAddress = this.oReferenceToCallingObject.oInvoice
					ENDIF
				CASE This.MODe=5
					IF EMPTY(this.oReferenceToCallingObject.oInvoice.ad_company) AND NOT EMPTY(this.oReferenceToCallingObject.oInvoice.ad_lname)
						l_oAddress = this.oReferenceToCallingObject.oInvoice
					ENDIF
				CASE This.MODe=9
					l_oAddress.ad_lname = l_oAddress.c_slname
					l_oAddress.ad_fname = l_oAddress.c_sfname
					l_oAddress.ad_email = l_oAddress.c_semail
					l_oAddress.ad_street = l_oAddress.c_sstreet
					IF TYPE("l_oAddress.c_sstree2")="C"
						l_oAddress.ad_street2 = l_oAddress.c_sstree2
					ENDIF
					IF TYPE("l_oAddress.c_stitle")="C"
						l_oAddress.ad_title = l_oAddress.c_stitle
					ENDIF
					l_oAddress.ad_city = l_oAddress.c_scity
					l_oAddress.ad_zip = l_oAddress.c_szip
					l_oAddress.ad_country = l_oAddress.c_scountr
					IF TYPE("l_oAddress.c_sadrtyp")="C"
						l_oAddress.ad_adrtype = l_oAddress.c_sadrtyp
					ENDIF
			ENDCASE
		
			WITH l_oAddress
				thisformset.DataCopy.ad_company = .ad_company
				thisformset.DataCopy.ad_city = .ad_city
				thisformset.DataCopy.ad_email = .ad_email
				thisformset.DataCopy.ad_fname = .ad_fname
				thisformset.DataCopy.ad_lname = .ad_lname
				thisformset.DataCopy.ad_note = .ad_note
				thisformset.DataCopy.ad_phone = .ad_phone
				thisformset.DataCopy.ad_phone2 = .ad_phone2
				thisformset.DataCopy.ad_phone3 = .ad_phone3
				thisformset.DataCopy.ad_street = .ad_street
				thisformset.DataCopy.ad_zip = .ad_zip
				thisformset.DataCopy.ad_country = .ad_country
				* Caution when adding new fields here! It is possible that some part of code is calling addressmask
				* without new field property!
				IF TYPE(".ad_mail1")="C"
					thisformset.DataCopy.ad_mail1 = .ad_mail1
				ENDIF
				IF TYPE(".ad_lang")="C" AND NOT EMPTY(.ad_lang)
					thisformset.DataCopy.ad_lang = .ad_lang
				ENDIF
				IF TYPE(".ad_street2")="C"
					thisformset.DataCopy.ad_street2 = .ad_street2
				ENDIF
				IF TYPE(".ad_title")="C"
					thisformset.DataCopy.ad_title = .ad_title
				ENDIF
				IF TYPE(".ad_adrtype")="C"
					thisformset.DataCopy.ad_adrtype = .ad_adrtype
				ENDIF
				IF TYPE(".ad_salute")="C"
					thisformset.DataCopy.ad_salute = .ad_salute
				ENDIF
				IF TYPE(".ad_titlcod")="N"
					thisformset.DataCopy.ad_titlcod = .ad_titlcod
				ENDIF
				IF TYPE(".ad_usr5")="C"
					thisformset.DataCopy.ad_usr5 = .ad_usr5
				ENDIF
			ENDWITH
		ENDIF
		With this.FAddressMask.MainPage.PageAddress.SLAVEPAGE.PAGEAPARTNER
			.CUpdateApartner.enabled = .F.
			.cmdDelPart.enabled = .F.
			.cmdNewAPart.enabled = .F.
		Endwith
		With this.FAddressMask.MainPage.PageAddress
			.refresh
			.SLAVEPAGE.PAGEFREE.refresh
		Endwith
	ENDPROC

	PROCEDURE addressnext
		if this.searchactive
			select (this.selectedtable)
		else
			select AddressTAlias
		endif
		if thisformset.AddressState = 0 then
			if not eof(alias()) then
				skip
				if !eof() then
					this.SelectAddress()
					if this.FAddressMask.MainPage.activepage = 2
					with this.FAddressMask.MainPage.PageGridAddress.AddressGrid
						.refresh
						.setfocus
					endwith
					else
						this.refreshaddressgrid()
					endif
				else
					skip -1
					this.SelectAddress()
				endif
			endif
		endif
	ENDPROC

	PROCEDURE addressprevious
		if this.searchactive
			select (this.selectedtable)
		else
			select AddressTAlias	
		endif
		if thisformset.AddressState = 0 then
			if not bof() then
				skip -1
				if (not bof()) and not (Ad_Addrid = thisformset.fAddressMask.oProcAddress.nAddressUnknownID) then
					this.SelectAddress()
					if this.FAddressMask.MainPage.activepage = 2
						with this.FAddressMask.MainPage.PageGridAddress.AddressGrid
							.refresh
							.setfocus
						endwith
					else
						this.refreshaddressgrid()
					endif
				else
					this.addressgotop()
				endif
			endif
		endif
		
	ENDPROC

	PROCEDURE addresssave
		LOCAL l_lSuccess, l_nError
		this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtad_website.SetFocus()
		this.fAddressMask.mainPage.pageAddress.txtAd_Compkey.SetFocus()
		
		IF this.FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.Enabled
			l_lSuccess = this.FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.OnSave()
			IF NOT l_lSuccess
				RETURN l_lSuccess
			ENDIF
		ENDIF
		
		this.AddressGetUsrChkVals()
		
		IF param2.pa_adrtyeq AND param2.pa_adrtyco AND EMPTY(thisformset.DataCopy.ad_company) AND NOT EMPTY(thisformset.DataCopy.ad_adrtype)
			thisformset.DataCopy.ad_adrtype = ""
		ENDIF
		
		this.FAddressMask.oProcAddress.AddressSet(thisformset.DataCopy)
		
		l_nError = thisformset.FAddressMask.oProcAddress.AddressValid()
		IF l_nError<>0
			alert(GetLangText("ADDRESS","TXT_NONAME") + CHR(13) + CHR(13) + this.FAddressMask.oProcAddress.cValidError)
			* set focus on right control
			DO CASE
				CASE l_nError = 2
					this.FAddressMask.MainPage.PageAddress.txtad_country.SetFocus()
				CASE l_nError = 3
					this.FAddressMask.MainPage.PageAddress.txtad_lang.SetFocus()
				CASE l_nError = 4
					this.FAddressMask.MainPage.PageAddress.txtad_title.SetFocus()
				CASE l_nError = 5
					this.FAddressMask.MainPage.PageAddress.txtad_lname.SetFocus()
				CASE l_nError = 6
					this.FAddressMask.MainPage.PageAddress.txtad_salute.SetFocus()
				CASE l_nError = 7
					this.FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_mail1.SetFocus()
				CASE l_nError = 8
					this.FAddressMask.MainPage.PageAddress.cboAdrType.SetFocus()
			ENDCASE
		ENDIF
		
		IF l_nError=0 AND this.FAddressMask.oProcAddress.AddressSave()
			this.FAddressMask.oProcAddress.AddressSaveFeatures(thisformset.DataCopy.ad_addrid, this.FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.curSelect)
			l_lSuccess = EndTransaction()
			IF NOT l_lSuccess
				DoTableRevert(.F.,'address')
				IF USED('adrmain')
					DoTableRevert(.F.,'adrmain')
				ENDIF
			ENDIF
		ENDIF
		
		IF l_lSuccess
			this.AddressSaveAfter()
		ENDIF
		
		RETURN l_lSuccess
	ENDPROC

	PROCEDURE addresssaveafter
		* Disable fields, and change state
		LOCAL l_oAddress, l_nSelect
		
		IF this.lodbc
			this.opgde.addresssave()
		ENDIF
		
		IF this.SearchActive
			IF USED("addr1")
				l_nSelect = SELECT()
				SELECT address
				SCATTER NAME l_oAddress
				SELECT addr1
				GATHER NAME l_oAddress
				IF EMPTY(addr1.rn)
					REPLACE rn WITH RECNO("address") IN addr1
				ENDIF
				SELECT (l_nSelect)
			ENDIF
		ENDIF
		
		if this.searchactive AND (thisformset.addressstate = 1 OR thisformset.addressstate = 2) AND NOT this.lodbc
			this.searchactive = .F.
			*wait window 'fa'
			Select AddressTAlias
			Set Order to TAG1
			this.SelectedTable = "address"
			this.SetAddressGridSource(this.SelectedTable)
			this.SetApartnerGridSource('apartner')
		endif
		this.addressfieldsdisable()
		this.FAddressMask.MainPage.PageGridAddress.enabled = .T.
		this.addressnext()
		IF thisformset.addressstate = 3
			this.addressprevious()
		ENDIF
		IF VARTYPE(this.Mode)="N" AND this.Mode = 25 AND thisformset.addressstate = 1
			* When entering new address, when referall link address form is showed, automaticly
			* add new address as selected.
			INSERT INTO (this.cCurSelectedAddresses) (cur_addrid, cur_selected) VALUES (address.ad_addrid, .T.)
		ENDIF
		this.refreshaddressgrid()
		thisformset.AddressState = 0
	ENDPROC

	PROCEDURE addresssearch
		WITH this.addressSearchDialog
		
		.TAd_company.value = ""
		.TAd_compkey.value = ""
		.TAd_compnum.value = 0
		.TAd_lname.value = ""
		.TAd_fname.value = ""
		.TAd_city.value = ""
		.TAd_member.value = 0
		.TAd_addrid.value = 0
		.TAd_adrtype.value = ""
		.TAd_email.value = ""
		.tphone.value = ""
		.txtAd_usr1.value = ""
		.txtAd_usr2.value = ""
		.txtAd_usr3.value = ""
		.txtAd_usr4.value = ""
		.txtAd_usr5.value = ""
		.txtAd_usr6.value = ""
		.txtAd_usr7.value = ""
		.txtAd_usr8.value = ""
		.txtAd_usr9.value = ""
		.txtAd_usr10.value = ""
		*RETURN
		.tcheckbox1.value = .f.
		.tcheckbox2.value = .f.
		.tcheckbox3.value = .f.
		.tcheckbox4.value = .f.
		.tcheckbox5.value = .f.
		.tcheckbox6.value = .f.
		.tcheckbox7.value = .f.
		.tcheckbox8.value = .f.
		.tcheckbox9.value = .f.
		.tcheckbox10.value = .f.
		.tcheckbox11.value = .f.
		.tcheckbox1.enabled = .f.
		.tcheckbox12.value = .f.
		.tcheckbox2.enabled = .f.
		.tcheckbox13.value = .f.
		.tcheckbox3.enabled = .f.
		.tcheckbox14.value = .f.
		.tcheckbox4.enabled = .f.
		.tcheckbox15.value = .f.
		.tcheckbox5.enabled = .f.
		.tcheckbox16.value = .f.
		.tcheckbox6.enabled = .f.
		.tcheckbox17.value = .f.
		.tcheckbox7.enabled = .f.
		.tcheckbox18.value = .f.
		.tcheckbox8.enabled = .f.
		.tcheckbox19.value = .f.
		.tcheckbox9.enabled = .f.
		.tcheckbox20.value = .f.
		.tcheckbox10.enabled = .f.
		.TSearchAll.value = ""
		.TAd_company.value = ""
		.TAd_compkey.value = ""
		.TAd_compnum.value = 0
		.TAd_lname.value = ""
		.TAd_fname.value = ""
		.TAd_city.value = ""
		.TAd_member.value = 0
		.TAd_email.value = ""
		.tphone.value = ""
		.txtAd_usr1.value = ""
		.txtAd_usr2.value = ""
		.txtAd_usr3.value = ""
		.txtAd_usr4.value = ""
		.txtAd_usr5.value = ""
		.txtAd_usr6.value = ""
		.txtAd_usr7.value = ""
		.txtAd_usr8.value = ""
		.txtAd_usr9.value = ""
		.txtAd_usr10.value = ""
		ENDWITH
		*IF thisformset.p_refreferralactive
		*	this.AddressSearchDialog.caption = Getlangtext("ADDRESS","TXT_REFERRALSEARCH")
		*ELSE
			this.AddressSearchDialog.caption = Getlangtext("ADDRESS","T_ADDRESSSEARCH")
		*ENDIF
		this.AddressSearchDialog.refresh
		this.AddressSearchDialog.zorder()
		this.AddressSearchDialog.visible = .T.
		*this.makeformunreachable()
		*do form "forms\AddressSearch"
		*if !SCancel
		*endif
		
		
	ENDPROC

	PROCEDURE addressstate_assign
		LPARAMETERS tnNewVal
		* Initialize Address State (0 - Normal, 1 - New, 2 - Copy, 3 - Edit)
		this.AddressState = tnNewVal
		IF this.FAddressMask.Visible
			this.FAddressMask.ActivateToolbar()
		ENDIF
	ENDPROC

	PROCEDURE addresstransfer
		LOCAL l_oParam AS Collection, l_nMainAddrid
		LOCAL ARRAY l_aParams(11)
		
		l_nMainAddrid = address.ad_addrid
		l_oParam = CREATEOBJECT("Collection")
		l_oParam.Add(l_nMainAddrid, "MAIN_ADDRID")
		
		l_aParams(1) = "SELECT_ADDRESSES"
		l_aParams(2) = ""
		l_aParams(3) = .F.
		l_aParams(4) = .F.
		l_aParams(5) = .F.
		l_aParams(6) = .F.
		l_aParams(7) = 0
		l_aParams(8) = .F.
		l_aParams(9) = this.fAddressMask
		l_aParams(10) = 0
		l_aParams(11) = l_oParam
		
		doform('searchadr','forms\addressmask', , .T., @l_aParams)
		
		l_oParam = .NULL.
		
		RETURN .T.
	ENDPROC

	PROCEDURE addressundo
		IF Thisformset.AddressState = 1
			this.addressnew()
			RETURN .T.
		ENDIF
		
		with this.FAddressMask.MainPage.PageAddress
		.txtAd_Company.Value= Address.Ad_Company
		.txtAd_Departm.Value= Address.Ad_Departm
		.txtAd_Lname.Value= Address.Ad_Lname
		.txtAD_Lang.Value= Address.AD_Lang
		.txtad_title.Value= Address.Ad_title
		.txtAd_Salute.Value= Address.Ad_Salute
		thisformset.DataCopy.ad_titlcod = Address.Ad_TitlCod
		.ocbotitle.Refresh()
		.txtAd_Compnum.Value= Address.Ad_Compnum
		.txtAd_Street.Value= Address.AD_STREET
		.txtAd_Street2.Value= Address.Ad_Street2
		.txtAd_State.Value= Address.Ad_State
		.txtAd_City.Value= Address.Ad_City
		.InfoPage.pagCommunication.txtAd_Phone.Value= Address.Ad_Phone
		.InfoPage.pagCommunication.txtAd_Phone2.Value= Address.Ad_Phone2
		.InfoPage.pagCommunication.txtAd_Phone3.Value= Address.Ad_Phone3
		.InfoPage.pagCommunication.txtAd_Fax.Value= Address.Ad_Fax
		.InfoPage.pagCommunication.txtAd_Email.Value= Address.Ad_Email
		.InfoPage.pagCommunication.txtAd_website.Value= Address.Ad_website
		.InfoPage.pagCommunication.txtad_ustidnr.Value= Address.ad_ustidnr
		.InfoPage.pagCommunication.chkad_save.Value= Address.ad_save
		.InfoPage.pagCommunication.chkad_novat.Value= Address.ad_novat
		.InfoPage.pagCommunication.txtAd_Mail1.Value= Address.Ad_Mail1
		.InfoPage.pagCommunication.txtAd_Mail2.Value= Address.Ad_Mail2
		.InfoPage.pagCommunication.txtAd_Mail3.Value= Address.Ad_Mail3
		.InfoPage.pagCommunication.txtAd_Mail4.Value= Address.Ad_Mail4
		.InfoPage.pagCommunication.txtAd_Mail5.Value= Address.Ad_Mail5
		.InfoPage.pagGuestInfo.txtAd_Ratecod.Value= Address.Ad_Ratecod
		.txtAd_Fname.Value= Address.Ad_Fname
		.SlavePage.PageSales.cboAd_market.Value= Address.Ad_market
		.SlavePage.PageSales.cboAd_source.Value= Address.Ad_source
		.SlavePage.PageSales.cboAd_discnt.Value= Address.Ad_discnt
		
		.InfoPage.pagGuestInfo.txtAd_Billins.Value= Address.Ad_Billins
		.InfoPage.pagGuestInfo.dtxtAd_Birth.Value= Address.Ad_Birth
		.InfoPage.pagGuestInfo.txtAd_Member.Value= Address.Ad_Member
		.InfoPage.pagGuestInfo.txtAd_webpass.Value= Address.Ad_webpass
		.InfoPage.pagGuestInfo.dtxtAd_Memdat.Value= Address.Ad_Memdat
		.txtAd_Compkey.Value= Address.Ad_Compkey
		.txtAd_Zip.Value= Address.Ad_Zip
		.txtAd_Country.Value= Address.Ad_Country
		thisformset.fAddressMask.oProcAddress.AddressSetFeatures(Address.ad_addrid, .InfoPage.pagGuestInfo.stxtFeature.curSelect, .T.)
		.InfoPage.pagGuestInfo.stxtFeature.RefreshValue()
		.InfoPage.pagGuestInfo.cboroomname.Value= Address.Ad_roomnum
		IF .InfoPage.pagGuestInfo.chkNomail.Enabled
			.InfoPage.pagGuestInfo.chkNomail.Value= Address.Ad_nomail
		ENDIF
		.chkAd_Vip.Value= Address.Ad_Vip
		.chkAd_Vip2.Value= Address.Ad_Vip2
		.cboadrtype.Value= Address.Ad_adrtype
		.ad_vipstat.Value= Address.Ad_vipstat
		endwith
		
		RETURN .T.
	ENDPROC

	PROCEDURE apartnerdelete
		LOCAL LProceed, LResult, LFoundInReservat, LMyApID, LNewApID, LAlias, LWait, LMyNewApData, lcArchScripts
		LMyNewApData = ""
		LProceed = .f.
		LFoundInReservat = .F.
		LMyApID = 0
		LNewApID = 0
		LAlias = ""
		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Refresh
		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Setfocus
		if !empty (ApartnerTAlias.ap_addrid)
			LAlias = ALIAS()
			LMyApID = ApartnerTAlias.ap_apid
			if !SEEK(ApartnerTAlias.ap_apid, 'reservat' , 'TAG25')
				SELECT reservat
				LOCATE FOR rs_invapid = ApartnerTAlias.ap_apid
				LFoundInReservat = FOUND()
			ELSE
				LFoundInReservat = .t.
			ENDIF
			IF LFoundInReservat
				if MESSAGEBOX(GetLangText("ADDRESS","TXT_APARTNER_FOUND"),4+32,GetLangText("FUNC","TXT_QUESTION")) = 6
					LProceed = .t.		
				ENDIF
			ELSE
				LProceed = .t.
			ENDIF
			IF LProceed 
				DO FORM forms\selectapartner TO LNewApID
				IF LNewApID <> 0
					LMyString = GetLangText("ADDRESS","TXT_TRANSFERAPARTNER") + CHR(13)
					LMyString = LMyString + ALLTRIM(ApartnerTAlias.ap_fname) + IIF(EMPTY(ApartnerTAlias.ap_fname),""," ") + ALLTRIM(flip(ApartnerTAlias.ap_lname))+CHR(13)
					LMyString = LMyString + GetLangText("WAKEUP","TXT_TO") + CHR(13)
					= SEEK(LNewApID,'apartner','tag3')
					LMyNewApData = ALLTRIM(ApartnerTAlias.ap_fname) + IIF(EMPTY(ApartnerTAlias.ap_fname),""," ") + ALLTRIM(flip(ApartnerTAlias.ap_lname))
					LMyString = LMyString + LMyNewApData  +CHR(13)+CHR(13)
					LMyString = LMyString + GetLangText("ADDRESS","T_DELETEAPARTNER")
					LMyNewApData = IIF(EMPTY(apartner.ap_title),"",ALLTRIM(apartner.ap_title)+" ")+;
								   ALLTRIM(ApartnerTAlias.ap_fname) + IIF(EMPTY(ApartnerTAlias.ap_fname),""," ") +;
								   ALLTRIM(flip(ApartnerTAlias.ap_lname))
					IF MESSAGEBOX(LMyString,4+32, GetLangText("FUNC","TXT_QUESTION") ) <> 6
						LProceed = .f.
					ELSE
						LProceed = .t.
					ENDIF
				ELSE
					LProceed = .F.
				ENDIF
			ENDIF
			IF LProceed
				LWait = GetLangText("COMMON", "T_PLEASEWAIT")
				WAIT CLEAR
				LWait = LWait+"."
				WAIT WINDOW LWait NOWAIT
				SELECT reservat
				IF LFoundInReservat
					= SEEK(LNewApID,'apartner','tag3')
					SCAN
						IF rs_apid = LMyApID
							replace rs_apid WITH LNewApID
							replace rs_apname WITH LMyNewApData
							LWait = LWait+"."
							WAIT WINDOW LWait NOWAIT
						ENDIF
						IF rs_invapid = LMyApID
							replace rs_invapid WITH LNewApID
							replace rs_invap WITH LMyNewApData
						ENDIF
					ENDSCAN
				ENDIF
				******************** Prepare SQLs for archive ******************************************************
				*
				TEXT TO lcArchScripts TEXTMERGE NOSHOW PRETEXT 15
				SELECT histres.* FROM histres WHERE hr_apid = <<SqlCnvB(LMyApID)>> OR hr_invapid = <<SqlCnvB(LMyApID)>>
				ENDTEXT
				ProcArchive("RestoreArchive", "histres", lcArchScripts, {})
				*
				****************************************************************************************************
				SELECT histres
				SCAN
					IF hr_apid = LMyApID
						replace hr_apid WITH LNewApID
						replace hr_apname WITH LMyNewApData
						LWait = LWait+"."
						WAIT WINDOW LWait NOWAIT
					ENDIF
					IF hr_invapid = LMyApID
						replace hr_invapid WITH LNewApID
						replace hr_invap WITH LMyNewApData
					ENDIF
				ENDSCAN
				******************** Delete temp files *************************************************************
				*
				ProcArchive("DeleteTempArchive", "histres")
				*
				****************************************************************************************************
				LWait = LWait+"."
				WAIT WINDOW LWait NOWAIT
				
				DELETE FROM adrphone WHERE aj_apid = LMyApID
				LWait = LWait+"."
				WAIT WINDOW LWait NOWAIT
		
				IF SEEK(LMyApID,'apartner','tag3')
					delete in apartner
					TABLEUPDATE(.t.,.t.,'apartner')
					if !eof('apartner')
						skip in apartnertalias
					endif
					this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Refresh
					this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Setfocus
				ENDIF
				WAIT CLEAR
			ENDIF
			SELECT &LAlias
		else
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
		endif
		if !(ApartnerTAlias.ap_addrid = AddressTAlias.ad_addrid)
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
		else
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .T.
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .T.
		endif
		
	ENDPROC

	PROCEDURE apartneredit
		this.FAddressMask.oProcAddress.ApartnerEdit(apartner.ap_apid)
		this.ChangeApartnerDialog.DataCopy = this.FAddressMask.oProcAddress.oApartner
		
		this.ChangeApartnerDialog.Refresh()
		this.ChangeApartnerDialog.Caption = Getlangtext("ADDRESS", "T_APARTNERNAME")
		this.ChangeApartnerDialog.ZOrder()
		this.ChangeApartnerDialog.LastTabKey = 0
		this.ChangeApartnerDialog.Visible = .T.
		
		RETURN .T.
	ENDPROC

	PROCEDURE apartnernew
		this.FAddressMask.oProcAddress.ApartnerNew(address.ad_addrid)
		
		this.ChangeApartnerDialog.DataCopy = this.FAddressMask.oProcAddress.oApartner
		this.ChangeApartnerDialog.Refresh()
		this.ChangeApartnerDialog.Caption = Getlangtext("ADDRESS", "T_APARTNERNAME")
		this.ChangeApartnerDialog.ZOrder()
		this.ChangeApartnerDialog.LastTabKey = 0
		this.ChangeApartnerDialog.Visible = .T.
		
		RETURN .T.
	ENDPROC

	PROCEDURE apartnersave
		LOCAL l_nError
		l_nError = this.FAddressMask.oProcAddress.ApartnerValid()
		IF l_nError>0
			alert(this.FAddressMask.oProcAddress.cValidError)
			DO CASE
				CASE l_nError = 2
					this.ChangeApartnerDialog.tAp_Lname.SetFocus()
				CASE l_nError = 3
					this.ChangeApartnerDialog.combo1.SetFocus()
			ENDCASE
		
			RETURN .F.
		ENDIF
		
		this.ChangeApartnerDialog.visible = .F.
		
		this.FAddressMask.oProcAddress.ApartnerSave()
		
		this.ChangeApartnerDialog.caption = ""
		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Refresh()
		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.SetFocus()
		this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
		this.FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Refresh()
		
		RETURN .T.
	ENDPROC

	PROCEDURE checkattachmentstext
		LPARAMETERS lp_nMsgId, lp_lSentMsg
		LOCAL l_cRetText
		DO CheckAttachmentsText IN procemail WITH lp_nMsgId, lp_lSentMsg, l_cRetText
		RETURN PADR(l_cRetText,5)
	ENDPROC

	PROCEDURE definecontrolsource
		LOCAL LCheckType, LMacro 
		this.FAddressMask.LockScreen = .T.
		this.SetApartnerGridSource("apartner")
		WITH thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid
			.recordsource = [curDocument]
			.Column1.controlsource = [curDocument.dc_file]
			.Column2.controlsource = [curDocument.dc_descr]
			.Column3.controlsource = [curDocument.dc_date]
			.Column4.controlsource = [curDocument.dc_time]
			.Column5.controlsource = [curDocument.dc_userid]
			.Column6.ControlSource = [thisformset.m_DocumentGetTypeText(curDocument.dc_type)]
		ENDWITH
		IF this.searchactive
			this.SetAddressGridSource(this.selectedtable)
		ELSE
		* record souce za listu je address
			this.SetAddressGridSource('address')
		ENDIF
		WITH this.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral
			.RecordSource = [tgridreferralcursor]
			.column1.ControlSource = [tgridreferralcursor.re_reftext]
			.column2.ControlSource = [tgridreferralcursor.re_addtext]
			.column3.ControlSource = [tgridreferralcursor.re_date]
			.column4.ControlSource = [tgridreferralcursor.re_user]	
			.column5.ControlSource = [tgridreferralcursor.re_linkres]	
		ENDWITH
		this.setcontrolsourcetogrid()
		this.FAddressMask.LockScreen = .F.
	ENDPROC

	PROCEDURE Destroy
		LOCAL _check, _toolbar
		checkkeylabel()
		thisformset.Visible = .F.
		gl_wind=.t.
		*cinvoice=''
		ccompany=''
		cname=''
		
		DO CASE
			CASE thisformset.AddressStart=='EDITL' .OR. thisformset.AddressStart=='BRWL' OR thisformset.AddressStart=="EDITQ"
				do case
					case empty(this.addresscall)
					case this.addresscall=='ARL' &&arr
						M.AC_ADDRID=ADDRESS.AD_ADDRID
						CCOMPANY=ADDRESS.AD_COMPANY
						cname=address.ad_lname
						*IF !_toolbar
						*	saYaddr(M.ac_addrid,4.75,2,40)
						*endif
					case this.addresscall=='RSL' && reservation
						m.rs_addrid=address.ad_addrid
						m.rs_lname=UPPER(address.ad_lname)
						*IF !_toolbar
						*	saYaddr(M.rs_addrid,1.6,2,40)	
						*endif
						IF _reser_mode = "NEW" OR _reser_mode = "EDIT"
		*					this.adrtoresfields()
		*					IF !EMPTY(address.ad_feat1) AND EMPTY(m.rs_feat1)
		*						m.rs_feat1 = address.ad_feat1
		*					ENDIF
		*					IF !EMPTY(address.ad_feat2) AND EMPTY(m.rs_feat2)
		*						m.rs_feat2 = address.ad_feat2
		*					ENDIF
		*					IF !EMPTY(address.ad_feat3) AND EMPTY(m.rs_feat3)
		*						m.rs_feat3 = address.ad_feat3
		*					ENDIF
						endif
					case this.addresscall=='BIL'
						l_Lname3=ADDRESS.AD_LNAME
						l_Id3=ADDRESS.AD_ADDRID
		
					case this.addresscall=='QER'
						*WAIT WINDOW STR(SET("Datasession"))
		 	            M.ad_lname = address.ad_lname
		 	            M.ad_fname = address.ad_fname
			            M.ad_addrid = address.ad_addrid
			            M.ad_country = address.ad_country
			            M.ad_titlcod = address.ad_titlcod
			            M.ad_lang = address.ad_lang
			            M.ad_created = address.ad_created
			            M.ad_updated = address.ad_updated
			            M.ad_userid = address.ad_userid
			            M.rs_addrid = M.ad_addrid
			            M.rs_lname = UPPER(M.ad_lname)
				endcase
		
			CASE thisformset.AddressStart=='EDITC' .OR. thisformset.AddressStart=='BRWC'
					do case
						case empty(this.addresscall)
						case this.addresscall=='RSC' && company
							m.rs_company=UPPER(address.ad_company)
							M.RS_COMPID=ADDRESS.AD_ADDRID
							IF (_reser_mode = "NEW" OR _reser_mode = "EDIT")&& AND EMPTY(m.rs_lname)
		*						this.adrtoresfields()
		*						IF !EMPTY(address.ad_feat1) AND EMPTY(m.rs_feat1)
		*							m.rs_feat1 = address.ad_feat1
		*						ENDIF
		*						IF !EMPTY(address.ad_feat2) AND EMPTY(m.rs_feat2)
		*							m.rs_feat2 = address.ad_feat2
		*						ENDIF
		*						IF !EMPTY(address.ad_feat3) AND EMPTY(m.rs_feat3)
		*							m.rs_feat3 = address.ad_feat3
		*						ENDIF
							endif
							IF !TYPE("thisformset.selapid") = "U"
								IF thisformset.selapid > 0 
									m.rs_apid = thisformset.selap(thisformset.selapid,1)
									*m.rs_apname = thisformset.selap(thisformset.selapid,3)
									m.rs_apname = IIF(EMPTY(thisformset.selap(thisformset.selapid,2)),"",ALLTRIM(thisformset.selap(thisformset.selapid,2))+" ")+IIF(EMPTY(thisformset.selap(thisformset.selapid,4)),"",ALLTRIM(thisformset.selap(thisformset.selapid,4))+" ")+ALLTRIM(flip(thisformset.selap(thisformset.selapid,3)))
								ELSE
									m.rs_apid = 0
									m.rs_apname = ""
									_check = .T.
								ENDIF
							ELSE
								IF !_check 
									m.rs_apid = 0
									m.rs_apname = ""
									_check = .T.	
								ENDIF
							ENDIF
						case this.addresscall=='RSI' && invoice
							cinvoice=''
							m.rs_invid=address.ad_addrid
							cinvoice=UPPER(address.ad_company)
							IF !TYPE("thisformset.selapid") = "U"
								IF thisformset.selapid > 0 
									m.rs_invapid = thisformset.selap(thisformset.selapid,1)
		*							m.rs_invap = ALLTRIM(UPPER(thisformset.selap(thisformset.selapid,2)))+" "+UPPER(thisformset.selap(thisformset.selapid,3))
									m.rs_invap = IIF(EMPTY(thisformset.selap(thisformset.selapid,2)),"",ALLTRIM(thisformset.selap(thisformset.selapid,2))+" ")+IIF(EMPTY(thisformset.selap(thisformset.selapid,4)),"",ALLTRIM(thisformset.selap(thisformset.selapid,4))+" ")+ALLTRIM(flip(thisformset.selap(thisformset.selapid,3)))
								ELSE
									m.rs_invapid = 0
									m.rs_invap = ""
									_check = .T.
								ENDIF
							ELSE
								IF !_check 
									m.rs_invapid = 0
									m.rs_invap = ""
									_check = .T.	
								ENDIF
							ENDIF
						case this.addresscall=='RSA' && agent
							m.rs_agent=UPPER(address.ad_company)
							m.rs_agentid=address.ad_addrid
						case this.addresscall=='ARC'
							M.AC_ADDRID=ADDRESS.AD_ADDRID
							CCOMPANY=ADDRESS.AD_COMPANY
							cname=address.ad_lname
							*wait window str(m.ac_addrid)+ccompany+cname
							*IF !_toolbar
							*	saYaddr(M.ac_addrid,4.75,2,40)
							*endif
						case this.addresscall=='BIC'
							l_Lname2=ADDRESS.AD_COMPANY
							l_Id2=ADDRESS.AD_ADDRID
							*M.rs_billins=ADDRESS.AD_ADDRID
							*CCOMPANY=ADDRESS.AD_COMPANY
							*cname=address.ad_lname
							*wait window str(m.ac_addrid)+ccompany+cname
							*saYaddr(M.rs_billins,3.750, 25.000, 50)
					endcase
			OTHERWISE
		ENDCASE
		
		IF this.screenformsdisabled&& AND !roomplanactive
			for i=1 to _screen.formcount
				_screen.forms(i).enabled=.t.
			NEXT
		ENDIF
		
		
		childtitle("")
		IF thisformset.AddressStart == "EDITR"
			IF SEEK(this.reserid,'reservat','tag1')
				IF !EMPTY(reservat.rs_addrid)
					IF !(ALLTRIM(UPPER(address.ad_lname))==ALLTRIM(UPPER(reservat.rs_lname)))
						SELECT reservat
						SET ORDER TO TAG10
						GOTO top
						SEEK address.ad_addrid
						IF FOUND()
							DO WHILE address.ad_addrid=reservat.rs_addrid AND !EOF()
								replace rs_lname WITH UPPER(address.ad_lname)
		*						replace rs_company WITH UPPER(address.ad_company)
								SKIP 1
							ENDDO
						ENDIF
						SELECT address
						this.refreshroomplan=.t.
					ENDIF
				ENDIF
				IF !EMPTY(reservat.rs_compid)
					IF !(ALLTRIM(UPPER(address.ad_company))==ALLTRIM(UPPER(reservat.rs_company)))
						SELECT reservat
						SET ORDER TO TAG11
						GOTO top
						SEEK address.ad_addrid
						IF FOUND()
							DO WHILE address.ad_addrid=reservat.rs_compid AND !EOF()
		*						replace rs_lname WITH UPPER(address.ad_lname)
								replace rs_company WITH UPPER(address.ad_company)
								SKIP 1
							ENDDO
						ENDIF
						SELECT address
						this.refreshroomplan=.t.
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF this.lodbc
			IF TYPE("this.opgde.oaddressgrid")="O" AND NOT ISNULL(this.opgde.oaddressgrid)
				this.opgde.oaddressgrid = .NULL.
			ENDIF
			IF TYPE("this.opgde.ocaaddress")="O" AND NOT ISNULL(this.opgde.ocaaddress)
				this.opgde.ocaaddress = .NULL.
			ENDIF
			this.opgde = .NULL.
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE doapartner
		LOCAL _addresse
		LOCAL ARRAY LApartners(1)
		*thisformset.AddProperty("selap(1)","_NOT_ENTERED_")
		_addresse = address.ad_addrid
		SELECT DISTINC apartner.ap_apid, apartner.ap_title, apartner.ap_lname, apartner.ap_fname, ;
			apartner.ap_phone1, apartner.ap_fax ;
		FROM apartner ;
		WHERE ap_addrid = _addresse INTO ARRAY LApartners&&thisformset.selap
		
		thisformset.AddProperty("selap(ALEN(LApartners,1)+1,6)","")
		ACOPY(LApartners,thisformset.selap)
		
		IF !EMPTY(address.ad_lname)
			thisformset.tform1.Tlistbox1.AddItem(LEFT(address.ad_title,7)+' '+left(address.ad_fname,10)+' '+left(flIp(address.ad_lname),17)+' Tel:'+;
			left(address.ad_phone,17)+' Fax:'+LEFT(address.ad_fax,97))
		ENDIF
		FOR i = 1 TO ALEN(thisformset.selap,1) - 1
			thisformset.tform1.Tlistbox1.AddItem(LEFT(thisformset.selap(i,2),7)+' '+LEFT(thisformset.selap(i,4),10)+' '+ ;
			LEFT(flip(thisformset.selap(i,3)),17)+' Tel:'+LEFT(thisformset.selap(i,5),17)+' Fax:'+LEFT(thisformset.selap(i,6),97))
		*	thisform.Tlistbox1.AddItem(thisformset.selap(i,2)+' '+TRIM(thisformset.selap(i,4))+' '+ ;
		*	TRIM(flip(thisformset.selap(i,3)))+' Tel:'+TRIM(thisformset.selap(i,5))+' Fax:'+TRIM(thisformset.selap(i,6)))
		ENDFOR
		thisformset.selap(ALEN(thisformset.selap,1),1)=0
		thisformset.selap(ALEN(thisformset.selap,1),2)=""
		thisformset.selap(ALEN(thisformset.selap,1),3)=""
		thisformset.selap(ALEN(thisformset.selap,1),4)=""
		thisformset.selap(ALEN(thisformset.selap,1),5)=""
		thisformset.selap(ALEN(thisformset.selap,1),6)=""
		thisformset.tform1.Tlistbox1.AddItem(" ")
		thisformset.tform1.Tlistbox1.Refresh()
		
		
	ENDPROC

	PROCEDURE docdelete
		LOCAL LMessage, l_nMaId, l_nSelect, l_oEmail
		
		IF NOT INLIST(curDocument.dc_type, "ARRECIVABL", "EINBOX", "ESENT") AND ;
				NOT dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
			RETURN .F.
		ENDIF
		
		l_nSelect = SELECT()
		LMessage = Str2Msg(GetLangText("DOC","TA_DOCDEL"), "%s", ;
				IIF(INLIST(curDocument.dc_type,"EINBOX","ESENT"),"(e-mail)",TRIM(curDocument.dc_file)), TRIM(curDocument.dc_descr))
		IF MESSAGEBOX(LMessage ,52,GetLangText("FUNC","TXT_QUESTION")) = 6
			DO CASE
			CASE INLIST(curDocument.dc_type, " ", "WORDDOC ", "WORDDOCX", "EXCELDOC", "WRITERDOC", "CALCDOC", "PDFDOC", "EXTERNAL")
				DELETE FILE (FULLPATH(gcDocumentdir+TRIM(dc_file)))
				DELETE in DocumentTAlias
				=TABLEUPDATE(.t.,.t.,"document")
			CASE curDocument.dc_type = "TELENOTE"
				DELETE in Document
				IF SEEK(VAL(document.dc_file),'phnote','tag2')
					DELETE IN phnote
				ENDIF
				=TABLEUPDATE(.t.,.t.,"document")
			CASE curDocument.dc_type = "EINBOX"
				l_oEmail = ProcEmail("PECreateEmailClient")
				l_oEmail.DeleteMsg(StrToSql("DLocate('einbox', 'ei_eiid = %n1 AND ei_msysid = %s1')", curDocument.dc_eiid))
				DO einbox_delete IN procemail WITH curDocument.dc_eiid
			CASE curDocument.dc_type = "ESENT"
				DO esent_delete IN procemail WITH curDocument.dc_esid
			CASE curDocument.dc_type = "ARRECIVABL"
				DO ArDeleteRecivablesListFromAddress IN ar WITH address.ad_addrid, curDocument.dc_agid
			ENDCASE
			SKIP 1 IN curDocument
			this.refreshdocpage()
		ENDIF
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE finishsearch_assign
		LPARAMETERS tlNewVal
		IF this.FinishSearch # tlNewVal
			this.FinishSearch = tlNewVal
			this.FAddressMask.ActivateToolbar()
		ENDIF
	ENDPROC

	PROCEDURE firstaddressinreferrals
		LPARAMETERS lp_nAddressID
		* checks if address ID exist in re_to feild in referral table
		* if exist than this address has link from some other address and is not first one
		
		LOCAL l_lAddressIsFirst
		l_lAddressIsFirst = NOT SEEK(lp_nAddressID, 'referral', 'Tag3')
		RETURN l_lAddressIsFirst
	ENDPROC

	PROCEDURE futureresdelete
		LOCAL l_nReserId, l_cFutCur, l_oCheckReser
		l_oCheckReser = .NULL.
		l_cFutCur = this.futurefilename
		l_nReserId = &l_cFutCur..rs_reserid
		
		IF SEEK(l_nReserId,"reservat","tag1")
			l_oCheckReser = CREATEOBJECT("checkreservat")
			IF NOT ISNULL(l_oCheckReser)
				l_oCheckReser.DeleteReser()
			ENDIF
			RELEASE l_oCheckReser
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE getcheckboxvalue		&& When Checkbox is used in FreePage, then transform String Values into Logical
		LPARAMETERS PUserFeldNummber
		
		LMacro = "IIF(address.ad_usr"+ALLTRIM(STR(PUserFeldNummber))+"='T',.T.,.F.)"
		
		RETURN &LMacro
	ENDPROC

	PROCEDURE getreferral
		LPARAMETERS lp_cLinkres
		LOCAL l_nAddrID, l_cResult, l_cRecSource, l_nRecno
		l_cResult = ""
		l_cRecSource = this.faddressMask.mainPage.pageGridAddress.addressGrid.RecordSource
		l_nAddrID = &l_cRecSource..ad_addrid
		DO CASE
			CASE lp_cLinkres = "MA"
				
				* Check is this address main address for some other address
				IF dlocate("referral","re_from = " + sqlcnv(l_nAddrID) + " AND referral.re_mainadr")
					l_cResult = "!"
				ENDIF
				
				* Now check has this address main address
				IF dlocate("referral","re_to = " + sqlcnv(l_nAddrID) + " AND referral.re_mainadr")
					IF SEEK(referral.re_from,'address3','tag1')
						l_cResult = l_cResult + ;
							ALLTRIM(IIF(EMPTY(address3.ad_company), UPPER(address3.ad_lname), UPPER(address3.ad_company)))
					ENDIF
				ENDIF	
			
			CASE lp_cLinkres = "OT"
				* Show only linked addresses, which are no main address, no bill address and no reservation address
				IF dlocate("referral","re_from = " + sqlcnv(l_nAddrID) + " AND NOT referral.re_mainadr AND EMPTY(referral.re_linkres)")
						l_cResult = ALLTRIM(IIF(SEEK(referral.re_to,'address3','tag1') AND NOT EMPTY(address3.ad_company), ;
								UPPER(address3.ad_company), UPPER(address3.ad_lname)))
				ENDIF
		
			OTHERWISE
				IF SEEK(l_nAddrID,"referral","tag2") AND ;
						(SEEK(PADR(l_nAddrID,8)+lp_cLinkres,"referral","tag4") OR SEEK(PADR(l_nAddrID,8)+"XB","referral","tag4"))
					l_cResult = ALLTRIM(IIF(SEEK(referral.re_to,'address3','tag1') AND NOT EMPTY(address3.ad_company), ;
							UPPER(address3.ad_company), UPPER(address3.ad_lname)))
				ENDIF
		ENDCASE
		RETURN l_cResult
	ENDPROC

	PROCEDURE Init
		LPARAMETERS lp_uParam1, lp_uParam2, lp_uParam3, lp_uParam4, lp_uParam5, ;
					lp_uParam6, lp_uParam7, lp_uParam8, lp_uParam9, lp_uParam10, lp_uParam11, lp_uParam12, lp_uParam13, ;
					lp_uParam14
		LOCAL l_cCallProc, l_nParamNo, l_uRetVal
		l_cCallProc = "this.MainEntryPoint" + "("
		FOR l_nParamNo = 1 TO PCOUNT()
			l_cCallProc = l_cCallProc + IIF(l_nParamNo = 1, "", ", ") + "@lp_uParam" + ALLTRIM(STR(l_nParamNo))
		NEXT
		l_cCallProc = l_cCallProc + ")"
		l_uRetVal = &l_cCallProc
		
		* Store used aliases after init. When exiting form, close all new opened aliases in MainExitPoint method.
		AUSED(this.ausedaliases)
		
		this.lfirststart = .F.
		
		RETURN l_uRetVal
	ENDPROC

	PROCEDURE lforbidenrem4_assign
		LPARAMETERS vNewVal
		
		IF vNewVal
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageSales.lblRemX.Visible = .F.
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageSales.txtRemX.Visible = .F.
		ENDIF 
		
		THIS.lforbidenrem4 = m.vNewVal
		
	ENDPROC

	PROCEDURE Load
		this.useoldversion = !g_newversionactive
		
		this.p_referralparams(1) = .F.
		this.p_referralparams(2) = 0
		this.p_referralparams(3) = ""
		this.p_referralparams(4) = 0
		
		this.cdocumentsfilter = ".T."
		this.ldocumentsemail = .T.
		this.lDebitorRecivables = _screen.DV
		this.FutureFileName = "futres1"
		
		this.lodbc = odbc()
		ini(.T.,.T.,this.DataEnvironment,,,.T.)
		IF this.lodbc
			SELECT address
			SET RELATION TO
			this.AddProperty("opgde",.NULL.)
			this.opgde = NEWOBJECT("_pg_addressmask_de","libs\proc_address.vcx")
			this.opgde.Initialize()
			this.opgde.ocaaddress = this.DataEnvironment.address
		ENDIF
		IF _screen.BMS
			= openfile(.F.,"bsacct")
		ENDIF
		
		SELECT *, CAST(0 AS n(10)) AS rn FROM address WHERE 0=1 INTO CURSOR addr1 READWRITE
		
		SELECT address
		SCATTER Name thisformset.DataCopy MEMO BLANK
		
		RETURN .T.
	ENDPROC

	PROCEDURE mainentrypoint
		LPARAMETERS AddStart, AddText, addtagno, addcall, rn, naddrid, nmode, reserid, pl_oRefObject, lp_nAdId, ;
				lp_oParam AS Collection, lp_lDontCloseOnFinish
		EXTERNAL ARRAY parights
		
		LOCAL LTop, lcForeColor, lcBackColor, l_lWrite, l_cSql, l_lMailingCodeCheck, l_lFound, l_cLang
		*WAIT WINDOW NOWAIT "Addstart: " + AddStart + ", addcall: " + addcall TIMEOUT 10
		
		IF PCOUNT() > 8 AND VARTYPE(pl_oRefObject)="O"
			this.oReferenceToCallingObject = pl_oRefObject
			IF nmode = 14
				this.oReferenceToCallingObject.Parent.Enabled = .F.
			ELSE
				IF VARTYPE(this.oReferenceToCallingObject)<>"X"
					this.oReferenceToCallingObject.Enabled = .F.
					this.oReferenceToCallingObject.AlwaysOnTop = .F.
				ENDIF
			ENDIF
		ENDIF
		IF PCOUNT()>10 AND VARTYPE(lp_oParam)="O"
			this.oParam = lp_oParam
			lp_oParam = .NULL.
		ENDIF
		gl_wind=.f.
		this.addresscall=addcall
		IF EMPTY(AddStart)
			AddStart = "NORMAL"
		ENDIF
		
		IF this.lfirststart
			IF this.lodbc
				this.opgde.oaddressgrid = this.FAddressMask.MainPage.PageGridAddress.AddressGrid
			ENDIF
			this.lforbidenrem4 = param.pa_noreml4
			this.AddProperty("lOkCommand",.F.)
			This.HistoryFileName = "histfilename"
			This.OldresFileName = "cTmpHistres"
			thisformset.ds=this.datasessionid
			this.selectedtable = 'address'
			this.AddProperty("screenformsdisabled",.F.)
			this.AddProperty("zipcodern",0)
			this.AddProperty("mode",0)
			this.AddProperty("reserid",0)
			this.AddProperty("refreshroomplan",.f.)
			this.AddProperty("gridcontrolsource",.F.)
			this.AddProperty("aaolumns(14,2)",.f.)
			this.AddProperty("p_UserFieldsForAccountInfo",param.pa_adrbank)
			IF NOT EMPTY(AddStart) AND AddStart = "SELECT_ADDRESSES"
				this.faddressMask.cFormLabel = "searchadr"
				this.AddProperty("cCurSelectedAddresses", SYS(2015))
				CREATE CURSOR (this.cCurSelectedAddresses) (cur_addrid i, cur_selected l(1))
				INDEX ON cur_addrid TAG TAG1
			ELSE
				this.FAddressMask.MainPage.PageGridAddress.AddressGrid.DefaultPropertiesSet(13, "gr_activ", .F.)
			ENDIF
			this.faddressMask.Init(.T.)
			this.FAddressMask.AddProperty("LastTabKey", 0) && Ading Property for Focus settings
			this.ChangeApartnerDialog.AddProperty('DataCopy', .F.)
			this.FAddressMask.AddProperty("lcloseonfinish", .T.)
			IF lp_lDontCloseOnFinish
				this.FAddressMask.lcloseonfinish = .F.
			ENDIF
		ELSE
			this.MainTableRevert()
			this.searchactive = .F.
			this.lOKCommand = .F.
			this.selectedtable = 'address'
			SET ORDER TO tag1 IN address
			this.SetAddressGridSource('address')
			IF this.fAddressMask.timer1.Interval <> 10
				this.fAddressMask.timer1.Interval = 10
			ENDIF
			IF this.fAddressMask.timer2.Interval <> 10
				this.fAddressMask.timer2.Interval = 10
			ENDIF
			* set default page in address guest details info page
			IF this.fAddressMask.mainPage.pageAddress.infoPage.ActivePage <> 1
				this.fAddressMask.mainPage.pageAddress.infoPage.ActivePage = 1
			ENDIF
			* Reset filter in documents page
			thisformset.ldocumentsemail = _SCREEN.OL
			thisformset.cdocumentsfilter = ".T."
			thisformset.lDebitorRecivables = _SCREEN.DV
			ZAP IN addr1
		ENDIF
		
		thisformset.AddressStart = AddStart
		thisformset.AddressText = AddText
		thisformset.mode = nmode
		thisformset.reserid = reserid
		
		this.firstsearch = .F.
		this.lStartedFirstTime = .F.
		thisformset.AddressState = 0 && Initialize Address State (0 - Normal, 1 - New, 2 - Copy New, 3 - Edit)
		this.FAddressMask.LastTabKey = 0
		this.searchactive = .F.  && Initializing Property "Searchactive" (.F. Off, .T. On)
		
		SELECT Address
		SET Order to TAG1
		
		IF thisformset.AddressStart == "EDIT" OR thisformset.AddressStart == "EDITR"
			l_lFound = .F.
			IF this.lodbc
				this.selectedtable = 'addr1'
				this.searchactive = .T.
				this.finishsearch = .F.
				this.setaddressgridsource()
				ZAP IN addr1
				this.setaddressgridsource(this.SelectedTable)
				IF EMPTY(thisformset.AddressText)
					IF NOT EMPTY(naddrid)
						thisformset.AddressText = naddrid
					ENDIF
				ENDIF
				IF EMPTY(addtagno)
					addtagno = 1
				ENDIF
				this.opgde.addressgetdatabyvalue(thisformset.AddressText, -addtagno)
				this.opgde.addressgetdatareset()
				this.finishsearch = this.opgde.addressgetdatabyvalue(thisformset.AddressText, addtagno)
				IF naddrid > 0
					l_lFound = dlocate(this.selectedtable,"ad_addrid = " + TRANSFORM(naddrid))
					*l_lFound = SEEK(naddrid,"address","tag1")
				ELSE
					GO TOP IN (this.selectedtable)
				ENDIF
				IF NOT l_lFound
					alert(GetLangText("WALKIN","TXT_ADRNOTFOUND"))
					SEEK(thisformset.fAddressMask.oProcAddress.nAddressUnknownID)
					IF !FOUND()
						thisformset.fAddressMask.oProcAddress.AddressInsertUnknown()
					ENDIF
				ENDIF
				this.SelectAddress()
			ELSE
				IF NOT EMPTY(naddrid)
					l_lFound = SEEK(naddrid)
				ENDIF
				IF NOT l_lFound
					alert(GetLangText("WALKIN","TXT_ADRNOTFOUND"))
					SEEK(thisformset.fAddressMask.oProcAddress.nAddressUnknownID)
					IF !FOUND()
						thisformset.fAddressMask.oProcAddress.AddressInsertUnknown()
					ENDIF
				ENDIF
				IF rn>0 .and. rn<=reccount()
					GO rn
				ENDIF
			ENDIF
		ENDIF
		
		SELECT address
		SCATTER Name thisformset.DataCopy Memo
		SELECT adrprvcy
		=SEEK(thisformset.DataCopy.ad_addrid, "adrprvcy", "tag2")
		SCATTER NAME thisformset.DataCopyPp MEMO
		
		IF this.lfirststart
			this.closeselectform = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.Enabled = paRights(104)
			this.fAddressMask.mainPage.pageAddress.slavePage.pageRevnue.Enabled = paRights(103)
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Visible = parights(133) AND _SCREEN.KT
		
			this.FAddressMask.Caption = GetLangText("ADDRESS","TXT_BRWADDR")
			childtitle(this.FAddressMask.Caption)
			this.AddressSearchDialog.chapartner.Caption = GetLangText("ADDRESS","T_SEARCHINAPARTNER")
			this.AddressSearchDialog.chexactsearch.Caption = GetLangText("ADDRESS","TXT_EXACT_SEARCH")
		
			IF NOT _screen.OL
				this.ldocumentsemail = .F.
				this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.btnMail.Visible = .T.
				this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
				this.fAddressMask.mainPage.pageAddress.slavePage.pageApartner.btnMail.Visible = .T.
				this.fAddressMask.mainPage.pageAddress.slavePage.pageApartner.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
				this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.btnMail.Visible = .F.
				this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.btnReply.Visible = .F.
			ENDIF
			IF NOT this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.btnMail.Visible
				this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Email.Width = this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Fax.Width
				this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Email.w = this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Fax.w
			ENDIF
			LOCAL _l
			WITH this.FAddressMask.MainPage.PageAddress
				.txtAd_Addrid.Value = EVL(this.DataCopy.ad_addrid,"N/A")
				.txtAd_Adid.Value = EVL(this.DataCopy.ad_adid,"N/A")
				.txtAd_Company.ControlSource = [thisformset.DataCopy.Ad_Company]
				.txtAd_Departm.ControlSource = [thisformset.DataCopy.Ad_Departm]
				.txtAd_Lname.ControlSource = [thisformset.DataCopy.Ad_Lname]
				.txtAD_Lang.ControlSource = [thisformset.DataCopy.AD_Lang]
				SELECT pl_charcod, pl_lang1, pl_lang2, pl_lang3, pl_lang4, pl_lang5, ;
					pl_lang6, pl_lang7, pl_lang8, pl_lang9, pl_lang10, pl_lang11 ;
					FROM picklist INNER JOIN title ON pl_charcod = title.ti_lang ;
					WHERE pl_label = "LANGUAGE" GROUP BY pl_charcod ;
					INTO CURSOR lang_picklist
				.txtAD_Lang.RowSource = "lang_picklist.pl_charcod, pl_lang"+ALLTRIM(g_langnum)
				.txtAd_Compnum.ControlSource = [thisformset.DataCopy.Ad_Compnum]
				.txtAd_Salute.ControlSource = [thisformset.DataCopy.Ad_Salute]
				.txtAd_Street.ControlSource = [thisformset.DataCopy.AD_STREET]
				.txtAd_Street2.ControlSource = [thisformset.DataCopy.Ad_Street2]
				.txtAd_State.ControlSource = [thisformset.DataCopy.Ad_State]
				.txtAd_City.ControlSource = [thisformset.DataCopy.Ad_City]
				.InfoPage.pagCommunication.txtAd_Phone.ControlSource = [thisformset.DataCopy.Ad_Phone]
				.InfoPage.pagCommunication.txtAd_Phone2.ControlSource = [thisformset.DataCopy.Ad_Phone2]
				.InfoPage.pagCommunication.txtAd_Phone3.ControlSource = [thisformset.DataCopy.Ad_Phone3]
				.InfoPage.pagCommunication.txtAd_Fax.ControlSource = [thisformset.DataCopy.Ad_Fax]
				.InfoPage.pagCommunication.txtAd_Email.ControlSource = [thisformset.DataCopy.Ad_Email]
				.InfoPage.pagCommunication.txtAd_website.ControlSource = [thisformset.DataCopy.Ad_website]
				.InfoPage.pagCommunication.txtad_ustidnr.ControlSource = [thisformset.DataCopy.ad_ustidnr]
				.InfoPage.pagCommunication.chkad_novat.ControlSource = [thisformset.DataCopy.ad_novat]
				.InfoPage.pagCommunication.chkad_save.ControlSource = [thisformset.DataCopy.ad_save]
				
				* Mailing code combos
				 TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
					SELECT pl_charcod, pl_lang<<ALLTRIM(g_langnum)>> AS pl_lang ;
						FROM picklist ;
						WHERE pl_label = 'MAILING   ' ;
					UNION ;
					SELECT CAST('' AS Char(3)) AS pl_charcod, CAST('' AS Char(25)) AS pl_lang ;
						FROM param ;
					ORDER BY 1
				 ENDTEXT
				 = sqlcursor(l_cSql,"curmailing8",.F.,"",.NULL.,.T.)
				_l = "curmailing8.pl_charcod, pl_lang"
				.InfoPage.pagCommunication.txtAd_Mail1.ControlSource = [thisformset.DataCopy.Ad_Mail1]
				.InfoPage.pagCommunication.txtAd_Mail1.rowsource = _l
				.InfoPage.pagCommunication.txtAd_Mail2.ControlSource = [thisformset.DataCopy.Ad_Mail2]
				.InfoPage.pagCommunication.txtAd_Mail2.rowsource = _l
				.InfoPage.pagCommunication.txtAd_Mail3.ControlSource = [thisformset.DataCopy.Ad_Mail3]
				.InfoPage.pagCommunication.txtAd_Mail3.rowsource = _l
				.InfoPage.pagCommunication.txtAd_Mail4.ControlSource = [thisformset.DataCopy.Ad_Mail4]
				.InfoPage.pagCommunication.txtAd_Mail4.rowsource = _l
				.InfoPage.pagCommunication.txtAd_Mail5.ControlSource = [thisformset.DataCopy.Ad_Mail5]
				.InfoPage.pagCommunication.txtAd_Mail5.rowsource = _l
		
				.txtAd_Fname.ControlSource = [thisformset.DataCopy.Ad_Fname]
				.InfoPage.pagGuestInfo.txtAd_Billins.ControlSource = [thisformset.DataCopy.Ad_Billins]
				.InfoPage.pagGuestInfo.dtxtAd_Birth.ControlSource = [thisformset.DataCopy.Ad_Birth]
				.InfoPage.pagGuestInfo.txtAd_Member.ControlSource = [thisformset.DataCopy.Ad_Member]
				.InfoPage.pagGuestInfo.txtAd_webpass.ControlSource = [thisformset.DataCopy.Ad_webpass]
				.InfoPage.pagGuestInfo.txtAd_Member.InputMask = REPLICATE("9",10)
				.InfoPage.pagGuestInfo.dtxtAd_Memdat.ControlSource = [thisformset.DataCopy.Ad_Memdat]
				.txtAd_Compkey.ControlSource = [thisformset.DataCopy.Ad_Compkey]
				.txtAd_Zip.ControlSource = [thisformset.DataCopy.Ad_Zip]
				.txtAd_Country.ControlSource = [thisformset.DataCopy.Ad_Country]
				_l = "picklist.pl_charcod, pl_lang"+ALLTRIM(g_langnum)
				.txtAd_Country.rowsource = _l
				STORE _screen.BMS TO .InfoPage.pagGuestInfo.lblCollectedPoints.Visible, .InfoPage.pagGuestInfo.txtCollectedPoints.Visible, ;
					.InfoPage.pagGuestInfo.lblTotalPoints.Visible, .InfoPage.pagGuestInfo.txtTotalPoints.Visible, ;
					.InfoPage.pagGuestInfo.lblbmsaccount.Visible, .InfoPage.pagGuestInfo.txtbmsaccount.Visible
		
				* Feature code multiselect list
				thisformset.fAddressMask.oProcAddress.AddressSetFeatures(thisformset.DataCopy.ad_addrid, .InfoPage.pagGuestInfo.stxtFeature.curSelect, .T.)
				.InfoPage.pagGuestInfo.stxtFeature.RefreshValue()
				.chkAd_Vip.ControlSource = [thisformset.DataCopy.Ad_Vip]
				.chkAd_Vip2.ControlSource = [thisformset.DataCopy.Ad_Vip2]
				.InfoPage.pagGuestInfo.ChkNomail.ControlSource = [thisformset.DataCopy.Ad_nomail]
		
				.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
				.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.SetControlSource()
		
				.SlavePage.PageNote.Edit1.ControlSource  = [thisformset.DataCopy.ad_note]
				.SlavePage.PageNote.txtAd_Created.ControlSource = [thisformset.DataCopy.Ad_Created]
				.SlavePage.PageNote.txtAd_Updated.ControlSource = [thisformset.DataCopy.Ad_Updated]
				.SlavePage.PageNote.txtAd_Userid.ControlSource = [thisformset.DataCopy.Ad_Userid]
				.ocbotitle.ControlSource  = [thisformset.DataCopy.ad_titlcod]
				STORE ;
					"SELECT pl_lang" + g_langnum + " , pl_charcod " + ;
					"FROM picklist " + ;
					"WHERE pl_label = " + sqlcnv("ADRTYPE",.T.) + " " + ;
					"UNION " + ;
					"SELECT '" + SPACE(25) + "' AS pl_lang" + g_langnum + " , '   ' AS pl_charcod " + ;
					"FROM param " + ;
					"WHERE " + sqlcnv(.T.,.T.) + " " + ;
					"ORDER BY 2" ;
					TO .cboadrtype.jsql
				.cboadrtype.jboundcolumn = 2
				.cboadrtype.jcolumncount = 2
				.cboadrtype.jcolumnwidths = "150,40"
				.cboadrtype.ControlSource  = [thisformset.DataCopy.ad_adrtype]
				.cboadrtype.Init()
				.ad_vipstat.ControlSource = [thisformset.DataCopy.ad_vipstat]
				.txtad_title.ControlSource  = [thisformset.DataCopy.Ad_title]
				.txtti_attn.ControlSource = [thisformset.DataCopy.ad_attn]
				.InfoPage.pagGuestInfo.txtAd_Ratecod.ControlSource = [thisformset.DataCopy.Ad_Ratecod]
				_l = "ratecode.rc_ratecod, rc_lang"+ ALLTRIM(g_langnum)+", rc_fromdat, rc_todat, rc_amnt1"
				.InfoPage.pagGuestInfo.txtAd_Ratecod.rowsource = _l
				.InfoPage.pagGuestInfo.cboroomname.ccontrolsource = [thisformset.DataCopy.ad_roomnum]
				.InfoPage.pagGuestInfo.Refresh()
			ENDWITH
		
			SELECT AddressTAlias
		
			this.cYes = GetLangText("COMMON","TXT_YES")
			this.cNo = GetLangText("COMMON","TXT_NO")
		
			WITH this.FAddressMask.MainPage.PageAddress
				.lblAd_Addrid.Caption = GetLangText("ADDRESS","T_ADDRESSID")
				.lblAd_Adid.Caption = "Server ID"
				.lblAd_Company.Caption = GetLangText("ADDRESS","TXT_COMPANY")
				.lblAd_Departm.Caption = GetLangText("ADDRESS","TXT_DEPARTM")
				.lblName.Caption = GetLangText("ADDRESS","TXT_LNAME")
				.lbAD_Lang.Caption = GetLangText("ADDRESS","T_LANGCOD")
				.lblAd_Compnum.Caption = GetLangText("ADDRESS","T_KEYNR")
				.lblAd_Salute.Caption = GetLangText("ADDRESS","TXT_SALUTE")
				.lblAd_Street.Caption = GetLangText("ADDRESS","TXT_STREET") + " 1"
				.lblAd_Street2.Caption = GetLangText("ADDRESS","TXT_STREET") + " 2"
				.lblAd_State.Caption = GetLangText("ADDRESS","TXT_STATE")
				.lblAd_City.Caption = GetLangText("ADDRESS","T_COUNTCITYZIP")
				.lblAd_adrtype.Caption = GetLangText("ADDRESS","TXT_ADDRESS_TYPE")
				.lblAd_vipstat.Caption = GetLangText("ADDRESS","TXT_VIP_STATUS")
				.chkAd_Vip2.Caption = GetLangText("ADDRESS","TXT_VIP_2")
		
				.InfoPage.pagCommunication.Caption = GetLangText("ADDRESS","TXT_ADDRCOMM")
				.InfoPage.pagGuestInfo.Caption = GetLangText("ADDRESS","TXT_GUESTINFO")
				.InfoPage.pagCommunication.lblAd_Phone.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
				.InfoPage.pagCommunication.lblAd_Phone2.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2/3"
				.InfoPage.pagCommunication.lblAd_Fax.Caption = GetLangText("ADDRESS","TXT_FAX")
				.InfoPage.pagCommunication.lblAd_Email.Caption = GetLangText("ADDRESS","TXT_EMAIL")
				.InfoPage.pagCommunication.lblAd_website.Caption = GetLangText("ADDRESS","T_WEB")
				.InfoPage.pagCommunication.lblAd_ustidnr.Caption = GetLangText("ADDRESS","TXT_FORIGN_VAT_NR")
				.InfoPage.pagCommunication.chkad_novat.Caption = GetLangText("ADDRESS","TXT_NO_VAT")
				.InfoPage.pagCommunication.chkad_save.Caption = GetLangText("ADDRESS","TXT_SAVEADDRESS")
				.InfoPage.pagCommunication.lblAd_Mail1.Caption = GetLangText("ADDRESS","TXT_MAILING")
				.InfoPage.pagGuestInfo.lblAd_Ratecod.Caption = GetLangText("RATES","TXT_RATECODE")
				.InfoPage.pagGuestInfo.lblAd_Feat1.Caption = GetLangText("ROOMFEAT","TW_FEATURE")
				.InfoPage.pagGuestInfo.lblAd_Member.Caption = GetLangText("ADDRESS","TXT_MEMBER")
				.InfoPage.pagGuestInfo.lblAd_webpass.Caption = "Web " + GetText("MGRSYS","TXT_USPASS")
				.InfoPage.pagGuestInfo.lblAd_Memdat.Caption = GetLangText("ADDRESS","TXT_MEMDAT")
				.InfoPage.pagGuestInfo.lblCollectedPoints.Caption = GetLangText("ARTICLE","TXT_COLLECTED_POINTS")
				.InfoPage.pagGuestInfo.lblTotalPoints.Caption = GetLangText("ARTICLE","TXT_TOTAL_POINTS")
				.InfoPage.pagGuestInfo.lblbmsaccount.Caption = GetLangText("MGRFINAN","TXT_BMS_ACCOUNT_NO")
				.lblAd_Fname.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
				.lbAD_titcod.Caption = GetLangText("ADDRESS","TXT_ATTITLE")
				.InfoPage.pagGuestInfo.lblAd_Billins.Caption = GetLangText("ADDRESS","TXT_BILLINS")
				.InfoPage.pagGuestInfo.lblAd_Birth.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
			*	.lblAd_Userid.Caption = GetLangText("ACT","T_USER")
				.lbAD_Compkey.Caption = GetLangText("ADDRESS","TXT_KEYSEARCH")
				.InfoPage.pagGuestInfo.ChkNomail.Caption = GetLangText("ADDRESS","TXT_NOMAIL")
				.InfoPage.pagGuestInfo.lblWishRoom.Caption = GetLangText("ADDRESS","T_WISHROOMNUM")
			ENDWITH
		
			* Initializing User 1-10 Fields in "Free Page"
			LOCAL l_cPaFld, l_cUsrLbl, l_cUsrChk, l_cUsrChk1, l_cUsrTxt
			LTop = 238
			FOR i = 1 TO 10
				l_cPaFld = "pa_user" + TRANSFORM(i)
				l_cUsrLbl = "LFree" + TRANSFORM(i)
				l_cUsrChk = "tcheckbox" + TRANSFORM(i)
				l_cUsrTxt = "freeText" + TRANSFORM(i)
				l_cUsrLbl1 = "LUsr" + TRANSFORM(i)
				l_cUsrChk1 = "Tcheckbox" + TRANSFORM(i)
				l_cUsrChk11 = "tcheckbox" + TRANSFORM(10+i)
				l_cUsrTxt1 = "txtAd_usr" + TRANSFORM(i)
				STORE EVL(ParamTAlias.&l_cPaFld, "") TO this.AddressSearchDialog.&l_cUsrLbl1..Caption, ;
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrLbl..Caption
				DO CASE
					*** Set Textboxes or Checkboxes in FreePage
					CASE EMPTY(ParamTAlias.&l_cPaFld)
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrTxt..Visible = .F.
						this.AddressSearchDialog.&l_cUsrTxt1..Visible = .F.
					CASE SUBSTR(param.pa_setusad,i,1) = "C"
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrChk..Visible = .T.
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrTxt..Visible = .F.
						this.AddressSearchDialog.&l_cUsrChk1..Visible = .T.
						this.AddressSearchDialog.&l_cUsrChk11..Visible = .T.
						this.AddressSearchDialog.&l_cUsrTxt1..Visible = .F.
						this.AddressSearchDialog.&l_cUsrChk1..Value = .F.
						this.AddressSearchDialog.&l_cUsrChk1..Top = LTop
						this.AddressSearchDialog.&l_cUsrChk11..Top = LTop
						this.AddressSearchDialog.&l_cUsrLbl1..Top = LTop+4
						LTop = LTop + 21
					OTHERWISE
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrTxt..Visible = .T.
						this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.&l_cUsrTxt..ControlSource  = [thisformset.DataCopy.ad_usr] + TRANSFORM(i)
						this.AddressSearchDialog.&l_cUsrTxt1..Visible = .T.
						this.AddressSearchDialog.&l_cUsrTxt1..InputMask = REPLICATE("X", 100)
						this.AddressSearchDialog.&l_cUsrTxt1..Value = ""
						this.AddressSearchDialog.&l_cUsrTxt1..Top = LTop
						this.AddressSearchDialog.&l_cUsrLbl1..Top = LTop+4
						LTop = LTop + 21
				ENDCASE
			NEXT
		
			IF this.p_UserFieldsForAccountInfo
				openfile(.F.,"banken")
				this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.tcbCallBankForm.Visible = .T.
				this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8.InputMask = "99999999"
			ENDIF
		
			WITH this.AddressSearchDialog
				IF !(LTop = 159)
					LTop = LTop + 5
				ENDIF
				.TSearchAll.top = LTop
				.LSearchAll.top = LTop
				.chapartner.top=ltop+25
				.chexactsearch.top = ltop+25
				.chexactsearch.Value = 1
				.chkmainserver.top = .chapartner.top + 20
				.Shape1.height = LTop + 48 + 20
				.height = LTop + 51 + 20
		
				.TAd_company.InputMask = REPLICATE("X", 50)
				.TAd_compkey.InputMask = REPLICATE("X", 15)
				.TAd_compnum.InputMask = REPLICATE("9", 10)
				.TAd_lname.InputMask = REPLICATE("X", 30)
				.TAd_fname.InputMask = REPLICATE("X", 20)
				.TAd_city.InputMask = REPLICATE("X", 30)
				.TAd_member.InputMask = REPLICATE("9", 10)
				.TAd_addrid.InputMask = REPLICATE("9", 8)
				.TAd_compnum.value = 0
				.TSearchAll.InputMask = REPLICATE("X", 40)
		
				.LFirma.Caption = GetLangText("ADDRESS","TXT_COMPANY")
				.LSuchname.Caption = GetLangText("ADDRESS","TXT_KEYSEARCH")
				.LSuchnummer.Caption = GetLangText("ADDRESS","T_KEYNR")
				.LName.Caption = GetLangText("ADDRESS","TXT_LNAME")
				.FName.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
				.LOrt.Caption = GetLangText("ADDRESS","TXT_CITY")
				.LMemberNumber.Caption = GetLangText("ADDRESS","TXT_MEMBER")
				.CSearch.Caption = GetLangText("COMMON","TXT_OK")
				.CCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
				.LSearchAll.Caption = GetLangText("ADDRESS","T_SEARCHALL")
				.LAddressType.Caption = GetLangText("ADDRESS","TXT_ADDRESS_TYPE")
				.LEmail.Caption = GetLangText("ADDRESS","TXT_EMAIL")
				.LPhone.Caption = GetLangText("ADDRESS","TXT_PHONE")
				.LAddrid.Caption = GetLangText("ADDRESS","T_ADDRESSID")
		
				STORE ;
					"SELECT pl_lang" + g_langnum + ", pl_charcod FROM picklist " + ;
					"WHERE pl_label = 'ADRTYPE   ' " + ;
					"UNION SELECT '" + SPACE(25) + "' AS pl_lang" + g_langnum + " , '   ' AS pl_charcod FROM param " + ;
					"ORDER BY 2" ;
					TO .TAd_adrtype.jsql
				.TAd_adrtype.Init()
		
				.TAd_company.value = ""
				.TAd_compkey.value = ""
				.TAd_compnum.value = 0
				.TAd_lname.value = ""
				.TAd_fname.value = ""
				.TAd_city.value = ""
				.TAd_member.value = 0
				.TAd_addrid.value = 0
				.TAd_adrtype.value = ""
				.TAd_email.value = ""
				.TPhone.value = ""
				.TSearchAll.value = ""
		
			ENDWITH
		
			WITH this.SelectForm.MCodeGrid
				.RecordSource = ""
				.Column1.ControlSource = ""
				.Column2.ControlSource = ""
			ENDWITH
		ELSE
			WITH this.AddressSearchDialog
				.TAd_company.value = ""
				.TAd_compkey.value = ""
				.TAd_compnum.value = 0
				.TAd_lname.value = ""
				.TAd_fname.value = ""
				.TAd_city.value = ""
				.TAd_member.value = 0
				.TAd_addrid.value = 0
				.TAd_adrtype.value = ""
				.TAd_email.value = ""
				.TPhone.value = ""
				.txtAd_usr1.value = ""
				.txtAd_usr2.value = ""
				.txtAd_usr3.value = ""
				.txtAd_usr4.value = ""
				.txtAd_usr5.value = ""
				.txtAd_usr6.value = ""
				.txtAd_usr7.value = ""
				.txtAd_usr8.value = ""
				.txtAd_usr9.value = ""
				.txtAd_usr10.value = ""
				.TSearchAll.value = ""
				.chexactsearch.Value = 1
			ENDWITH
		ENDIF
		
		SELECT ApartnerTAlias
		SCATTER Name this.ChangeApartnerDialog.DataCopy Memo
		
		IF this.lfirststart
			WITH this.ChangeApartnerDialog
				.Tap_apid.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_apid]
				.TAp_Title.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.Ap_title]
				.TAp_Fname.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_fname]
				.TAp_Lname.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_lname]
				.TAp_Phone1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_phone1]
				.TAp_Phone2.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_phone2]
				.TAp_Fax.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_fax]
				.TAp_Email.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_email]
				.CAp_Vip1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_vip1]
				.TAp_Gebdate.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_gebdate]
				.TAp_User1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user1]
				.TAp_User2.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user2]
				.TAp_User3.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user3]
				.Combo1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_titlcod]
				.TAp_Salute.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_salute]
		
		
				.Lap_apid.Caption = GetLangText("ADDRESS","T_APARTNERID")
				.LAp_Title.Caption = GetLangText("ADDRESS","T_APARTNERTITCOD")
				.LAp_Fname.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
				.LAp_Lname.Caption = GetLangText("ADDRESS","TXT_LNAME")
				.LAp_Phone1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
				.LAp_Phone2.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2"
				.LAp_Fax.Caption = GetLangText("ADDRESS","TXT_FAX")
				.LAp_Email.Caption = GetLangText("ADDRESS","TXT_EMAIL")
				.LAp_Vip1.Caption = GetLangText("WALKIN","T_VIP")
				.LAp_Gebdate.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
				.LAp_User1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 1"
				.LAp_User2.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 2"
				.LAp_User3.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 3"
				.LAp_Salute.Caption = GetLangText("ADDRESS","TXT_SALUTE")
		
		
				.COk.Caption = GetLangText("COMMON","TXT_OK")
				.CCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
				.CUndo.Caption = GetLangText("ADDRESS","T_UNDO")
			ENDWITH
		
			WITH this.FAddressMask
				.MainPage.PageAddress.Caption = GetLangText("ADDRESS","PT_ADDRESSNAME")
				.MainPage.PageGridAddress.Caption = GetLangText("ADDRESS","PT_ADDRESSBROWSE")
				.MainPage.PageAddress.InfoPage.pagCommunication.btnBrowse.ToolTipText = GetLangText("ADDRESS","TT_BWEBADDRESS")
			ENDWITH
		
			WITH this.FAddressMask.MainPage.PageAddress.SlavePage
				.PageApartner.Caption = GetLangText("ADDRESS","PT_APARTNERNAME")
				.PageApartner.ToolTipText = GetLangText("ADDRESS","TT_PAPARTNER")
				.PageApartner.cmdNewAPart.ToolTipText =  GetLangText("ADDRESS","TT_BNEWAPARTNER")
				.PageApartner.cmdDelPart.ToolTipText =  GetLangText("ADDRESS","TT_BDELAPARTNER")
				.PageApartner.CUpdateApartner.ToolTipText =  GetLangText("ADDRESS","TT_BEDITAPARTNER")
				.PageApartner.cmdNewAPart.Caption = .PageApartner.cmdNewAPart.ToolTipText
				.PageApartner.cmdDelPart.Caption = .PageApartner.cmdDelPart.ToolTipText
				.PageApartner.CUpdateApartner.Caption = .PageApartner.CUpdateApartner.ToolTipText
				.PageNote.Caption = GetLangText("ADDRESS","PT_NOTENAME")
				.PageNote.ToolTipText = GetLangText("ADDRESS","TT_PNOTE")
				.PageNote.lblAd_Created.Caption = GetLangText("RESERVAT","T_CREATED")
				.PageNote.lblAd_Updated.Caption = GetLangText("RESERVAT","T_CHANGED")
				.PageDokument.Caption = GetLangText("ADDRESS","PT_DOCUMENTNAME")
				.PageDokument.ToolTipText = GetLangText("ADDRESS","TT_PDOCUMENT")
				.PageDokument.BDokEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITDOCUMENT")
				.PageDokument.BDokNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWDOCUMENT")
				.PageDokument.BDokDel.ToolTipText = GetLangText("ADDRESS","TT_BDELDOCUMENT")
				.PageDokument.TcPhoneNote.ToolTipText = GetLangText("ADDRESS","TXT_NEW_PHONE_NOTE")
				.PageDokument.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
				.PageDokument.btnMail.Enabled = parights(135)
				.pageDokument.btnReply.ToolTipText = GetLangText("ADDRESS","TT_BMAILREPLY")
				.pageDokument.BtnNewExternalDocument.ToolTipText = GetLangText("ADDRESS","TT_BNEW_EXTERNAL_DOCUMENT")
				.PageDokument.tcChange.ToolTipText = GetLangText("ADDRESS","TXT_CHOOSE_DOCUMENT_TYPE")
				.pageDokument.BDokEdit.Caption = .pageDokument.BDokEdit.ToolTipText
				.pageDokument.BDokNew.Caption = .pageDokument.BDokNew.ToolTipText
				.pageDokument.BDokDel.Caption = .pageDokument.BDokDel.ToolTipText
				.pageDokument.TcPhoneNote.Caption = .pageDokument.TcPhoneNote.ToolTipText
				.pageDokument.btnMail.Caption = .pageDokument.btnMail.ToolTipText
				.pageDokument.btnReply.Caption = .pageDokument.btnReply.ToolTipText
				.pageDokument.BtnNewExternalDocument.Caption = .pageDokument.BtnNewExternalDocument.ToolTipText
				.pageDokument.tcChange.Caption = .pageDokument.tcChange.ToolTipText
				.PageRevnue.Caption = GetLangText("ADDRESS","PT_HISTORYNAME")
				.PageRevnue.ToolTipText = GetLangText("ADDRESS","TT_PHISTORY")
				.PageRevnue.AddProperty("cHrFilter",".T.")
				.pagerevnue.BHistPrint.Enabled = parights(131)
				.pagerevnue.BHistPrint.ToolTipText = GetLangText("ADDRESS","TT_PRINT_HISTORY")
				.pagerevnue.cmdShowReservation.ToolTipText = GetLangText("ADDRESS","TT_SHOW_RESERVATION")
				.pagerevnue.cmdCopyReservation.ToolTipText = GetLangText("ADDRESS","TT_COPY_RESERVATION")
				.pagerevnue.cmdSearchReservation.ToolTipText = GetLangText("ADDRESS","TT_SEARCH_RESERVATION")
				.pagerevnue.cmdBillPreview.ToolTipText = GetLangText("ADDRESS","TT_BILL_PREVIEW")
				.pagerevnue.BHistPrint.Caption = .pagerevnue.BHistPrint.ToolTipText
				.pagerevnue.cmdShowReservation.Caption = .pagerevnue.cmdShowReservation.ToolTipText
				.pagerevnue.cmdCopyReservation.Caption = .pagerevnue.cmdCopyReservation.ToolTipText
				.pagerevnue.cmdSearchReservation.Caption = .pagerevnue.cmdSearchReservation.ToolTipText
				.pagerevnue.cmdBillPreview.Caption = .pagerevnue.cmdBillPreview.ToolTipText
				.PageHistory.Caption = GetLangText("ADDRESS","PT_REVNUENAME")
				.PageHistory.ToolTipText = GetLangText("ADDRESS","TT_PREVNUE")
				.PageFuture.Caption = GetLangText("ADDRESS","PT_FUTURENAME")
				.PageFuture.ToolTipText = GetLangText("ADDRESS","TT_PFUTURE")
				.PageFuture.BFutEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITRESERVATION")
				.PageFuture.BFutNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWRESERVATION")
				.PageFuture.BFutDel.ToolTipText = GetLangText("ADDRESS","TT_BDELRESERVATION")
				.PageFuture.cmdFutAlt.ToolTipText = GetLangText("ADDRESS","TT_ALLOTMENT")
				.PageFuture.BFutEdit.Caption = .PageFuture.BFutEdit.ToolTipText
				.PageFuture.BFutNew.Caption = .PageFuture.BFutNew.ToolTipText
				.PageFuture.BFutDel.Caption = .PageFuture.BFutDel.ToolTipText
				.PageFuture.cmdFutAlt.Caption = .PageFuture.cmdFutAlt.ToolTipText
				.PageFree.Caption = GetLangText("ADDRESS","PT_INFO")
				.PageFree.ToolTipText = GetLangText("ADDRESS","TT_PINFO")
				.pageReferral.bRDelete.ToolTipText = GetLangText("ADDRESS","TT_BDELETEREFERRAL")
				.pageReferral.brEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITREFERRAL")
				.pageReferral.brNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWREFERRAL")
				.pageReferral.brGoto.ToolTipText = GetLangText("ADDRESS","TT_BGOTOREFERRAL")
				.pageReferral.cmdshowreferrals.ToolTipText = GetLangText("ADDRESS","TT_BSTRUCTREFERRAL")
				.pageReferral.Caption = GetLangText("ADDRESS","TXT_REFERRAL_PAGE")
				.pageReferral.ToolTipText = GetLangText("ADDRESS","TT_REFERRAL_PAGE")
				.pageReferral.Enabled = parights(129)
				.pageReferral.bRDelete.Caption = .pageReferral.bRDelete.ToolTipText
				.pageReferral.brEdit.Caption = .pageReferral.brEdit.ToolTipText
				.pageReferral.brNew.Caption = .pageReferral.brNew.ToolTipText
				.pageReferral.brGoto.Caption = .pageReferral.brGoto.ToolTipText
				.pageReferral.cmdshowreferrals.Caption = .pageReferral.cmdshowreferrals.ToolTipText
				.PageSales.Caption = GetLangText("ADDRESS","PT_SALES")
				.PageSales.ToolTipText = GetLangText("ADDRESS","TT_PSALES")
				.PageSales.Enabled = parights(134) AND _SCREEN.US
				.PagePrivacyPolicy.Caption = GetLangText("ADDRESS","PT_PRIVACY_POLICY")
				.PagePrivacyPolicy.ToolTipText = GetLangText("ADDRESS","TT_PRIVACY_POLICY")
				.PagePrivacyPolicy.Enabled = _SCREEN.GO
			ENDWITH
		ENDIF
		
		SELECT address
		this.AddressFieldsDisable()
		this.FAddressMask.alwaysontop=.f.
		
		DO CASE
		CASE thisformset.AddressStart == "EDITL" OR thisformset.AddressStart == "EDITC"
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BDokNew.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BtnNewExternalDocument.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokEdit.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokDel.Enabled = .F.
			*** Disable using of Referral Page, when called from Valids from "old" Fox forms
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
			this.p_disablereferral = (.T. AND NOT g_newversionactive) OR (NOT EMPTY(nmode) AND nmode == 16)
			***
			IF this.addresscall= "RSC" OR this.addresscall= "RSL" OR this.addresscall= "ARC" OR this.addresscall= "RSI"
					for i=1 to _screen.formcount
					IF _screen.forms(i).name != "FAddressMask" AND ;
						_screen.forms(i).name != "ChangeApartnerDialog" AND ;
						_screen.forms(i).name != "SelectForm" AND ;
						_screen.forms(i).name != "AddressSearchDialog" AND ;
						UPPER(_screen.forms(i).BaseClass)<>'TOOLBAR' AND ;
						_screen.forms(i).name != "Tform1"
						
						_screen.forms(i).enabled=.f.
				    endif
				NEXT
				this.screenformsdisabled = .T.
			*	this.killtoolbar = .T.
				this.FAddressMask.MinButton = .F.
				this.FAddressMask.mainPage.Tabs = .F.
				this.FAddressMask.Visible=.t.
				this.AddressNew()
			ELSE
				this.FAddressMask.MinButton = .F.
				this.FAddressMask.Visible=.t.
				this.AddressNew()
				this.FAddressMask.timer1.enabled=.t.
			ENDIF
		CASE thisformset.AddressStart == "EDITAKTION" OR thisformset.AddressStart == "EDITAR"
			IF EMPTY(naddrid)
				IF rn>0 .and. rn<=reccount()
					GO rn
				ENDIF
			ELSE
				= SEEK(naddrid, "address", "tag1")
			ENDIF
			SET ORDER TO addtagno
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			this.FAddressMask.MinButton = .F.
			this.FAddressMask.alwaysontop=.t.
			this.FAddressMask.Visible=.t.
			this.AddressEdit()
			this.FAddressMask.timer1.enabled=.t.
		CASE thisformset.AddressStart == "EDITQ"
		*	IF rn>0 .and. rn<=(reccount()+1)
		*		GO rn
		*	ENDIF
			SET ORDER TO addtagno
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BDokNew.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BtnNewExternalDocument.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokEdit.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokDel.Enabled = .F.
			*** Disable using of Referral Page, when called from Valids from "old" Fox forms
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
			this.p_disablereferral = .T. AND NOT g_newversionactive
			***
		*	this.FAddressMask.mainPage.Tabs = .F.
			this.FAddressMask.MinButton = .F.
			this.FAddressMask.alwaysontop=.t.
			this.FAddressMask.Visible=.t.
			this.AddressNew()
			this.FAddressMask.timer1.enabled=.t.
			
		CASE thisformset.AddressStart == "BRWC" .OR. thisformset.AddressStart=='BRWL'
			IF this.lodbc
				this.selectedtable = 'addr1'
				this.searchactive = .T.
				this.finishsearch = .F.
				this.setaddressgridsource()
				ZAP IN addr1
				this.setaddressgridsource(this.SelectedTable)
				this.opgde.addressgetdatabyvalue(thisformset.AddressText, -addtagno)
				this.opgde.addressgetdatareset()
				this.finishsearch = this.opgde.addressgetdatabyvalue(thisformset.AddressText, addtagno)
				IF naddrid > 0
					 = dlocate(this.selectedtable,"ad_addrid = " + TRANSFORM(naddrid))
					*=SEEK(naddrid,"address","tag1")
				ELSE
					IF NOT EMPTY(lp_nAdId)
						l_lWrite = .T.
						thisformset.fAddressMask.oProcAddress.AdrMainGetAddress(lp_nAdId, l_lWrite)
					ELSE
						GO TOP IN (this.selectedtable)
						*SET NEAR ON
						*=SEEK(thisformset.AddressText,"address")
					ENDIF
				ENDIF
			ELSE
				SELECT address
				SET order to tag addtagno
				IF rn > 0
					IF this.mode = 29
						this.searchaddresstablecustom(this.oParam.Item("PHONE_NUMBER"))
						thisformset.oParam.Remove("PHONE_NUMBER")
						thisformset.oParam.Add("","PHONE_NUMBER")
					ELSE
						GO rn
					ENDIF
				else
					IF NOT EMPTY(lp_nAdId)
						l_lWrite = .T.
						thisformset.fAddressMask.oProcAddress.AdrMainGetAddress(lp_nAdId, l_lWrite)
					ELSE
		
						SET near on
				*		SET order to tag addtagno
						SEEK(thisformset.AddressText)
					ENDIF
				ENDIF
			ENDIF
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
			this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
			*** Disable using of Referral Page, when called from Valids from "old" Fox forms
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
			this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
			this.p_disablereferral = .T. AND NOT g_newversionactive
			***
			IF this.addresscall= "RSC" OR this.addresscall= "RSL" OR this.addresscall= "ARC" OR this.addresscall= "RSI"
				for i=1 to _screen.formcount
					IF _screen.forms(i).name != "FAddressMask" AND ;
						_screen.forms(i).name != "ChangeApartnerDialog" AND ;
						_screen.forms(i).name != "SelectForm" AND ;
						_screen.forms(i).name != "AddressSearchDialog" AND ;
						UPPER(_screen.forms(i).BaseClass)<>'TOOLBAR' AND ;
						_screen.forms(i).name != "Tform1"
						
						_screen.forms(i).enabled=.f.
				    endif
				NEXT
				this.screenformsdisabled = .T.
			*	this.killtoolbar = .T.
			*	this.FAddressMask.timer1.enabled=.t.
				this.FAddressMask.MinButton = .F.
				this.FAddressMask.mainPage.Tabs = .F.
				this.FAddressMask.MainPage.activepage=2
				this.FAddressMask.Visible=.t.
			ELSE
				this.FAddressMask.MinButton = .F.
				this.FAddressMask.MainPage.activepage=2
				this.FAddressMask.Visible=.t.
				l_lMailingCodeCheck = thisformset.addresscall = "xx" AND ;
						INLIST(thisformset.mode, 3, 4) AND ;
						TYPE("thisformset.oReferenceToCallingObject.Parent.nCheckMailingCode")="N" AND ;
						INLIST(thisformset.oReferenceToCallingObject.Parent.nCheckMailingCode, 1, 2)
				IF l_lMailingCodeCheck
					this.FAddressMask.timer2.lMailingCodeCheck = .T.
				ENDIF
				this.FAddressMask.timer2.enabled=.t.
			ENDIF	
			
		CASE thisformset.AddressStart=='EDIT'
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			thisformset.tpypahd = .T.
			this.FAddressMask.Visible=.t.
			IF this.addresscall= "INHOUSE"
		*		this.FAddressMask.alwaysontop =.t.
				this.AddressEdit()
				this.FAddressMask.timer1.enabled=.t.		
			else
				this.FAddressMask.alwaysontop =.f.
				this.AddressEdit()
			endif
			*this.fAddressMask.mainPage.PageAddress.slavePage.ActivePage = 2
			*this.fAddressMask.mainPage.pageAddress.SetFocus()
		
		CASE thisformset.AddressStart=='EDITR'
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			thisformset.tpypahd = .T.
			this.FAddressMask.Visible=.t.
			this.FAddressMask.alwaysontop =.f.
			this.AddressEdit()
		CASE thisformset.AddressStart = "NORMAL"
			thisformset.tpypahd = .T.
			this.FAddressMask.alwaysontop=.f.
			this.firstsearch = .T.
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
		*	this.addressSearchDialog.tAd_company.SetFocus()
		CASE thisformset.AddressStart = "SELECT_ADDRESSES"
			this.AddressSearchDialog.visible = .F.
			this.AddressSearchDialog.caption = ""
			IF EMPTY(this.mode)
				this.mode = 24
			ENDIF
			DO CASE
				CASE this.mode = 24
					this.fAddressMask.Caption = getlangtext("COMMON","TXT_CHOOSE")
				CASE this.mode = 25
					this.fAddressMask.Caption = getlangtext("ADDRESS","TXT_REFERRALSEARCH")
			ENDCASE
			thisformset.tpypahd = .T.
			this.FAddressMask.alwaysontop=.f.
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = parights(109)
			this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
			*this.screenformsdisabled = .T.
			*this.FAddressMask.MinButton = .F.
			*this.FAddressMask.mainPage.Tabs = .F.
			this.FAddressMask.MainPage.activepage=2
			*this.FAddressMask.Visible=.T.
		ENDCASE
		
		*this.FAddressMask.LockScreen = .F.
		
		IF this.firstsearch
			this.addressSearchDialog.Show()
		ENDIF
	ENDPROC

	PROCEDURE mainexitpoint
		* Is called when mask is no more visible, and data shouldn't be displayed more for selected reservation (set)
		
		LOCAL l_oForm, i
		LOCAL ARRAY l_aUsedAliasesOnExit(1)
		*this.Release()
		
		FOR EACH l_oForm IN this.Forms
			IF l_oForm.Visible
				IF LOWER(l_oForm.Name) = "faddressmask"
					l_oForm.Destroy()
				ENDIF
				l_oForm.Visible = .F.
			ENDIF
		ENDFOR
		
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this.FAddressMask
				_screen.oCardReaderHandler.oHicHandler.oCr.oParent = .NULL.
			ENDIF
		ENDIF
		
		IF this.FaddressMask.lcloseonfinish
			this.Release()
		ELSE
			this.fAddressMask.Unload()
			this.Unload()
			IF this.lodbc
				this.opgde.AddressGetDataReset(.T.)
			ENDIF
			* Remove statistic cursor. So it will be created next time.
			IF PEMSTATUS(this.fAddressMask.mainPage.pageAddress.slavePage.pageHistory, "oRevenuePage", 5)
				this.fAddressMask.mainPage.pageAddress.slavePage.pageHistory.RemoveObject("oRevenuePage")
			ENDIF
			this.oReferenceToCallingObject = .NULL.
			this.mode = .F. && Prevent call of unload method, when realy relasing formset
			AUSED(l_aUsedAliasesOnExit)
		
			FOR i = 1 TO ALEN(l_aUsedAliasesOnExit,1)
				IF ASCAN(this.ausedaliases,l_aUsedAliasesOnExit(i,1)) = 0
					dclose(l_aUsedAliasesOnExit(i,1))
				ENDIF
			ENDFOR
			
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE maintablerevert
		LOCAL i, l_cAlias
		LOCAL ARRAY l_aUsedAliasesOnExit(1)
		
		AUSED(l_aUsedAliasesOnExit)
		
		FOR i = 1 TO ALEN(l_aUsedAliasesOnExit,1)
			l_cAlias = l_aUsedAliasesOnExit(i,1)
			IF CURSORGETPROP("Buffering",l_cAlias)=5
				DoTableRevert(.T.,l_cAlias)
			ENDIF
		ENDFOR
		
		RETURN .T.
	ENDPROC

	PROCEDURE makeformavailable
		*this.FAddressMask.contMakeFormUreachable.enabled = .F.
		*this.FAddressMask.contMakeFormUreachable.visible = .F.
		
	ENDPROC

	PROCEDURE makeformunreachable
		*this.FAddressMask.contMakeFormUreachable.enabled = .T.
		*this.FAddressMask.contMakeFormUreachable.visible = .T.
		*this.FAddressMask.contMakeFormUreachable.zorder()
		
	ENDPROC

	PROCEDURE m_adjustaddressstring
		LPARAMETERS p_cRecievedString, p_nAddrId
		LOCAL l_cText, l_nRecno
		l_nRecno = RECNO('address')
		= SEEK(p_nAddrId, 'address', 'tag1')
		
		l_cText = ALLTRIM(p_cRecievedString) + CHR(10) + ALLTRIM(address.ad_street)  + CHR(10) + ;
			ALLTRIM(address.ad_zip) + " " + ALLTRIM(address.ad_city)
		
		GO l_nRecno IN address
		RETURN l_cText
	ENDPROC

	PROCEDURE m_cancel_state_for_new_referral		&& When user canceled adding of new address for new referral
		IF LOWER(thisformset.fAddressMask.cformlabel) = "searchadr"
			RETURN .T.
		ENDIF
		if thisformset.searchactive
			select (this.selectedtable)
			INDEX ON ad_addrid TAG TAG1
			SET ORDER TO TAG1
			IF !SEEK(thisformset.p_referralparams(2))
				this.searchactive = .F.
				this.selectedtable='address'
				this.SetAddressGridSource('address')
				IF !EMPTY(thisformset.p_referralparams(3))
					SET ORDER TO thisformset.p_referralparams(3) IN address
				ENDIF
			ENDIF
			SET ORDER TO 
		else
			select Address
		endif
		IF SEEK(thisformset.p_referralparams(2),this.selectedtable,'TAG1')
			this.SelectAddress()
		ENDIF
		SELECT tgridreferralcursor
		GOTO BOTTOM
		thisformset.p_referralparams(1) = .F.
		thisformset.p_referralparams(2) = 0
		thisformset.p_referralparams(3) = ""
		thisformset.p_referralparams(4) = 0
		
		thisformset.FAddressMask.Caption = GetLangText("ADDRESS","TXT_BRWADDR")
		thisformset.FAddressMask.MainPage.pageAddress.Enabled = .t.
		thisformset.FAddressMask.MainPage.activepage=1
		thisformset.FAddressMask.Activate()
		thisformset.FAddressMask.MainPage.pageAddress.slavePage.ActivePage=8
		thisformset.refreshaddressgrid()
		*thisformset.addressprevious()
		*thisformset.addressnext()
		thisformset.FAddressMask.MainPage.pageAddress.slavePage.pageReferral.tgridReferral.SetFocus()
		RETURN .T.
		
	ENDPROC

	PROCEDURE m_connectreferraltoreservation
		LPARAMETERS pl_nAddrId, pl_cType
		* pl_nAddrId: address.ad_addrid
		* pl_cType: "XC" - Company, "XI" - Invoice
		* Returns ad_addrid, or 0, when no Address is found
		
		LOCAL l_nAddrId
		l_nAddrId = 0
		CursorQuery("referral", "re_from = " + SqlCnv(pl_nAddrId,.T.))
		= SEEK(PADR(pl_nAddrId,8)+"XB",'referral','tag4') && XB is same as XC AND XI
		IF NOT FOUND('referral')
			= SEEK(PADR(pl_nAddrId,8)+pl_cType,'referral','tag4')
		ENDIF
		IF FOUND('referral')
			l_nAddrId = referral.re_to
		ENDIF
		
		RETURN l_nAddrId
	ENDPROC

	PROCEDURE m_documentchoose		&& Calls Form for creating new document, or to choose which type of document to see in Document Grid
		LPARAMETERS LMode
		DO CASE
		CASE LMode = "NEW"
			this.newDocument.Caption = GetLangText("DOC","T_DOC")
			this.newDocument.Tag = "NEW"
			this.newDocument.toDocumentType.optionAll.Visible = .F.
			this.newDocument.toDocumentType.Value = 2
		CASE LMode = "SELECT"
			this.newDocument.Caption = GetLangText("DOC","TXT_FILTER_DOCUMENTS")
			this.newDocument.Tag = "SELECT"
			this.newDocument.toDocumentType.optionAll.Visible = .T.
		ENDCASE
		this.newDocument.ZOrder()
		this.newDocument.Visible = .T.
		RETURN .T.
		
	ENDPROC

	PROCEDURE m_documentgettypetext
		LPARAMETERS l_cDocumentType
		LOCAL l_cText
		DO GetDocumentType IN procaddress WITH l_cDocumentType, l_cText
		
		RETURN l_cText
	ENDPROC

	PROCEDURE m_editreferral		&& Calls Form for editing one record in referral.dbf
		LPARAMETERS LMode, lp_oCol
		LOCAL LGuestOK, LCompanyOK
		IF EMPTY(LMode)
			LMode = "EDIT"
		ENDIF
		thisformset.faddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral.SetFocus()
		IF SEEK(tgridreferralcursor.re_id,'referral1','tag1')
			thisformset.referralForm.p_fromcompany = IIF(SEEK(referral1.re_from,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname))
			LGuestOK = EMPTY(address3.ad_company)
			thisformset.referralForm.p_tocompany = IIF(SEEK(referral1.re_to,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname))
			LCompanyOK = !EMPTY(address3.ad_company)
			thisformset.referralForm.Caption = GetLangText("REFERRAL","TXT_REFERRAL")
			thisformset.referralForm.p_mode = LMode
			thisformset.referralForm.tpageMain.pageInfo.tlabelUser.Caption = GetLangText("ACT","T_USER")+":"
			thisformset.referralForm.tpageMain.pageInfo.tlabelDate.Caption = GetLangText("DOC","T_DATE")
			thisformset.referralForm.tpageMain.pageInfo.tlabelTime.Caption = GetLangText("DOC","T_TIME")
			thisformset.referralForm.tpageMain.pageInfo.tlabelUserValue.Caption = referral1.re_user
			thisformset.referralForm.tpageMain.pageInfo.tlabelDateValue.Caption = DTOC(TTOD(referral1.re_date))
			thisformset.referralForm.tpageMain.pageInfo.tlabelTimeValue.Caption = TTOC(referral1.re_date,2)
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdUser.Caption = GetLangText("ACT","T_USER")+":"
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdDate.Caption = GetLangText("DOC","T_DATE")
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdTime.Caption = GetLangText("DOC","T_TIME")
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdUserValue.Caption = referral1.re_upuser
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdDateValue.Caption = DTOC(TTOD(referral1.re_updated))
			thisformset.referralForm.tpageMain.pageInfo.tlabelUpdTimeValue.Caption = TTOC(referral1.re_updated,2)
			thisformset.referralForm.p_linkres = .F.
			thisformset.m_linkres(2,.f.,.f.,referral1.re_linkres)
			*IF LGuestOK AND LCompanyOK
				thisformset.referralForm.tpageMain.pageData.tcLinkCompany.Enabled = .T.	
				thisformset.referralForm.tpageMain.pageData.tcLinkInvoice.Enabled = .T.	
			*ELSE
			*	thisformset.referralForm.tpageMain.pageData.tcLinkCompany.Enabled = .F.	
			*	thisformset.referralForm.tpageMain.pageData.tcLinkInvoice.Enabled = .F.	
			*ENDIF
		
			thisformset.referralForm.tpageMain.pageData.ttFrom.tooltiptext = ;
				this.m_gettooltipforaddress(referral1.re_from)
		
			thisformset.referralForm.tpageMain.pageData.ttTo.tooltiptext = ;
				this.m_gettooltipforaddress(referral1.re_to)
		
			thisformset.referralForm.p_fromcompany = ;
				this.m_AdjustAddressString(thisformset.referralForm.p_fromcompany, referral1.re_from)
			thisformset.referralForm.p_tocompany = ;
				this.m_AdjustAddressString(thisformset.referralForm.p_tocompany, referral1.re_to)
		
			IF thisformset.referralForm.p_mode = "NEW"
				this.FAddressMask.oProcAddress.ReferralNew()
			ELSE
				this.FAddressMask.oProcAddress.ReferralEdit(referral1.re_id)
			ENDIF
			thisformset.referralForm.oData = this.FAddressMask.oProcAddress.oReferral
			
			thisformset.referralForm.oReferrals = lp_oCol
			thisformset.referralForm.tpageMain.ActivePage = 1
			thisformset.referralForm.refresh()
			thisformset.referralForm.tpageMain.Refresh()
			thisformset.referralForm.tpageMain.pageInfo.Refresh()
			thisformset.referralForm.zorder()
			thisformset.referralForm.visible = .T.
			thisformset.referralForm.tpageMain.pageData.tcomboFrom.SetFocus()
		ENDIF
		
	ENDPROC

	PROCEDURE m_findnewaddress
		LPARAMETERS pl_nAddrId
		IF SEEK(pl_nAddrId, "address", "tag1")
			thisformset.p_referralparams(4) = address.ad_addrid
			thisformset.faddressMask.mainPage.pageGridAddress.AddressGrid.SetFocus()
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE m_getselectedaddress
		LPARAMETERS lp_nApid, lp_lDontRefreshToolbar
		LOCAL l_nAddrid, l_cSql, l_nRet, l_nRecno
		LOCAL ARRAY l_aDefs(4,5)
		
		l_nAddrid = address.ad_addrid
		lp_nApid = 0
		IF PCOUNT() = 1 AND DLocate("apartner", "ap_addrid = " + SqlCnv(l_nAddrid,.T.))
			TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
				SELECT IIF(EMPTY(ap_title),'',ALLTRIM(ap_title)+' ') + ALLTRIM(ap_fname) + 
					IIF(EMPTY(ap_fname),'',' ') + ALLTRIM(Flip(ap_lname)) AS ap_apname,
					ap_phone1, ap_fax, ap_apid, 1, ap_lname, ap_email
					FROM apartner WHERE ap_addrid = <<TRANSFORM(l_nAddrid)>>
				UNION SELECT IIF(EMPTY(ad_title),'',ALLTRIM(ad_title)+' ') + ALLTRIM(ad_fname) + 
					IIF(EMPTY(ad_fname),'',' ') + ALLTRIM(Flip(ad_lname)),
					ad_phone, ad_fax, 0, 0, ad_lname, ad_email
					FROM address WHERE ad_addrid = <<TRANSFORM(l_nAddrid)>>
					ORDER BY 5, 6
			ENDTEXT
			l_cCurName = SqlCursor(l_cSql)
			IF TYPE("p_nPrivacyApartId") = "N"
				l_nRecno = DLookUp(l_cCurName, "ap_apid = " + SqlCnv(p_nPrivacyApartId,.T.), "RECNO()")
			ENDIF
		
			l_aDefs(1,1) = "ap_apname"
			l_aDefs(1,2) = 170
			l_aDefs(1,3) = GetLangText("ADDRESS","TXT_LNAME")
			l_aDefs(1,4) = "TXT"
			l_aDefs(2,1) = "ap_phone1"
			l_aDefs(2,2) = 170
			l_aDefs(2,3) = GetLangText("ADDRESS","TXT_PHONE")
			l_aDefs(2,4) = "TXT"
			l_aDefs(3,1) = "ap_fax"
			l_aDefs(3,2) = 170
			l_aDefs(3,3) = GetLangText("ADDRESS","TXT_FAX")
			l_aDefs(3,4) = "TXT"
			l_aDefs(4,1) = "ap_email"
			l_aDefs(4,2) = 220
			l_aDefs(4,3) = "E-Mail"
			l_aDefs(4,4) = "TXT"
		
			l_nRet = FNDoBrwMulSel(l_cCurName, @l_aDefs, GetLangText("MENU", "MGR_RENT_OBJECTS"),,.T.,,,lp_lDontRefreshToolbar, l_nRecno)
			IF l_nRet = 1
				lp_nApid = &l_cCurName..ap_apid
			ENDIF
		ENDIF
		
		RETURN l_nAddrid
	ENDPROC

	PROCEDURE m_gettooltipforaddress
		LPARAMETERS p_nAddrId
		
		LOCAL lnAddrRecNo
		LOCAL l_cLName
		
		lnAddrRecNo = RECNO('address')
		
		= SEEK(p_nAddrId, "address", "tag1")
		
		l_cLName = IIF(EMPTY(address.ad_company), "", Flip(address.ad_company) + ;
			CHR(10)) + IIF(EMPTY(address.ad_departm), "", address.ad_departm + ;
			CHR(10)) + LTRIM(TRIM(address.ad_title) + " ") + LTRIM(TRIM(address.ad_fname) + " ") ;
			+ Flip(address.ad_lname) + CHR(10) + IIF(EMPTY(address.ad_street), "", ;
			address.ad_street + CHR(10)) + IIF(EMPTY(address.ad_street2), "", ;
			address.ad_street2 + CHR(10)) + LTRIM(TRIM(address.ad_zip) + "  ") + address.ad_city
		IF address.ad_country<>paRam.pa_country
			l_cLName = l_cLName + CHR(10) + ;
				DLookUp('PickList' , 'pl_label=[COUNTRY] and pl_charcod = ' + ;
				SqlCnv(address.ad_country), 'pl_lang' + g_langnum)
		ENDIF
		l_cLName = l_cLName + CHR(10) + 'Tel:'+TRIM(address.ad_phone) + ;
			' Fax:' + TRIM(address.ad_fax)
		
		GO lnAddrRecNo IN address
		
		RETURN l_cLName
	ENDPROC

	PROCEDURE m_linkres		&& Creates string,based on checkbox setting, which is writen in referral.re_linkres field.
		LPARAMETERS LMode, LCompany, LInvoice, LRef
		LOCAL LString
		LString = ""
		IF LMode = 1
			DO CASE
				CASE LCompany AND LInvoice
					LString = "XB"
				CASE LCompany
					LString = "XC"
				CASE LInvoice
					LString = "XI"
			ENDCASE
			RETURN LString
		ELSE
			DO CASE
				CASE LRef = "XB"
					this.referralForm.tpageMain.pageData.tcLinkCompany.Value = .T.
					this.referralForm.tpageMain.pageData.tcLinkInvoice.Value = .T.
					
				CASE LRef = "XC"
					this.referralForm.tpageMain.pageData.tcLinkCompany.Value = .T.
					this.referralForm.tpageMain.pageData.tcLinkInvoice.Value = .F.
				CASE LRef = "XI"
					this.referralForm.tpageMain.pageData.tcLinkCompany.Value = .F.
					this.referralForm.tpageMain.pageData.tcLinkInvoice.Value = .T.
				OTHERWISE
					this.referralForm.tpageMain.pageData.tcLinkCompany.Value = .F.
					this.referralForm.tpageMain.pageData.tcLinkInvoice.Value = .F.
			ENDCASE
			RETURN
		ENDIF
		
	ENDPROC

	PROCEDURE m_newforreferral
		DO FORM "forms\addressmask" WITH 'EDITC', "", 1, 'xx', 1, 1, 16, 0, this.FAddressMask
		
		RETURN .T.
	ENDPROC

	PROCEDURE m_onemailcmd
		LPARAMETERS lp_lApartner
		EXTERNAL ARRAY parights
		LOCAL l_cFilePath, l_oAdrprvcy
		LOCAL ARRAY l_aDocumentsToSend(1)
		STORE .F. TO l_aDocumentsToSend
		
		IF _screen.GO
			IF PAAddressConsent(,address.ad_addrid,@l_oAdrprvcy)
				this.DataCopyPp = l_oAdrprvcy
				this.RefreshPrivacyPage()
			ELSE
				Alert(GetLangText("ADDRESS","TA_CONSENT_EMAIL_NOT_GRANTED"))
				RETURN .F.
			ENDIF
		ENDIF
		IF address.ad_nomail
			Alert(GetLangText("ADDRESS","TA_CONSENT_EMAIL_NOT_GRANTED"))
			RETURN .F.
		ENDIF
		
		l_cFilePath = FULLPATH(gcDocumentdir)
		
		SELECT CAST(l_cFilePath+ALLTRIM(dc_file) AS Char(254)) AS c_file FROM curDocument ;
				WHERE dc_doctosend INTO ARRAY l_aDocumentsToSend
		
		IF _SCREEN.OL
			IF parights(135)
				DO FORM forms\emailsend.scx WITH "NEW", address.ad_addrid, this, 0, 0, l_aDocumentsToSend
				this.refreshdocpage()
				GO TOP IN curDocument
			ENDIF
		ELSE
			l_cEmail = ALLTRIM(this.FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Email.Value)
			l_cDisplayName = ALLTRIM(this.FAddressMask.MainPage.PageAddress.txtAd_Company.Value)
			IF EMPTY(l_cDisplayName) 
				l_cDisplayName = ALLTRIM(this.FAddressMask.MainPage.PageAddress.txtAd_Lname.Value) + ;
					" " + ALLTRIM(this.FAddressMask.MainPage.PageAddress.txtAd_Fname.Value)
			ENDIF
		
			procemail("PESendMail", l_cEmail,, l_cDisplayName,,,,address.ad_addrid)
		
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE m_onemailreplycmd
		LOCAL l_lSuccess
		IF curDocument.dc_type = "EINBOX"
			IF SEEK(curDocument.dc_eiid,"einbox","tag1") AND SEEK(curDocument.dc_eiid, "einboxsn", "tag1")
				DO FORM forms\emailsend.scx WITH "REPLY", einboxsn.eb_addrid, this, curDocument.dc_eiid
				this.refreshdocpage()
				GO TOP IN curDocument
			ENDIF
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE m_onnewexternaldocumentcmd
		PANewExternalDocument(address.ad_addrid)
		this.refreshdocpage()
		RETURN .T.
	ENDPROC

	PROCEDURE m_phonenote		&& Calls Phone Note form
		LPARAMETERS LMode
		LOCAL LTime
		LOCAL ARRAY LParamArray(5)
		LParamArray(1) = "FADDRESSMASK"
		LParamArray(2) = this.DataSessionId
		LParamArray(3) = LMode
		IF LMode = "EDIT"
			IF SEEK(VAL(document.dc_file),'phnote','tag2')
				LParamArray(4) = TTOC(phnote.ph_updated)
				LParamArray(5) = phnote.ph_upuser
			ELSE
				RETURN .F.
			ENDIF
		ENDIF
		LOCAL LoPhoneNote, LlAction, LoAction
		SELECT curDocument
		SET RELATION OFF INTO document
		DO FORM forms\phonenote NAME LoPhoneNote LINKED WITH LParamArray TO LlAction
		IF LlAction
			DO FORM forms\action NAME LoAction LINKED WITH "NEW",,address.ad_addrid
		ENDIF
		SET RELATION TO dc_recno INTO document IN curDocument
		this.refreshdocpage()
		IF LMode <> "EDIT"
			GO TOP IN curDocument
		ENDIF
		RETURN .T.
	ENDPROC

	PROCEDURE m_referral_checkvalid_linkres		&& Checks if for selected address allready set property to automaticly enter company and invoice data in reservat.prg
		LPARAMETERS pcMode
		
		* pcMode, Valid values are:
		* "C" - Called to check, if referral for Company is allready selected
		* "I" - Called to check, if referral for Invoice is allready selected
		* Function is returnig .T., when selection is approved, and .F., when Selection is restricted
		* Function can replace field re_linkres in referral.dbf with "" string
		
		LOCAL LRecno, LFound, LRefAddrId, LSelected, LTag, LReturn, LFrom, LTo
		LReturn = .F.
		LRefAddrId = 0
		thisformset.referralForm.p_linkres = .F.
		LRecno = RECNO('referral1')
		LSelected = ALIAS()
		SELECT referral1
		LTag = ORDER()
		LFrom = referral1.re_from
		LTo = referral1.re_to
		
		DO CASE
		 CASE pcMode = "C"
			SET ORDER TO TAG2
			SEEK LFrom
			IF NOT (re_linkres = "XC" OR re_linkres = "XB") OR EMPTY(re_linkres)
				SCAN REST FOR (re_linkres = "XC" OR re_linkres = "XB") WHILE referral1.re_from = LFrom
					LFound = .T.
					EXIT
				ENDSCAN
			ELSE
				LFound = .T.
			ENDIF
		 CASE pcMode = "I"
			SET ORDER TO TAG2
			SEEK LFrom
			IF NOT (re_linkres = "XI" OR re_linkres = "XB") OR EMPTY(re_linkres)
				SCAN REST FOR (re_linkres = "XI" OR re_linkres = "XB") WHILE referral1.re_from = LFrom
					LFound = .T.
					EXIT
				ENDSCAN
			ELSE
				LFound = .T.
			ENDIF
		ENDCASE	
		
		IF LFound AND referral1.re_to <> LTo
			IF MESSAGEBOX(getlangtext("REFERRAL","TXT_REFERRAL_ALERT")+CHR(13)+;
					 getlangtext("REFERRAL","TXT_REFERRAL_ALERT1");
					 +CHR(13)+CHR(13)+IIF(SEEK(referral1.re_to,'address3','tag1'),UPPER(address3.ad_company),""),;
					 4+32+256, GetLangText("FUNC","TXT_QUESTION"))=6
				replace referral1.re_linkres WITH "" IN referral1
				LReturn = .T.
			ENDIF
		ELSE
			LReturn = .T.
		ENDIF
		
		IF !EMPTY(LRecno)
			GO LRecno IN referral1
		ENDIF
		IF !EMPTY(LTag)
			SET ORDER TO &LTag IN referral1
		ENDIF
		IF !EMPTY(LSelected)
			SELECT &LSelected
		ENDIF
		IF LReturn
			thisformset.referralForm.p_linkres = .T.
		ENDIF
		RETURN LReturn
		
	ENDPROC

	PROCEDURE m_referral_checkvalid_mainaddress
		LPARAMETERS lp_oData
		LOCAL l_lAllowed, l_nToAddrId, l_nSelect, l_cSql, l_cCur
		
		IF VARTYPE(lp_oData)<>"O"
			RETURN l_lAllowed
		ENDIF
		
		l_nSelect = SELECT()
		
		l_nToAddrId = lp_oData.re_to
		
		TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
			SELECT re_id, re_mainadr, re_to, ad_company ;
				FROM referral ;
				INNER JOIN address ON re_to = ad_addrid ;
				WHERE re_id <> <<sqlcnv(lp_oData.re_id)>> AND re_to = <<sqlcnv(l_nToAddrId,.T.)>> AND re_mainadr
		ENDTEXT
		
		l_cCur = sqlcursor(l_cSql,"",.F.,"",.NULL.,.T.)
		IF RECCOUNT()>0
			l_lAllowed = yesno( ;
					getlangtext("REFERRAL","TXT_REFERRAL_ALERT")+CHR(13)+;
					getlangtext("REFERRAL","TXT_REFERRAL_ALERT1")+CHR(13)+CHR(13)+;
					UPPER(&l_cCur..ad_company);
					)
			* When user say that he will to change main address, old main address would be 
			* removed when referral is saved.
		ELSE
			l_lAllowed = .T.
		ENDIF
		dclose(l_cCur)
		
		SELECT(l_nSelect)
		
		RETURN l_lAllowed
	ENDPROC

	PROCEDURE m_selectreferral		&& New address is selected for referral, now go back to source address
		IF LOWER(thisformset.fAddressMask.cformlabel) = "searchadr"
			this.onselectedaddressesok()
			RETURN .T.
		ENDIF
		
		
		RETURN .T.
	ENDPROC

	PROCEDURE m_set_state_for_referral_search		&& Change form behavior when new address for referral ist searched
		LOCAL l_oParam AS Collection, l_nMainAddrid
		LOCAL ARRAY l_aParams(11)
		
		l_nMainAddrid = address.ad_addrid
		l_oParam = CREATEOBJECT("Collection")
		l_oParam.Add(l_nMainAddrid, "MAIN_ADDRID")
		
		l_aParams(1) = "SELECT_ADDRESSES"
		l_aParams(2) = ""
		l_aParams(3) = .F.
		l_aParams(4) = .F.
		l_aParams(5) = .F.
		l_aParams(6) = .F.
		l_aParams(7) = 25
		l_aParams(8) = .F.
		l_aParams(9) = this.fAddressMask
		l_aParams(10) = 0
		l_aParams(11) = l_oParam
		
		doform('searchadr','forms\addressmask', , .T., @l_aParams)
		
		l_oParam = .NULL.
		
		RETURN .T.
	ENDPROC

	PROCEDURE onhistory
		LOCAL l_cCaption
		
		l_cCaption = TRANSFORM(address.ad_addrid) + " " + ALLTRIM(address.ad_company) + " " + ALLTRIM(address.ad_lname)
		DO FORM forms\rshistor WITH address.ad_changes, l_cCaption
	ENDPROC

	PROCEDURE onjumptoaddress
		LPARAMETERS lp_nAddrId
		LOCAL l_oAddress, l_nSelect, l_nRecno
		IF EMPTY(lp_nAddrId)
			RETURN .T.
		ENDIF
		IF dlocate("address","ad_addrid = " + sqlcnv(lp_nAddrId))
			IF this.SearchActive
				IF USED("addr1")
					l_nRecno = RECNO("addr1")
					IF NOT dlocate("addr1","ad_addrid = " + sqlcnv(lp_nAddrId))
						l_nSelect = SELECT()
						SELECT address
						SCATTER NAME l_oAddress MEMO
						INSERT INTO addr1 FROM NAME l_oAddress
						REPLACE rn WITH RECNO("address") IN addr1
						SELECT (l_nSelect)
					ELSE
						GO l_nRecno IN addr1
					ENDIF
				ENDIF
			ENDIF
			
			this.refreshaddressgrid()
		
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE onselect
		DO CASE
			CASE LOWER(this.FAddressMask.cformlabel) = "searchadr"
				this.OnSelectedAddressesOK()
			CASE NOT (this.AddressStart = "NORMAL") AND this.AddressState = 0
				* When called from another form, then close on ENTER
				this.lOkCommand = .T.
				this.AddressExit()
			CASE this.FAddressMask.MainPage.ActivePage = 2 OR EMPTY(address.ad_addrid)
			OTHERWISE
				WITH this.FAddressMask.MainPage.PageAddress.SlavePage
					IF .ActivePage = 1 AND .PageApartner.CUpdateApartner.enabled
						.PageApartner.CUpdateApartner.click()
					ENDIF
					IF .ActivePage = 3 AND .PageDokument.BDokEdit.enabled
						.PageDokument.BDokEdit.click()
					ENDIF
					IF .ActivePage = 5 AND .PageFuture.BFutEdit.enabled
						.PageFuture.BFutEdit.click()
					ENDIF
					IF .ActivePage = 8 AND .pageReferral.BrEdit.Enabled
						.pageReferral.BrEdit.click()
					ENDIF
				ENDWITH
		ENDCASE
	ENDPROC

	PROCEDURE onselectaddress
		LPARAMETERS lp_lChange
		LOCAL l_nAddrId, l_lSelected
		l_nAddrId = EVALUATE(this.fAddressMask.mainPage.pageGridAddress.addressGrid.RecordSource+".ad_addrid")
		IF PCOUNT()=0
			IF LOWER(this.fAddressMask.cformlabel) = "searchadr" AND dlocate(this.cCurSelectedAddresses,"cur_addrid = " + sqlcnv(l_nAddrId))
				l_lSelected = EVALUATE(this.cCurSelectedAddresses+".cur_selected")
			ENDIF
		ELSE
			DO CASE
				CASE dlocate(this.cCurSelectedAddresses,"cur_addrid = " + sqlcnv(l_nAddrId))
					l_lSelected = EVALUATE(this.cCurSelectedAddresses+".cur_selected")
					IF NOT l_lSelected AND thisformset.fAddressMask.oProcAddress.AddressDeleteAllowed(l_nAddrId, thisformset.oParam.Item("MAIN_ADDRID"))
						l_lSelected = .T.
					ELSE
						l_lSelected = .F.
					ENDIF
					REPLACE cur_selected WITH l_lSelected IN (this.cCurSelectedAddresses)
				OTHERWISE
					IF thisformset.fAddressMask.oProcAddress.AddressDeleteAllowed(l_nAddrId, thisformset.oParam.Item("MAIN_ADDRID"))
						l_lSelected = .T.
						INSERT INTO (this.cCurSelectedAddresses) (cur_addrid, cur_selected) VALUES (l_nAddrId, l_lSelected)
					ENDIF
			ENDCASE
		ENDIF
		RETURN l_lSelected
	ENDPROC

	PROCEDURE onselectedaddresses
		LPARAMETERS lp_oCol AS Collection
		LOCAL l_nAddrId AS Integer
		
		IF NOT (PCOUNT()>0 AND NOT ISNULL(lp_oCol))
			RETURN .T.
		ENDIF
		
		this.fAddressMask.oProcAddress.AddressDeleteMany(lp_oCol)
		
		FOR EACH l_nAddrId IN lp_oCol FOXOBJECT
			this.AddressDeleteAfter(l_nAddrId)
		ENDFOR
		
		RETURN .T.
	ENDPROC

	PROCEDURE onselectedaddressesok
		LOCAL l_lExit
		IF thisformset.AddressState <> 0
			RETURN .T.
		ENDIF
		IF this.Mode = 25
			IF NOT EMPTY(this.cCurSelectedAddresses) AND USED(this.cCurSelectedAddresses) AND RECCOUNT(this.cCurSelectedAddresses)=0
				* Nothing marked. Add currently selected address.
				INSERT INTO (this.cCurSelectedAddresses) (cur_addrid, cur_selected) VALUES (address.ad_addrid, .T.)
			ENDIF
			l_lExit = .T.
		ELSE
			l_lExit = yesno(strfmt(getlangtext("ADDRESS","TXT_SURE_TO_TRANSFER"),CHR(13)+CHR(13)+;
					this.fAddressMask.mainPage.pageGridAddress.edtMainAddress.Value))
		ENDIF
		IF l_lExit
			this.laddressesfordeleteselected = .T.
			this.addressexit()
		ENDIF
	ENDPROC

	PROCEDURE onselectedreferrals
		LPARAMETERS lp_oCol AS Collection
		LOCAL l_nAddrId AS Integer, l_nMainAddrId AS Integer, l_nNewId AS Integer, l_oSelected AS Collection
		
		IF NOT (PCOUNT()>0 AND NOT ISNULL(lp_oCol))
			RETURN .T.
		ENDIF
		l_nMainAddrId = address.ad_addrid
		l_oSelected = .NULL.
		FOR EACH l_nAddrId IN lp_oCol FOXOBJECT
			this.FAddressMask.oProcAddress.ReferralNew(l_nMainAddrId, l_nAddrId)
			IF this.FAddressMask.oProcAddress.ReferralValid() = 0
				IF this.FAddressMask.oProcAddress.ReferralSave()
					IF EMPTY(l_nNewId)
						l_nNewId = this.FAddressMask.oProcAddress.oReferral.re_id
					ELSE
						IF ISNULL(l_oSelected)
							l_oSelected = CREATEOBJECT("Collection")
						ENDIF
						l_oSelected.Add(this.FAddressMask.oProcAddress.oReferral.re_id)
					ENDIF
				ENDIF
			ENDIF
		ENDFOR
		
		IF NOT EMPTY(l_nNewId) && Has user selected 1 or more addresses?
			this.refreshaddressgrid()
		
			* edit first referral
			IF dlocate("tgridreferralcursor","re_id = " + sqlcnv(l_nNewId))
				thisformset.m_editreferral("EDIT", l_oSelected)
			ENDIF
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE onselectreferral
		LPARAMETERS lp_lChange
		LOCAL l_nAddrId, l_lSelected
		l_nAddrId = EVALUATE(this.fAddressMask.mainPage.pageGridAddress.addressGrid.RecordSource+".ad_addrid")
		IF PCOUNT()=0
			IF dlocate(this.cCurSelectedAddresses,"cur_addrid = " + sqlcnv(l_nAddrId))
				l_lSelected = EVALUATE(this.cCurSelectedAddresses+".cur_selected")
			ENDIF
		ELSE
			DO CASE
				CASE dlocate(this.cCurSelectedAddresses,"cur_addrid = " + sqlcnv(l_nAddrId))
					l_lSelected = EVALUATE(this.cCurSelectedAddresses+".cur_selected")
					IF NOT l_lSelected
						l_lSelected = .T.
					ELSE
						l_lSelected = .F.
					ENDIF
					REPLACE cur_selected WITH l_lSelected IN (this.cCurSelectedAddresses)
				OTHERWISE
					l_lSelected = .T.
					INSERT INTO (this.cCurSelectedAddresses) (cur_addrid, cur_selected) VALUES (l_nAddrId, l_lSelected)
			ENDCASE
		ENDIF
		RETURN l_lSelected
	ENDPROC

	PROCEDURE putcheckboxvalue		&& Put a string value from logical checkbox into user field
		LPARAMETERS PValue
		
		RETURN IIF(PValue,'T','F')
		
	ENDPROC

	PROCEDURE referral_goto		&& Jump to address record
		thisformset.p_referralparams(2) = tgridreferralcursor.re_to
		thisformset.p_referralparams(3) = ORDER('address')
		thisformset.m_cancel_state_for_new_referral()
		RETURN .T.
	ENDPROC

	PROCEDURE refreshaddressgrid
		LOCAL i, lcCheckBox
		
		this.FAddressMask.LockScreen = .T.
		
		*DO case
		*CASE this.FAddressMask.MainPage.activepage = 1
		
			SELECT AddressTAlias
			IF NOT this.lDontChangeDataCopy
				SCATTER Name this.DataCopy Memo
				this.FAddressMask.oProcAddress.AddressSet(this.DataCopy)
				this.DataCopyPp = this.FAddressMask.oProcAddress.AddressGet("adrprvcy")
				this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacyPolicy.Requery()
		
				this.AddressCopyFromAdrmain()
				this.fAddressMask.MainPage.PageAddress.txtAd_addrid.Value = EVL(this.DataCopy.ad_addrid,"N/A")
				this.fAddressMask.MainPage.PageAddress.txtAd_adid.Value = EVL(this.DataCopy.ad_adid,"N/A")
				this.fAddressMask.oProcAddress.AddressSetFeatures(this.DataCopy.ad_addrid, this.fAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.curSelect, .T.)
				this.fAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.RefreshValue()
				this.SetBonusPoints()		
			ELSE
				this.lDontChangeDataCopy = .F.
			ENDIF
			
			WITH this.fAddressMask.mainPage.pageAddress.slavePage.pageFree
				FOR i = 1 TO 10
					lcCheckBox = "tcheckbox" + TRANSFORM(i)
					IF .&lcCheckBox..Visible
						.&lcCheckBox..Value = this.getcheckboxvalue(i)
					ENDIF
				NEXT
			ENDWITH
			WITH this.FAddressMask.MainPage.PageAddress.SlavePage
				this.FAddressMask.MainPage.PageAddress.Refresh()
		
				SELECT AddressTAlias
				.Enabled = NOT EMPTY(AddressTAlias.ad_addrid)
		
				IF .ActivePage = 1
					this.fAddressMask.refresh
					.PageApartner.CUpdateApartner.Enabled = (this.AddressStart = "NORMAL") AND NOT EMPTY(ApartnerTAlias.ap_addrid)
					.PageApartner.cmdDelPart.Enabled = .PageApartner.CUpdateApartner.Enabled
				ENDIF
		
				.PageNote.refresh
		
				IF .ActivePage = 2
					.PageNote.Edit1.value = AddressTAlias.ad_note
					.PageNote.txtAd_Created.value = AddressTAlias.Ad_Created
					.PageNote.txtAd_Updated.value = AddressTAlias.Ad_Updated
				ENDIF
		
				IF .ActivePage = 3
					this.refreshdocpage()
				ENDIF
		
				IF .ActivePage = 4
					thisformset.refreshstatistics()
				ENDIF
		
				IF .ActivePage = 5
					this.refreshfuturepage()
					.PageFuture.refresh
				ENDIF
		
				IF .ActivePage = 6
					this.refresholdrespage()
				ENDIF
		
				IF .ActivePage = 7
					.pagefree.refresh()
				ENDIF
		
				IF .ActivePage = 8
					this.refreshreferralgrid()
				ENDIF
		
				IF .ActivePage = 9
					this.RefreshSalesPage()
				ENDIF
		
				IF .ActivePage = 10
					this.RefreshPrivacyPage()
				ENDIF
			ENDWITH
		
		*ENDCASE
		this.FAddressMask.LockScreen = .F.
		
	ENDPROC

	PROCEDURE refreshdocpage
		IF this.lRefreshingDocPage
			RETURN .F.
		ENDIF
		this.lRefreshingDocPage = .T.
		
		LOCAL l_nSelect, l_cWhere, l_nRecNo, l_nPhDocID, l_lSentEMail
		
		l_nSelect = SELECT()
		
		SELECT curDocument
		l_nRecNo = RECNO()
		ZAP
		
		IF NOT this.AddressFromAdrMainSelected()
			l_cWhere = this.cdocumentsfilter
			SELECT *, RECNO() AS dc_recno, CAST(0 AS N(8)) AS dc_eiid, CAST(0 AS N(8)) AS dc_esid, CAST('' AS C(30)) AS dc_phcname, ;
					CAST('' AS C(5)) AS dc_attachment, .F. AS dc_doctosend, CAST(0 AS N(8)) AS dc_agid FROM document ;
					WHERE dc_addrid = address.ad_addrid AND &l_cWhere ;
					INTO CURSOR curTempDocument READWRITE
			SCAN FOR dc_type = "TELENOTE"
				l_nPhDocID = INT(VAL(dc_file))
				IF SEEK(l_nPhDocID,"phnote","tag2")
					DO CASE
						CASE phnote.ph_addrid > 0 AND phnote.ph_apid > 0
							IF SEEK(phnote.ph_apid,"apartner2","tag3")
								REPLACE dc_phcname WITH apartner2.ap_lname IN curTempDocument
							ENDIF
						CASE phnote.ph_addrid > 0
							IF SEEK(phnote.ph_addrid,"address3","tag1")
								REPLACE dc_phcname WITH address3.ad_lname IN curTempDocument
							ENDIF
						OTHERWISE
							* do nothing, leave blank contact name
					ENDCASE
				ENDIF
			ENDSCAN
		
			IF this.ldocumentsemail
				SELECT * FROM esentrcp WHERE ec_addrid = address.ad_addrid ;
					GROUP BY ec_esid INTO CURSOR curTempEsent
				SCAN FOR SEEK(ec_esid,"esent","tag1") AND NOT esent.es_deleted
					l_lSentEMail = .T.
					INSERT INTO curTempDocument (dc_esid, dc_date, dc_time, dc_addrid, dc_descr, dc_userid, dc_type, dc_attachment) ;
							VALUES (esent.es_esid, TTOD(esent.es_datime), ;
							PADL(HOUR(esent.es_datime), 2, "0")+":"+PADL(MINUTE(esent.es_datime), 2, "0"), ;
							address.ad_addrid, esent.es_subject, esent.es_userid, "ESENT", this.CheckAttachmentsText(esent.es_esid, l_lSentEMail))
				ENDSCAN
				DClose("curTempEsent")
				SELECT * FROM einboxsn WHERE eb_addrid = address.ad_addrid GROUP BY eb_eiid INTO CURSOR curTempEinbox
				SCAN FOR SEEK(eb_eiid,"einbox","tag1") AND NOT einbox.ei_deleted
					l_lSentEMail = .F.
					INSERT INTO curTempDocument (dc_eiid, dc_date, dc_time, dc_addrid, dc_descr, dc_userid, dc_type, dc_attachment) ;
							VALUES (einbox.ei_eiid, TTOD(einbox.ei_datime), ;
							PADL(HOUR(einbox.ei_datime), 2, "0")+":"+PADL(MINUTE(einbox.ei_datime), 2, "0"), ;
							address.ad_addrid, einbox.ei_subject, einbox.ei_userid, "EINBOX", this.CheckAttachmentsText(einbox.ei_eiid, l_lSentEMail))
				ENDSCAN
				DClose("curTempEinbox")
			ENDIF
		
			IF this.lDebitorRecivables
				DO ArGetRecivablesForAddress IN ar WITH address.ad_addrid, "curTempDocument"
			ENDIF
			SELECT curDocument
			APPEND FROM DBF("curTempDocument")
			DClose("curTempDocument")
		ENDIF
		
		IF l_nRecNo > RECCOUNT()
			LOCATE
		ELSE
			GO l_nRecNo
		ENDIF
		
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageDokument.SetAll("Enabled", NOT EMPTY(address.ad_addrid), "tCommandButton")
		STORE NOT EMPTY(curDocument.dc_addrid) TO ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageDokument.bDokEdit.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageDokument.bDokDel.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnReply.Enabled
		
		this.RefreshGrid(this.fAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid)
		
		SELECT (l_nSelect)
		
		this.lRefreshingDocPage = .F.
		RETURN .T.
	ENDPROC

	PROCEDURE refreshfuturepage
		LOCAL l_nSelect, l_nRecNo, l_lActiveAllotment
		
		IF this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.lRefreshing
			RETURN
		ENDIF
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.lRefreshing = .T.
		
		l_nSelect = SELECT()
		
		SELECT (this.futurefilename)
		l_nRecNo = RECNO()
		ZAP
		
		IF NOT this.AddressFromAdrMainSelected()
			SELECT * FROM reservat ;
				WHERE (rs_addrid = address.ad_addrid OR rs_compid = address.ad_addrid OR rs_agentid = address.ad_addrid OR rs_saddrid = address.ad_addrid) AND ;
				rs_status IN ('IN','DEF','ASG','6PM','OPT','TEN','LST','CXL') ;
				ORDER BY rs_arrdate ;
				INTO CURSOR curFutureTemp
			SELECT (this.futurefilename)
			APPEND FROM DBF("curFutureTemp")
			DClose("curFutureTemp")
			l_lActiveAllotment = DLocate("althead", "al_addrid = address.ad_addrid AND IIF(al_cutday = 0, al_cutdate, al_todat - al_cutday) >= " + SqlCnv(SysDate(),.T.))
		ENDIF
		
		** Enable some buttons
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.bFutNew.Enabled = this.AddressStart = "NORMAL" AND paRights(105)
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.bFutEdit.Enabled = this.AddressStart = "NORMAL" AND paRights(106) AND RECCOUNT() > 0
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.bFutDel.Enabled = this.AddressStart = "NORMAL" AND paRights(107) AND RECCOUNT() > 0
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.cmdFutAlt.Enabled = this.AddressStart = "NORMAL" AND paRights(133) AND l_lActiveAllotment
		
		IF l_nRecNo > RECCOUNT()
			LOCATE
		ELSE
			GO l_nRecNo
		ENDIF
		**
		
		this.RefreshGrid(this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid)
		
		SELECT (l_nSelect)
		
		this.fAddressMask.MainPage.PageAddress.SlavePage.PageFuture.lRefreshing = .F.
		RETURN .T.
	ENDPROC

	PROCEDURE refreshgrid
		LPARAMETERS lp_oGrid
		
		lp_oGrid.Refresh()
		IF TYPE("lp_oGrid.Parent.ActiveControl") = "O" AND lp_oGrid.Parent.ActiveControl = lp_oGrid
			KEYBOARD '{UPARROW}'
		ENDIF
	ENDPROC

	PROCEDURE refresholdrespage
		LOCAL l_nSelect, l_nRecno, l_cSql, l_naddrid, l_cSysDate, l_cArchScripts
		
		l_nSelect = SELECT()
		
		SELECT cTmpHistres
		l_nRecNo = RECNO()
		ZAP
		
		IF NOT this.AddressFromAdrMainSelected()
			l_naddrid = address.ad_addrid
			l_cSysDate = SqlCnv(SysDate(),.T.)
		
			******************** Prepare SQLs for archive ******************************************************
			*
			TEXT TO l_cArchScripts TEXTMERGE NOSHOW PRETEXT 15
			SELECT histres.* FROM histres
				WHERE hr_addrid = <<SqlCnvB(l_naddrid)>> OR hr_compid = <<SqlCnvB(l_naddrid)>> OR  hr_agentid = <<SqlCnvB(l_naddrid)>>;
		
			SELECT hresext.* FROM hresext
				INNER JOIN histres ON hr_reserid = rs_reserid
				WHERE hr_addrid = <<SqlCnvB(l_naddrid)>> OR hr_compid = <<SqlCnvB(l_naddrid)>> OR  hr_agentid = <<SqlCnvB(l_naddrid)>>
			ENDTEXT
			ProcArchive("RestoreArchive", "histres,hresext", l_cArchScripts, {})
			*
			****************************************************************************************************
		
			TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
			SELECT h1.*, CAST(NVL(al_allott,'') AS Char(30)) AS al_allott ;
				FROM ( ;
					SELECT hr_rsid ;
						FROM histres ;
						WHERE (hr_addrid = <<TRANSFORM(l_naddrid)>> OR hr_compid = <<TRANSFORM(l_naddrid)>> OR  hr_agentid = <<TRANSFORM(l_naddrid)>>) AND ;
						hr_depdate < <<l_cSysDate>> AND hr_status IN ('OUT','CXL','NS') ;
					UNION ;
					SELECT hr_rsid ;
						FROM histres ;
						INNER JOIN hresext ON hr_rsid = rs_rsid AND rs_saddrid = <<TRANSFORM(l_naddrid)>> ;
						WHERE hr_depdate < <<l_cSysDate>> AND hr_status IN ('OUT','CXL','NS') ;
					) c1 ;
				INNER JOIN histres h1 ON c1.hr_rsid = h1.hr_rsid ;
				LEFT JOIN althead ON h1.hr_altid = al_altid ;
				LEFT JOIN hresext ON h1.hr_rsid = rs_rsid ;
				LEFT JOIN roomtype ON h1.hr_roomtyp = rt_roomtyp ;
				<<IIF(this.FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cHrFilter==".T.",""," AND " + this.FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cHrFilter)>>
			ENDTEXT
		
			l_cCur = SqlCursor(l_cSql,,,,,.T.)
		
			******************** Delete temp files *************************************************************
			*
			ProcArchive("DeleteTempArchive", "histres,hresext")
			*
			****************************************************************************************************
		
			SELECT cTmpHistres
			APPEND FROM DBF(l_cCur)
			DClose(l_cCur)
		ENDIF
		IF l_nRecNo > RECCOUNT()
			LOCATE
		ELSE
			GO l_nRecNo
		ENDIF
		
		STORE NOT EMPTY(cTmpHistres.hr_addrid) OR NOT EMPTY(cTmpHistres.hr_rsid) TO ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.bHistPrint.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdShowReservation.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdCopyReservation.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdBillPreview.Enabled
		
		this.RefreshGrid(this.fAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid)
		
	ENDPROC

	PROCEDURE refreshprivacypage
		LOCAL l_nSelect
		
		l_nSelect = SELECT()
		
		this.fAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.Refresh()
		
		SELECT (l_nSelect)
		RETURN .T.
	ENDPROC

	PROCEDURE refreshreferralgrid
		LOCAL LReftext, LAddtext, LLinkres, l_cIsMainAdr, l_lShowReferrals
		
		l_nSelect = SELECT()
		
		SELECT tgridreferralcursor
		l_nRecNo = RECNO()
		ZAP
		
		IF NOT this.AddressFromAdrMainSelected()
			STORE "" TO LReftext, LAddtext, LLinkres
		
			SELECT * FROM tGridReferralCursor WHERE 0=1 INTO CURSOR ReferralCursor READWRITE
		
			*** Fill Cursor
			SELECT referral
			*** Search first TO
			SET ORDER TO TAG3
			GOTO TOP
			IF SEEK(address.ad_addrid)
				SCAN REST WHILE re_to = address.ad_addrid
					IF SEEK("REFERRAL  "+STR(referral.re_lnkt,3),"picklist4","tag3")
						LMacro = "LReftext = picklist4.pl_lang"+ALLTRIM(g_langnum)
						&LMacro
					ELSE
						LReftext = "NOT DEFINED"
					ENDIF
					LAddtext = GetLangText("REFERRAL","TXT_FROM") + " " + IIF(SEEK(referral.re_from,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname))
					l_cFullAdr = TRIM(address3.ad_street) + ", " + TRIM(address3.ad_zip) + " " + TRIM(address3.ad_city)
					DO CASE
						CASE referral.re_linkres = "XB"
							LLinkres = GetLangText("ADDRESS","TXT_COMPANY")+"+"+GetLangText("RESERVAT","T_INVOICE")
						CASE referral.re_linkres = "XC"
							LLinkres = GetLangText("ADDRESS","TXT_COMPANY")
						CASE referral.re_linkres = "XI"
							LLinkres = GetLangText("RESERVAT","T_INVOICE")
						OTHERWISE
							LLinkres = ""
					ENDCASE		
					l_cIsMainAdr = IIF(referral.re_mainadr, ALLTRIM(address3.ad_company) + ", " + ALLTRIM(address3.ad_lname), "")
					INSERT INTO referralcursor ;
					(re_id, ;
					 re_to, ;
					 re_lnkf, ;
					 re_lnkt, ;
					 re_date, ;
					 re_user, ;
					 re_reftext, ;
					 re_addtext, ;
					 re_linkres, ;
					 re_fulladr, ;
					 re_mainadi) ;
					 VALUES ;
					(referral.re_id, ;
					 referral.re_from, ;
					 referral.re_lnkf, ;
					 referral.re_lnkt, ;
					 referral.re_date, ;
					 referral.re_user, ;
					 LReftext, ;
					 LAddtext, ;
					 LLinkres, ;
					 l_cFullAdr, ;
					 l_cIsMainAdr)
				ENDSCAN
			ENDIF
			*** Search then FROM
			SET ORDER TO TAG2
			GOTO TOP
			IF SEEK(address.ad_addrid)
				SCAN REST WHILE re_from = address.ad_addrid
					IF SEEK("REFERRAL  "+STR(referral.re_lnkf,3),"picklist4","tag3")
						LMacro = "LReftext = picklist4.pl_lang"+ALLTRIM(g_langnum)
						&LMacro
					ELSE
						LReftext = "NOT DEFINED"
					ENDIF
					LAddtext = GetLangText("REFERRAL","TXT_TO") + " " + IIF(SEEK(referral.re_to,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname))
					l_cFullAdr = TRIM(address3.ad_street) + ", " +TRIM(address3.ad_zip) + " " + TRIM(address3.ad_city)
					DO CASE
						CASE referral.re_linkres = "XB"
							LLinkres = GetLangText("ADDRESS","TXT_COMPANY")+"+"+GetLangText("RESERVAT","T_INVOICE")
						CASE referral.re_linkres = "XC"
							LLinkres = GetLangText("ADDRESS","TXT_COMPANY")
						CASE referral.re_linkres = "XI"
							LLinkres = GetLangText("RESERVAT","T_INVOICE")
						OTHERWISE
							LLinkres = ""
					ENDCASE		
					l_cIsMainAdr = IIF(referral.re_mainadr,this.cYes,this.cNo)
					INSERT INTO referralcursor ;
					(re_id, ;
					 re_to, ;
					 re_lnkf, ;
					 re_lnkt, ;
					 re_date, ;
					 re_user, ;
					 re_reftext, ;
					 re_addtext, ;
					 re_linkres, ;
					 re_fulladr, ;
					 re_mainadi) ;
					 VALUES ;
					(referral.re_id, ;
					 referral.re_to, ;
					 referral.re_lnkf, ;
					 referral.re_lnkt, ;
					 referral.re_date, ;
					 referral.re_user, ;
					 LReftext, ;
					 LAddtext, ;
					 LLinkres, ;
					 l_cFullAdr, ;
					 l_cIsMainAdr)
					 l_lShowReferrals = .T.
				ENDSCAN
			ENDIF
		
			SELECT tgridreferralcursor
			APPEND FROM DBF('referralcursor')
			DClose('referralcursor')
		ENDIF
		
		IF l_nRecNo > RECCOUNT()
			LOCATE
		ELSE
			GO l_nRecNo
		ENDIF
		
		this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.BRNew.Enabled = NOT this.p_disablereferral
		this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.cmdShowReferrals.Enabled = NOT this.p_disablereferral AND l_lShowReferrals
		STORE RECCOUNT('tgridreferralcursor') > 0 AND NOT this.p_disablereferral TO ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.bRDelete.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.bREdit.Enabled, ;
			this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.bRGoto.Enabled
		
		this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.Refresh()
		this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.SetFocus()
		*this.RefreshGrid(this.fAddressMask.MainPage.PageAddress.SlavePage.pageReferral.tGridReferral)
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE refreshsalespage
		LPARAMETERS lp_cWhatToRefresh
		IF PCOUNT() = 0
			lp_cWhatToRefresh = "ALL"
		ENDIF
		LOCAL l_nBalance, l_nRem0, l_nRem1, l_nRem2, l_nRem3, l_nRemX, l_nRevSum, l_nRmsSum, l_nRevMEnd, l_nRmsMEnd, ;
				l_nRevD30, l_nRmsD30, l_nRevYEnd, l_nRmsYEnd, l_nRevD365, l_nRmsD365, l_cIntrestsString, l_cResIntString, ;
				l_nAmnt1, l_nAmnt2, l_nAmnt3, l_nCamnt1, l_nCamnt2, l_nCamnt3, l_cRatecode, l_dContactDate, l_cContactType
		
		IF lp_cWhatToRefresh = "ALL" AND this.aPageSalesData(10) = address.ad_addrid && Data for this address are already showed
			RETURN .T.
		ENDIF
		IF this.AddressFromAdrMainSelected()
			STORE 0 TO this.aPageSalesData, this.aAraccountData, this.aForecastData
			STORE "" TO this.aPageSalesData(1), this.aPageSalesData(2), this.aPageSalesData(9), this.aPageSalesData(12)
			STORE {} TO this.aPageSalesData(11)
		ELSE
			WAIT WINDOW GetLangText("COMMON", "T_PLEASEWAIT") NOWAIT
		
			thisformset.aPageSalesData(10) = address.ad_addrid
			IF lp_cWhatToRefresh = "ADRRATES" OR lp_cWhatToRefresh = "ALL"
				DO AddrAgreedRates IN procaddress WITH address.ad_addrid, l_cRatecode, l_nAmnt1, l_nAmnt2, l_nAmnt3, ;
						l_nCamnt1, l_nCamnt2, l_nCamnt3
				thisformset.aPageSalesData(3) = l_nAmnt1
				thisformset.aPageSalesData(4) = l_nAmnt2
				thisformset.aPageSalesData(5) = l_nAmnt3
				thisformset.aPageSalesData(6) = l_nCamnt1
				thisformset.aPageSalesData(7) = l_nCamnt2
				thisformset.aPageSalesData(8) = l_nCamnt3
				thisformset.aPageSalesData(9) = l_cRatecode
			ENDIF
			IF _screen.dv AND lp_cWhatToRefresh = "ALL"
				DO ArRemainders IN araccount WITH address.ad_addrid, l_nBalance, l_nRem0, l_nRem1, l_nRem2, l_nRem3, l_nRemX
				thisformset.aAraccountData(1) = l_nBalance
				thisformset.aAraccountData(2) = l_nRem0
				thisformset.aAraccountData(3) = l_nRem1
				thisformset.aAraccountData(4) = l_nRem2
				thisformset.aAraccountData(5) = l_nRem3
				thisformset.aAraccountData(6) = l_nRemX
			ENDIF
		
			IF lp_cWhatToRefresh = "ALL"
				DO AaRevenueForecast IN aaupd WITH address.ad_addrid, l_nRevSum, l_nRmsSum, l_nRevMEnd, l_nRmsMEnd, l_nRevD30, ;
						l_nRmsD30, l_nRevYEnd, l_nRmsYEnd, l_nRevD365, l_nRmsD365
				thisformset.aForecastData(1) = l_nRevSum
				thisformset.aForecastData(2) = l_nRmsSum
				thisformset.aForecastData(3) = l_nRevMEnd
				thisformset.aForecastData(4) = l_nRmsMEnd
				thisformset.aForecastData(5) = l_nRevD30
				thisformset.aForecastData(6) = l_nRmsD30
				thisformset.aForecastData(7) = l_nRevYEnd
				thisformset.aForecastData(8) = l_nRmsYEnd
				thisformset.aForecastData(9) = l_nRevD365
				thisformset.aForecastData(10) = l_nRmsD365
				
				DO AddrLastContact IN procaddress WITH address.ad_addrid, l_dContactDate, l_cContactType
				thisformset.aPageSalesData(11) = l_dContactDate
				thisformset.aPageSalesData(12) = l_cContactType
			ENDIF
			IF lp_cWhatToRefresh = "INTRESTS" OR lp_cWhatToRefresh = "ALL"
				DO AddrIntrests IN procaddress WITH address.ad_addrid, l_cIntrestsString
				thisformset.aPageSalesData(1) = l_cIntrestsString
			ENDIF
			IF lp_cWhatToRefresh = "RESINTERVALS" OR lp_cWhatToRefresh = "ALL"
				DO AddrReservationIntervals IN procaddress WITH address.ad_addrid, l_cResIntString
				thisformset.aPageSalesData(2) = l_cResIntString
			ENDIF
		
			WAIT CLEAR
		ENDIF
		
		this.FAddressMask.MainPage.PageAddress.SlavePage.PageSales.Refresh()
		
		RETURN .T.
	ENDPROC

	PROCEDURE refreshstatistics		&& Method that recalculates statistics and shows it in Revnue.
		IF NOT PEMSTATUS(this.fAddressMask.MainPage.PageAddress.SlavePage.PageHistory, "oRevenuePage", 5)
			this.fAddressMask.MainPage.PageAddress.SlavePage.PageHistory.oRevenuePage.RefreshStatistics()
		ENDIF
	ENDPROC

	PROCEDURE Release
		IF this.lodbc
			this.opgde.Release()
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE searchaddresstable
		LOCAL csort, cseekexp, l_lMessage, lorder, lnFoundAddressCounter, cScopeWhile, apart_, i_, i, cscopeap
		LOCAL lCompany, lCompkey, lCompnum, lName, FName, lCity, lMember, LAdrType, lEmail, lSearchall, lPhone, lExactSearch, cScopeFor
		LOCAL lusr1, lusr2, lusr3, lusr4, lusr5, lusr6, lusr7, lusr8, lusr9, lusr10, cAddToScope, l_lSearchAdrMain, l_cNear
		LOCAL l_cAdrMainScope, LAddrId, l_oAdrmain, l_lContinueAdrMainSerarch, l_cAdrMainAlias
		cScopeWhile=""
		l_cAdrMainScope = ""
		
		* First get updates from main server
		this.FAddressMask.oProcAddress.AdrMainChanges()
		
		SELECT addresstalias
		
		WITH this.AddressSearchDialog
			LCompany = upper(alltrim(.TAd_company.value))
			LCompkey = upper(trim(.TAd_compkey.value))
			LCompnum = .TAd_compnum.value
			LName = upper(trim(.TAd_lname.value))
			FName = upper(trim(.TAd_fname.value))
			LCity = upper(trim(.TAd_city.value))
			LMember = .TAd_member.value
			LAddrId = .TAd_addrid.value
			LAdrType = .TAd_adrtype.value
			LEmail = upper(trim(.TAd_email.value))
			lPhone = upper(trim(.TPhone.value))
			apart_= IIF(.chapartner.value=1,.t.,.f.)
			lExactSearch = IIF(.chexactsearch.value=1,.T.,.F.)
			FOR i=1 to 10
				lusr_='lusr'+allt(str(i))
				IF EVALUATE(".Tcheckbox"+ALLTRIM(STR(i+10))+".value")
					t_='.Tcheckbox'+allt(str(i))+'.value'
					&lusr_=thisformset.putcheckboxvalue(EVALUATE(t_))
				ELSE
					t_='.txtad_usr'+allt(str(i))+'.value'
					&lusr_=upper(ALLTRIM((&t_)))
				ENDIF
			NEXT
			LSearchAll= upper(trim(.TSearchAll.value))
			l_lSearchAdrMain = .chkmainserver.Value
		ENDWITH
		
		IF this.lodbc
			this.selectedtable = 'addr1'
			this.searchactive = .T.
			this.finishsearch = .F.
			this.setaddressgridsource()
			ZAP IN addr1
			this.setaddressgridsource(this.SelectedTable)
			this.opgde.addressgetdatareset()
			this.finishsearch = this.opgde.addressgetdatapaged(,,LCompany, LCompkey, LCompnum, LName, FName, LCity, LMember, LAddrId, LAdrType, LEmail, lPhone, apart_, lExactSearch, lusr1, lusr2, lusr3, lusr4, lusr5, lusr6, lusr7, lusr8, lusr9, lusr10, LSearchAll)
			this.addressgoto()
			RETURN .T.
		ENDIF
		
		i_="EMPTY(lCompany) AND EMPTY(lCompkey) AND EMPTY(lCompnum) AND EMPTY(lName) AND EMPTY(fName) AND EMPTY(lCity)"
		i_=i_+" AND EMPTY(lMember) AND EMPTY(LAddrId) AND EMPTY(LAdrType) AND EMPTY(lEmail) AND EMPTY(lPhone) AND EMPTY(lSearchall)"
		FOR i=1 to 10
			lusr_='lusr'+allt(str(i))
			i_=i_+'.and. empty('+lusr_+')'
		NEXT
		
		IF &i_
			* No filter
			this.searchactive = .F.
			this.selectedtable = 'address'
			SET ORDER TO tag1 IN address
		ELSE
		* record source - cursor addr
			lorder = ORDER('address')
			this.searchactive=.t.
			this.SetAddressGridSource()
			ZAP IN addr1
			SELECT addresstalias
			norder=0
			cseekexp=''
			cScopeFor=''
			cAddToScope = ''
			cscopeap=''
			csort= ''
			IF  !empty(LCompany)
				norder = 3
				csort= 'AD_COMPANY'
				cseekexp = alltrim(LCompany)
				IF lExactSearch
					cAddToScope = "UPPER(AD_COMPANY)+UPPER(AD_LNAME) = "+ "["+ALLTRIM(LCompany)+"]"
				ELSE
					cAddToScope = "["+ALLTRIM(LCompany)+"] $ UPPER(AD_COMPANY)"
				ENDIF
				cScopeFor = cAddToScope
				cScopeWhile=cScopeFor
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "UPPER(AD_COMPANY) = " + sqlcnv(ALLTRIM(LCompany)))
				ENDIF
			ENDIF
			IF  !empty(LCompkey)
				IF norder=0
					norder = 4
					csort = 'AD_COMPKEY'
					cseekexp = allt(LCompkey)
				else
					csort= csort+',ad_compkey'
				ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(AD_COMPKEY) = ["+ ALLTRIM(LCompkey)+"]"
				ELSE
					cAddToScope = "["+ ALLTRIM(LCompkey)+"] $ UPPER(AD_COMPKEY)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "ad_compkey = " + sqlcnv(ALLTRIM(LCompkey)))
				ENDIF
			ENDIF
			LCOMPNUM1=LCompnum
			IF  !empty(LCompnum+LCOMPNUM1)
				IF norder=0
					norder = 5
					CSEEKexp = LCompnum
					csort='ad_compnum'
				else
					csort=csort+',ad_compnum'
				ENDIF
				cAddToScope = 'between(ad_compnum,'+ALLTRIM(STR(LCompnum))+','+ALLTRIM(STR(LCOMPNUM1))+')'
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor= cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "ad_compnum = " + sqlcnv(LCompnum))
				ENDIF
			ENDIF
			lmember1=LMember
			IF  !empty(LMember+lmember1)
				IF norder=0
					norder = 6
					cseekexp = LMember
					csort='ad_member'
				else
					csort=csort+',ad_member'
				ENDIF
				cAddToScope = 'between(ad_member,'+ALLTRIM(STR(LMember))+','+ALLTRIM(STR(lmember1))+')'
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
			ENDIF
			LAddrId1=LAddrId
			IF  !empty(LAddrId+LAddrId1)
				IF norder=0
					norder = 1
					cseekexp = LAddrId
					csort='ad_addrid'
				else
					csort=csort+',ad_addrid'
				ENDIF
				cAddToScope = 'between(ad_addrid,'+ALLTRIM(STR(LAddrId1))+','+ALLTRIM(STR(LAddrId1))+')'
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
			ENDIF
			IF  !empty(LName)
				IF norder=0
					norder = 2
					cseekexp = alltrim(LName)
					csort='ad_lname'
				else
					csort=csort+',ad_lname'
				ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(AD_LNAME)+UPPER(AD_FNAME)+UPPER(AD_CITY) = ["+ ALLTRIM(LName)+"]"
				ELSE
					cAddToScope = "["+ALLTRIM(LName)+"] $ UPPER(AD_LNAME)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF apart_
					IF lExactSearch
						cAddToScope = "UPPER(ap_lname) = ["+ ALLTRIM(LName)+"]"
					ELSE
						cAddToScope = "["+ALLTRIM(LName)+"] $ UPPER(ap_lname)"
					ENDIF
					IF EMPTY(cscopeap)
						cscopeap = cAddToScope
					ELSE
						cscopeap=cscopeap+'.and.'+cAddToScope
					ENDIF
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "UPPER(ad_lname) = " + sqlcnv(ALLTRIM(LName)))
				ENDIF
			ENDIF
			IF  !empty(FName)
				IF norder=0
					norder = 21
					cseekexp = alltrim(FName)
					csort='ad_fname'
				else
					csort=csort+',ad_fname'
				ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(AD_FNAME) = ["+ ALLTRIM(FName)+"]"
				ELSE
					cAddToScope = "["+ALLTRIM(FName)+"] $ UPPER(AD_FNAME)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile=cScopeFor
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF apart_
					IF lExactSearch
						cAddToScope = "UPPER(ap_fname) = ["+ ALLTRIM(FName)+"]"
					ELSE
						cAddToScope = "["+ALLTRIM(FName)+"] $ UPPER(ap_fname)"
					ENDIF
					IF EMPTY(cscopeap)
						cscopeap = cAddToScope
					ELSE
						cscopeap=cscopeap+'.and.'+cAddToScope
					ENDIF
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "UPPER(ad_fname) = " + sqlcnv(ALLTRIM(FName)))
				ENDIF
			ENDIF
			IF  !empty(LCity)
				IF norder=0
					norder = 7
					cseekexp = alltrim(LCity)
					csort='ad_city'
		*		else
		*			IF norder = 2
		*				norder = 20
		*				cseekexp = alltrim(LName)
		*			ENDIF 
		*			csort=csort+',ad_city'
				ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(AD_CITY)+UPPER(AD_LNAME)+UPPER(AD_FNAME) = ["+ ALLTRIM(LCity)+"]"
				ELSE
					cAddToScope = "["+ALLTRIM(LCity)+"] $ UPPER(AD_CITY)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
					cScopeWhile = cAddToScope
				ELSE
		*			IF norder = 20 AND !EMPTY(LName)
		*				cScopeFor="UPPER(AD_LNAME)+UPPER(AD_CITY)='"+ alltrim(LName)+"' .and. UPPER(AD_CITY) = '" + alltrim(LCity)+"'"
		*				cScopeWhile="UPPER(AD_LNAME) ='"+ alltrim(LName)+"'"
		*			ELSE
						cScopeFor=cScopeFor+'.and.'+cAddToScope
		*			ENDIF
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "UPPER(ad_city) = " + sqlcnv(ALLTRIM(LCity)))
				ENDIF
			ENDIF
			IF  !empty(LAdrType)
				cAddToScope = "ad_adrtype = " + sqlcnv(ALLTRIM(LAdrType),.T.)
				cScopeFor = cScopeFor + IIF(EMPTY(cScopeFor), '', ' AND ') + cAddToScope
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "ad_adrtype = " + sqlcnv(ALLTRIM(LAdrType),.T.))
				ENDIF
			ENDIF
			IF !empty(LEmail)
				IF norder=0
					norder=19
		*			cseekexp=allt(LEmail)
		*			csort='ad_email'
				else
					csort=csort+',ad_email'
				ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(ad_email)=["+LEmail+"]"
				ELSE
					cAddToScope = "["+LEmail+"] $ UPPER(ad_email)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF apart_
					IF lExactSearch
						cAddToScope = "UPPER(ap_email)=["+LEmail+"]"
					ELSE
						cAddToScope = "["+LEmail+"] $ UPPER(ap_email)"
					ENDIF
					IF EMPTY(cscopeap)
						cscopeap = cAddToScope
					ELSE
						cscopeap=cscopeap+'.and.'+cAddToScope
					ENDIF
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "UPPER(ad_email) = " + sqlcnv(ALLTRIM(LEmail)))
				ENDIF
			ENDIF
			IF !empty(LPhone)
		*		IF norder=0
		*			norder = 8
		*			cseekexp = alltrim(LPhone)
		*			csort='ad_phone'
		*		else
					csort=csort+',ad_phone'
		*		ENDIF
				IF lExactSearch
					cAddToScope = "UPPER(ad_phone)=["+LPhone+"]"
				ELSE
					cAddToScope = "["+LPhone+"] $ UPPER(ad_phone)"
				ENDIF
				IF empty(cScopeFor)
					cScopeFor = cAddToScope
				ELSE
					cScopeFor=cScopeFor+'.and.'+cAddToScope
				ENDIF
				IF apart_
					IF lExactSearch
						cAddToScope = "UPPER(ap_phone1)=["+LPhone+"]"
					ELSE
						cAddToScope = "["+LPhone+"] $ UPPER(ap_phone1)"
					ENDIF
					IF EMPTY(cscopeap)
						cscopeap = cAddToScope
					ELSE
						cscopeap=cscopeap+'.and.'+cAddToScope
					ENDIF
				ENDIF
				IF l_lSearchAdrMain
					l_cAdrMainScope = sqland(l_cAdrMainScope, "ad_phone = " + sqlcnv(ALLTRIM(LPhone)))
				ENDIF
			ENDIF
			FOR i=1 to 10
				lusr_='lusr'+allt(str(i))
				IF  !empty(&lusr_)
					IF norder=0
						norder = 7+i
						cseekexp = alltrim(&lusr_)
						csort='&lusr_'
					else
						csort=csort+',&lusr_'
					ENDIF
					IF lExactSearch
						cAddToScope = "UPPER(AD_USR" + ALLTRIM(STR(i)) + ") = ["+ ALLTRIM(&lusr_)+"]"
					ELSE
						cAddToScope = "["+ ALLTRIM(&lusr_)+"] $ UPPER(AD_USR" + ALLTRIM(STR(i))+")"
					ENDIF
					IF empty(cScopeFor)
						cScopeFor = cAddToScope
						cScopeWhile = cAddToScope
					ELSE
						cScopeFor=cScopeFor+'.and.'+cAddToScope
					ENDIF
				ENDIF
			NEXT
			IF empty(cScopeFor)
				cScopeFor = '.T.'
			ENDIF
			IF empty(cscopeAP)
				cscopeAP = '.F.'
			ENDIF
			IF norder=0
		*this will be true only if just phone number is entered and nothing else
				norder = 2
			ENDIF
			IF !empty(LSearchAll)
				cseekexp = ''
				norder=0
				IF lExactSearch
					TEXT TO cScopeFor TEXTMERGE NOSHOW PRETEXT 15
						UPPER(ad_company) = '%s' OR 
						UPPER(ad_compkey) = '%s' OR 
						UPPER(ad_lname) = '%s' OR 
						UPPER(ad_fname) = '%s' OR 
						UPPER(ad_city)+UPPER(ad_lname)+UPPER(ad_fname) = '%s' OR 
						UPPER(ad_street) = '%s' OR 
						UPPER(ad_street2) = '%s' OR 
						UPPER(ad_usr1) = '%s' OR 
						UPPER(ad_usr2) = '%s' OR 
						UPPER(ad_usr3) = '%s' OR 
						UPPER(ad_usr4) = '%s' OR 
						UPPER(ad_usr5) = '%s' OR 
						UPPER(ad_usr6) = '%s' OR 
						UPPER(ad_usr7) = '%s' OR 
						UPPER(ad_usr8) = '%s' OR 
						UPPER(ad_usr9) = '%s' OR 
						UPPER(ad_usr10) = '%s' OR 
						UPPER(ad_departm) = '%s' OR 
						UPPER(ad_email) = '%s' OR 
						UPPER(ad_website) = '%s' OR 
						UPPER(ad_mail1) = '%s' OR 
						UPPER(ad_mail2) = '%s' OR 
						UPPER(ad_mail3) = '%s' OR 
						UPPER(ad_mail4) = '%s' OR 
						UPPER(ad_mail5) = '%s' OR 
						UPPER(ad_country) = '%s' OR 
						UPPER(ad_state) = '%s' OR 
						UPPER(ad_zip) = '%s' OR 
						UPPER(ad_phone) = '%s' OR 
						UPPER(ad_phone2) = '%s' OR 
						UPPER(ad_phone3) = '%s' OR 
						UPPER(ad_fax) = '%s' OR 
						UPPER(ad_ratecod) = '%s' OR 
						UPPER(get_rm_rmname(ad_roomnum)) = '%s' OR 
						UPPER(ad_userid) = '%s'
					ENDTEXT
					cScopeFor = STRTRAN(cScopeFor, "%s", LSearchAll)
						 	
					TEXT TO cscopeap TEXTMERGE NOSHOW PRETEXT 15
						UPPER(ap_lname) = '%s' OR 
						UPPER(ap_fname) = '%s' OR 
						UPPER(ap_phone1) = '%s' OR 
						UPPER(ap_phone2) = '%s' OR 
						UPPER(ap_fax) = '%s' OR 
						UPPER(ap_mail1) = '%s' OR 
						UPPER(ap_email) = '%s' OR 
						'%s' $ UPPER(ap_note)
					ENDTEXT
					cscopeap = STRTRAN(cscopeap, "%s", LSearchAll)
				ELSE
					TEXT TO cScopeFor TEXTMERGE NOSHOW PRETEXT 15
						'%s' $ UPPER(ad_company) OR 
						'%s' $ UPPER(ad_compkey) OR 
						'%s' $ UPPER(ad_lname) OR 
						'%s' $ UPPER(ad_fname) OR 
						'%s' $ UPPER(ad_city) OR 
						'%s' $ UPPER(ad_street) OR 
						'%s' $ UPPER(ad_street2) OR 
						'%s' $ UPPER(ad_usr1) OR 
						'%s' $ UPPER(ad_usr2) OR 
						'%s' $ UPPER(ad_usr3) OR 
						'%s' $ UPPER(ad_usr4) OR 
						'%s' $ UPPER(ad_usr5) OR 
						'%s' $ UPPER(ad_usr6) OR 
						'%s' $ UPPER(ad_usr7) OR 
						'%s' $ UPPER(ad_usr8) OR 
						'%s' $ UPPER(ad_usr9) OR 
						'%s' $ UPPER(ad_usr10) OR 
						'%s' $ UPPER(ad_departm) OR 
						'%s' $ UPPER(ad_email) OR 
						'%s' $ UPPER(ad_website) OR 
						'%s' $ UPPER(ad_mail1) OR 
						'%s' $ UPPER(ad_mail2) OR 
						'%s' $ UPPER(ad_mail3) OR 
						'%s' $ UPPER(ad_mail4) OR 
						'%s' $ UPPER(ad_mail5) OR 
						'%s' $ UPPER(ad_country) OR 
						'%s' $ UPPER(ad_state) OR 
						'%s' $ UPPER(ad_zip) OR 
						'%s' $ UPPER(ad_phone) OR 
						'%s' $ UPPER(ad_phone2) OR 
						'%s' $ UPPER(ad_phone3) OR 
						'%s' $ UPPER(ad_fax) OR 
						'%s' $ UPPER(ad_ratecod) OR 
						'%s' $ UPPER(get_rm_rmname(ad_roomnum)) OR 
						'%s' $ UPPER(ad_userid)
					ENDTEXT
					cScopeFor = STRTRAN(cScopeFor, "%s", LSearchAll)
					
					TEXT TO cscopeap TEXTMERGE NOSHOW PRETEXT 15
						'%s' $ UPPER(ap_lname) OR 
						'%s' $ UPPER(ap_fname) OR 
						'%s' $ UPPER(ap_phone1) OR 
						'%s' $ UPPER(ap_phone2) OR 
						'%s' $ UPPER(ap_fax) OR 
						'%s' $ UPPER(ap_mail1) OR 
						'%s' $ UPPER(ap_email) OR 
						'%s' $ UPPER(ap_note)
					ENDTEXT
					cscopeap = STRTRAN(cscopeap, "%s", LSearchAll)
				ENDIF
			ENDIF
			WaitWindowShow(GetLangText("COMMON", "T_PLEASEWAIT"))
			this.FAddressMask.LockScreen = .T.
			this.fAddressMask.MousePointer = 99
			IF NOT lExactSearch
				cScopeWhile = ""
			ENDIF
			thisformset.cscope=cScopeFor
			thisformset.cScopewhile=cScopeWhile
			thisformset.norder=norder
			thisformset.apart=apart_
			thisformset.cscopeap=cscopeap
		
			SELECT address
			IF norder!=0
				LMar ="SET ORDER TO TAG" + ALLTRIM(STR(norder))
				&LMar
				IF lExactSearch
					SEEK(cseekexp)
				ELSE
					GO TOP
				ENDIF
			ENDIF
			lnFoundAddressCounter=0
			IF !empty(LSearchAll)
				SCAN for &cScopeFor WHILE lnFoundAddressCounter<100
					lnFoundAddressCounter=lnFoundAddressCounter+1
					SCATTER memvar
					INSERT into addr1 from memvar
					REPLACE	rn with recno('address') in addr1
				ENDSCAN
			ELSE
				IF EMPTY(cScopeWhile)
					SCAN REST for &cScopeFor WHILE lnFoundAddressCounter<100
						lnFoundAddressCounter=lnFoundAddressCounter+1
						SCATTER memvar
						INSERT into addr1 from memvar
						REPLACE	rn with recno('address') in addr1
					ENDSCAN
				ELSE
					SCAN REST for &cScopeFor WHILE (lnFoundAddressCounter<100) AND &cScopeWhile
						lnFoundAddressCounter=lnFoundAddressCounter+1
						SCATTER memvar
						INSERT into addr1 from memvar
						REPLACE	rn with recno('address') in addr1
					ENDSCAN
				ENDIF
			ENDIF
		
			thisformset.nrecno=RECNO()
			this.finishsearch = (lnFoundAddressCounter < 100)
		* search apartner table
			IF apart_
				SELECT apartner1
				SCAN FOR &cscopeap
					SELECT addr1
					LOCATE FOR ad_addrid=address2.ad_addrid
					IF !FOUND()
						SELECT address2
						IF !EOF('address2')
							SCATTER memvar
							INSERT INTO addr1 FROM memvar
							replace rn WITH RECNO('address2') IN addr1
							lnFoundAddressCounter=lnFoundAddressCounter+1
						endif
					endif
					SELECT apartner1
				ENDSCAN
			ENDIF
			IF l_lSearchAdrMain AND NOT EMPTY(l_cAdrMainScope)
				l_lContinueAdrMainSerarch = .T.
				IF _screen.oGlobal.lmainserverremote
					l_cAdrMainAlias = "adrmacl19q"
					dclose("adrmacl19q")
					sqlcursor("SELECT * FROM __#SRV.ADRMAIN#__ WHERE " + l_cAdrMainScope, "adrmacl19q")
					IF NOT USED("adrmacl19q")
						l_lContinueAdrMainSerarch = .F.
					ENDIF
				ELSE
					l_cAdrMainAlias = "adrmain"
				ENDIF
				IF l_lContinueAdrMainSerarch
					SELECT (l_cAdrMainAlias)
					SCAN FOR &l_cAdrMainScope
						SELECT addr1
						LOCATE FOR ad_adid=&l_cAdrMainAlias..ad_adid
						IF !FOUND()
							SELECT (l_cAdrMainAlias)
							SCATTER MEMO NAME l_oAdrmain
							l_oAdrmain.ad_company = "*" + l_oAdrmain.ad_company
							l_oAdrmain.ad_lname = "*" + l_oAdrmain.ad_lname
							INSERT INTO addr1 FROM NAME l_oAdrmain
							lnFoundAddressCounter=lnFoundAddressCounter+1
						ENDIF
					ENDSCAN
				ENDIF
			ENDIF
		
			this.searchactive = (lnFoundAddressCounter > 0)
			this.selectedtable = IIF(this.searchactive, 'addr1', 'address')
			l_lMessage = (lnFoundAddressCounter = 0)
		ENDIF
		this.SetAddressGridSource(this.selectedtable)
		
		WaitWindowClear()
		this.FAddressMask.LockScreen = .F.
		this.fAddressMask.MousePointer = 0
		
		IF l_lMessage
			Alert(GetLangText("ADDRESS","TXT_GOTOP"))
			IF NOT EMPTY(cseekexp) AND lExactSearch
				l_cNear = SET("Near")
				SET NEAR ON
				=SEEK(cseekexp,"address")
				SET NEAR &l_cNear
				this.addressgoto()
			ELSE
				SET ORDER TO 1 IN address
				this.addressgotop()
			ENDIF
		ELSE
			this.addressgotop()
		ENDIF
	ENDPROC

	PROCEDURE searchaddresstablecustom
		LPARAMETERS lp_cSearchPhone
		LOCAL lnFoundAddressCounter, l_cPhoneAddrCur, l_lMessage
		IF EMPTY(lp_cSearchPhone)
			RETURN .T.
		ENDIF
		
		this.searchactive=.t.
		this.SetAddressGridSource()
		ZAP IN addr1
		SELECT addresstalias
		
		lnFoundAddressCounter = 0
		l_cPhoneAddrCur = ""
		
		WaitWindowShow(GetLangText("COMMON", "T_PLEASEWAIT"))
		
		l_cPhoneAddrCur = PAGetAddrIdForPhoneNumberInCursor(lp_cSearchPhone)
		SELECT (l_cPhoneAddrCur)
		SCAN FOR SEEK(aj_addrid, "address" , "tag1")
			SELECT address
			lnFoundAddressCounter=lnFoundAddressCounter+1
			SCATTER memvar
			INSERT into addr1 from memvar
			REPLACE rn with recno('address') in addr1
		ENDSCAN
		dclose(l_cPhoneAddrCur)
		
		this.searchactive = (lnFoundAddressCounter > 0)
		this.selectedtable = IIF(this.searchactive, 'addr1', 'address')
		l_lMessage = (lnFoundAddressCounter = 0)
		
		this.SetAddressGridSource(this.selectedtable)
		
		WaitWindowClear()
		
		IF l_lMessage
			Alert(GetLangText("ADDRESS","TXT_GOTOP"))
			SET ORDER TO 1 IN address
			this.addressgotop()
		ELSE
			this.addressgotop()
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE searchengine
		LOCAL r_, a_, o_, c_, cw_, cp_
		LOCAL l_nLastRecord, l_nRecno
		
		If !Thisformset.finishsearch
		*	WAIT WINDOW NOWAIT "Search engine"
			IF this.lodbc
				l_nLastRecord = EVALUATE(thisformset.SelectedTable + ".rn")
				l_nRecno = RECNO(thisformset.SelectedTable)
				
				this.finishsearch = this.opgde.addressgetdatapaged()
				GO l_nRecno IN (thisformset.SelectedTable)
				this.opgde.addressgetdata("ad_addrid = " + TRANSFORM(l_nLastRecord))
				this.fAddressMask.MainPage.PageGridAddress.AddressGrid.Refresh()
			*	this.addressgotop()
				RETURN .T.
			ENDIF
			Thisformset.finishsearch= .T.
		
			a_=Alias()
			r_=RECNO()
			Select address
			o_=Sys(22)
			Set Order To Thisformset.norder
			Go Thisformset.nrecno
			broj=0
			c_=Thisformset.cscope
			cw_=Thisformset.cscopewhile
			cp_=Thisformset.cscopeap
			Wait Window GetLangText("COMMON", "T_PLEASEWAIT") Nowait
			IF EMPTY(cw_)
				Scan For &c_ Rest While broj<100
					broj=broj+1
					Scatter Memvar
					If broj>1
						Insert Into addr1 From Memvar
						Replace	rn With Recno('address') In addr1
					Endif
				ENDSCAN
			ELSE
				Scan For &c_ Rest While broj<100 AND &cw_
					broj=broj+1
					Scatter Memvar
					If broj>1
						Insert Into addr1 From Memvar
						Replace	rn With Recno('address') In addr1
					Endif
				ENDSCAN
			ENDIF
			Thisformset.nrecno=Recno()
		* search apartner table
			If Thisformset.apart
				Select apartner1
				Scan For &cp_
					Select addr1
					Locate For ad_addrid=address2.ad_addrid
					If !Found()
						Select address2
						If !Eof('address2')
							Scatter Memvar
							Insert Into addr1 From Memvar
							Replace rn With Recno('address2') In addr1
						Endif
					Endif
					Select apartner1
				Endscan
				Select address
			Endif
			Wait Clear
			Select address
			Set Order To Tag &o_
			Select &a_
			GO r_
		* found all records that match criteria
			Thisformset.finishsearch = (broj < 100)
			IF this.fAddressMask.mainPage.ActivePage = 2
				Thisformset.faddressMask.mainPage.pageGridAddress.Refresh
				Thisformset.faddressMask.mainPage.pageGridAddress.SetFocus
			endif
			Select &a_
			GO r_
			this.SelectAddress()
		Endif
		
	ENDPROC

	PROCEDURE selectaddress
		LOCAL l_cGridSourceAlias, l_nArea, l_nRecno
		
		l_nArea = SELECT()
		
		IF TYPE("this.fAddressMask.MainPage.PageGridAddress.AddressGrid") = "O"
			* On destroy event sometime occures afterrowcolchange event and grid object already released.
			l_cGridSourceAlias = this.fAddressMask.MainPage.PageGridAddress.AddressGrid.RecordSource
		ELSE
			RETURN
		ENDIF
		
		SELECT address
		DO CASE
			CASE EMPTY(l_cGridSourceAlias) OR LOWER(l_cGridSourceAlias) == "address"
			CASE EMPTY(&l_cGridSourceAlias..rn)
				IF this.lOdbc
					this.opgde.AddressGetData("0=1")
				ELSE
					GO BOTTOM
					SKIP
				ENDIF
			OTHERWISE
				IF this.lOdbc
					this.opgde.AddressGetData("ad_addrid = " + TRANSFORM(&l_cGridSourceAlias..rn))
				ELSE
					GO &l_cGridSourceAlias..rn
				ENDIF
		ENDCASE
		IF this.lOdbc
			this.SetApartnerGridSource()
			CursorQuery("apartner", "ap_apid <> -9999 AND ap_addrid = " + SqlCnv(&l_cGridSourceAlias..ad_addrid,.T.),,,,"tag1")
			this.SetApartnerGridSource("apartner")
		ENDIF
		SELECT &l_cGridSourceAlias
		l_nRecno = RECNO()
		SKIP -1
		this.nFirstlastrecord = IIF(BOF(), BITSET(this.nFirstlastrecord,0), BITCLEAR(this.nFirstlastrecord,0))
		GO l_nRecno
		SKIP
		this.nFirstlastrecord = IIF(EOF(), BITSET(this.nFirstlastrecord,1), BITCLEAR(this.nFirstlastrecord,1))
		GO l_nRecno
		
		this.FAddressMask.oProcAddress.AddressSetFeatures(address.ad_addrid, this.FAddressMask.MainPage.pageAddress.InfoPage.pagGuestInfo.stxtFeature.curSelect, .T.)
		this.FAddressMask.MainPage.pageAddress.InfoPage.pagGuestInfo.stxtFeature.RefreshValue()
		
		this.FAddressMask.ActivateToolbar()
		
		SELECT (l_nArea)
	ENDPROC

	PROCEDURE selectformexit
		WITH this.selectForm
		if NOT IsNull(.NextObj1)
			if .NextObj1.Visible AND .NextObj1.Enabled
				.NextObj1.SetFocus()
			else
				if NOT IsNull(.NextObj2)
					.NextObj2.SetFocus()
				endif
			endif
		endif
		ENDWITH
	ENDPROC

	PROCEDURE setaddressgridsource
		LPARAMETERS lp_cGridRecordSource
		LOCAL l_cOldRecordSource
		
		WITH this.fAddressMask.MainPage.PageGridAddress.AddressGrid
			lp_cGridRecordSource = EVL(lp_cGridRecordSource,"")
			l_cOldRecordSource = .RecordSource
			IF NOT l_cOldRecordSource == lp_cGridRecordSource
				IF this.lodbc
					IF NOT EMPTY(l_cOldRecordSource) AND NOT EMPTY(TARGET(1, l_cOldRecordSource))
						SET RELATION OFF INTO apartner IN &l_cOldRecordSource
					ENDIF
					IF NOT EMPTY(lp_cGridRecordSource) AND EMPTY(TARGET(1, lp_cGridRecordSource))
						SET RELATION TO ad_addrid INTO apartner IN &lp_cGridRecordSource ADDITIVE
					ENDIF
				ENDIF
				.RecordSource = lp_cGridRecordSource
				IF NOT EMPTY(lp_cGridRecordSource)
					.Column1.ControlSource = lp_cGridRecordSource+'.ad_compkey'
					.Column2.ControlSource = lp_cGridRecordSource+'.ad_company'
					.Column3.ControlSource = 'RTrim('+lp_cGridRecordSource+'.ad_lname) + ", " + RTrim('+lp_cGridRecordSource+'.ad_fname)'
					.Column4.ControlSource = lp_cGridRecordSource+'.ad_title'
					.Column5.ControlSource = lp_cGridRecordSource+'.ad_street'
					.Column6.ControlSource = lp_cGridRecordSource+'.ad_zip'
					.Column7.ControlSource = lp_cGridRecordSource+'.ad_city'
					.Column8.ControlSource = lp_cGridRecordSource+'.ad_phone'
					.Column9.ControlSource = 'thisformset.GetReferral("XC")'
					.Column10.ControlSource = 'thisformset.GetReferral("XI")'
					.Column11.ControlSource = 'thisformset.GetReferral("MA")'
					.Column12.ControlSource = 'thisformset.GetReferral("OT")'
					.Column13.ControlSource = 'thisformset.OnSelectAddress()'
					.Column14.ControlSource = lp_cGridRecordSource+'.ad_departm'
					.Column15.ControlSource = lp_cGridRecordSource+'.ad_compnum'
				ENDIF
			ENDIF
		ENDWITH
	ENDPROC

	PROCEDURE setapartnergridsource
		LPARAMETERS lp_cGridRecordSource
		LOCAL l_cAdrAlias, l_cAdrTarget
		
		WITH this.fAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid
			lp_cGridRecordSource = EVL(lp_cGridRecordSource,"")
			IF NOT .RecordSource == lp_cGridRecordSource
				IF this.lodbc
					l_cAdrAlias = this.fAddressMask.MainPage.PageGridAddress.AddressGrid.RecordSource
					IF NOT EMPTY(l_cAdrAlias)
						l_cAdrTarget = TARGET(1, l_cAdrAlias)
						DO CASE
							CASE EMPTY(lp_cGridRecordSource) AND NOT EMPTY(l_cAdrTarget)
								SET RELATION OFF INTO &l_cAdrTarget IN &l_cAdrAlias
							CASE NOT EMPTY(lp_cGridRecordSource) AND EMPTY(l_cAdrTarget)
								SET RELATION TO ad_addrid INTO &lp_cGridRecordSource IN &l_cAdrAlias ADDITIVE
							OTHERWISE
						ENDCASE
					ENDIF
				ENDIF
				.RecordSource = lp_cGridRecordSource
				IF NOT EMPTY(lp_cGridRecordSource)
					.Column1.ControlSource = lp_cGridRecordSource+'.ap_title'
					.Column2.ControlSource = lp_cGridRecordSource+'.ap_fname'
					.Column3.ControlSource = lp_cGridRecordSource+'.ap_lname'
					.Column4.ControlSource = lp_cGridRecordSource+'.ap_phone1'
					.Column5.ControlSource = lp_cGridRecordSource+'.ap_phone2'
					.Column6.ControlSource = lp_cGridRecordSource+'.ap_fax'
					.Column7.ControlSource = lp_cGridRecordSource+'.ap_email'
					.Column8.ControlSource = lp_cGridRecordSource+'.ap_vip1'
					.Column9.ControlSource = lp_cGridRecordSource+'.ap_gebdate'
					.Column10.ControlSource = lp_cGridRecordSource+'.ap_user1'
					.Column11.ControlSource = lp_cGridRecordSource+'.ap_user2'
					.Column12.ControlSource = lp_cGridRecordSource+'.ap_user3'
					.Column13.ControlSource = lp_cGridRecordSource+'.ap_salute'
				ENDIF
			ENDIF
		ENDWITH
	ENDPROC

	PROCEDURE setbonuspoints
		LOCAL l_oBMSHandler, l_nBb_bbid, l_nCollectedPoints, l_nAvailablePoints, l_nSpentPoints
		
		IF _screen.BMS
			l_oBMSHandler = NEWOBJECT("cBMSHandler", "common\progs\bmshandler.prg", "", SysDate(), g_userid, 1, ;
				_screen.oGlobal.oParam2.pa_bmstype, _screen.oGlobal.oParam2.pa_bsdays)
			l_nBb_bbid = l_oBMSHandler.GetBonusAccountByAddress(this.DataCopy.ad_addrid, this.DataCopy.ad_adid)
			IF l_nBb_bbid > 0
				l_oBMSHandler.GetBonusPoints(l_nBb_bbid, @l_nAvailablePoints, @l_nCollectedPoints, @l_nSpentPoints)
			ELSE
				STORE 0 TO l_nCollectedPoints, l_nAvailablePoints, l_nSpentPoints
			ENDIF
			this.FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtCollectedPoints.Value = l_nCollectedPoints
			this.FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtTotalPoints.Value = l_nAvailablePoints
			this.FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtbmsaccount.Value = l_nBb_bbid
		ENDIF
	ENDPROC

	PROCEDURE setcontrolsourcetogrid		&& Set stored settings to grid object
		WITH thisformset.FAddressMask.MainPage.PageAddress.SlavePage.pageRevnue.revnueGrid
			.RecordSource = this.gridcontrolsource
			FOR i = 1 TO .ColumnCount
				.columns(i).header1.caption = this.aaolumns(i,1)
				.columns(i).controlsource = this.aaolumns(i,2)
			NEXT
		ENDWITH
		
	ENDPROC

	PROCEDURE takecontrolsource		&& Store Grid deginition to array, for later restore
		WITH thisformset.FAddressMask.MainPage.PageAddress.SlavePage.pageRevnue.revnueGrid
			this.gridcontrolsource = .RecordSource
			FOR i = 1 TO .ColumnCount
				this.aaolumns(i,1)=.columns(i).header1.caption
				this.aaolumns(i,2)=.columns(i).controlsource
			NEXT
		ENDWITH
		
	ENDPROC

	PROCEDURE Unload
		DO CASE
			CASE TYPE("this.mode") <> "N"
			CASE this.mode=1
				* bill instruction - company
				this.oReferenceToCallingObject.l_id2=address.ad_addrid
				this.oReferenceToCallingObject.l_lname2=UPPER(ALLTRIM(address.ad_company))
				this.oReferenceToCallingObject.l_instr2=address.ad_billins
				this.oReferenceToCallingObject.Enabled=.T.
				this.oReferenceToCallingObject.Refresh()
			CASE this.mode=2
				* bill instruction - name
				this.oReferenceToCallingObject.l_id3=address.ad_addrid
				this.oReferenceToCallingObject.l_lname3=UPPER(ALLTRIM(address.ad_lname))
				this.oReferenceToCallingObject.l_instr3=address.ad_billins
				this.oReferenceToCallingObject.Enabled=.T.
				this.oReferenceToCallingObject.Refresh()
			Case This.MODe=3
		* RESERVATION - NAME
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					LOCAL l_nRefCompid, l_nRefInvId
					l_nRefCompid = this.m_ConnectReferralToReservation(address.ad_addrid, "XC")
					l_nRefInvId = this.m_ConnectReferralToReservation(address.ad_addrid, "XI")
					this.oReferenceToCallingObject.Parent.SetNameFromAddress(address.ad_addrid, l_nRefCompid, l_nRefInvId)
				ENDIF
			Case This.MODe=4
		* RESERVATION - COMPANY
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					this.oReferenceToCallingObject.Parent.SetCompanyFromAddress(address.ad_addrid)
				ENDIF
			Case This.MODe=5
		* RESERVATION - INVOICE
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					this.oReferenceToCallingObject.Parent.SetInvoiceFromAddress(address.ad_addrid, address.ad_company, address.ad_lname)
				ENDIF
			Case This.MODe=6
		* RESERVATION - AGENT
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					this.oReferenceToCallingObject.Parent.SetAgentFromAddress(address.ad_addrid)
				ENDIF
			CASE this.mode=9
		* RESERVATION - SNAME
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					this.oReferenceToCallingObject.Parent.SetSNameFromAddress(address.ad_addrid)
				ENDIF
			Case Inlist(This.MODe,7,8)
		* QUICK RESERVATION
				IF TYPE("this.oReferenceToCallingObject.Parent") = "O" AND NOT ISNULL(this.oReferenceToCallingObject.Parent)
					this.oReferenceToCallingObject.Parent.mAddressSelected(address.ad_addrid)
				ENDIF
			CASE this.mode=10
		* CallAddressForm - Name
				FOR i=1 TO _screen.formCount
					IF UPPER(ALLTRIM(_screen.forms(i).name))=='CALLADDRESSFORM'
						_screen.forms(i).ttname.value = address.ad_lname
						_SCREEN.FORms(I).ENABLED=.T.
						_SCREEN.FORMS(I).ttname.SETFOCUS
						_Screen.Forms(I).Refresh
					ENDIF
				next
			CASE this.mode=11
		* CallAddressForm - Company
				FOR i=1 TO _screen.formCount
					IF UPPER(ALLTRIM(_screen.forms(i).name))=='CALLADDRESSFORM'
						_screen.forms(i).ttcompany.value = address.ad_company
						IF TYPE("thisformset.selapid") <> "U" AND thisformset.selapid > 0 
							_screen.forms(i).parent.apid = thisformset.selap(thisformset.selapid,1)
						ELSE
							_screen.forms(i).parent.apid = 0
						ENDIF
						_SCREEN.FORms(I).ENABLED=.T.
						_SCREEN.FORMS(I).ttcompany.SETFOCUS
						_Screen.Forms(I).Refresh
					ENDIF
				next
			CASE this.mode=12
		* A/R Accounts, edit
				IF TYPE("this.oReferenceToCallingObject") = "O" AND NOT ISNULL(this.oReferenceToCallingObject)
					this.oReferenceToCallingObject.SetAddress(address.ad_addrid)
				ENDIF
			CASE this.mode=13
		* A/R Accounts, address
				FOR i=1 TO _screen.formCount
					IF TYPE('_screen.forms(i).formname')='C' .and. ;
							((upper(ALLTRIM(_screen.forms(i).formname))=='ARACCOUNTSFORM' OR upper(ALLTRIM(_screen.forms(i).formname))=='CRACCOUNTSFORM').AND. UPPER(ALLTRIM(_screen.forms(i).name))=='FORMARACCOUNTS')
						LOCAL lcAddress
						_SCREEN.FORms(I).ENABLED=.T.
						_Screen.Forms(I).Refresh
					ENDIF
				next
			CASE this.mode = 14 OR this.mode = 15 OR this.mode = 17
				* Address mask is called from:
				*(Bills;cmdBillins) OR (PostPay;m_address) OR (vouchers;m_edit)
				IF NOT this.lOkCommand
					LOCAL l_cYesNo
					IF this.mode = 14
						l_cYesNo = GetLangText("BILL","TXT_SAVE_QUESTION")
					ELSE
						l_cYesNo = GetLangText("BILL","TXT_SAVE_ADDRESS")
					ENDIF
					this.lOkCommand = yesno(l_cYesNo)
				ENDIF
				IF this.lOkCommand
					IF this.mode = 17
						this.oReferenceToCallingObject.Parent.SetAddress(address.ad_addrid)
					ELSE
						this.oReferenceToCallingObject.SetAddress(address.ad_addrid)
					ENDIF
				ENDIF
				IF this.mode = 14
					this.oReferenceToCallingObject.Parent.Enabled = .T.
				ELSE
					this.oReferenceToCallingObject.Enabled = .T.
					IF this.mode = 15
						this.oReferenceToCallingObject.AlwaysOnTop = .T.
					ENDIF
				ENDIF
			CASE this.mode = 16
				this.oReferenceToCallingObject.AlwaysOnTop = .T.
				this.oReferenceToCallingObject.Enabled = .T.
				this.oReferenceToCallingObject.parent.m_FindNewAddress(address.ad_addrid)
			CASE this.mode = 18
				IF yesno(GetLangText("BILL","TXT_SAVE_QUESTION"))
					this.oReferenceToCallingObject.SetAddress(1, address.ad_addrid)
				ENDIF
				LOCAL l_lZapCursor, l_lBrowseFromSelected
				l_lZapCursor = .T.
				l_lBrowseFromSelected = .T.
				this.oReferenceToCallingObject.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
				this.oReferenceToCallingObject.Enabled = .T.
			CASE this.mode = 19
				IF yesno(GetLangText("BILL","TXT_SAVE_QUESTION"))
					this.oReferenceToCallingObject.SetAddress(2, address.ad_addrid)
				ENDIF
				LOCAL l_lZapCursor, l_lBrowseFromSelected
				l_lZapCursor = .T.
				l_lBrowseFromSelected = .T.
				this.oReferenceToCallingObject.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
				this.oReferenceToCallingObject.Enabled = .T.
			CASE this.mode = 20
				this.oReferenceToCallingObject.OnAddressMaskClose(address.ad_addrid)
			CASE this.mode = 21 AND TYPE("this.oReferenceToCallingObject.oAddress") = "O"
				this.oReferenceToCallingObject.Enabled = .T.
				IF this.lOKCommand
					this.oReferenceToCallingObject.refreshlist("ADDR", address.ad_addrid)
				ENDIF
			CASE this.mode = 22 AND TYPE("this.oReferenceToCallingObject.oAddress") = "O"
				this.oReferenceToCallingObject.Enabled = .T.
				IF this.lOKCommand
					this.oReferenceToCallingObject.refreshlist("COMP", address.ad_addrid)
				ENDIF
			CASE this.mode = 23
				* quck roomplan rentmode - name
				this.oReferenceToCallingObject.Border3.cntEditReservation.oCheckReservat.rs_addrid_change("reservat", address.ad_addrid)
				this.oReferenceToCallingObject.Enabled = .T.
				this.oReferenceToCallingObject.Border3.cntEditReservation.Refresh()
			CASE INLIST(this.mode, 24, 25)
				* Select addresses
				LOCAL l_oCallRef, l_oCol AS Collection, l_nSelect, l_cMethodToCall
				IF this.mode = 24
					l_cMethodToCall = "onselectedaddresses"
				ELSE
					l_cMethodToCall = "onselectedreferrals"
				ENDIF
				STORE .NULL. TO l_oCallRef, l_oCol
				IF TYPE("this.oReferenceToCallingObject") = "O"
					this.oReferenceToCallingObject.Enabled = .T.
					IF NOT PEMSTATUS(this.oReferenceToCallingObject,l_cMethodToCall,5)
						IF TYPE("this.oReferenceToCallingObject.Parent") = "O"
							* formset
							IF PEMSTATUS(this.oReferenceToCallingObject.Parent,l_cMethodToCall,5)
								l_oCallRef = this.oReferenceToCallingObject.Parent
							ENDIF
						ENDIF
					ELSE
						* form
						l_oCallRef = this.oReferenceToCallingObject
					ENDIF
				ENDIF
				IF NOT ISNULL(l_oCallRef)
					IF this.lAddressesForDeleteSelected
						l_nSelect = SELECT()
						l_oCol = CREATEOBJECT("Collection")
						SELECT (this.cCurSelectedAddresses)
						SCAN FOR cur_selected
							l_oCol.Add(cur_addrid)
						ENDSCAN
						SELECT (l_nSelect)
					ENDIF
					EVALUATE("l_oCallRef."+l_cMethodToCall+"(l_oCol)")
					l_oCol = .NULL.
				ENDIF
			CASE this.mode = 26
				* Conference guests
				this.oReferenceToCallingObject.Enabled = .T.
				this.oReferenceToCallingObject.SetAddress(address.ad_addrid)
			CASE this.mode = 27
				* Bonus Accounts
				IF TYPE("this.oReferenceToCallingObject") = "O" AND NOT ISNULL(this.oReferenceToCallingObject)
					this.oReferenceToCallingObject.SetAddress(address.ad_addrid, address.ad_adid)
				ENDIF
			CASE this.mode = 28
				* Just enable calling form
				IF TYPE("this.oReferenceToCallingObject") = "O" AND NOT ISNULL(this.oReferenceToCallingObject)
					this.oReferenceToCallingObject.Enabled = .T.
				ENDIF
			CASE this.mode = 29
				* Called from messagesform, to enter new addres, with phone number received from TAPI as caller id
				this.oparam = .NULL.
		ENDCASE
		IF thisformset.AddressStart == "EDITR"
			For _I=1 To _Screen.FormCount
				If Upper(Alltrim(_Screen.Forms(_I).Name))=='FWEEKFORM'
					IF this.refreshroomplan
						_Screen.Forms(_I).activate
						_Screen.Forms(_I).enabled = .t.
						_Screen.Forms(_I).timeraddr.enabled = .t.
					ELSE
						_Screen.Forms(_I).enabled = .t.
					ENDIF
					EXIT
				ENDIF
			next
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Activate
		if thisformset.firstsearch = .T.
			this.init()
		endif
		
		thisformset.AddressMaskVisibleFirstTime()
	ENDPROC

	PROCEDURE AddressSearchDialog.CCancel.Click
		thisform.visible = .F.
		thisform.caption = ""
		if thisformset.firstsearch
			thisformset.MainExitPoint()
		endif
		*IF thisformset.p_newreferralactive
		*	thisformset.p_newreferralactive = .F.
		*ENDIF
		
	ENDPROC

	PROCEDURE AddressSearchDialog.CCancel.LostFocus
		if thisform.LastTabKey = 2
			thisform.LastTabKey = 0
			thisform.TAd_company.SetFocus()
		endif
		
	ENDPROC

	PROCEDURE AddressSearchDialog.CSearch.Click
		thisform.p_ok_pressed = .T.
		thisform.visible = .F.
		thisform.caption = ""
		FOR i = 1 TO thisform.controlcount
			IF UPPER(thisform.controls(i).baseclass) = "TEXTBOX"
				IF TYPE('thisform.controls(i).value') = "C"
					IF AT("]",thisform.controls(i).value )>0
						thisform.controls(i).value = STRTRAN(thisform.controls(i).value,"]"," ")
					ENDIF
				ENDIF
			ENDIF
		NEXT i
		
		if thisformset.firstsearch
			thisformset.firstsearch = .F.
		*	Local m.AllExist
		*	if IsNull(g_BriliantToolBar) 
		*		g_BriliantToolBar = NewObject("CDynToolBar")
		*	else
		*		m.AllExist = .T.
		*	endif
		*	g_BriliantToolBar.AddRef()
		*	thisformset.InitToolBar()
		*	if NOT m.AllExist
		*		g_BriliantToolBar.Visible = .T.
		*		g_BriliantToolBar.Dock(0)
		*	else
		*		if g_BriliantToolBar.Docked
			*			g_BriliantToolBar.Dock(g_BriliantToolBar.DockPosition)
		*		endif
			*ENDIF
		*	ENDIF
		
			thisformset.searchaddresstable()
			thisformset.FAddressMask.Show
			IF thisformset.AddressStart = "NORMAL"
				thisformset.FAddressMask.mainPage.ActivePage = 2
			ENDIF
		else
			thisformset.searchaddresstable()
		endif
		*IF thisformset.p_newreferralactive
		*	thisformset.FAddressMask.MainPage.activepage=2
		*	thisformset.FAddressMask.MainPage.pageGridAddress.AddressGrid.SetFocus()
		*ENDIF
		
	ENDPROC

	PROCEDURE AddressSearchDialog.Deactivate
		IF this.p_ok_pressed
			this.p_ok_pressed = .F.
		ELSE
			this.CCancel.click()
		ENDIF
		
	ENDPROC

	PROCEDURE AddressSearchDialog.Destroy
		DODEFAULT()
		if thisformset.firstsearch
			thisformset.MainExitPoint()
		endif
	ENDPROC

	PROCEDURE AddressSearchDialog.Init
		DODEFAULT()
		this.AddProperty("LastTabKey", 0)
		this.AddProperty("p_ok_pressed",.F.)
		this.caption = Getlangtext("ADDRESS","T_ADDRESSSEARCH")
		this.tcheckbox11.Caption = Getlangtext("ACT","TW_SEARCH")
		this.tcheckbox12.Caption = this.tcheckbox11.Caption
		this.tcheckbox13.Caption = this.tcheckbox11.Caption
		this.tcheckbox14.Caption = this.tcheckbox11.Caption
		this.tcheckbox15.Caption = this.tcheckbox11.Caption
		this.tcheckbox16.Caption = this.tcheckbox11.Caption
		this.tcheckbox17.Caption = this.tcheckbox11.Caption
		this.tcheckbox18.Caption = this.tcheckbox11.Caption
		this.tcheckbox19.Caption = this.tcheckbox11.Caption
		this.tcheckbox20.Caption = this.tcheckbox11.Caption
		this.tad_email.InputMask = REPLICATE("X",100)
		IF NOT _screen.oGlobal.lUseMainServer
			this.chkmainserver.Visible = .F.
			this.chkmainserver.Value = .F.
		ELSE
			this.chkmainserver.Caption = Getlangtext("ADDRESS","TXT_MAIN_SERVER_SEARCH")
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		do case
			case ((nKeyCode = 15)  AND (nShiftAltCtrl = 1)) OR;
				 ((nKeyCode = 19) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 26) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 148) AND (nShiftAltCtrl = 3)) OR;
				 ((nKeyCode = 5) AND (nShiftAltCtrl = 0))
				this.LastTabKey = 1
			case ((nKeyCode = 9) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 4) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 2) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 148) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 24) AND (nShiftAltCtrl = 0))
				this.LastTabKey = 2
			case ((nKeyCode = 18) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 3) AND (nShiftAltCtrl = 0))
				nodefault
			case ((nKeyCode = 27) AND (nShiftAltCtrl = 0))
				this.CCancel.Click()
				nodefault
			otherwise
				this.LastTabKey = 0
		endcase
		
		
	ENDPROC

	PROCEDURE AddressSearchDialog.QueryUnload
		NODEFAULT
		THIS.cCancel.Click
		
	ENDPROC

	PROCEDURE AddressSearchDialog.TAd_company.LostFocus
		if thisform.LastTabKey = 1
			thisform.LastTabKey = 0
			thisform.CCancel.SetFocus()
		endif
		
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox11.Valid
		IF this.Value = .f.
			thisform.tcheckbox1.Enabled = .f.
		ELSE
			thisform.tcheckbox1.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox12.Valid
		IF this.Value = .f.
			thisform.tcheckbox2.Enabled = .f.
		ELSE
			thisform.tcheckbox2.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox13.Valid
		IF this.Value = .f.
			thisform.tcheckbox3.Enabled = .f.
		ELSE
			thisform.tcheckbox3.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox14.Valid
		IF this.Value = .f.
			thisform.tcheckbox4.Enabled = .f.
		ELSE
			thisform.tcheckbox4.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox15.Valid
		IF this.Value = .f.
			thisform.tcheckbox5.Enabled = .f.
		ELSE
			thisform.tcheckbox5.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox16.Valid
		IF this.Value = .f.
			thisform.tcheckbox6.Enabled = .f.
		ELSE
			thisform.tcheckbox6.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox17.Valid
		IF this.Value = .f.
			thisform.tcheckbox7.Enabled = .f.
		ELSE
			thisform.tcheckbox7.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox18.Valid
		IF this.Value = .f.
			thisform.tcheckbox8.Enabled = .f.
		ELSE
			thisform.tcheckbox8.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox19.Valid
		IF this.Value = .f.
			thisform.tcheckbox9.Enabled = .f.
		ELSE
			thisform.tcheckbox9.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE AddressSearchDialog.Tcheckbox20.Valid
		IF this.Value = .f.
			thisform.tcheckbox10.Enabled = .f.
		ELSE
			thisform.tcheckbox10.Enabled = .t.
		ENDIF
	ENDPROC

	PROCEDURE ChangeApartnerDialog.CCancel.Click
		*thisform.DataCopy = .NULL.
		thisform.LastTabKey = 0
		
		thisform.visible = .F.
		thisform.caption = ""
		
		RETURN .T.
	ENDPROC

	PROCEDURE ChangeApartnerDialog.CCancel.LostFocus
		if thisform.LastTabKey = 2
			thisform.LastTabKey = 0
			thisform.TAp_Lname.SetFocus()
		endif
	ENDPROC

	PROCEDURE ChangeApartnerDialog.COk.Click
		thisformset.apartnersave()
	ENDPROC

	PROCEDURE ChangeApartnerDialog.Combo1.changesalute
		LPARAMETERS lp_cNewSalute
		IF TYPE("thisform.DataCopy.ap_salute")="C"
			thisform.DataCopy.ap_salute = lp_cNewSalute
			thisform.TAp_Salute.Refresh()
		ENDIF
	ENDPROC

	PROCEDURE ChangeApartnerDialog.Combo1.changetitle
		LPARAMETERS lp_cNewTitle
		IF TYPE("thisform.DataCopy.ap_title") = "C"
			thisform.DataCopy.ap_title = lp_cNewTitle
			thisform.TAp_Title.Refresh()
		ENDIF
	ENDPROC

	PROCEDURE ChangeApartnerDialog.CUndo.Click
		IF thisformset.FAddressMask.oProcAddress.capartnermode = "NEW"
			thisformset.FAddressMask.oProcAddress.ApartnerNew(address.ad_addrid)
		ELSE
			thisformset.FAddressMask.oProcAddress.ApartnerEdit(apartner.ap_apid)
		ENDIF
		
		thisform.DataCopy = thisformset.FAddressMask.oProcAddress.oApartner
		thisform.Refresh()
		
		thisform.TAp_Lname.SetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE ChangeApartnerDialog.Deactivate
		IF NOT _screen.ActiveForm.name = "SelectForm"
			this.CCancel.click()
		ENDIF
	ENDPROC

	PROCEDURE ChangeApartnerDialog.Destroy
		this.DataCopy = .NULL.
	ENDPROC

	PROCEDURE ChangeApartnerDialog.Init
		DODEFAULT()
		this.AddProperty("LastTabKey", 0)
		this.AddProperty("DataCopy",.NULL.)
	ENDPROC

	PROCEDURE ChangeApartnerDialog.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		do case
		case ((nKeyCode = 15)  AND (nShiftAltCtrl = 1)) OR;
			 ((nKeyCode = 19) AND (nShiftAltCtrl = 0)) OR;
			 ((nKeyCode = 26) AND (nShiftAltCtrl = 2)) OR;
			 ((nKeyCode = 148) AND (nShiftAltCtrl = 3)) OR;
			 ((nKeyCode = 5) AND (nShiftAltCtrl = 0))
			this.LastTabKey = 1
		case ((nKeyCode = 9) AND (nShiftAltCtrl = 0)) OR;
			 ((nKeyCode = 4) AND (nShiftAltCtrl = 0)) OR;
			 ((nKeyCode = 2) AND (nShiftAltCtrl = 2)) OR;
			 ((nKeyCode = 148) AND (nShiftAltCtrl = 2)) OR;
			 ((nKeyCode = 24) AND (nShiftAltCtrl = 0))
			this.LastTabKey = 2
		case ((nKeyCode = 18) AND (nShiftAltCtrl = 0)) OR;
			 ((nKeyCode = 3) AND (nShiftAltCtrl = 0))
			nodefault
		case ((nKeyCode = 27) AND (nShiftAltCtrl = 0))
			this.CCancel.Click()
			nodefault
		otherwise
			this.LastTabKey = 0
		endcase
		
	ENDPROC

	PROCEDURE ChangeApartnerDialog.TAp_Lname.LostFocus
		if thisform.LastTabKey = 1
			thisform.LastTabKey = 0
			thisform.CCancel.SetFocus()
		endif
		
	ENDPROC

	PROCEDURE ChangeApartnerDialog.TAp_Title.GotFocus
		if thisformset.apartnerlostfocus
			thisformset.apartnerlostfocus = .F.
		endif
	ENDPROC

	PROCEDURE FAddressMask.Activate
		SetKeyLabel()
		DODEFAULT()
		thisformset.AddressMaskVisibleFirstTime()
	ENDPROC

	PROCEDURE FAddressMask.Deactivate
		CheckKeyLabel()
		DODEFAULT()
	ENDPROC

	PROCEDURE FAddressMask.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		this.mainPage.pageGridAddress.AddressGrid.Init(.T.)
		DODEFAULT()
		thisformset.ScaleWidth = this.width/this.w
		thisformset.scaleheight = this.height/this.h
	ENDPROC

	PROCEDURE FAddressMask.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		LOCAL LActivePage
		
		* When Referral is selected, call diffrent methods
		IF thisformset.p_referralparams(1)												&& I think that this segment of code not used.
			DO CASE
			CASE (nKeyCode = 13 AND nShiftAltCtrl = 0) OR ;
				(nKeyCode = 23 AND nShiftAltCtrl = 2)			&& Enter OR Ctrl+END
				thisformset.m_selectreferral()
				NODEFAULT
			CASE nKeyCode = 1 AND nShiftAltCtrl = 2				&& Ctrl+A
				thisformset.m_cancel_state_for_new_referral()
				NODEFAULT
			CASE nKeyCode = 14 AND nShiftAltCtrl = 2			&& Ctrl+N
				thisformset.m_newforreferral()
				NODEFAULT
			CASE nKeyCode = 6 AND nShiftAltCtrl = 2				&& Ctrl+F
				thisformset.addresssearch()
				NODEFAULT	
			ENDCASE
			RETURN .T.
		ENDIF
		
		IF LOWER(thisform.cformlabel) = "searchadr"
			* Addresses select mode
			DO CASE
				CASE nKeyCode = 32 AND nShiftAltCtrl = 0		&& SPACEBAR
					IF this.MainPage.ActivePage = 2
						* Select checkbox in grid
						DO CASE
							CASE thisformset.mode = 24
								thisformset.onselectaddress(.T.)
								this.mainPage.pageGridAddress.addressGrid.Refresh()
							CASE thisformset.mode = 25
								thisformset.onselectreferral(.T.)
								this.mainPage.pageGridAddress.addressGrid.Refresh()
						ENDCASE
						NODEFAULT
					ENDIF
				OTHERWISE
					DODEFAULT(nKeyCode, nShiftAltCtrl)
			ENDCASE
			RETURN .T.
		ENDIF
		
		LActivePage = this.MainPage.PageAddress.SlavePage.ActivePage 
		
		DO CASE 
			CASE nKeyCode = 148 AND nShiftAltCtrl = 2			&& Ctrl+TAB
				DO CASE
					CASE thisformset.AddressEditEnabled
					CASE this.MainPage.ActivePage = 1
						this.MainPage.ActivePage = 2
					OTHERWISE
						this.MainPage.ActivePage = 1
				ENDCASE
				NODEFAULT
			CASE nKeyCode = 13 AND nShiftAltCtrl = 0 AND this.MainPage.ActivePage <> 1	AND (thisformset.AddressStart = "NORMAL" OR thisformset.addressstate <> 0)	&& Enter
				DODEFAULT(5,2)
			CASE nKeyCode = 22 AND nShiftAltCtrl = 0			&& Insert
				DO CASE
					CASE this.MainPage.ActivePage <> 1
						DODEFAULT(14,2)
					CASE EMPTY(address.ad_addrid)
					OTHERWISE
						IF LActivePage = 1 AND this.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled
							this.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 3 AND this.MainPage.PageAddress.SlavePage.PageDokument.BDokNew.enabled
							this.MainPage.PageAddress.SlavePage.PageDokument.BDokNew.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 5 AND this.MainPage.PageAddress.SlavePage.PageFuture.BFutNew.enabled
							this.MainPage.PageAddress.SlavePage.PageFuture.BFutNew.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 8 AND this.MainPage.PageAddress.SlavePage.pageReferral.BRNew.enabled
							this.MainPage.PageAddress.SlavePage.pageReferral.BRNew.click()
							NODEFAULT
						ENDIF
				ENDCASE
			CASE nKeyCode = 146 AND nShiftAltCtrl = 2			&& Ctrl+Insert
				IF this.MainPage.ActivePage = 1 AND NOT EMPTY(address.ad_addrid)
					IF LActivePage = 3 AND this.MainPage.PageAddress.SlavePage.PageDokument.btnNewExternalDocument.enabled
						this.MainPage.PageAddress.SlavePage.PageDokument.btnNewExternalDocument.click()
						NODEFAULT
					ENDIF
				ENDIF
			CASE nKeyCode = 7 AND nShiftAltCtrl = 0				&& Delete
				DO CASE
					CASE this.MainPage.ActivePage <> 1
						DODEFAULT(4,2)
					CASE EMPTY(address.ad_addrid)
					OTHERWISE
						IF LActivePage = 1 AND this.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled
							this.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 3 AND this.MainPage.PageAddress.SlavePage.PageDokument.BDokDel.enabled
							this.MainPage.PageAddress.SlavePage.PageDokument.BDokDel.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 5 AND this.MainPage.PageAddress.SlavePage.PageFuture.BFutDel.enabled
							this.MainPage.PageAddress.SlavePage.PageFuture.BFutDel.click()
							NODEFAULT
						ENDIF
						IF LActivePage = 8 AND this.MainPage.PageAddress.SlavePage.pageReferral.bRDelete.enabled
							this.MainPage.PageAddress.SlavePage.pageReferral.bRDelete.click()
							NODEFAULT
						ENDIF
				ENDCASE
			CASE nKeyCode = 21 AND nShiftAltCtrl = 2			&& Ctrl+U
				DODEFAULT(nKeyCode, nShiftAltCtrl)
				IF thisformset.AddressEditEnabled AND NOT LActivePage = 9
					this.MainPage.PageAddress.SlavePage.ActivePage = 9
					thisformset.refreshaddressgrid()
				ENDIF
			CASE nKeyCode = 16 AND nShiftAltCtrl = 2			&& Ctrl+P
				DO CASE
					CASE this.mainPage.ActivePage <> 1
					CASE EMPTY(address.ad_addrid)
					CASE LActivePage = 6 AND parights(131)
						this.mainPage.pageAddress.slavePage.pageRevnue.bHistPrint.SetFocus()
						this.mainPage.pageAddress.slavePage.pageRevnue.bHistPrint.Click
					CASE LActivePage = 4 AND parights(132)
						this.MainPage.PageAddress.SlavePage.PageHistory.oRevenuePage.KeyPress(nKeyCode, nShiftAltCtrl)
				ENDCASE
				NODEFAULT
			CASE nKeyCode = 1 AND nShiftAltCtrl = 2 AND Thisformset.AddressState = 0			&& Ctrl+A
				IF NOT (LActivePage = 1)
					this.MainPage.PageAddress.SlavePage.ActivePage = 1
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 7 AND nShiftAltCtrl = 3				&& Ctrl+Shift+G
				IF NOT (LActivePage = 10)
					this.MainPage.PageAddress.SlavePage.ActivePage = 10
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 20 AND nShiftAltCtrl = 2			&& Ctrl+T
				DO CASE
					CASE LActivePage = 6
						IF this.MainPage.PageAddress.SlavePage.pageRevnue.cmdBillPreview.Enabled AND NOT EMPTY(address.ad_addrid)
							this.MainPage.PageAddress.SlavePage.pageRevnue.cmdBillPreview.Click()
						ENDIF
					CASE LActivePage <> 2
						this.MainPage.PageAddress.SlavePage.ActivePage = 2
						thisformset.refreshaddressgrid()
					OTHERWISE
				ENDCASE
				NODEFAULT
			CASE nKeyCode = 13 AND nShiftAltCtrl = 2			&& Ctrl+M
				IF NOT (LActivePage = 3)
					this.MainPage.PageAddress.SlavePage.ActivePage = 3
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 127 AND nShiftAltCtrl = 2			&& Ctrl+H
				IF NOT (LActivePage = 6)
					this.MainPage.PageAddress.SlavePage.ActivePage = 6
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 10 AND nShiftAltCtrl = 2			&& Ctrl+J
				IF NOT (LActivePage = 4)
					this.MainPage.PageAddress.SlavePage.ActivePage = 4
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 25 AND nShiftAltCtrl = 3			&& Ctrl+Shift+Y	- Future Page
				IF NOT (LActivePage = 5)
					this.MainPage.PageAddress.SlavePage.ActivePage = 5
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 9 AND nShiftAltCtrl = 2				&& Ctrl+I
				IF NOT (LActivePage = 7)
					this.MainPage.PageAddress.SlavePage.ActivePage = 7
					thisformset.refreshaddressgrid()
				ENDIF
				NODEFAULT
			CASE nKeyCode = 7 AND nShiftAltCtrl = 2				&& Ctrl+G
				DO CASE
					CASE EMPTY(address.ad_addrid)
					CASE LActivePage = 6
						IF this.MainPage.PageAddress.SlavePage.pageRevnue.cmdSearchReservation.Enabled
							this.MainPage.PageAddress.SlavePage.pageRevnue.cmdSearchReservation.Click()
						ENDIF
					CASE LActivePage = 8
						IF this.MainPage.PageAddress.SlavePage.pageReferral.BRGoto.Enabled
							this.MainPage.PageAddress.SlavePage.pageReferral.BRGoto.Click()
						ENDIF
					OTHERWISE
						this.MainPage.PageAddress.SlavePage.ActivePage = 8
						thisformset.refreshreferralgrid()
				ENDCASE
				NODEFAULT
			CASE nKeyCode = 18 AND nShiftAltCtrl = 2			&& Ctrl+R
				IF LActivePage = 6 AND NOT EMPTY(address.ad_addrid)
					IF this.MainPage.PageAddress.SlavePage.pageRevnue.cmdShowReservation.Enabled
						this.MainPage.PageAddress.SlavePage.pageRevnue.cmdShowReservation.Click()
						NODEFAULT
					ENDIF
				ENDIF
			CASE nKeyCode = 15 AND nShiftAltCtrl = 2			&& Ctrl+O
				DO CASE
					CASE EMPTY(address.ad_addrid)
					CASE LActivePage = 6
						IF this.MainPage.PageAddress.SlavePage.pageRevnue.cmdCopyReservation.Enabled
							this.MainPage.PageAddress.SlavePage.pageRevnue.cmdCopyReservation.Click()
						ENDIF
						NODEFAULT
					CASE LActivePage = 4
						this.MainPage.PageAddress.SlavePage.PageHistory.oRevenuePage.KeyPress(nKeyCode, nShiftAltCtrl)
						NODEFAULT
				ENDCASE
			CASE nKeyCode = 2 AND nShiftAltCtrl = 2				&& Ctrl+B
				IF NOT thisformset.AddressEditEnabled AND _screen.OL
					thisformset.m_OnEMailCmd()
				ENDIF
				NODEFAULT
			OTHERWISE
				IF thisformset.AddressState <> 0 AND nKeyCode = 13
					&& Pass ENTER key, to go to next textbox in Address Mask
				ELSE
					IF DODEFAULT(nKeyCode, nShiftAltCtrl)
						NODEFAULT
					ENDIF
				ENDIF
		ENDCASE
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.Activate
		IF this.parent.ActivePage = 1 AND NOT thisformset.AddressEditEnabled AND thisformset.OldActivPage <> 1
		   thisformset.refreshaddressgrid()
		endif
		thisformset.OldActivPage = 1
		
		IF NOT thisformset.tpypahd
			* When this page is active, then allow PageGridAddress to set focus on grid.
			* This was prevented, when form was called in browse mode.
			thisformset.tpypahd = .T.
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.chkAd_Vip.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			this.Parent.chkAd_Vip2.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.chkAd_Vip2.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			thisformset.FaddressMask.mainPage.pageAddress.slavePage.pageNote.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.Activate
		this.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnBrowse.Click
		Local LWebAddress, LWebName
		
		LWebAddress = alltrim(this.parent.txtad_website.value)
		LWebName = alltrim(thisform.MainPage.pageAddress.txtAd_Company.value)
		If Empty (LWebName) 
			LWebName = alltrim(thisform.MainPage.pageAddress.txtAd_Lname.value) + " " + ;
						alltrim(thisform.MainPage.pageAddress.txtAd_Fname.value)
		endif
		
		If NOT Empty (LWebAddress)
			thisform.mail.NavigateTo(LWebAddress)
		else 
			MESSAGEBOX("Keine Internet Adresse!",48,GetLangText("RESERV2","TW_INFO"))
		endif
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnCall.Click
		LOCAL ARRAY l_aParams(1)
		
		IF NOT _screen.oGlobal.oTerminal.tm_calluse
			RETURN .T.
		ENDIF
		
		l_aParams(1) = address.ad_addrid
		doform('frmaddresscaller', 'forms\addressmaskcaller','',.F.,@l_aParams,,"DoNewCall")
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnMail.Click
		thisformset.m_OnEMailCmd()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.btnMail.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			this.Parent.txtad_website.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_novat.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			this.Parent.txtAd_Mail1.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.chkad_save.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			this.Parent.txtad_ustidnr.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Email.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Fax.GotFocus
		IF !EMPTY(this.value)
			thisformset.emptyfax = .F.
		endif 
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Fax.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail1.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail2.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail3.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail4.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail5.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
			CASE INLIST(nKeyCode, 9, 13) AND nShiftAltCtrl = 0
				NODEFAULT
				this.Parent.Parent.ActivePage = 2
				this.Parent.Parent.pagGuestInfo.txtAd_Ratecod.SetFocus()
			OTHERWISE
				DODEFAULT(nKeyCode, nShiftAltCtrl)
		ENDCASE
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Mail5.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone.GotFocus
		IF !EMPTY(this.value)
			thisformset.emptyphone1 = .F.
		endif 
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone2.GotFocus
		IF !EMPTY(this.value)
			thisformset.emptyphone2 = .F.
		endif 
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone2.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone3.GotFocus
		IF !EMPTY(this.value)
			thisformset.emptyphone3 = .F.
		endif 
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone3.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_ustidnr.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagCommunication.txtad_website.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.Activate
		this.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.cboRoomname.GotFocus
		IF NOT EMPTY(this.value)
			thisformset.emptyphone1 = .F.
		ENDIF
		DODEFAULT()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.ChkNomail.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 13 AND nShiftAltCtrl = 0
			NODEFAULT
			this.Parent.txtad_member.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Birth.InteractiveChange
		thisform.LastTabKey = 2
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.dtxtAd_Memdat.InteractiveChange
		thisform.LastTabKey = 2
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.stxtFeature.GotFocus
		thisformset.FAddressMask.oProcAddress.AddressSetFeatures(address.ad_addrid, this.curSelect)
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Billins.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Feat1.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Member.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Ratecod.GotFocus
		IF ORDER('ratecode')!="TAG1"
			SET ORDER TO 1 IN ratecode
		ENDIF
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtAd_Ratecod.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtad_webpass.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtbmsaccount.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtCollectedPoints.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.InfoPage.pagGuestInfo.txtTotalPoints.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.ocbotitle.changesalute
		LPARAMETERS lp_cNewSalute
		thisformset.DataCopy.ad_salute = lp_cNewSalute
		thisform.MainPage.PageAddress.txtAd_Salute.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.ocbotitle.changetitle
		LPARAMETERS lp_cNewTitle
		thisformset.DataCopy.ad_title = lp_cNewTitle
		thisform.MainPage.PageAddress.txtad_title.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.Activate
		this.Parent.PageDokument.lOpened = .F.
		return
		
		if !(ApartnerTAlias.ap_addrid = AddressTAlias.ad_addrid)
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
		else
			*IF thisformset.FAddressMask.alwaysontop =.t.
				*thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
				*thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
			*ELSE
				thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .T.
				thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .T.
			*endif
		endif
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.AfterRowColChange
		LPARAMETERS nColIndex
		*IF thisformset.FAddressMask.alwaysontop =.t.
			*thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
			*thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .F.
		*ELSE
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .T.
			thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = .T.
		*ENDIF
		this.refresh
		*this.setfocus
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.DblClick
		thisform.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.click
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.defineudpopupmenu
		DIMENSION this.aPopupMenu[4]
		this.aPopupMenu[1] = this.Parent.CmdNewAPart
		this.aPopupMenu[2] = this.Parent.CUpdateApartner
		this.aPopupMenu[3] = this.Parent.CmdDelPart
		this.aPopupMenu[4] = P_COLUMNS
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Init
		LOCAL l_nCol
		
		WITH this
			.Column1.Header1.Caption = GetLangText("ADDRESS","TXT_TITLE")
			.Column2.Header1.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
			.Column3.Header1.Caption = GetLangText("ADDRESS","TXT_LNAME")
			.Column4.Header1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
			.Column5.Header1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2"
			.Column6.Header1.Caption = GetLangText("ADDRESS","TXT_FAX")
			.Column7.Header1.Caption = GetLangText("ADDRESS","TXT_EMAIL")
			.Column8.Header1.Caption = GetLangText("WALKIN","T_VIP")
			.Column9.Header1.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
			.Column10.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "1"
			.Column11.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "2"
			.Column12.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "3"
			.Column13.Header1.Caption = GetLangText("ADDRESS","TXT_SALUTE")
		ENDWITH
		FOR l_nCol = 1 TO this.ColumnCount
			this.Columns(l_nCol).controls(2).ToolTipText = "Zwei mal clicken für änderungen"
		ENDFOR
		
		thisformset.SetApartnerGridSource("apartner")
		
		DODEFAULT()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.restorecolumn
		LPARAMETERS lp_oColumn
		lp_oColumn.ReadOnly = .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.Valid
		this.lAbout2LeaveGrid = .t.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.ApartnerGrid.When
		this.lAbout2LeaveGrid = .f.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.btnMail.Click
		thisformset.m_OnEMailCmd(.T.)
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.Click
		*activate window view
		*wait window alias()
		gt=1
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.Click
		thisformset.apartnerdelete()
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.Click
		thisformset.apartnernew()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.Click
		thisformset.apartneredit()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.Init
		DODEFAULT()
		thisformset.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = .F.
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.Activate
		IF NOT this.lOpened
			this.lOpened = .T.
			thisformset.refreshdocpage()
			GO TOP IN curDocument
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokDel.Click
		this.parent.DokumentGrid.Setfocus()
		if !empty (curDocument.dc_addrid)
			thisformset.docdelete()
		else
			this.enabled = .F.
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokEdit.Click
		Local LFile, LDir, LDesc, l_cOnError
		*Public myword
		IF RECCOUNT("curDocument") = 0
			RETURN .T.
		ENDIF
		
		this.parent.DokumentGrid.Refresh()
		this.parent.DokumentGrid.Setfocus()
		
		IF NOT INLIST(curDocument.dc_type, "ARRECIVABL", "EINBOX", "ESENT") AND ;
				NOT dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
			RETURN .F.
		ENDIF
		
		DO CASE
			CASE curDocument.dc_type = "TELENOTE"
				thisformset.m_phonenote("EDIT")
			CASE INLIST(curDocument.dc_type, " ", "WORDDOC ", "WORDDOCX")
				LDir = gcDocumentdir
				LFile = LDir + alltrim(curDocument.dc_file)
		
				If !Empty (LFile)
					IF FILE(FULLPATH(LFile))
						LDesc = alltrim(curDocument.dc_descr)
						LOCAL l_oWord
						l_oWord = .NULL.
						l_oWord = NEWOBJECT("autoword","cit_system")
						IF ISNULL(l_oWord) OR (TYPE('l_oWord')=="L" AND NOT l_oWord) OR NOT l_oWord.OpenDocument(FULLPATH(LFile))
							= alert(GetLangText("EMBROWS","TXT_OPERATION_UNSUCCESSFULL"))
						ENDIF
							thisform.Show
						ELSE
						this.parent.DokumentGrid.Refresh
						this.parent.DokumentGrid.Setfocus
						IF yesno(STRTRAN(GetLangText("DOC","TA_NODOCDEL"), "%s", ALLTRIM(curDocument.dc_file)))
							DELETE IN curDocument
							IF dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
								DELETE IN DocumentTAlias
								= TABLEUPDATE(.t.,.t.,"document")
							ENDIF
						ENDIF
						this.parent.DokumentGrid.Refresh
						this.parent.DokumentGrid.Setfocus
					ENDIF && FILE(FULLPATH(LFile))
				ELSE && !Empty (LFile)
					MESSAGEBOX("Keinen Dokument vorhanden!",48,GetLangText("RESERV2","TW_INFO"))
				ENDIF
			CASE curDocument.dc_type = "EINBOX"
				IF NOT EMPTY(curDocument.dc_eiid)
					DO FORM forms\emailsend.scx WITH "EDITRECEIVED", address.ad_addrid, thisformset, curDocument.dc_eiid
					thisformset.refreshdocpage()
				ENDIF
			CASE curDocument.dc_type = "ESENT"
				IF NOT EMPTY(curDocument.dc_esid)
					DO FORM forms\emailsend.scx WITH "EDITSENT", address.ad_addrid, thisformset, 0, curDocument.dc_esid
					thisformset.refreshdocpage()
				ENDIF
			CASE curDocument.dc_type = "ARRECIVABL"
				DO ArShowRecivablesForAddress IN ar WITH address.ad_addrid, curDocument.dc_agid
			CASE curDocument.dc_type = "WRITERDOC"
				LOCAL l_cOutputFile, l_oOpenOfficeDesktop
				l_cOutputFile = FULLPATH(gcDocumentdir+ALLTRIM(curDocument.dc_file))
				IF FILE(l_cOutputFile)
					l_oOpenOfficeDesktop = NEWOBJECT("AutoOpenOffice", "cit_system")
					IF NOT l_oOpenOfficeDesktop.OpenDocument(l_cOutputFile)
						Alert(GetLangText("EMBROWS","TXT_OPERATION_UNSUCCESSFULL"))
					ENDIF
				ELSE
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
					IF yesno(STRTRAN(GetLangText("DOC","TA_NODOCDEL"), "%s", ALLTRIM(curDocument.dc_file)))
						DELETE IN curDocument
						IF dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
							DELETE IN DocumentTAlias
							= TABLEUPDATE(.t.,.t.,"document")
						ENDIF
					ENDIF
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
				ENDIF
			CASE INLIST(curDocument.dc_type, "EXCELDOC", "PDFDOC")
				LOCAL l_cOutputFile, l_oOpenOfficeDesktop
				l_cOutputFile = FULLPATH(gcDocumentdir+ALLTRIM(curDocument.dc_file))
				IF FILE(l_cOutputFile)
					WinExecute(l_cOutputFile)
				ELSE
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
					IF yesno(STRTRAN(GetLangText("DOC","TA_NODOCDEL"), "%s", ALLTRIM(curDocument.dc_file)))
						DELETE IN curDocument
						IF dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
							DELETE IN DocumentTAlias
							= TABLEUPDATE(.t.,.t.,"document")
						ENDIF
					ENDIF
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
				ENDIF
			CASE curDocument.dc_type = "EXTERNAL"
				LOCAL l_cOutputFile, l_cExtension, l_cForbbiden
				l_cOutputFile = FULLPATH(gcDocumentdir+ALLTRIM(curDocument.dc_file))
				IF FILE(l_cOutputFile)
					l_cExtension = JUSTEXT(l_cOutputFile)
					l_cForbbiden = PAGetDangerouseFilesList()
					IF ["]+UPPER(ALLTRIM(l_cExtension))+["] $ l_cForbbiden
						alert(GetLangText("KEYCARD1","TXT_BLOCKED")+"!")
					ELSE
						WinExecute(l_cOutputFile)
					ENDIF
				ELSE
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
					IF yesno(STRTRAN(GetLangText("DOC","TA_NODOCDEL"), "%s", ALLTRIM(curDocument.dc_file)))
						DELETE IN curDocument
						IF dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
							DELETE IN DocumentTAlias
							= TABLEUPDATE(.t.,.t.,"document")
						ENDIF
					ENDIF
					this.Parent.DokumentGrid.Refresh()
					this.Parent.DokumentGrid.Setfocus()
				ENDIF
		ENDCASE
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.BDokNew.Click
		*KEYBOARD '{F7}' PLAIN CLEAR
		_screen.oGlobal.oRG.AddressReportsShow()
		this.Parent.lOpened = .F.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnMail.Click
		thisformset.m_OnEMailCmd()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnNewExternalDocument.Click
		thisformset.m_OnNewExternalDocumentCmd()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.btnReply.Click
		thisformset.m_OnEMailReplyCmd()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.AfterRowColChange
		LPARAMETERS nColIndex
		IF USED("curDocument")
			dlocate("document","dc_file = " + sqlcnv(curDocument.dc_file))
		ENDIF
		IF TYPE("this.parent.BDokEdit") = "O"
			this.parent.BDokEdit.enabled = .T.
		ENDIF
		*this.Refresh
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column3.Header1.DblClick
		IF DESCENDING(1,'curDocument')
			SET ORDER TO 1 IN curDocument ASCENDING
		ELSE
			SET ORDER TO 1 IN curDocument DESCENDING
		ENDIF
		GO TOP IN curDocument
		this.Parent.Parent.Refresh()
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column5.Header1.DblClick
		IF DESCENDING(3,'curDocument')
			SET ORDER TO 3 IN curDocument ASCENDING
		ELSE
			SET ORDER TO 3 IN curDocument DESCENDING
		ENDIF
		GO TOP IN curDocument
		this.Parent.Parent.Refresh()
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column6.Header1.DblClick
		IF DESCENDING(4,'curDocument')
			SET ORDER TO 4 IN curDocument ASCENDING
		ELSE
			SET ORDER TO 4 IN curDocument DESCENDING
		ENDIF
		GO TOP IN curDocument
		this.Parent.Parent.Refresh()
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column7.Header1.DblClick
		IF DESCENDING(2,'curDocument')
			SET ORDER TO 2 IN curDocument ASCENDING
		ELSE
			SET ORDER TO 2 IN curDocument DESCENDING
		ENDIF
		GO TOP IN curDocument
		this.Parent.Parent.Refresh()
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Tchkgrid1.Click
		IF INLIST(curDocument.dc_type, " ", "WORDDOC ", "WORDDOCX", "EXCELDOC", "WRITERDOC", "CALCDOC", "PDFDOC", "EXTERNAL")
			REPLACE curDocument.dc_doctosend WITH ;
						NOT curDocument.dc_doctosend IN curDocument
		ELSE
			this.Value = 0
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Column9.Tchkgrid1.InteractiveChange
		*
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.defineudpopupmenu
		DIMENSION this.aPopupMenu[9]
		this.aPopupMenu[1] = this.Parent.BDokNew
		this.aPopupMenu[2] = this.Parent.TcPhoneNote
		this.aPopupMenu[3] = this.Parent.BtnMail
		this.aPopupMenu[4] = this.Parent.BtnReply
		this.aPopupMenu[5] = this.Parent.btnNewExternalDocument
		this.aPopupMenu[6] = this.Parent.BDokEdit
		this.aPopupMenu[7] = this.Parent.BDokDel
		this.aPopupMenu[8] = this.Parent.TcChange
		this.aPopupMenu[9] = P_COLUMNS
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Init
		SELECT *, RECNO() AS dc_recno, 00000000 AS dc_eiid, 00000000 AS dc_esid, SPACE(30) AS dc_phcname, ;
				SPACE(5) AS dc_attachment, .F. AS dc_doctosend, 00000000 AS dc_agid FROM document WHERE .F. INTO CURSOR curDocument READWRITE
		SET RELATION TO dc_recno INTO document IN curDocument
		INDEX ON dc_date TAG TAG1 DESCENDING
		INDEX ON dc_phcname TAG TAG2 DESCENDING
		INDEX ON dc_userid TAG TAG3 DESCENDING
		INDEX ON dc_type TAG TAG4 DESCENDING
		INDEX ON DTOS(dc_date)+dc_time TAG TAG5 DESCENDING
		SET ORDER TO TAG5
		WITH this
			.Column1.Header1.Caption = GetLangText("DOC","T_DOC")
			.Column2.Header1.Caption = GetLangText("DOC","T_DESCR")
			.Column3.Header1.Caption = GetLangText("DOC","T_DATE")
			.Column4.Header1.Caption = GetLangText("DOC","T_TIME")
			.Column5.Header1.Caption = GetLangText("DOC","T_USER")
			.Column6.Header1.Caption = GetLangText("DOC","TXT_DOCUMENT_TYPE")
			.Column7.Header1.Caption = GetLangText("DOC","TXT_CONTACT_NAME")
			.Column8.Header1.Caption = GetLangText("EMBROWS","TXT_ATTACHMENT")
			.Column9.Header1.Caption = GetLangText("EMBROWS","TXT_MARK")
			
			.RecordSource = [curDocument]
			.Column1.ControlSource = [curDocument.dc_file]
			.Column2.ControlSource = [curDocument.dc_descr]
			.Column3.ControlSource = [curDocument.dc_date]
			.Column4.ControlSource = [curDocument.dc_time]
			.Column5.ControlSource = [curDocument.dc_userid]
			.Column6.ControlSource = [thisformset.m_DocumentGetTypeText(curDocument.dc_type)]
			.Column7.ControlSource = [curDocument.dc_phcname]
			.Column8.ControlSource = [curDocument.dc_attachment]
			.Column9.ControlSource = [curDocument.dc_doctosend]
		ENDWITH
		DODEFAULT()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.Valid
		this.lAbout2LeaveGrid = .t.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.DokumentGrid.When
		this.lAbout2LeaveGrid = .f.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.Init
		this.AddProperty("lOpened",.F.)
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcChange.Click
		thisformset.m_documentchoose("SELECT")
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageDokument.TcPhoneNote.Click
		thisformset.m_phonenote("NEW")
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFree.Activate
		this.Parent.PageDokument.lOpened = .F.
		this.Refresh
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF thisformset.p_UserFieldsForAccountInfo AND NOT EMPTY(this.Value)
			IF nKeyCode = 12 AND nShiftAltCtrl =2 && Ctrl + L
				NODEFAULT
				LOCAL loForm
				DO FORM forms\bankdataform NAME loForm LINKED WITH this.Value
				this.Value = ALLTRIM(STR(banken.blz))
				this.Parent.FreeText9.Value = banken.name
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8.LostFocus
		IF thisformset.p_UserFieldsForAccountInfo AND NOT EMPTY(this.Value)
			LOCAL lcReturningString
			lcReturningString = ALLTRIM(this.Value)
			lcReturningString = STRTRAN(lcReturningString, " ", "")
			lcReturningString = STRTRAN(lcReturningString, "-", "")
			IF SEEK(VAL(lcReturningString),"banken","tag1")
				this.Parent.FreeText9.Value = ALLTRIM(banken.name)
				this.Value = ALLTRIM(STR(banken.blz))
			ELSE
				LOCAL loForm
				DO FORM forms\bankdataform NAME loForm LINKED WITH this.Value
				this.Value = ALLTRIM(STR(banken.blz))
				this.Parent.FreeText9.Value = banken.name
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFree.tcbCallBankForm.Click
		LOCAL loForm
		DO FORM forms\BankDataForm NAME loForm LINKED WITH this.Parent.FreeText8.Value
		this.Parent.FreeText8.Value = ALLTRIM(STR(banken.blz))
		this.Parent.FreeText9.Value = ALLTRIM(banken.name)
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.Activate
		this.Parent.PageDokument.lOpened = .F.
		thisformset.refreshfuturepage()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutDel.Click
		thisformset.FutureResDelete()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutEdit.Click
		LOCAL ARRAY LArray(16)
		thisformset.resdialog = "EDIT"
		
		x_=thisformset.datasessionid
		y_=thisformset.futurefilename+'.rs_reserid'
		rs_rsid_=&y_
		
		
		IF g_Nscreenmode = 2 OR g_Nscreenmode = 1
			thisform.NewObject("oToolbarHnd","ctoolbarhnd","proctoolbar.prg")
			thisform.oToolbarHnd.HideToolbars()
		ENDIF
		
		SELECT reservat
		LOCATE for rs_rsid_=rs_reserid
		= rsCheck()
		biRthday()
		*	thisform.Enabled=.f.
		*	doform('reservat','forms\reservat with '+ALLTRIM(STR(rs_rsid_))+',"EDIT"',"",.T.)
		LArray(1)=rs_rsid_
		LArray(2)='EDIT'
		LArray(16)=thisformset.FAddressMask
		doform('reservat','forms\reservat','',.T.,@LArray)
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.BFutNew.Click
		LOCAL ARRAY LArray(16)
		LOCAL l_nAddrId, l_nCompId, l_nInvId, l_nReferralCompid, l_nReferralInvId, l_cLName, l_cCompany
		
		STORE 0 TO l_nAddrId, l_nCompId, l_nInvId, l_nReferralCompid, l_nReferralInvId
		STORE "" TO l_cLName, l_cCompany
		
		IF NOT EMPTY(address.ad_lname)
			l_nAddrId = address.ad_addrid
			l_cLName = UPPER(address.ad_lname)
		ENDIF
		
		l_nReferralCompid = thisformset.m_ConnectReferralToReservation(address.ad_addrid, "XC")
		IF (l_nReferralCompid > 0) AND SEEK(l_nReferralCompid, 'address3','tag1') AND ;
				NOT EMPTY(address3.ad_company)
			l_nCompId = address3.ad_addrid
			l_cCompany = UPPER(address3.ad_company)
		ENDIF
		
		IF EMPTY(l_nCompId) AND NOT EMPTY(address.ad_company)
			l_nCompId = address.ad_addrid
			l_cCompany = UPPER(address.ad_company)
		ENDIF
		
		l_nReferralInvId = thisformset.m_ConnectReferralToReservation(address.ad_addrid, "XI")
		IF (l_nReferralInvId > 0) AND SEEK(l_nReferralInvId, 'address3','tag1') AND ;
				NOT EMPTY(address3.ad_company)
			l_nInvId = address3.ad_addrid
		ENDIF
		
		LArray(1) = 1
		LArray(2) = "NEW"
		LArray(3) = ""
		LArray(4) = ""
		LArray(5) = sySdate()
		LArray(6) = {}
		LArray(7) = 0
		LArray(8) = l_nAddrId
		LArray(9) = l_cLName
		LArray(10) = l_nCompId
		LArray(11) = l_cCompany
		LArray(12) = ""
		LArray(13) = ""
		LArray(14) = ""
		LArray(15) = l_nInvId
		LArray(16) = thisformset.FAddressMask
		doform('reservat','forms\reservat','',.T.,@LArray)
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.cmdFutAlt.Click
		LOCAL l_cFilter
		l_cFilter = "al_addrid = " + ALLTRIM(STR(address.ad_addrid)) + " AND IIF(al_cutday = 0, al_cutdate >= g_sysdate, al_todat - al_cutday >= g_sysdate) IN althead"
		do form "forms\MngForm" with "MngAllottCtrl", 0, l_cFilter
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.defineudpopupmenu
		DIMENSION this.aPopupMenu[5]
		this.aPopupMenu[1] = this.Parent.BFutNew
		this.aPopupMenu[2] = this.Parent.BFutEdit
		this.aPopupMenu[3] = this.Parent.BFutDel
		this.aPopupMenu[4] = this.Parent.cmdFutAlt
		this.aPopupMenu[5] = P_COLUMNS
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.FutureGrid.Init
		SELECT * FROM reservat WHERE .F. INTO CURSOR (thisformset.FutureFileName) READWRITE
		
		WITH this
			.Column1.Header1.caption = GetLangText("ADDRESS","TXT_LNAME")
			.Column2.Header1.caption = GetLangText("ADDRESS","TXT_ARRDATE")
			.Column3.Header1.caption = GetLangText("ADDRESS","TXT_DEPDATE")
			.Column4.Header1.caption = GetLangText("ADDRESS","TXT_FROM")
			.Column5.Header1.caption = GetLangText("ADDRESS","TXT_TO")
			.Column6.Header1.caption = GetLangText("ADDRESS","TXT_ROOMS")
			.Column7.Header1.caption = GetLangText("ADDRESS","TXT_ROOMTYPE")
			.Column8.Header1.caption = GetLangText("ADDRESS","TXT_ROOMNUM")
			.Column9.Header1.caption = GetLangText("ADDRESS","TXT_PERS")
			.Column10.Header1.caption = GetLangText("ADDRESS","TXT_RATE")
			.Column11.Header1.caption = GetLangText("ADDRESS","TXT_RATECOD")
			.Column12.Header1.caption = GetLangText("ADDRESS","TXT_STATUS")
			.Column13.Header1.caption = GetLangText("RESERVAT","TH_GROUP")
			          
			.RecordSource = thisformset.FutureFileName
			.Column1.ControlSource = thisformset.FutureFileName + [.rs_lname]
			.Column2.ControlSource = thisformset.FutureFileName + [.rs_arrdate]
			.Column3.ControlSource = thisformset.FutureFileName + [.rs_depdate]
			.Column4.ControlSource = thisformset.FutureFileName + [.rs_arrtime]
			.Column5.ControlSource = thisformset.FutureFileName + [.rs_deptime]
			.Column6.ControlSource = thisformset.FutureFileName + [.rs_rooms]
			.Column7.ControlSource = [get_rt_roomtyp(]+thisformset.FutureFileName + [.rs_roomtyp)]
			.Column8.ControlSource = [Get_rm_rmname(]+thisformset.FutureFileName+[.rs_roomnum)]
			.Column9.ControlSource = thisformset.FutureFileName + [.rs_adults + ] + ;
					thisformset.FutureFileName + [.rs_childs + ] + ;
					thisformset.FutureFileName + [.rs_childs2 + ] + ;
					thisformset.FutureFileName + [.rs_childs3]
			.Column10.ControlSource = thisformset.FutureFileName + [.rs_rate]
			.Column11.ControlSource = thisformset.FutureFileName + [.rs_ratecod]
			.Column12.ControlSource = thisformset.FutureFileName + [.rs_status]
			.Column13.ControlSource = thisformset.FutureFileName + [.rs_group]
		ENDWITH
		
		DODEFAULT()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageFuture.Init
		this.AddProperty("lRefreshing",.F.)
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageHistory.Activate
		this.Parent.PageDokument.lOpened = .F.
		IF NOT PEMSTATUS(this, "oRevenuePage", 5)
			SELECT 0
			this.AddObject("oRevenuePage", "RevenuePage")
			this.oRevenuePage.InitAfter()
		ENDIF
		this.oRevenuePage.Activate()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageNote.Activate
		this.Parent.pageDokument.lOpened = .F.
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageNote.Edit1.InteractiveChange
		_screen.oProcessHandler(ALLTRIM(STR(P_EDIT))).Execute(thisformset, "NoteChanged")
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.Activate
		this.Parent.PageDokument.lOpened = .F.
		thisformset.RefreshPrivacyPage()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacypolicy.chkAp_nomail.InteractiveChange
		DODEFAULT()
		
		thisform.MainPage.PageAddress.InfoPage.pagGuestInfo.ChkNomail.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PagePrivacyPolicy.oPrivacypolicy.Refresh
		LPARAMETERS lp_lRefreshAddress
		
		DODEFAULT(lp_lRefreshAddress)
		IF lp_lRefreshAddress
			SELECT address
			SCATTER MEMO NAME thisformset.DataCopy
			thisform.Refresh()
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.Activate
		this.Parent.PageDokument.lOpened = .F.
		thisformset.refreshreferralgrid()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRDelete.Click
		LOCAL LId
		LId = tgridreferralcursor.re_id
		*this.Parent.tgridReferral.SetFocus()
		IF SEEK(LId,'referral1','tag1')
			IF MESSAGEBOX(GetLangText("REFERRAL","TXT_REALLY_DELETE")+CHR(13)+;
				GetLangText("REFERRAL","TXT_REFERRAL_ID")+" "+ALLTRIM(STR(referral1.re_id))+CHR(13)+;
				GetLangText("REFERRAL","TXT_FROM")+" "+IIF(SEEK(referral1.re_from,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname))+CHR(13)+;
				GetLangText("REFERRAL","TXT_TO")+" "+IIF(SEEK(referral1.re_to,'address3','tag1') AND !EMPTY(address3.ad_company),UPPER(address3.ad_company),UPPER(address3.ad_lname)),4+32,GetLangText("FUNC","TXT_QUESTION"));
				=6
				DELETE IN referral1
				TABLEUPDATE(.t.,.t.,'referral1')
		*		GO BOTTOM in tgridreferralcursor
				thisformset.refreshreferralgrid()
		*		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.refresh()
		*		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral.SetFocus()
			ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BREdit.Click
		thisformset.m_editreferral()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRGoto.Click
		thisformset.referral_goto()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.BRNew.Click
		*thisformset.fAddressMask.mainPage.ActivePage = 2
		*thisformset.addresssearch()
		thisformset.m_set_state_for_referral_search()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.cmdshowreferrals.Click
		LOCAL ARRAY l_aParams(1)
		
		l_aParams(1) = thisformset
		
		doform('addressreferrals','forms\addressreferrals', , .F., @l_aParams)
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Column1.Header1.DblClick
		IF DESCENDING(1,'tgridreferralcursor')
			SET ORDER TO 1 IN tgridreferralcursor ASCENDING
		ELSE
			SET ORDER TO 1 IN tgridreferralcursor DESCENDING
		ENDIF
		GOTO TOP IN tgridreferralcursor
		this.Parent.Parent.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.defineudpopupmenu
		DIMENSION this.aPopupMenu[6]
		this.aPopupMenu[1] = this.Parent.BRNew
		this.aPopupMenu[2] = this.Parent.BREdit
		this.aPopupMenu[3] = this.Parent.BRDelete
		this.aPopupMenu[4] = this.Parent.BRGoto
		this.aPopupMenu[5] = this.Parent.Cmdshowreferrals
		this.aPopupMenu[6] = P_COLUMNS
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageReferral.TgridReferral.Init
		CREATE CURSOR tgridreferralcursor ;
			(re_id N(8), ;
			 re_to N(8), ;
			 re_lnkf N(3), ;
			 re_lnkt N(3), ;
			 re_date D(8), ;
			 re_user C(10), ;
			 re_reftext C(25), ;
			 re_addtext C(50), ;
			 re_linkres C(20), ;
			 re_mainadi C(82), ;
			 re_fulladr C(250))
		INDEX ON re_reftext TAG tag1
		
		CREATE CURSOR curLinkedAddress ;
			(re_mark l(1), ;
			re_from N(8), ;
			re_to N(8), ;
			re_addtext C(50), ;
			re_addrid n(8), ;
			re_city c(30))
		INDEX ON re_addrid TAG Tag1
		INDEX ON re_mark TAG Tag2
		SET ORDER TO
		
		WITH this
			.RecordSource = [tgridreferralcursor]
			.column1.ControlSource = [tgridreferralcursor.re_reftext]
			.column2.ControlSource = [tgridreferralcursor.re_addtext]
			.column3.ControlSource = [tgridreferralcursor.re_date]
			.column4.ControlSource = [tgridreferralcursor.re_user]
			.column5.ControlSource = [tgridreferralcursor.re_linkres]
			.column6.ControlSource = [tgridreferralcursor.re_fulladr]
			.column7.ControlSource = [tgridreferralcursor.re_mainadi]
			.column1.header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")
			.column2.header1.Caption = GetLangText("REFERRAL","TXT_REFERRENCE_IN_GRID")
			.column3.header1.Caption = GetLangText("MGRRESER","TXT_DATE")
			.column4.header1.Caption = GetLangText("DOC","T_USER")
			.column5.header1.Caption = GetLangText("REFERRAL","TXT_LINKED_IN_RESERVAT")
			.column6.header1.Caption = GetLangText("ADDRESS","TXT_ADDRESS")
			.column7.header1.Caption = GetLangText("REFERRAL","TXT_LINK_MAIN_ADDRESS")
			.SetAll('movable',.f.,'column')
		ENDWITH
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.Activate
		this.Parent.PageDokument.lOpened = .F.
		thisformset.refresholdrespage()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.BHistPrint.Click
		PRIVATE p_selectform
		p_selectform = .null.
		DECLARE laExtraParamadr(4,1)
		laExtraParamadr(1,1)=address.ad_addrid
		laExtraParamadr(2,1)=16&& li_menu
		laExtraParamadr(3,1)=1
		laExtraParamadr(4,1)='_AH00100'
		DOform('selectreport','forms\selectreport','NAME p_selectform NOSHOW with 1,"addresshistory",0,laExtraParamadr,1')
		p_selectform.release()
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdBillPreview.Click
		LOCAL l_nWindow, l_nStyle, l_oParams, l_nBillAddrId, l_lUseBDateInStyle
		l_oParams = CREATEOBJECT("Empty")
		ADDPROPERTY(l_oParams, "cbillfrxname", "")
		
		SELECT cTmpHistres
		DO FORM "forms\billhistselectwin" WITH "cTmpHistres", l_oParams TO l_nWindow
		
		SELECT cTmpHistres
		IF NOT EMPTY(l_nWindow)
			l_nStyle = ProcBillStyle(cTmpHistres.hr_rsid, l_nWindow, @l_lUseBDateInStyle, .T.)
			l_nBillAddrId = DLookUp("billnum", "bn_reserid = " + SqlCnv(cTmpHistres.hr_reserid,.T.) + " AND bn_window = " + SqlCnv(l_nWindow,.T.), "bn_addrid")
			DO PrintCopy IN billhist WITH cTmpHistres.hr_reserid, l_nWindow, .T., l_nStyle, l_lUseBDateInStyle, l_nBillAddrId,,l_oParams.cbillfrxname
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdCopyReservation.Click
		LOCAL l_oCG AS PrCopyGroup OF procreservat.prg, l_lCopyGroup, l_nnewgroupreserid
		
		IF thisformset.useoldversion OR EMPTY(cTmpHistres.hr_reserid)
			RETURN .T.
		ENDIF
		IF NOT EMPTY(cTmpHistres.hr_groupid)
			l_lCopyGroup = yesno(GetLangText("RESERVAT", "TXT_COPYGROUP")+CHR(13)+CHR(10)+cTmpHistres.hr_group)
		ENDIF
		IF l_lCopyGroup
			l_oCG = NEWOBJECT("PrCopyGroup","procreservat.prg")
			l_nnewgroupreserid = l_oCG.OnCopyGroup(cTmpHistres.hr_reserid)
			l_oCG.Release()
			l_oCG = .NULL.
			IF l_nnewgroupreserid > 0
				DO FORM forms\quickedit WITH l_nnewgroupreserid
			ENDIF
		ELSE
			LOCAL ARRAY LArray(16)
			LArray(1) = cTmpHistres.hr_reserid
			LArray(2) = "COPY"
			LArray(3) = ""
			LArray(4) = ""
			LArray(5) = {}
			LArray(6) = {}
			LArray(7) = ""
			LArray(8) = 0
			LArray(9) = ""
			LArray(10) = 0
			LArray(11) = ""
			LArray(12) = ""
			LArray(13) = ""
			LArray(14) = ""
			LArray(15) = 0
			LArray(16) = thisform
			doform('reservat','forms\reservat','',.T.,@LArray)
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdSearchReservation.Click
		LOCAL l_nFound
		
		l_nFound = 0
		
		DO FORM forms\searchres WITH thisform, 60 TO l_nFound
		*	1 - cancelled
		*	2 - .F.
		*	3 - .T.
		IF l_nFound = 3
			thisformset.refresholdrespage()
		ELSE
			* when l_nFound = 1 do nothing
		ENDIF
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.cmdShowReservation.Click
		IF NOT thisformset.useoldversion AND NOT EMPTY(cTmpHistres.hr_reserid)
			LOCAL ARRAY LArray(16)
			LArray(1) = cTmpHistres.hr_reserid
			LArray(2) = "HISTORY"
			LArray(16) = thisform
			doform('reservat','forms\reservat','',.T.,@LArray)
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.AfterRowColChange
		LPARAMETERS nColIndex
		this.Refresh
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column1.Header1.DblClick
		DO CASE
			CASE ORDER('cTmpHistres') <> "TAG3"
				SET ORDER TO TAG3 IN cTmpHistres
			CASE DESCENDING(3,'cTmpHistres')
				SET ORDER TO TAG3 IN cTmpHistres ASCENDING
			OTHERWISE
				SET ORDER TO TAG3 IN cTmpHistres DESCENDING
		ENDCASE
		
		GOTO TOP IN cTmphistres
		this.Parent.Parent.SetFocus()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column15.Header1.DblClick
		DO CASE
			CASE ORDER('cTmpHistres') <> "TAG5"
				SET ORDER TO TAG5 IN cTmpHistres
			CASE DESCENDING(5,'cTmpHistres')
				SET ORDER TO TAG5 IN cTmpHistres ASCENDING
			OTHERWISE
				SET ORDER TO TAG5 IN cTmpHistres DESCENDING
		ENDCASE
		
		GOTO TOP IN cTmphistres
		this.Parent.Parent.SetFocus()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column2.Header1.DblClick
		DO CASE
			CASE ORDER('cTmpHistres') <> "TAG1"
				SET ORDER TO TAG1 IN cTmpHistres
			CASE DESCENDING(1,'cTmpHistres')
				SET ORDER TO TAG1 IN cTmpHistres ASCENDING
			OTHERWISE
				SET ORDER TO TAG1 IN cTmpHistres DESCENDING
		ENDCASE
		
		GOTO TOP IN cTmpHistres
		this.Parent.Parent.SetFocus()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column3.Header1.DblClick
		DO CASE
			CASE ORDER('cTmpHistres') <> "TAG2"
				SET ORDER TO TAG2 IN cTmpHistres
			CASE DESCENDING(2,'cTmpHistres')
				SET ORDER TO TAG2 IN cTmpHistres ASCENDING
			OTHERWISE
				SET ORDER TO TAG2 IN cTmpHistres DESCENDING
		ENDCASE
		
		GOTO TOP IN cTmphistres
		this.Parent.Parent.SetFocus()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Column7.Header1.DblClick
		DO CASE
			CASE ORDER('cTmpHistres') <> "TAG4"
				SET ORDER TO TAG4 IN cTmpHistres
			CASE DESCENDING(4,'cTmpHistres')
				SET ORDER TO TAG4 IN cTmpHistres ASCENDING
			OTHERWISE
				SET ORDER TO TAG4 IN cTmpHistres DESCENDING
		ENDCASE
		
		GOTO TOP IN cTmphistres
		this.Parent.Parent.SetFocus()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.DblClick
		this.SetFocus()
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.defineudpopupmenu
		DIMENSION this.aPopupMenu[6]
		this.aPopupMenu[1] = this.Parent.BHISTPRINT
		this.aPopupMenu[2] = this.Parent.CmdShowReservation
		this.aPopupMenu[3] = this.Parent.CmdCopyReservation
		this.aPopupMenu[4] = this.Parent.CmdSearchReservation
		this.aPopupMenu[5] = this.Parent.CmdBillPreview
		this.aPopupMenu[6] = P_COLUMNS
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Init
		LOCAL ARRAY l_aHistresCur(1)
		= AFIELDS(l_aHistresCur, "histres")
		DO CursorAddField IN ProcBill WITH l_aHistresCur, "al_allott", "C", 30, 0
		CREATE CURSOR cTmpHistres FROM ARRAY l_aHistresCur
		* If new column added then it must be added in listsdata.prg too. (addresshistory printing)
		INDEX ON DTOS(hr_arrdate) TAG TAG1
		INDEX ON DTOS(hr_depdate) TAG TAG2
		INDEX ON hr_lname TAG TAG3
		INDEX ON hr_roomtyp TAG TAG4
		INDEX ON al_allott TAG TAG5
		
		WITH this
			.RecordSource = [cTmpHistres]
			.column1.ControlSource = [cTmpHistres.hr_lname]
			.column2.ControlSource = [cTmpHistres.hr_arrdate]
			.column3.ControlSource = [cTmpHistres.hr_depdate]
			.column4.ControlSource = [cTmpHistres.hr_arrtime]
			.column5.ControlSource = [cTmpHistres.hr_deptime]
			.column6.ControlSource = [cTmpHistres.hr_rooms]
			.column7.ControlSource = [get_rt_roomtyp(cTmpHistres.hr_roomtyp)]
			.column8.ControlSource = [Get_rm_rmname(cTmpHistres.hr_roomnum)]
			.column9.ControlSource = [cTmpHistres.hr_adults + cTmpHistres.hr_childs + ;
				cTmpHistres.hr_childs2 + cTmpHistres.hr_childs3]
			.column10.ControlSource = [cTmpHistres.hr_rate]
			.column11.ControlSource = [cTmpHistres.hr_ratecod]
			.column12.ControlSource = [cTmpHistres.hr_status]
			.column13.ControlSource = [cTmpHistres.hr_company]
			.column14.ControlSource = [cTmpHistres.hr_group]
			.column15.ControlSource = [cTmpHistres.al_allott]
			.Column1.Header1.caption = GetLangText("ADDRESS","TXT_LNAME")
			.Column2.Header1.caption = GetLangText("ADDRESS","TXT_ARRDATE")
			.Column3.Header1.caption = GetLangText("ADDRESS","TXT_DEPDATE")
			.Column4.Header1.caption = GetLangText("ADDRESS","TXT_FROM")
			.Column5.Header1.caption = GetLangText("ADDRESS","TXT_TO")
			.Column6.Header1.caption = GetLangText("ADDRESS","TXT_ROOMS")
			.Column7.Header1.caption = GetLangText("ADDRESS","TXT_ROOMTYPE")
			.Column8.Header1.caption = GetLangText("ADDRESS","TXT_ROOMNUM")
			.Column9.Header1.caption = GetLangText("ADDRESS","TXT_PERS")
			.Column10.Header1.caption = GetLangText("ADDRESS","TXT_RATE")
			.Column11.Header1.caption = GetLangText("ADDRESS","TXT_RATECOD")
			.Column12.Header1.caption = GetLangText("ADDRESS","TXT_STATUS")
			.Column13.Header1.caption = GetLangText("ADDRESS","TXT_COMPANY")
			.Column14.Header1.caption = GetLangText("RESERV2","TXT_GROUP")
			.Column15.Header1.caption = GetLangText("RESERVAT","T_ALLOTT")
		ENDWITH
		DODEFAULT()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.Valid
		this.lAbout2LeaveGrid = .t.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageRevnue.RevnueGrid.When
		this.lAbout2LeaveGrid = .f.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageSales.Activate
		this.Parent.PageDokument.lOpened = .F.
		thisformset.RefreshSalesPage()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdIntrests.Click
		LOCAL l_oForm
		l_oForm = .NULL.
		DO FORM forms\adrintrests NAME l_oForm LINKED WITH address.ad_addrid
		thisformset.RefreshSalesPage("INTRESTS")
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdRates.Click
		LOCAL l_oForm
		l_oForm = .NULL.
		DO FORM forms\adrrates NAME l_oForm LINKED WITH address.ad_addrid
		thisformset.RefreshSalesPage("ADRRATES")
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageSales.cmdReIntervals.Click
		LOCAL l_oForm
		l_oForm = .NULL.
		DO FORM forms\adrresintervals NAME l_oForm LINKED WITH address.ad_addrid
		thisformset.RefreshSalesPage("RESINTERVALS")
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.SlavePage.PageSales.Init
		DODEFAULT()
		STORE 0 TO thisformset.aPageSalesData, thisformset.aAraccountData, thisformset.aForecastData
		STORE "" TO thisformset.aPageSalesData(1), thisformset.aPageSalesData(2), thisformset.aPageSalesData(9), thisformset.aPageSalesData(12)
		STORE {} TO thisformset.aPageSalesData(11)
		LOCAL l_nChild
		
		this.lblLast.Caption = GetLangText("ADDRESS","TXT_LAST")+":"
		this.lblLastRatecode.Caption = GetLangText("RESERVAT","T_RATECODE")+":"
		this.lblLastPrice.Caption = GetLangText("RESERVAT","T_PRICE")+":"
		this.lblRatecode.Caption = GetLangText("RATES","TXT_RATECODE")+":"
		this.lblPriceAdult1.Caption = "1."+GetLangText("RESERVAT","T_ADULTS")+":"
		this.lblPriceAdult2.Caption = "2."+GetLangText("RESERVAT","T_ADULTS")+":"
		this.lblPriceAdult3.Caption = "3."+GetLangText("RESERVAT","T_ADULTS")+":"
		this.lblLastPriceChild1.Caption = GetLangText("RESERVAT","T_CHILDS")+"1:"
		this.lblLastPriceChild2.Caption = GetLangText("RESERVAT","T_CHILDS")+"2:"
		this.lblLastPriceChild3.Caption = GetLangText("RESERVAT","T_CHILDS")+"3:"
		this.lblLastRoomtype.Caption = GetLangText("RESERVAT","T_ROOMTYPE")+":"
		this.lblLastRoom.Caption = GetLangText("DP","T_ROOM")+":"
		this.lblLastStay.Caption = GetLangText("RESERVAT","T_STAY")+":"
		this.lblLastContact.Caption = GetLangText("ADDRESS","TXT_LASTCONTACT")+":"
		this.lblLastContactType.Caption = GetLangText("ADDRESS","TXT_LASTCONTACT_TYPE")+":"
		this.lblMarket.Caption = GetLangText("DENIAL","T_MARKET")+":"
		this.lblSource.Caption = GetLangText("DENIAL","T_SOURCE")+":"
		
		this.txtLastRatecode.ControlSource = [laststay.ls_ratecod]
		this.txtLastPrice.ControlSource = [laststay.ls_rate]
		this.txtRatecode.ControlSource = [thisformset.aPageSalesData(9)]
		this.txtPriceAdults1.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceAdults2.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceAdults3.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceChild1.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceChild2.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceChild3.InputMask = REPLICATE("9", 6) + ".99"
		this.txtPriceAdults1.ControlSource = [thisformset.aPageSalesData(3)]
		this.txtPriceAdults2.ControlSource = [thisformset.aPageSalesData(4)]
		this.txtPriceAdults3.ControlSource = [thisformset.aPageSalesData(5)]
		this.txtPriceChild1.ControlSource = [thisformset.aPageSalesData(6)]
		this.txtPriceChild2.ControlSource = [thisformset.aPageSalesData(7)]
		this.txtPriceChild3.ControlSource = [thisformset.aPageSalesData(8)]
		this.txtLastRoomtype.ControlSource = [Get_rt_roomtyp(laststay.ls_roomtyp)]
		this.txtLastRoom.ControlSource = [Get_rm_rmname(laststay.ls_roomnum)]
		this.txtLastStayArr.ControlSource = [laststay.ls_arrdat]
		this.txtLastStayDep.ControlSource = [laststay.ls_depdate]
		this.txtContactDate.ControlSource = [thisformset.aPageSalesData(11)]
		this.txtContactType.ControlSource = [thisformset.aPageSalesData(12)]
		this.txtMarket.ControlSource = [laststay.ls_market]
		this.txtSource.ControlSource = [laststay.ls_source]
		
		l_nChild = lstcount(param.pa_childs)
		DO CASE
			CASE l_nChild = 0
				this.lblLastPriceChild1.Visible = .F.
				this.txtPriceChild1.Visible = .F.
				this.lblLastPriceChild2.Visible = .F.
				this.txtPriceChild2.Visible = .F.
				this.lblLastPriceChild3.Visible = .F.
				this.txtPriceChild3.Visible = .F.
			CASE l_nChild = 1
				this.lblLastPriceChild2.Visible = .F.
				this.txtPriceChild2.Visible = .F.
				this.lblLastPriceChild3.Visible = .F.
				this.txtPriceChild3.Visible = .F.
			CASE l_nChild = 2
				this.lblLastPriceChild3.Visible = .F.
				this.txtPriceChild3.Visible = .F.
		ENDCASE
		
		this.lblOpenBalance.Caption = GetLangText("ADDRESS","TXT_OPEN_BALANCE")+":"
		this.lblRem0.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 0"
		this.lblRem1.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 1"
		this.lblRem2.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 2"
		this.lblRem3.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 3"
		this.lblRemX.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 4"
		
		this.txtOpenBalance.ControlSource = [thisformset.aAraccountData(1)]
		this.txtRem0.ControlSource = [thisformset.aAraccountData(2)]
		this.txtRem1.ControlSource = [thisformset.aAraccountData(3)]
		this.txtRem2.ControlSource = [thisformset.aAraccountData(4)]
		this.txtRem3.ControlSource = [thisformset.aAraccountData(5)]
		this.txtRemX.ControlSource = [thisformset.aAraccountData(6)]
		
		IF NOT _screen.dv
			this.lblOpenBalance.Visible = .F.
			this.lblRem0.Visible = .F.
			this.lblRem1.Visible = .F.
			this.lblRem2.Visible = .F.
			this.lblRem3.Visible = .F.
			this.lblRemX.Visible = .F.
			this.txtOpenBalance.Visible = .F.
			this.txtRem0.Visible = .F.
			this.txtRem1.Visible = .F.
			this.txtRem2.Visible = .F.
			this.txtRem3.Visible = .F.
			this.txtRemX.Visible = .F.
			this.linArHorizontal1.Visible = .F.
			this.linArHorizontal2.Visible = .F.
			this.linArVertical1.Visible = .F.
			this.linArVertical2.Visible = .F.
			this.linArVertical3.Visible = .F.
			this.linArVertical4.Visible = .F.
			this.linArVertical5.Visible = .F.
		ENDIF
		
		this.lblAd_market.Caption = GetLangText("DENIAL","T_MARKET")+":"
		this.lblAd_source.Caption = GetLangText("DENIAL","T_SOURCE")+":"
		this.lblAd_discnt.Caption = GetLangText("RESERVAT","T_DISCOUNT")+":"
		this.cboAd_market.ControlSource = [thisformset.DataCopy.Ad_market]
		this.cboAd_source.ControlSource = [thisformset.DataCopy.Ad_source]
		this.cboAd_discnt.ControlSource = [thisformset.DataCopy.Ad_discnt]
		this.lblAd_discnt.Visible = _screen.oGlobal.oParam.pa_discnt
		this.cboAd_discnt.Visible = _screen.oGlobal.oParam.pa_discnt
		
		this.lblForecast.Caption = GetLangText("ADDRESS","TXT_FORECAST")
		this.lblExpectedRevOcc.Caption = GetLangText("ADDRESS","TXT_EXPECTED_REV_OCC")+":"
		this.lblUntilMonthEnd.Caption = GetLangText("ADDRESS","TXT_UNTIL_MONTH_END")+":"
		this.lblNext30days.Caption = GetLangText("ADDRESS","TXT_NEXT_30_DAYS")+":"
		this.lblUntilYearEnd.Caption = GetLangText("ADDRESS","TXT_UNTIL_YEAR_END")+":"
		this.lblNext365Days.Caption = GetLangText("ADDRESS","TXT_NEXT_365_DAYS")+":"
		this.lblRoom1.Caption = GetLangText("RATES","TXT_ROOM")
		this.lblRoom2.Caption = GetLangText("RATES","TXT_ROOM")
		this.lblRoom3.Caption = GetLangText("RATES","TXT_ROOM")
		this.lblRoom4.Caption = GetLangText("RATES","TXT_ROOM")
		this.lblRoom5.Caption = GetLangText("RATES","TXT_ROOM")
		
		this.txtExpectedRev.ControlSource = [thisformset.aForecastData(1)]
		this.txtExpectedOcc.ControlSource = [thisformset.aForecastData(2)]
		this.txtRevUntilMonthEnd.ControlSource = [thisformset.aForecastData(3)]
		this.txtOccUntilMonthEnd.ControlSource = [thisformset.aForecastData(4)]
		this.txtRevNext30days.ControlSource = [thisformset.aForecastData(5)]
		this.txtOccNext30days.ControlSource = [thisformset.aForecastData(6)]
		this.txtRevUntilYearEnd.ControlSource = [thisformset.aForecastData(7)]
		this.txtOccUntilYearEnd.ControlSource = [thisformset.aForecastData(8)]
		this.txtRevNext365Days.ControlSource = [thisformset.aForecastData(9)]
		this.txtOccNext365Days.ControlSource = [thisformset.aForecastData(10)]
		
		this.lblIntrests.Caption = GetLangText("ADDRESS","TXT_INTRESTS")
		this.lblResIntervals.Caption = GetLangText("ADDRESS","TXT_EXPECTED_RES_INTERVALS")
		
		this.edtIntrests.ControlSource = [thisformset.aPageSalesData(1)]
		this.edtResIntervals.ControlSource = [thisformset.aPageSalesData(2)]
		RETURN .T.
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_City.GotFocus
		if NOT thisformset.SelectForm.InEdit
			IF !EMPTY(this.value)
				thisformset.emptycity = .F.
			ELSE
				thisformset.emptycity = .T.
			endif 
		
			IF EMPTY(this.Parent.txtAd_zip.value)
				thisformset.emptyzip = .T.
			ELSE
				thisformset.emptyzip = .F.
			endif 
			IF EMPTY(this.Parent.txtAd_State.value)
				thisformset.emptystate = .T.
			ELSE
				thisformset.emptystate = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone.value)
				thisformset.emptyphone1 = .T.
			ELSE
				thisformset.emptyphone1 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone2.value)
				thisformset.emptyphone2 = .T.
			ELSE
				thisformset.emptyphone2 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone3.value)
				thisformset.emptyphone3 = .T.
			ELSE
				thisformset.emptyphone3 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Fax.value)
				thisformset.emptyfax = .T.
			ELSE
				thisformset.emptyfax = .F.
			endif 
		
		
			Select ZipcodeTAlias
			set Order to TAG2
			SEEK this.Parent.txtAd_Country.Value + zc_city
		*	Set Filter To pl_label = "LANGUAGE"
			thisformset.zipcodern = 0
			thisformset.SelectForm.TFilter = Filter() &&uvek tako
			thisformset.SelectForm.TField = [zc_city] &&sta ostaje u edit boxu
			thisformset.SelectForm.SetFilter = .T. && nebitno
			thisformset.SelectForm.NextObj1 = thisform.MainPage.PageAddress.InfoPage.pagCommunication.txtAd_Phone &&koji ce sledeco objekt dobiti fokus
			thisformset.SelectForm.CurrObj = this && uvek tako
		
			&&fizicki izgled
			thisformset.SelectForm.Width = 320 * thisformset.ScaleWidth
			thisformset.SelectForm.Height = 110 * thisformset.ScaleHeight
			thisformset.SelectForm.MCodeGrid.Width = 320 * thisformset.ScaleWidth
			thisformset.SelectForm.MCodeGrid.ColumnCount = 2
			thisformset.SelectForm.MCodeGrid.Column1.Width = 116 * thisformset.ScaleWidth
			thisformset.SelectForm.MCodeGrid.Column2.Width = 170 * thisformset.ScaleWidth
		
			&& kontola grida
			thisformset.SelectForm.MCodeGrid.RecordSource = [ZipcodeTAlias]
			thisformset.SelectForm.MCodeGrid.Column1.ControlSource = [zc_city]
			thisformset.SelectForm.MCodeGrid.Column2.ControlSource = [zc_zip]
			&&polozaj forme 
			thisformset.SelectForm.Top = thisform.Top + thisform.MainPage.Top + this.Top + this.Height + 50 && - Title height
			thisformset.SelectForm.Left = max(5, thisform.Left + this.Left - Int(thisformset.SelectForm.Width / 2))
			
			thisformset.closeselectform = .T.
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_City.InteractiveChange
		Local m.SStart
		
		thisform.AlwaysOnTop = .T.
		
		thisformset.SelectForm.InEdit = .T.
		
		m.SStart = this.SelStart
		
		thisformset.SelectForm.Visible = .T.
		
		
		SEEK this.Parent.txtAd_Country.Value + UPPER(allTrim(this.Text))
		if !found()
			thisformset.SelectForm.visible = .f.
		else
			if !thisformset.SelectForm.visible
				thisformset.SelectForm.visible = .t.
			endif
		endif
		
		IF thisformset.SelectForm.MCodeGrid.Height != thisformset.SelectForm.Height
			thisformset.SelectForm.MCodeGrid.SetFocus()
			this.SetFocus()
		ENDIF
		
		this.SelStart = m.SStart
		
		thisform.AlwaysOnTop = .F.
		thisformset.SelectForm.Refresh()
		
		thisformset.SelectForm.InEdit = .F.
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_City.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			thisformset.SelectForm.Visible = .T.
			thisformset.SelectForm.MCodeGrid.SetFocus()
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_City.LostFocus
		IF TYPE("thisformset.SelectForm") = "U"
			RETURN
		ENDIF
		
		if thisformset.SelectForm.InEdit
			return
		endif
		
		if Empty(this.Text)
			Select ZipcodeTAlias
		*	Set Filter To
			thisformset.SelectForm.Visible = .F.
			return
		endif
		
		Local m.EFeat, LFound
		m.EFeat = alltrim(this.Text)
		
		IF !(thisformset.zipcodern = 0)
			GO thisformset.zipcodern
			thisformset.zipcodern = 0
			LFound = .T.
		ELSE
			SEEK UPPER(this.Parent.txtAd_Country.Value + m.EFeat)
			IF FOUND()
				LFound = .T.
			ELSE
				LFound = .F.
			ENDIF
		ENDIF
		
		if LFound
			this.Value = RTrim(zc_city) && ovo
				WITH thisform.MainPage.PageAddress
					IF thisformset.emptyzip
						.txtAd_zip.value = zipcodetalias.zc_zip
					ENDIF
					IF thisformset.emptystate
						.txtAd_State.value = zipcodetalias.zc_state
					ENDIF
					IF thisformset.emptyphone1 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyphone2 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone2.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyphone3 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone3.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyfax AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Fax.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
				endwith
		
		endif
		this.Refresh()
		thisformset.SelectForm.Visible = .F.
		
		*Set Filter To
		thisformset.closeselectform = .F.
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Company.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Company.LostFocus
		IF EMPTY(this.parent.txtAd_Compkey.value)
			this.parent.txtAd_Compkey.value = PACreateCompanyKey(this.value)
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Compkey.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Compnum.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Country.GotFocus
		IF ORDER('picklist')!="TAG4"
			set order to "TAG4" IN PickList
		ENDIF
		SET FILTER TO pl_label = "COUNTRY" IN PickList
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Country.LostFocus
		SET FILTER TO IN PickList
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Country.Valid
		LOCAL LOk
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.Value)) = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Departm.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Fname.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Lang.LostFocus
		this.Parent.ocbotitle.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Lang.Valid
		LOCAL LOk, Lval
		Lval = ALLTRIM(UPPER(this.Value))
		IF !EMPTY(this.displayValue)
			FOR i = 1 TO this.ListCount
				IF Lval = alltrim(this.List(i,1))
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .T.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Lname.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Salute.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_State.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Street.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Street2.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Zip.GotFocus
		if NOT thisformset.SelectForm.InEdit
			IF !EMPTY(this.value)
				thisformset.emptyzip = .F.
			ELSE
				thisformset.emptyzip = .T.
			endif 
		
			IF EMPTY(this.Parent.txtAd_City.value)
				thisformset.emptycity = .T.
			ELSE
				thisformset.emptycity = .F.
			endif 
			IF EMPTY(this.Parent.txtAd_State.value)
				thisformset.emptystate = .T.
			ELSE
				thisformset.emptystate = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone.value)
				thisformset.emptyphone1 = .T.
			ELSE
				thisformset.emptyphone1 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone2.value)
				thisformset.emptyphone2 = .T.
			ELSE
				thisformset.emptyphone2 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Phone3.value)
				thisformset.emptyphone3 = .T.
			ELSE
				thisformset.emptyphone3 = .F.
			endif 
			IF EMPTY(this.Parent.InfoPage.pagCommunication.txtAd_Fax.value)
				thisformset.emptyfax = .T.
			ELSE
				thisformset.emptyfax = .F.
			endif 
		
		*	Local m.Lang
		
			Select ZipcodeTAlias
			set Order to TAG1
			SEEK this.Parent.txtAd_Country.Value + zc_zip
		*	Set Filter To pl_label = "LANGUAGE"
			thisformset.zipcodern = 0
			
			thisformset.SelectForm.TFilter = Filter() &&uvek tako
			thisformset.SelectForm.TField = [zc_zip] &&sta ostaje u edit boxu
			thisformset.SelectForm.SetFilter = .T. && nebitno
			thisformset.SelectForm.NextObj1 = thisform.MainPage.PageAddress.txtAd_City &&koji ce sledeco objekt dobiti fokus
			thisformset.SelectForm.CurrObj = this && uvek tako
		
			&&fizicki izgled
			thisformset.SelectForm.Width = 320 * thisformset.ScaleWidth
			thisformset.SelectForm.Height = 110 * thisformset.ScaleHeight
			thisformset.SelectForm.MCodeGrid.Width = 320 * thisformset.ScaleWidth
			thisformset.SelectForm.MCodeGrid.ColumnCount = 2
			thisformset.SelectForm.MCodeGrid.Column1.Width = 116 * thisformset.ScaleWidth
			thisformset.SelectForm.MCodeGrid.Column2.Width = 170 * thisformset.ScaleWidth
		
			&& kontola grida
			thisformset.SelectForm.MCodeGrid.RecordSource = [ZipcodeTAlias]
			thisformset.SelectForm.MCodeGrid.Column1.ControlSource = [zc_zip]
			thisformset.SelectForm.MCodeGrid.Column2.ControlSource = [zc_city]
			&&polozaj forme 
			thisformset.SelectForm.Top = thisform.Top + thisform.MainPage.Top + this.Top + this.Height + 50 && - Title height
			thisformset.SelectForm.Left = max(5, thisform.Left + this.Left - Int(thisformset.SelectForm.Width / 2))
			
			thisformset.closeselectform = .T.
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Zip.InteractiveChange
		Local m.SStart
		
		thisform.AlwaysOnTop = .T.
		
		thisformset.SelectForm.InEdit = .T.
		
		m.SStart = this.SelStart
		
		thisformset.SelectForm.Visible = .T.
		
		
		SEEK this.Parent.txtAd_Country.Value + allTrim(this.Text) IN zipcode
		
		if !found('zipcode')
			thisformset.SelectForm.visible = .f.
		else
			if !thisformset.SelectForm.visible
				thisformset.SelectForm.visible = .t.
			endif
		endif
		IF thisformset.SelectForm.MCodeGrid.Height != thisformset.SelectForm.Height
			thisformset.SelectForm.MCodeGrid.SetFocus()
			this.SetFocus()
		ENDIF
		
		this.SelStart = m.SStart
		
		thisform.AlwaysOnTop = .F.
		thisformset.SelectForm.Refresh()
		
		thisformset.SelectForm.InEdit = .F.
		
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Zip.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			thisformset.SelectForm.Visible = .T.
			thisformset.SelectForm.MCodeGrid.SetFocus()
			if !found()
				thisformset.SelectForm.visible = .f.
			else
				if !thisformset.SelectForm.visible
					thisformset.SelectForm.visible = .t.
				endif
			endif
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtAd_Zip.LostFocus
		IF TYPE("thisformset.SelectForm") = "U"
			RETURN
		ENDIF
		
		if thisformset.SelectForm.InEdit
			return
		endif
		
		if Empty(this.Text)
			Select ZipcodeTAlias
		*	Set Filter To
			thisformset.SelectForm.Visible = .F.
		*	if thisformset.SelectForm.TitleBar = 1
		*		thisformset.SelectForm.TitleBar = 0
		*		thisformset.SelectForm.Caption = ""
		*		thisformset.SelectForm.MCodeGrid.visible = .T.
		*	endif
		
			return
		endif
		
		Local m.EFeat, LFound
		m.EFeat = alltrim(this.Text)
		*GOTO TOP IN 'zipcode'
		*SEEK UPPER(this.Parent.txtAd_Country.Value + m.EFeat)
		IF !(thisformset.zipcodern = 0)
			GO thisformset.zipcodern
			thisformset.zipcodern = 0
			LFound = .T.
		ELSE
			SEEK UPPER(this.Parent.txtAd_Country.Value + m.EFeat) IN zipcode
			IF FOUND('zipcode')
				LFound = .T.
			ELSE
				LFound = .F.
			ENDIF
		ENDIF
		
		if LFound
			this.Value = RTrim(zc_zip) && ovo
		*	IF thisformset.zipcodern = 0
				WITH thisform.MainPage.PageAddress
					IF thisformset.emptycity
						.txtAd_City.value = zipcodetalias.zc_city
					ENDIF
					IF thisformset.emptystate
						.txtAd_State.value = zipcodetalias.zc_state
					ENDIF
					IF thisformset.emptyphone1 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyphone2 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone2.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyphone3 AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Phone3.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
					IF thisformset.emptyfax AND !EMPTY(zipcodetalias.zc_prefix)
						.InfoPage.pagCommunication.txtAd_Fax.value = ALLTRIM(zipcodetalias.zc_prefix) + "-"
					ENDIF
				endwith
		*	endif
		else
			*this.Value = ""
		endif
		this.Refresh()
		thisformset.SelectForm.Visible = .F.
		*if thisformset.SelectForm.TitleBar = 1
		*	thisformset.SelectForm.TitleBar = 0
		*	thisformset.SelectForm.Caption = ""
		*	thisformset.SelectForm.MCodeGrid.visible = .T.
		*endif
		
		*Set Filter To
		thisformset.closeselectform = .F.
			
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageAddress.txtti_attn.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if (nKeyCode = ShKCChoose) AND (nShiftAltCtrl = ShSCAChoose)
			nodefault
		endif
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.Activate
		LOCAL l_nRecno
		
		this.Parent.PageAddress.SlavePage.PageDokument.lOpened = .F.
		
		if this.parent.activepage = 2&& AND !thisformset.tpypahd
		*	this.addressgrid.refresh
		*	WAIT WINDOW "Refresh PageGrid" NOWAIT TIMEOUT 1
			*IF !thisformset.tpypahd
			*	if INLIST(thisFORMSET.addressstart,'BRW','BRC')&& AND !thisformset.tpypahd
			*		THISFORM.TIMER1.ENABLED=.T.
					*this.tpypahd = .T.
			*	ENDIF
			*ELSE
				*WAIT WINDOW "Refresh PageGrid, Setfocus" NOWAIT TIMEOUT 1
			
			*************************************************************************************************************
			* Don't allow focus to be set on grid, when called in BROWSE mode, because form won't be resized properly.  *
			* In PageAddress.Activate we will allow this, because when user get on this page on another address record, *
			* in grid this wouldn't be refreshed.
		
			IF thisformset.tpypahd
				l_nRecno = RECNO(this.AddressGrid.RecordSource)
				this.addressgrid.setfocus()
				* In some cases when Addressmask is maximized after editing an address SetFocus change selected record on address alias.
				GO l_nRecno IN (this.AddressGrid.RecordSource)
			ENDIF
		
			*                                                                                                           *
			*************************************************************************************************************
		
		endif
		thisformset.OldActivPage = 2
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.AfterRowColChange
		LPARAMETERS nColIndex
		
		thisformset.SelectAddress()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.BeforeRowColChange
		LPARAMETERS nColIndex
		If Thisformset.selectedtable<>'address' And !Empty(Thisformset.selectedtable)
			If Recno()<Reccount() AND RECNO()>(RECCOUNT()-25)
				*WAIT WINDOW NOWAIT "test"
				thisformset.searchengine
			Endif
		ENDIF
		IF !This.lAbout2LeaveGrid
			This.nRecNo = 0
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Tchkgrid1.Click
		DO CASE
			CASE thisformset.mode = 24
				thisformset.onselectaddress(.T.)
			CASE thisformset.mode = 25
				thisformset.onselectreferral(.T.)
		ENDCASE	
		this.Parent.Parent.Refresh()
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.Column13.Tchkgrid1.InteractiveChange
		* overlap class code
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		
		LOCAL l_nOldArea, l_nColumn, l_lDoDefault, l_nGridTopCorr, l_nMainAddrId, l_cAdrInfo, l_i
		LOCAL ARRAY l_aColumnSaved(11)
		
		WITH this
			.ColumnCount = .ColumnCount
			.Column1.cSortOrder = "tag4"
			.Column2.cSortOrder = "tag3"
			.Column3.cSortOrder = "tag2"
			.Column5.cSortOrder = "tag26"
			.Column6.cSortOrder = "tag27"
			.Column7.cSortOrder = "tag7"
			.Column8.cSortOrder = "tag28"
			.Column14.cSortOrder = "tag29"
			.Column15.cSortOrder = "tag5"
			.Column1.Header1.Caption = GetLangText("ADDRESS","TXT_KEYSEARCH")
			.Column2.Header1.Caption = GetLangText("ADDRESS","TXT_COMPANY")
			.Column3.Header1.Caption = GetLangText("ADDRESS","TXT_LNAME") + ", " + GetLangText("ADDRESS","TXT_FIRSTNAME")
			.Column4.Header1.Caption = GetLangText("ADDRESS","TXT_TITLE")
			.Column5.Header1.Caption = GetLangText("ADDRESS","TXT_STREET")
			.Column6.Header1.Caption = GetLangText("ADDRESS","TXT_CITYZIP ")
			.Column7.Header1.Caption = GetLangText("ADDRESS","TXT_CITY")
			.Column8.Header1.Caption = GetLangText("ADDRESS","TXT_PHONE")
			.Column9.Header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" " ;
				+GetLangText("ADDRESS","TXT_COMPANY")
			.Column10.Header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" " ;
				+GetLangText("RESERVAT","T_INVOICE")
			.Column11.Header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" " ;
				+GetLangText("REFERRAL","TXT_LINK_MAIN_ADDRESS")
			.Column12.Header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID_OTHER")
			.Column13.Header1.Caption = GetLangText("CONFWEEK","TW_SELECT")
			.Column14.Header1.Caption = GetLangText("ADDRESS","TXT_DEPARTM")
			.Column15.Header1.Caption = GetLangText("ADDRESS","T_KEYNR")
			thisformset.SetAddressGridSource('address')
		ENDWITH
		
		IF LOWER(thisform.cformlabel) = "searchadr"
			* Address select mode. Called to select addresses, which should be deleted and merged with main address
			l_nGridTopCorr = 90
			this.Top = this.Top + l_nGridTopCorr
			this.Height = this.Height - l_nGridTopCorr
			this.Column13.ControlSource = [thisformset.onselectaddress()]
			this.cgridlabelname = UPPER(ALLTRIM(thisform.cformlabel)+this.Name)
			this.ReadOnly = .F.
			this.SetAll("ReadOnly",.T.)
			this.column13.ReadOnly = .F.
			this.Parent.AddObject("edtMainAddress","teditbox")
			this.Parent.edtMainAddress.Top = this.Parent.shape1.Top + 10
			this.Parent.edtMainAddress.left = INT(this.Parent.shape1.width/2)
			this.Parent.edtMainAddress.Height = this.Top - this.Parent.edtMainAddress.Top - 5
			this.Parent.edtMainAddress.Width = INT(this.Parent.shape1.width/2) - 10
			this.Parent.edtMainAddress.ReadOnly = .T.
			this.Parent.edtMainAddress.FontSize = 10
			this.Parent.edtMainAddress.ResizeFontSize = .F.
			this.Parent.edtMainAddress.Init()
			TRY
				l_nMainAddrId = thisformset.oParam.Item("MAIN_ADDRID")
			CATCH
			ENDTRY
			IF NOT EMPTY(l_nMainAddrId) AND dlocate("address3","ad_addrid = " + sqlcnv(l_nMainAddrId))
				l_cAdrInfo = ""
				l_cAdrInfo = l_cAdrInfo + ;
						IIF(EMPTY(address3.ad_company), ALLTRIM(address3.ad_title), address3.ad_company) + CHR(13)
				l_cAdrInfo = l_cAdrInfo + ALLTRIM(address3.ad_departm) + CHR(13)
				l_cAdrInfo = l_cAdrInfo + IIF(EMPTY(address3.ad_company), "", LTRIM(RTRIM(address3.ad_title) + " ")) + ;
							LTRIM(RTRIM(address3.ad_fname) + " ") + Flip(address3.ad_lname) + CHR(13)
				l_cAdrInfo = l_cAdrInfo + address3.ad_street + CHR(13)
				l_cAdrInfo = l_cAdrInfo + address3.ad_street2 + CHR(13)
				l_cAdrInfo = l_cAdrInfo + LTRIM(RTRIM(address3.ad_zip) + "  ") + address3.ad_city + CHR(13)
				l_cAdrInfo = l_cAdrInfo +  ;
						DLookUp('PickList', 'pl_label = [COUNTRY] AND pl_charcod = ' + SqlCnv(address3.ad_country), 'pl_lang' + g_langnum)
				this.Parent.edtMainAddress.Value = l_cAdrInfo
			ENDIF
			this.Parent.edtMainAddress.Visible = .T.
		
			this.Parent.AddObject("lblMainAddress","tlabel")
			IF thisformset.mode = 24
				this.Parent.lblMainAddress.Caption = GetLangText("ADDRESS","TXT_SELECT_ADDRESSES")
			ELSE
				this.Parent.lblMainAddress.Caption = GetLangText("REFERRAL","TXT_REF_THIS_CONTACT")
			ENDIF
			this.Parent.lblMainAddress.Top = this.Parent.edtMainAddress.Top
			this.Parent.lblMainAddress.Left = this.Parent.shape1.Left + 5
			this.Parent.lblMainAddress.Width = this.Parent.edtMainAddress.Width - 20
			this.Parent.lblMainAddress.Height = this.Parent.edtMainAddress.Height
			this.Parent.lblMainAddress.WordWrap = .T.
			this.Parent.lblMainAddress.Init()
			this.Parent.lblMainAddress.Visible = .T.
		ELSE
			this.cgridlabelname = UPPER(this.Name)
		ENDIF
		
		* Columns 9 ,10, 11 are not active by default
		
		this.DefaultPropertiesSet(9, "gr_activ", .F.)
		this.DefaultPropertiesSet(10, "gr_activ", .F.)
		this.DefaultPropertiesSet(11, "gr_activ", .F.)
		this.DefaultPropertiesSet(12, "gr_show", .T.)
		this.DefaultPropertiesSet(12, "gr_activ", .F.)
		this.DefaultPropertiesSet(13, "gr_activ", LOWER(thisform.cformlabel) = "searchadr")
		this.DefaultPropertiesSet(13, "gr_show", .F.)
		this.DefaultPropertiesSet(14, "gr_order", 2)	&& Department is 2nd column in grid
		this.DefaultPropertiesSet(4, "gr_order", 4)		&& Title (before name) is 4th column in grid
		
		IF _screen.BMS
			* Mark red when address has BMS account
			LOCAL l_cBackColor
			IF _screen.oGlobal.lUseMainServer
				IF NOT _screen.oGlobal.lmainserverremote
					l_cBackColor = "SEEK(EVALUATE(thisformset.fAddressMask.mainPage.pageGridAddress.addressGrid.RecordSource+'.ad_adid'),'bsacct','tag3') ,rgb(255,130,130)"
				ENDIF
			ELSE
				l_cBackColor = "SEEK(EVALUATE(thisformset.fAddressMask.mainPage.pageGridAddress.addressGrid.RecordSource+'.ad_addrid'),'bsacct','tag2') ,rgb(255,130,130)"
			ENDIF
			IF NOT EMPTY(l_cBackColor)
				FOR l_i = 1 TO this.ColumnCount
					this.Columns(l_i).AddProperty("cCustomDynamicBackColor",l_cBackColor)
				ENDFOR
				this.HighlightRowLineWidth = 3
				this.HighlightStyle = 0
				this.HighlightRow = .T.
			ENDIF
		ENDIF
		
		DODEFAULT()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.setordering
		LPARAMETERS lp_cSortOrder, lp_lAskOrder
		
		IF NOT thisformset.SearchActive
			DODEFAULT(lp_cSortOrder, lp_lAskOrder)
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.Valid
		this.lAbout2LeaveGrid = .t.
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.AddressGrid.When
		this.lAbout2LeaveGrid = .f.
		
	ENDPROC

	PROCEDURE FAddressMask.MainPage.PageGridAddress.Deactivate
		IF !thisformset.FAddressMask.mainPage.Tabs
			thisformset.tpypahd = .T.
			thisformset.FAddressMask.mainPage.Tabs = .T.
		ENDIF
		*IF !thisformset.tpypahd
		*	this.addressgrid.refresh()
		*	thisformset.refreshaddressgrid()
		*ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.Moved
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this
				_screen.oCardReaderHandler.oHicHandler.oCr.MoveForm()
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.oProcAddress.adrmainchangesgetprogress
		LPARAMETERS lp_nPercent, lp_nMode
		* Modes:
		* 0 - Start, 1 - Iterate, 2 - Finish
		
		IF EMPTY(lp_nMode)
			lp_nMode = 0
		ENDIF
		IF EMPTY(lp_nPercent)
			lp_nPercent = 1
		ENDIF
		DO CASE
			CASE lp_nMode = 0
				_screen.oGlobal.oStatusBar.ProgressBarStart(GetLangText("COMMON","TXT_SYNC_ADDRESS"))
			CASE lp_nMode = 2
				_screen.oGlobal.oStatusBar.ProgressBarStop()
			OTHERWISE
				_screen.oGlobal.oStatusBar.ProgressBarStep(lp_nPercent)
		ENDCASE
		
		RETURN .T.
	ENDPROC

	PROCEDURE FAddressMask.oProcAddress.requeryallreferralscursor
		LOCAL llFirstAddress
		
		IF this.RequeryAllReferralCursors
			this.RequeryAllReferralCursors = .F.
			llFirstAddress = thisformset.FirstAddressInReferrals(address.ad_addrid)
			ZAP IN curLinkedAddress
			DO GetAllReferralList IN procaddress WITH address.ad_addrid, llFirstAddress
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.QueryUnload
		NODEFAULT
		thisformset.addressexit()
	ENDPROC

	PROCEDURE FAddressMask.Release
		IF thisformset.lodbc
			IF TYPE("thisformset.opgde.oaddressgrid")="O" AND NOT ISNULL(thisformset.opgde.oaddressgrid)
				thisformset.opgde.oaddressgrid = .NULL.
			ENDIF
			IF TYPE("thisformset.opgde.ocaaddress")="O" AND NOT ISNULL(thisformset.opgde.ocaaddress)
				thisformset.opgde.ocaaddress = .NULL.
			ENDIF
			thisformset.opgde = .NULL.
		ENDIF
		
		DODEFAULT()
		
		this.Parent.Release()
	ENDPROC

	PROCEDURE FAddressMask.Resize
		LPARAMETERS nwidth,nheight
		DODEFAULT(nwidth,nheight)
		thisformset.ScaleWidth = this.width/this.w
		thisformset.scaleheight = this.height/this.h
		
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this
				_screen.oCardReaderHandler.oHicHandler.oCr.MoveForm()
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE FAddressMask.Timer1.Timer
		this.Enabled = .F.
		IF thisformset.AddressStart == "EDITL" AND _screen.oGlobal.oParam2.pa_aselnam
			thisform.mainpage.pageaddress.txtAd_Fname.SetFocus()
		ELSE
			thisform.mainpage.pageaddress.txtad_company.SetFocus()
		ENDIF
		
	ENDPROC

	PROCEDURE FAddressMask.Timer2.Init
		this.AddProperty("lMailingCodeCheck",.F.)
	ENDPROC

	PROCEDURE FAddressMask.Timer2.Timer
		this.Enabled = .F.
		IF this.lMailingCodeCheck
			this.lMailingCodeCheck = .F.
			thisform.mainpage.ActivePage = 1
			thisform.mainpage.pageAddress.InfoPage.ActivePage=2
			thisform.mainpage.pageAddress.InfoPage.pagGuestInfo.Activate()
		ELSE
			thisform.mainpage.pageGRIDaddress.ADDRESSGRID.setfocus
		ENDIF
		
		RETURN .T.
		
	ENDPROC

	PROCEDURE NewDocument.assigncaption
		this.Caption = ""&&GetLangText("ADDRESS","TXT_DOCUMENT_TYPE")
		this.tlabelDocumentType.Caption = GetLangText("DOC","TXT_DOCUMENT_TYPE")
		this.toDocumentType.optionDOC.Caption = GetLangText("DOC","TXT_WORD_DOCUMENT")
		this.toDocumentType.optionEXCEL.Caption = GetLangText("DOC","TXT_EXCEL_DOCUMENT")
		this.toDocumentType.optionNOTE.Caption = GetLangText("DOC","TXT_PHONE_NOTE")
		this.toDocumentType.optionEMAIL.Caption = GetLangText("DOC","TXT_EMAIL")
		this.toDocumentType.optionRECIVABLES.Caption = GetLangText("DOC","TXT_RECIVABLES")
		this.toDocumentType.optionWRITER.Caption = GetLangText("DOC","TXT_WRITER_DOCUMENT")
		this.toDocumentType.optionCALC.Caption = GetLangText("DOC","TXT_CALC_DOCUMENT")
		this.toDocumentType.optionPDF.Caption = GetLangText("DOC","TXT_PDF_DOCUMENT")
		this.toDocumentType.optionEXTERNAL.Caption = GetLangText("DOC","TXT_EXTERN_DOCUMENT")
		this.toDocumentType.optionAll.Caption = GetLangText("DOC","TXT_ALL_DOCUMENTS")
		
		this.tcbCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
		this.tcbOK.Caption = GetLangText("COMMON","TXT_OK")
		
	ENDPROC

	PROCEDURE NewDocument.Init
		this.Tag = ""
		this.assigncaption()
		IF NOT _SCREEN.OL
			this.ToDocumentType.OptionEMAIL.Enabled = .F.
		ENDIF
		DODEFAULT()
	ENDPROC

	PROCEDURE NewDocument.QueryUnload
		NODEFAULT
		thisform.tcbCancel.Click()
	ENDPROC

	PROCEDURE NewDocument.TcbCancel.Click
		thisform.Tag = ""
		thisform.Caption = ""
		thisform.Visible = .F.
		
	ENDPROC

	PROCEDURE NewDocument.TcbOK.Click
		LOCAL LFilter
		IF thisform.Tag = "SELECT"
			DO CASE
				CASE thisform.toDocumentType.Value = 2
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "INLIST(dc_type, [ ], [WORDDOC ], [WORDDOCX])"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 3
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [EXCELDOC]"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 4
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [TELENOTE]"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 5
					thisformset.ldocumentsemail = .T.
					thisformset.cdocumentsfilter = ".F."
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 6
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = ".F."
					thisformset.lDebitorRecivables = .T.
				CASE thisform.toDocumentType.Value = 7
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [WRITERDOC]"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 8
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [CALCDOC]"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 9
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [PDFDOC]"
					thisformset.lDebitorRecivables = .F.
				CASE thisform.toDocumentType.Value = 10
					thisformset.ldocumentsemail = .F.
					thisformset.cdocumentsfilter = "dc_type = [EXTERNAL]"
					thisformset.lDebitorRecivables = .F.
				OTHERWISE
					thisformset.ldocumentsemail = _SCREEN.OL
					thisformset.cdocumentsfilter = ".T."
					thisformset.lDebitorRecivables = _SCREEN.DV
			ENDCASE
			thisformset.refreshdocpage()
			GO TOP IN curDocument
		ENDIF
		thisform.Tag = ""
		thisform.Caption = ""
		thisform.Visible = .F.
		
		RETURN .T.
	ENDPROC

	PROCEDURE ReferralForm.Activate
		this.tpageMain.pageData.tcomboFrom.SetFocus()
		
	ENDPROC

	PROCEDURE ReferralForm.assigncaption
		this.Caption = ""&&GetLangText("REFERRAL","TXT_REFERRAL")
		this.tcbCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
		this.tcbOK.Caption = GetLangText("COMMON","TXT_OK")
		this.tpageMain.pageData.tlFrom.Caption = GetLangText("REFERRAL","TXT_REF_THIS_CONTACT")
		this.tpageMain.pageData.tlTo.Caption = GetLangText("REFERRAL","TXT_TO_THIS_CONTACT")
		this.tpageMain.pageData.tlText.Caption = GetLangText("REFERRAL","TXT_YOU_CAN_LINK_CONTACT")
		this.tpageMain.pageData.tlFromCombo.Caption = GetLangText("REFERRAL","TXT_REFERRENCE")
		this.tpageMain.pageData.tlToCombo.Caption = GetLangText("REFERRAL","TXT_REFERRENCE")
		this.tpageMain.PageData.tcLinkCompany.Caption = GetLangText("REFERRAL","TXT_LINK_COMPANY")
		this.tpageMain.PageData.tcLinkInvoice.Caption = GetLangText("REFERRAL","TXT_LINK_INVOICE")
		this.tpageMain.PageData.tcMainAddress.Caption = GetLangText("REFERRAL","TXT_LINK_MAIN_ADDRESS")
		this.tpageMain.pageInfo.tlabelMessage.Caption = GetLangText("REFERRAL","TXT_INFO_ABOUT_REFERRAL")
		this.tpageMain.pageInfo.tlCreated.Caption = GetLangText("REFERRAL","TXT_INFO_CREATED")
		this.tpageMain.pageInfo.tlupdated.Caption = GetLangText("REFERRAL","TXT_INFO_UPDATED")
		
		
		this.tpageMain.pageData.Caption = GetLangText("REFERRAL","TXT_REFERRAL_LINK")
		this.tpageMain.pageInfo.Caption = GetLangText("REFERRAL","TXT_AUDIT")
	ENDPROC

	PROCEDURE ReferralForm.Deactivate
		IF thisform.p_ok_pressed
			thisform.p_ok_pressed = .F.
		ELSE
			thisform.tcbCancel.Click()	
		ENDIF
		
	ENDPROC

	PROCEDURE ReferralForm.Init
		LOCAL LMacro
		this.AddProperty("p_fromcompany","")
		this.AddProperty("p_tocompany","")
		this.AddProperty("p_ok_pressed",.f.)
		this.AddProperty("LastTabKey", 0)
		this.AddProperty("p_mode","")
		this.AddProperty("p_linkres",.f.)
		this.AddProperty("oReferrals",.NULL.)
		this.AddProperty("oData",.NULL.)
		*this.AddProperty("p_note","")
		
		SELECT referral1
		SCATTER MEMO NAME thisform.oData BLANK
		
		this.tpageMain.pageData.ttFrom.ControlSource = [thisform.p_fromcompany]
		this.tpageMain.pageData.ttTo.ControlSource = [thisform.p_tocompany]
		this.tpageMain.pageData.tcMainAddress.ControlSource = [thisform.oData.re_mainadr]
		this.tpageMain.pageData.teditNotes.ControlSource = [thisform.oData.re_note]
		
		STORE "SELECT pl_lang"+g_langnum+" AS pl_lang, pl_numcod " + ;
			"FROM picklist " + ;
			"WHERE pl_label = [REFERRAL] " + ;
			"ORDER BY 1" TO ;
			this.tpageMain.pageData.tcomboFrom.jsql, ;
			this.tpageMain.pageData.tcomboto.jsql
		this.tpageMain.pageData.tcomboFrom.jboundcolumn = 2
		this.tpageMain.pageData.tcomboFrom.jcolumncount = 2
		this.tpageMain.pageData.tcomboFrom.jcolumnwidths = "250,40"
		this.tpageMain.pageData.tcomboFrom.ControlSource = "thisform.oData.re_lnkf"
		this.tpageMain.pageData.tcomboFrom.Init()
		
		this.tpageMain.pageData.tcomboTo.jboundcolumn = 2
		this.tpageMain.pageData.tcomboTo.jcolumncount = 2
		this.tpageMain.pageData.tcomboTo.jcolumnwidths = "250,40"
		this.tpageMain.pageData.tcomboTo.ControlSource = "thisform.oData.re_lnkt"
		this.tpageMain.pageData.tcomboTo.Init()
		
		
		this.assigncaption()
		DODEFAULT()
		
	ENDPROC

	PROCEDURE ReferralForm.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		do case
			case ((nKeyCode = 15)  AND (nShiftAltCtrl = 1)) OR;
				 ((nKeyCode = 19) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 26) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 148) AND (nShiftAltCtrl = 3)) OR;
				 ((nKeyCode = 5) AND (nShiftAltCtrl = 0))
				this.LastTabKey = 1
			case ((nKeyCode = 9) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 4) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 2) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 148) AND (nShiftAltCtrl = 2)) OR;
				 ((nKeyCode = 24) AND (nShiftAltCtrl = 0))
				this.LastTabKey = 2
			case ((nKeyCode = 18) AND (nShiftAltCtrl = 0)) OR;
				 ((nKeyCode = 3) AND (nShiftAltCtrl = 0))
				nodefault
			case ((nKeyCode = 27) AND (nShiftAltCtrl = 0))
				this.tcbCancel.Click()
				nodefault
			otherwise
				this.LastTabKey = 0
		endcase
		
	ENDPROC

	PROCEDURE ReferralForm.QueryUnload
		NODEFAULT
		this.tcbCancel.Click()
		
	ENDPROC

	PROCEDURE ReferralForm.TcbCancel.Click
		*!*	LOCAL LRecno
		*!*	IF thisform.p_mode = "NEW"
		*!*		DELETE IN referral1
		*!*		=TABLEUPDATE(.t.,.t.,'referral1')
		*!*		GO BOTTOM in tgridreferralcursor
		*!*	ELSE
		*!*		=TABLEREVERT(.t.,'referral1')
		*!*		SELECT tgridreferralcursor
		*!*		LOCATE FOR tgridreferralcursor.re_id = referral1.re_id
		*!*		SELECT address
		*!*	ENDIF
		thisform.visible = .F.
		thisform.caption = ""
		
		* Remove reference to thisformset.FAddressMask.oProcAddress.oReferral
		SELECT referral1
		SCATTER MEMO NAME thisform.oData BLANK
		
		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral.Refresh
		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral.SetFocus()
		
	ENDPROC

	PROCEDURE ReferralForm.TcbCancel.LostFocus
		if thisform.LastTabKey = 2
			thisform.LastTabKey = 0
			thisform.tpageMain.pageData.SetFocus()
		endif
		
	ENDPROC

	PROCEDURE ReferralForm.TcbOK.Click
		LOCAL LLinkRes
		
		thisform.p_ok_pressed = .T.
		
		IF thisform.p_linkres
			LLinkRes = thisformset.m_linkres(1,thisform.tpageMain.pageData.tcLinkCompany.Value,thisform.tpageMain.pageData.tcLinkInvoice.Value,"")
			thisform.oData.re_linkres = LLinkRes
		ENDIF
		
		IF thisformset.FAddressMask.oProcAddress.ReferralValid()<>0
			alert(thisformset.FAddressMask.oProcAddress.cValidError)
			RETURN .F.
		ENDIF
		
		thisformset.FAddressMask.oProcAddress.ReferralSave()
		
		thisform.visible = .F.
		thisform.caption = ""
		
		IF VARTYPE(thisform.oReferrals) = "O" AND NOT VARTYPE(thisform.oReferrals)="X"
			* We have more referrals, to update with same settings
			thisformset.FAddressMask.oProcAddress.ReferralCopySelected(referral1.re_id, thisform.oReferrals)
		ENDIF
		
		* Remove reference to thisformset.FAddressMask.oProcAddress.oReferral
		SELECT referral1
		SCATTER MEMO NAME thisform.oData BLANK
		
		IF thisform.p_mode = "NEW"
			GO BOTTOM in tgridreferralcursor
		ELSE
			SELECT tgridreferralcursor
			LOCATE FOR tgridreferralcursor.re_id = referral1.re_id
			SELECT address
		ENDIF
		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.refresh()
		thisformset.fAddressMask.mainPage.pageAddress.slavePage.pageReferral.tgridReferral.SetFocus()
		
		
	ENDPROC

	PROCEDURE ReferralForm.TpageMain.PageData.TcLinkCompany.InteractiveChange
		IF !thisformset.m_referral_checkvalid_linkres("C")
			this.Value = .F.
		ENDIF
	ENDPROC

	PROCEDURE ReferralForm.TpageMain.PageData.TcLinkInvoice.InteractiveChange
		IF !thisformset.m_referral_checkvalid_linkres("I")
			this.Value = .F.
		ENDIF
	ENDPROC

	PROCEDURE ReferralForm.TpageMain.PageData.TcMainAddress.InteractiveChange
		IF this.Value
			IF !thisformset.m_referral_checkvalid_mainaddress(thisform.oData)
				this.Value = .F.
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE SelectForm.Destroy
		DODEFAULT()
		this.MCodeGrid.RecordSource = ""
		
		*this.MCodeGrid.SetFocus
		*IF thisformset.closeselectform
		*	this.Visible = .F.
		*	this.MCodeGrid.SetFocus
		*ENDIF
		
	ENDPROC

	PROCEDURE SelectForm.GotFocus
		this.MCodeGrid.Width = this.Width
		this.MCodeGrid.Height = this.Height
		
		if NOT this.InEdit AND this.SetFilter
			Local Flt
			Flt = this.TFilter
			Set Filter To &Flt
		endif
		
	ENDPROC

	PROCEDURE SelectForm.Init
		DODEFAULT()
		this.AddProperty("InEdit", .F.)
		this.AddProperty("TField", .F.)
		this.AddProperty("TFilter", "")
		this.AddProperty("SetFilter", .F.)
		this.AddProperty("NextObj1", .NULL.)
		this.AddProperty("NextObj2", .NULL.)
		this.AddProperty("CurrObj", .NULL.)
		this.AddProperty("CDClass", .NULL.)
		
		
	ENDPROC

	PROCEDURE SelectForm.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		if (nKeyCode = 13) or (nKeyCode = 27) or (nKeyCode = 9)
			thisformset.selectformexit()
			nodefault
		endif
		
	ENDPROC

	PROCEDURE SelectForm.LostFocus
		*thisformset.zipcodern = RECNO()
		if NOT this.InEdit AND NOT IsNull(this.CurrObj)
			thisformset.zipcodern = RECNO()
			this.CurrObj.LostFocus()
		endif
		
	ENDPROC

	PROCEDURE SelectForm.MCodeGrid.AfterRowColChange
		LPARAMETERS nColIndex
		
		Local TField
		
		if NOT thisform.InEdit
			if NOT IsNull(thisform.CDClass)
				thisform.CDClass.Check()
			endif
			TField = thisform.TField
			thisform.CurrObj.Value = &TField
		endif
		
	ENDPROC

	PROCEDURE SelectForm.MCodeGrid.Column1.Text1.DblClick
		thisformset.selectformexit()
		
	ENDPROC

	PROCEDURE SelectForm.MCodeGrid.Column1.Text1.GotFocus
		*	Local m.Lang
		
	ENDPROC

	PROCEDURE SelectForm.MCodeGrid.Column1.Text1.LostFocus
		*	Local m.Lang
		
	ENDPROC

	PROCEDURE SelectForm.MCodeGrid.Column2.Text1.DblClick
		thisformset.selectformexit()
		
	ENDPROC

	PROCEDURE Tform1.Activate
		this.tlistbox1.ListIndex = 1
		this.tlistbox1.SetFocus()
		
		
	ENDPROC

	PROCEDURE Tform1.Destroy
		DODEFAULT()
		IF thisform.rel
			thisformset.faddressmask.release()
		
		*	thisformset.selectform.release()
		ENDIF
		
	ENDPROC

	PROCEDURE Tform1.Init
		DODEFAULT()
		this.Caption = GetLangText("ADDRESS","TXT_SELAPARTNER")
		this.tcommandbutton1.Caption = GetLangText("COMMON","TXT_OK")
		this.AddProperty("rel",.F.)
		***
	ENDPROC

	PROCEDURE Tform1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		IF (nKeyCode = 27) AND (nShiftAltCtrl = 0)
			thisform.tcommandbutton1.Click()
		*	thisform.Rel = .T.
		*	thisformset.closeselectform = .F.
		*	thisform.LostFocus()
		*	thisform.Release()
		ENDIF
		
	ENDPROC

	PROCEDURE Tform1.LostFocus
		*IF !thisformset.killtoolbar
		*	thisform.rel
		*	thisform.tcommandbutton1.Click()
		*ENDIF
		
		
	ENDPROC

	PROCEDURE Tform1.Tcommandbutton1.Click
		LOCAL LiIndex
		LiIndex = thisform.Tlistbox1.ListIndex
		IF !EMPTY(address.ad_lname)
			IF LiIndex = 1
				thisformset.AddProperty("SelApid",0)
			ELSE
				thisformset.AddProperty("SelApid",LiIndex-1)
			endif
		ELSE
			thisformset.AddProperty("SelApid",LiIndex)
		ENDIF
		thisform.Rel = .T.
		*thisformset.closeselectform = .F.
		thisform.LostFocus()
		thisform.Release()
		*thisform.AlwaysOnTop = .F.
		*thisform.visible = .F.
		
		
	ENDPROC

	PROCEDURE Tform1.Tlistbox1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if nKeyCode = 13 and nShiftAltCtrl = 0
			thisform.tcommandbutton1.Click()
		ENDIF
		
	ENDPROC

ENDDEFINE

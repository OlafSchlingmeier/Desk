*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="_pg_addressmask.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\constdefines.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 200
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 520
	
	PROCEDURE Init
		LOCAL llNoDataOnLoad
		
		this.NewObject("oCAAdrMain", "caadrmain", "progs\cadefdesk.prg")
		llNoDataOnLoad = .T.
		this.oCAAdrMain.CursorFill(.T.,llNoDataOnLoad)
		SELECT 0
		
		RETURN .T.
	ENDPROC

ENDDEFINE

DEFINE CLASS frmaddress AS tformcommon OF "..\libs\main.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="pgfMain" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagEdit.pgfInfoPage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagEdit.pgfSlave" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column13.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column14.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pgfMain.pagBrowse.grdAddress.Column14.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oSearchHandler" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oHyperlink" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: gridactivate
		*m: mode_assign
		*m: nextpage
		*m: onappendpage
		*m: ontransfer
		*m: refreshrecordstate
		*p: addressstate
		*p: cfilter
		*p: corder
		*p: finishsearch
		*p: mode
		*p: obizaddress
	*</DefinedPropArrayMethod>

	addressstate = 0
	cfilter = 1=1
	corder = ad_addrid
	ctbrclass = cTbrAddress_pg
	DoCreate = .T.
	formname = addressmask
	Height = 500
	Icon = ..\bitmap\icons\crdfle03.ico
	KeyPreview = .T.
	lusecommonshortcuts = .F.
	mode = 0
	Name = "frmAddress"
	obizaddress = .NULL.
	ShowTips = .T.
	Width = 800

	ADD OBJECT 'oHyperlink' AS hyperlink WITH ;
		Height = 22, ;
		Left = 36, ;
		Name = "oHyperlink", ;
		Top = 0, ;
		Width = 23
		*< END OBJECT: BaseClass="hyperlink" />

	ADD OBJECT 'oSearchHandler' AS brilliantshandler WITH ;
		enabled = .T., ;
		Left = 0, ;
		Name = "oSearchHandler", ;
		Top = 0
		*< END OBJECT: ClassLib="..\libs\cit_bridge.vcx" BaseClass="custom" />

	ADD OBJECT 'pgfMain' AS tpageframe WITH ;
		ActivePage = 2, ;
		Anchor = 15, ;
		ErasePage = .T., ;
		Height = 500, ;
		Name = "pgfMain", ;
		PageCount = 2, ;
		Width = 800, ;
		Page1.Caption = "pagEdit", ;
		Page1.Name = "pagEdit", ;
		Page2.Caption = "pagBrowse", ;
		Page2.Name = "pagBrowse"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress' AS _pg_tbrowse WITH ;
		Anchor = 15, ;
		ColumnCount = 14, ;
		DeleteMark = .F., ;
		Height = 515, ;
		ladduserdefinedcolumns = .T., ;
		lresizecolumns = .F., ;
		Name = "grdAddress", ;
		Panel = 1, ;
		RecordSource = " ", ;
		resizefontsize = .F., ;
		setcolumns = .T., ;
		TabIndex = 1, ;
		Width = 796, ;
		ZOrderSet = 0, ;
		Column1.Name = "Column1", ;
		Column1.Width = 60, ;
		Column10.Name = "Column10", ;
		Column10.Width = 58, ;
		Column11.InputMask = "999,999.99", ;
		Column11.Name = "Column11", ;
		Column11.Width = 65, ;
		Column12.Name = "Column12", ;
		Column13.Name = "Column13", ;
		Column14.Name = "Column14", ;
		Column14.Width = 60, ;
		Column2.Name = "Column2", ;
		Column2.Width = 60, ;
		Column3.Name = "Column3", ;
		Column3.Width = 35, ;
		Column4.Name = "Column4", ;
		Column4.Width = 35, ;
		Column5.Name = "Column5", ;
		Column5.Width = 25, ;
		Column6.Name = "Column6", ;
		Column6.Width = 60, ;
		Column7.Name = "Column7", ;
		Column7.Width = 70, ;
		Column8.Alignment = 1, ;
		Column8.InputMask = "9999", ;
		Column8.Name = "Column8", ;
		Column8.Width = 33, ;
		Column9.Name = "Column9", ;
		Column9.Width = 40
		*< END OBJECT: ClassLib="..\libs\_pg_cit_data.vcx" BaseClass="grid" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column1.Tbgrid1' AS tbgrid WITH ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column10.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column11.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 19, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T., ;
		Width = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column12.Tbgrid1' AS tbgrid WITH ;
		Left = 16, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column13.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column13.Tbgrid1' AS tbgrid WITH ;
		Left = 12, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column14.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column14.Tbgrid1' AS tbgrid WITH ;
		Left = 8, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column2.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column3.Tbgrid1' AS tbgrid WITH ;
		Left = 15, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column4.Tbgrid1' AS tbgrid WITH ;
		Left = 20, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 13, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column6.Tbgrid1' AS tbgrid WITH ;
		ControlSource = "reservat3.rs_roomtyp", ;
		Left = 23, ;
		Name = "Tbgrid1", ;
		Top = 23, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column8.Tbgrid1' AS tbgrid WITH ;
		Alignment = 1, ;
		Left = 20, ;
		Name = "Tbgrid1", ;
		Top = 23, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pgfMain.pagBrowse.grdAddress.Column9.Tbgrid1' AS tbgrid WITH ;
		Left = 21, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'pgfMain.pagEdit.pgfInfoPage' AS tpageframe WITH ;
		ActivePage = 1, ;
		Anchor = 105, ;
		ErasePage = .T., ;
		Height = 280, ;
		Left = 396, ;
		Name = "pgfInfoPage", ;
		PageCount = 2, ;
		Top = 2, ;
		Width = 400, ;
		Page1.Caption = "pagCommunication", ;
		Page1.Name = "pagCommunication", ;
		Page2.Caption = "pagGuestInfo", ;
		Page2.Name = "pagGuestInfo"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />

	ADD OBJECT 'pgfMain.pagEdit.pgfSlave' AS tpageframe WITH ;
		Anchor = 30, ;
		ErasePage = .T., ;
		Height = 187, ;
		Left = 2, ;
		Name = "pgfSlave", ;
		PageCount = 9, ;
		Top = 282, ;
		Width = 794, ;
		Page1.Caption = "pagApartners", ;
		Page1.Name = "pagApartners", ;
		Page2.Caption = "pagNote", ;
		Page2.Name = "pagNote", ;
		Page3.Caption = "pagDocuments", ;
		Page3.Name = "pagDocuments", ;
		Page4.Caption = "pagRevenue", ;
		Page4.Name = "pagRevenue", ;
		Page5.Caption = "pagFuture", ;
		Page5.Name = "pagFuture", ;
		Page6.Caption = "pagHistory", ;
		Page6.Name = "pagHistory", ;
		Page7.Caption = "pagInfo", ;
		Page7.Name = "pagInfo", ;
		Page8.Caption = "pagReferrals", ;
		Page8.Name = "pagReferrals", ;
		Page9.Caption = "pagSales", ;
		Page9.Name = "pagSales"
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="pageframe" />
	
	PROCEDURE assigncaption
		*	DO CASE
		*		CASE this.mode = 24
		*			this.fAddressMask.Caption = getlangtext("COMMON","TXT_CHOOSE")
		*		CASE this.mode = 25
		*			this.fAddressMask.Caption = getlangtext("ADDRESS","TXT_REFERRALSEARCH")
		*	ENDCASE
		this.Caption = GetText("ADDRESS","TXT_BRWADDR")
		this.pgfMain.pagEdit.Caption = GetText("ADDRESS","PT_ADDRESSNAME")
		this.pgfMain.pagEdit.pgfInfoPage.pagCommunication.Caption = GetLangText("ADDRESS","TXT_ADDRCOMM")
		this.pgfMain.pagEdit.pgfInfoPage.pagGuestInfo.Caption = GetLangText("ADDRESS","TXT_GUESTINFO")
		this.pgfMain.pagBrowse.Caption = GetText("ADDRESS","PT_ADDRESSBROWSE")
		
		WITH this.pgfMain.pagEdit.pgfSlave
			.pagApartners.Caption = GetLangText("ADDRESS","PT_APARTNERNAME")
			.pagApartners.ToolTipText = GetLangText("ADDRESS","TT_PAPARTNER")
		*	.pagApartners.cmdNewAPart.ToolTipText =  GetLangText("ADDRESS","TT_BNEWAPARTNER")
		*	.pagApartners.cmdDelPart.ToolTipText =  GetLangText("ADDRESS","TT_BDELAPARTNER")
		*	.pagApartners.CUpdateApartner.ToolTipText =  GetLangText("ADDRESS","TT_BEDITAPARTNER")
		*	.pagApartners.cmdNewAPart.Caption = .pagApartners.cmdNewAPart.ToolTipText
		*	.pagApartners.cmdDelPart.Caption = .pagApartners.cmdDelPart.ToolTipText
		*	.pagApartners.CUpdateApartner.Caption = .pagApartners.CUpdateApartner.ToolTipText
			.pagNote.Caption = GetLangText("ADDRESS","PT_NOTENAME")
			.pagNote.ToolTipText = GetLangText("ADDRESS","TT_PNOTE")
		*	.pagNote.lblAd_Created.Caption = GetLangText("RESERVAT","T_CREATED")
		*	.pagNote.lblAd_Updated.Caption = GetLangText("RESERVAT","T_CHANGED")
			.pagDocuments.Caption = GetLangText("ADDRESS","PT_DOCUMENTNAME")
			.pagDocuments.ToolTipText = GetLangText("ADDRESS","TT_PDOCUMENT")
		*	.pagDocuments.BDokEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITDOCUMENT")
		*	.pagDocuments.BDokNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWDOCUMENT")
		*	.pagDocuments.BDokDel.ToolTipText = GetLangText("ADDRESS","TT_BDELDOCUMENT")
		*	.pagDocuments.TcPhoneNote.ToolTipText = GetLangText("ADDRESS","TXT_NEW_PHONE_NOTE")
		*	.pagDocuments.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
		*	.pagDocuments.btnMail.Enabled = paRights(135)
		*	.pagDocuments.btnReply.ToolTipText = GetLangText("ADDRESS","TT_BMAILREPLY")
		*	.pagDocuments.tcChange.ToolTipText = GetLangText("ADDRESS","TXT_CHOOSE_DOCUMENT_TYPE")
		*	.pagDocuments.BDokEdit.Caption = .pagDocuments.BDokEdit.ToolTipText
		*	.pagDocuments.BDokNew.Caption = .pagDocuments.BDokNew.ToolTipText
		*	.pagDocuments.BDokDel.Caption = .pagDocuments.BDokDel.ToolTipText
		*	.pagDocuments.TcPhoneNote.Caption = .pagDocuments.TcPhoneNote.ToolTipText
		*	.pagDocuments.btnMail.Caption = .pagDocuments.btnMail.ToolTipText
		*	.pagDocuments.btnReply.Caption = .pagDocuments.btnReply.ToolTipText
		*	.pagDocuments.tcChange.Caption = .pagDocuments.tcChange.ToolTipText
			.pagRevenue.Caption = GetLangText("ADDRESS","PT_REVNUENAME")
			.pagRevenue.ToolTipText = GetLangText("ADDRESS","TT_PREVNUE")
			.pagFuture.Caption = GetLangText("ADDRESS","PT_FUTURENAME")
			.pagFuture.ToolTipText = GetLangText("ADDRESS","TT_PFUTURE")
		*	.pagFuture.BFutEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITRESERVATION")
		*	.pagFuture.BFutNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWRESERVATION")
		*	.pagFuture.BFutDel.ToolTipText = GetLangText("ADDRESS","TT_BDELRESERVATION")
		*	.pagFuture.cmdFutAlt.ToolTipText = GetLangText("ADDRESS","TT_ALLOTMENT")
		*	.pagFuture.BFutEdit.Caption = .pagFuture.BFutEdit.ToolTipText
		*	.pagFuture.BFutNew.Caption = .pagFuture.BFutNew.ToolTipText
		*	.pagFuture.BFutDel.Caption = .pagFuture.BFutDel.ToolTipText
		*	.pagFuture.cmdFutAlt.Caption = .pagFuture.cmdFutAlt.ToolTipText
			.pagHistory.Caption = GetLangText("ADDRESS","PT_HISTORYNAME")
			.pagHistory.ToolTipText = GetLangText("ADDRESS","TT_PHISTORY")
		*	.pagHistory.AddProperty("cHrFilter",".T.")
		*	.pagHistory.BHistPrint.Enabled = paRights(131)
		*	.pagHistory.BHistPrint.ToolTipText = GetLangText("ADDRESS","TT_PRINT_HISTORY")
		*	.pagHistory.cmdShowReservation.ToolTipText = GetLangText("ADDRESS","TT_SHOW_RESERVATION")
		*	.pagHistory.cmdCopyReservation.ToolTipText = GetLangText("ADDRESS","TT_COPY_RESERVATION")
		*	.pagHistory.cmdSearchReservation.ToolTipText = GetLangText("ADDRESS","TT_SEARCH_RESERVATION")
		*	.pagHistory.cmdBillPreview.ToolTipText = GetLangText("ADDRESS","TT_BILL_PREVIEW")
		*	.pagHistory.BHistPrint.Caption = .pagHistory.BHistPrint.ToolTipText
		*	.pagHistory.cmdShowReservation.Caption = .pagHistory.cmdShowReservation.ToolTipText
		*	.pagHistory.cmdCopyReservation.Caption = .pagHistory.cmdCopyReservation.ToolTipText
		*	.pagHistory.cmdSearchReservation.Caption = .pagHistory.cmdSearchReservation.ToolTipText
		*	.pagHistory.cmdBillPreview.Caption = .pagHistory.cmdBillPreview.ToolTipText
			.pagInfo.Caption = GetLangText("ADDRESS","PT_INFO")
			.pagInfo.ToolTipText = GetLangText("ADDRESS","TT_PINFO")
			.pagReferrals.Caption = GetLangText("ADDRESS","TXT_REFERRAL_PAGE")
			.pagReferrals.ToolTipText = GetLangText("ADDRESS","TT_REFERRAL_PAGE")
			.pagReferrals.Enabled = paRights(129)
		*	.pagReferrals.bRDelete.ToolTipText = GetLangText("ADDRESS","TT_BDELETEREFERRAL")
		*	.pagReferrals.brEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITREFERRAL")
		*	.pagReferrals.brNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWREFERRAL")
		*	.pagReferrals.brGoto.ToolTipText = GetLangText("ADDRESS","TT_BGOTOREFERRAL")
		*	.pagReferrals.cmdshowreferrals.ToolTipText = GetLangText("ADDRESS","TT_BSTRUCTREFERRAL")
		*	.pagReferrals.bRDelete.Caption = .pagReferrals.bRDelete.ToolTipText
		*	.pagReferrals.brEdit.Caption = .pagReferrals.brEdit.ToolTipText
		*	.pagReferrals.brNew.Caption = .pagReferrals.brNew.ToolTipText
		*	.pagReferrals.brGoto.Caption = .pagReferrals.brGoto.ToolTipText
		*	.pagReferrals.cmdshowreferrals.Caption = .pagReferrals.cmdshowreferrals.ToolTipText
			.pagSales.Caption = GetLangText("ADDRESS","PT_SALES")
			.pagSales.ToolTipText = GetLangText("ADDRESS","TT_PSALES")
			.pagSales.Enabled = paRights(134) AND _screen.US
		ENDWITH
	ENDPROC

	PROCEDURE findnext
		this.oSearchHandler.FindNext()
	ENDPROC

	PROCEDURE findprev
		this.oSearchHandler.FindPrevious()
	ENDPROC

	PROCEDURE gridactivate
		IF this.pgfMain.ActivePage = 2 AND TYPE("this.ActiveControl") = "O" AND this.ActiveControl # this.pgfMain.pagBrowse.grdAddress
			this.pgfMain.pagBrowse.grdAddress.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE Init
		LPARAMETERS AddStart, AddText, addtagno, addcall, rn, naddrid, nmode, reserid, pl_oRefObject, lp_nAdId, lp_oParam AS Collection
		LOCAL llSuccess
		
		this.oCallingObj = pl_oRefObject
		
		this.oBizAddress = CREATEOBJECT("cbizaddress")
		this.oBizAddress.Initialize()
		this.oBizAddress.AdrGetByAddrId()
		
		this.pgfMain.pagBrowse.grdAddress.cSource = 'address'
		this.pgfMain.pagBrowse.grdAddress.cPrimaryKey = "ad_addrid"
		this.pgfMain.pagBrowse.grdAddress.cOrder = ""
		this.pgfMain.pagBrowse.grdAddress.cForClause = "1=1"
		*	this.pgfMain.pagBrowse.grdAddress.cSeekExpression = "rs_arrdate"
		*	this.pgfMain.pagBrowse.grdAddress.eSeekValue = g_sysdate
		this.pgfMain.pagBrowse.grdAddress.Init(.T.)
		
		DODEFAULT()
		
		*this.oSearchHandler.Fill()
		llSuccess = .T.&&this.OnFilter()
		*this.pgfMain.pagBrowse.grdAddress.cForClause = cFilter
		
		LOCAL l_lZapCursor, l_lBrowseFromSelected, l_lFound
		l_lZapCursor = .F.
		l_lBrowseFromSelected = .F.
		this.pgfMain.pagBrowse.grdAddress.lNeerToggle = .T.
		l_lFound = this.pgfMain.pagBrowse.grdAddress.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		this.pgfMain.pagBrowse.grdAddress.lNeerToggle = .F.
		
		RETURN llSuccess
		
		*	LPARAMETERS AddStart, AddText, addtagno, addcall, rn, naddrid, nmode, reserid, pl_oRefObject, lp_nAdId, ;
		*			lp_oParam AS Collection
		*	LOCAL LTop, lcForeColor, lcBackColor, l_lWrite
		
		*	IF PCOUNT() > 8
		*		this.AddProperty("oReferenceToCallingObject", pl_oRefObject)
		*		IF nmode = 14
		*			this.oReferenceToCallingObject.Parent.Enabled = .F.
		*		ELSE
		*			IF VARTYPE(this.oReferenceToCallingObject)<>"X"
		*				this.oReferenceToCallingObject.Enabled = .F.
		*				this.oReferenceToCallingObject.AlwaysOnTop = .F.
		*			ENDIF
		*		ENDIF
		*	ENDIF
		*	this.lforbidenrem4 = param.pa_noreml4
		*	this.AddProperty("lOkCommand",.F.)
		*	This.HistoryFileName = "histfilename"
		*	This.OldresFileName = "cTmpHistres"
		*	thisformset.ds=this.datasessionid
		*	this.searchtable=substr(sys(2015),3,10)
		*	this.selectedtable = 'address'
		*	this.AddProperty("screenformsdisabled",.F.)
		*	this.AddProperty("zipcodern",0)
		*	this.AddProperty("mode",nmode)
		*	this.AddProperty("reserid",reserid)
		*	this.AddProperty("refreshroomplan",.f.)
		*	this.AddProperty("gridcontrolsource",.F.)
		*	this.AddProperty("aaolumns(14,2)",.f.)
		*	this.AddProperty("p_UserFieldsForAccountInfo",param.pa_adrbank)
		IF PCOUNT()>10
			this.oParam = lp_oParam
			lp_oParam = .NULL.
		ENDIF
		IF NOT EMPTY(AddStart) AND AddStart = "SELECT_ADDRESSES"
			this.cFormLabel = "searchadr"
		ELSE
			this.pgfMain.pagBrowse.grdAddress.DefaultPropertiesSet(13, "gr_activ", .F.)
		ENDIF
		
		*	this.faddressMask.Init(.T.)
		
		*	gl_wind=.f.
		*	*this.FAddressMask.LockScreen = .t.
		this.addresscall=addcall
		
		IF EMPTY(AddStart)
			AddStart = "NORMAL"
		ENDIF
		thisformset.AddressStart = AddStart
		thisformset.AddressText = AddText
		thisformset.AddressState = 0 && Initialize Address State (0 - Normal, 1 - New, 2 - Copy New, 3 - Edit)
		this.AddProperty("LastTabKey", 0) && Ading Property for Focus settings
		this.searchactive = .F.  && Initializing Property "Searchactive" (.F. Off, .T. On)
		
		*	SELECT Address
		*	SET Order to TAG1
		
		*	IF thisformset.AddressStart == "EDIT" OR thisformset.AddressStart == "EDITR"
		*		IF !empty(naddrid)
		*		  IF !SEEK(naddrid)
		*		   MESSAGEBOX(GetLangText("WALKIN","TXT_ADRNOTFOUND"),16,GetLangText("RECURRES","TXT_INFORMATION"))
		*		   SEEK(thisformset.fAddressMask.oProcAddress.nAddressUnknownID)
		*		   IF !FOUND()
		*				thisformset.fAddressMask.oProcAddress.AddressInsertUnknown()
		*		   endif
		*		  ENDIF
		*		ELSE
		*		   MESSAGEBOX(GetLangText("WALKIN","TXT_ADRNOTFOUND"),16,GetLangText("RECURRES","TXT_INFORMATION"))
		*		   SEEK(thisformset.fAddressMask.oProcAddress.nAddressUnknownID)
		*		   IF !FOUND()
		*				thisformset.fAddressMask.oProcAddress.AddressInsertUnknown()
		*		   endif
		*		endif
		*		IF rn>0 .and. rn<=reccount()
		*			GO rn
		*		ENDIF
		*	ENDIF
		
		*	this.closeselectform = .F.
		*	this.checkbtnrights()
		*	this.fAddressMask.cAddressNew.Enabled = .F.
		*	this.fAddressMask.cEditAddress.Enabled = .F.
		*	this.fAddressMask.cCopyNewRecord.Enabled = .F.
		*	IF (SUBSTR(thisformset.buttonrights, 6, 1)!="1")
		*		this.fAddressMask.cdelAddress.Enabled = .F.
		*	ENDIF
		*	IF (SUBSTR(thisformset.buttonrights, 1, 1)!="1")
		*		this.fAddressMask.cExit.Enabled = .F.
		*		this.FAddressMask.Closable = .F.
		*	ENDIF
		*	IF (SUBSTR(thisformset.buttonrights, 5, 1)!="1")
		*		this.fAddressMask.csearchAddress.Enabled = .F.
		*	ENDIF
		*	IF (SUBSTR(thisformset.buttonrights, 8, 1)="1")
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.Enabled = .T.
		*	ELSE
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.Enabled = .F.
		*	ENDIF
		*	IF (SUBSTR(thisformset.buttonrights, 7, 1)="1")
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageRevnue.Enabled = .T.
		*	ELSE
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageRevnue.Enabled = .F.
		*	ENDIF
		*	IF parights(133) AND _SCREEN.KT
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Visible = .T.
		*	ELSE
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Visible = .F.
		*	ENDIF
		
		*	this.FAddressMask.Caption = GetLangText("ADDRESS","TXT_BRWADDR")
		*	childtitle(this.FAddressMask.Caption)
		*	this.AddressSearchDialog.chapartner.Caption = GetLangText("ADDRESS","T_SEARCHINAPARTNER")
		*	this.AddressSearchDialog.chexactsearch.Caption = GetLangText("ADDRESS","TXT_EXACT_SEARCH")
		
		*	IF NOT _screen.OL
		*		this.ldocumentsemail = .F.
		*		this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Email.Width = this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtad_website.Width
		*		this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtAd_Email.w = this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.txtad_website.w
		*		this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.btnMail.Visible = .T.
		*		this.fAddressMask.mainPage.pageAddress.InfoPage.pagCommunication.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageApartner.btnMail.Visible = .T.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageApartner.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.btnMail.Visible = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.btnReply.Visible = .F.
		*	ENDIF
		
		*	LOCAL _l
		*	SCATTER Name thisformset.DataCopy Memo
		*	WITH this.FAddressMask.MainPage.PageAddress
		*		.txtAd_Addrid.ControlSource = [thisformset.DataCopy.Ad_Addrid]
		*		.txtAd_Company.ControlSource = [thisformset.DataCopy.Ad_Company]
		*		.txtAd_Departm.ControlSource = [thisformset.DataCopy.Ad_Departm]
		*		.txtAd_Lname.ControlSource = [thisformset.DataCopy.Ad_Lname]
		*		.txtAD_Lang.ControlSource = [thisformset.DataCopy.AD_Lang]
		*		SELECT pl_charcod, pl_lang1, pl_lang2, pl_lang3, pl_lang4, pl_lang5, ;
		*			pl_lang6, pl_lang7, pl_lang8, pl_lang9, pl_lang10, pl_lang11 ;
		*			FROM picklist INNER JOIN title ON pl_charcod = title.ti_lang ;
		*			WHERE pl_label = "LANGUAGE" GROUP BY pl_charcod ;
		*			INTO CURSOR lang_picklist
		*		.txtAD_Lang.RowSource = "lang_picklist.pl_charcod, pl_lang"+ALLTRIM(g_langnum)
		*		.txtAd_Compnum.ControlSource = [thisformset.DataCopy.Ad_Compnum]
		*		.txtAd_Salute.ControlSource = [thisformset.DataCopy.Ad_Salute]
		*		.txtAd_Street.ControlSource = [thisformset.DataCopy.AD_STREET]
		*		.txtAd_Street2.ControlSource = [thisformset.DataCopy.Ad_Street2]
		*		.txtAd_State.ControlSource = [thisformset.DataCopy.Ad_State]
		*		.txtAd_City.ControlSource = [thisformset.DataCopy.Ad_City]
		*		.InfoPage.pagCommunication.txtAd_Phone.ControlSource = [thisformset.DataCopy.Ad_Phone]
		*		.InfoPage.pagCommunication.txtAd_Phone2.ControlSource = [thisformset.DataCopy.Ad_Phone2]
		*		.InfoPage.pagCommunication.txtAd_Phone3.ControlSource = [thisformset.DataCopy.Ad_Phone3]
		*		.InfoPage.pagCommunication.txtAd_Fax.ControlSource = [thisformset.DataCopy.Ad_Fax]
		*		.InfoPage.pagCommunication.txtAd_Email.ControlSource = [thisformset.DataCopy.Ad_Email]
		*		.InfoPage.pagCommunication.txtAd_website.ControlSource = [thisformset.DataCopy.Ad_website]
		*		.InfoPage.pagCommunication.txtad_ustidnr.ControlSource = [thisformset.DataCopy.ad_ustidnr]
		*		.InfoPage.pagCommunication.chkad_novat.ControlSource = [thisformset.DataCopy.ad_novat]
		*		.InfoPage.pagCommunication.chkad_save.ControlSource = [thisformset.DataCopy.ad_save]
		*		_l = "picklist.pl_charcod, pl_lang"+ALLTRIM(g_langnum)
		*		.InfoPage.pagGuestInfo.txtAd_Mail1.ControlSource = [thisformset.DataCopy.Ad_Mail1]
		*		.InfoPage.pagGuestInfo.txtAd_Mail1.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Mail2.ControlSource = [thisformset.DataCopy.Ad_Mail2]
		*		.InfoPage.pagGuestInfo.txtAd_Mail2.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Mail3.ControlSource = [thisformset.DataCopy.Ad_Mail3]
		*		.InfoPage.pagGuestInfo.txtAd_Mail3.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Mail4.ControlSource = [thisformset.DataCopy.Ad_Mail4]
		*		.InfoPage.pagGuestInfo.txtAd_Mail4.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Mail5.ControlSource = [thisformset.DataCopy.Ad_Mail5]
		*		.InfoPage.pagGuestInfo.txtAd_Mail5.rowsource = _l
		*		.txtAd_Fname.ControlSource = [thisformset.DataCopy.Ad_Fname]
		*		.InfoPage.pagGuestInfo.txtAd_Billins.ControlSource = [thisformset.DataCopy.Ad_Billins]
		*		.InfoPage.pagGuestInfo.dtxtAd_Birth.ControlSource = [thisformset.DataCopy.Ad_Birth]
		*		.InfoPage.pagGuestInfo.txtAd_Member.ControlSource = [thisformset.DataCopy.Ad_Member]
		*		.InfoPage.pagGuestInfo.txtAd_Member.InputMask = REPLICATE("9",10)
		*		.InfoPage.pagGuestInfo.dtxtAd_Memdat.ControlSource = [thisformset.DataCopy.Ad_Memdat]
		*		.txtAd_Compkey.ControlSource = [thisformset.DataCopy.Ad_Compkey]
		*		.txtAd_Zip.ControlSource = [thisformset.DataCopy.Ad_Zip]
		*		.txtAd_Country.ControlSource = [thisformset.DataCopy.Ad_Country]
		*		.txtAd_Country.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Feat1.ControlSource = [thisformset.DataCopy.Ad_Feat1]
		*		.InfoPage.pagGuestInfo.txtAd_Feat1.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Feat2.ControlSource = [thisformset.DataCopy.Ad_Feat2]
		*		.InfoPage.pagGuestInfo.txtAd_Feat2.rowsource = _l
		*		.InfoPage.pagGuestInfo.txtAd_Feat3.ControlSource = [thisformset.DataCopy.Ad_Feat3]
		*		.InfoPage.pagGuestInfo.txtAd_Feat3.rowsource = _l
		*		.InfoPage.pagGuestInfo.chkAd_Vip.ControlSource = [thisformset.DataCopy.Ad_Vip]
		*		.InfoPage.pagGuestInfo.chkAd_Vip2.ControlSource = [thisformset.DataCopy.Ad_Vip2]	
		*		.InfoPage.pagGuestInfo.ChkNomail.ControlSource = [thisformset.DataCopy.Ad_nomail]
		*		.SlavePage.PageNote.Edit1.ControlSource  = [thisformset.DataCopy.ad_note]
		*		.SlavePage.PageNote.txtAd_Created.ControlSource = [thisformset.DataCopy.Ad_Created]
		*		.SlavePage.PageNote.txtAd_Updated.ControlSource = [thisformset.DataCopy.Ad_Updated]
		*		.SlavePage.PageNote.txtAd_Userid.ControlSource = [thisformset.DataCopy.Ad_Userid]
		*		.ocbotitle.ControlSource  = [thisformset.DataCopy.ad_titlcod]
		*		STORE ;
		*			"SELECT pl_lang" + g_langnum + " , pl_charcod " + ;
		*			"FROM picklist " + ;
		*			"WHERE pl_label = " + sqlcnv("ADRTYPE",.T.) + " " + ;
		*			"UNION " + ;
		*			"SELECT SPACE(25) AS pl_lang" + g_langnum + " , SPACE(3) AS pl_charcod " + ;
		*			"FROM param " + ;
		*			"WHERE " + sqlcnv(.T.,.T.) + " " + ;
		*			"ORDER BY 2" ;
		*			TO .InfoPage.pagGuestInfo.cboadrtype.jsql
		*		.InfoPage.pagGuestInfo.cboadrtype.jboundcolumn = 2
		*		.InfoPage.pagGuestInfo.cboadrtype.jcolumncount = 2
		*		.InfoPage.pagGuestInfo.cboadrtype.jcolumnwidths = "150,40"
		*		.InfoPage.pagGuestInfo.cboadrtype.ControlSource  = [thisformset.DataCopy.ad_adrtype]
		*		.InfoPage.pagGuestInfo.cboadrtype.Init()
		*		.InfoPage.pagGuestInfo.ad_vipstat.ControlSource = [thisformset.DataCopy.ad_vipstat]
		*		.txtad_title.ControlSource  = [thisformset.DataCopy.Ad_title]
		*		.txtti_attn.ControlSource = [thisformset.DataCopy.ad_attn]
		*		.InfoPage.pagGuestInfo.txtAd_Ratecod.ControlSource = [thisformset.DataCopy.Ad_Ratecod]
		*		_l = "ratecode.rc_ratecod, rc_lang"+ ALLTRIM(g_langnum)+", rc_fromdat, rc_todat, rc_amnt1"
		*		.InfoPage.pagGuestInfo.txtAd_Ratecod.rowsource = _l
		*		.InfoPage.pagGuestInfo.cboroomname.ccontrolsource = [thisformset.DataCopy.ad_roomnum]
		*		.InfoPage.pagGuestInfo.Refresh()
		*	ENDWITH
		
		*	SELECT AddressTAlias
		
		*	this.cYes = GetLangText("COMMON","TXT_YES")
		*	this.cNo = GetLangText("COMMON","TXT_NO")
		
		*	WITH this.FAddressMask.MainPage.PageAddress
		*		.lblAd_Addrid.Caption = GetLangText("ADDRESS","T_ADDRESSID")
		*		.lblAd_Company.Caption = GetLangText("ADDRESS","TXT_COMPANY")
		*		.lblAd_Departm.Caption = GetLangText("ADDRESS","TXT_DEPARTM")
		*		.lblName.Caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.lbAD_Lang.Caption = GetLangText("ADDRESS","T_LANGCOD")
		*		.lblAd_Compnum.Caption = GetLangText("ADDRESS","T_KEYNR")
		*		.lblAd_Salute.Caption = GetLangText("ADDRESS","TXT_SALUTE")
		*		.lblAd_Street.Caption = GetLangText("ADDRESS","TXT_STREET") + " 1"
		*		.lblAd_Street2.Caption = GetLangText("ADDRESS","TXT_STREET") + " 2"
		*		.lblAd_State.Caption = GetLangText("ADDRESS","TXT_STATE")
		*		.lblAd_City.Caption = GetLangText("ADDRESS","T_COUNTCITYZIP")
		*		.InfoPage.pagCommunication.Caption = GetLangText("ADDRESS","TXT_ADDRCOMM")
		*		.InfoPage.pagGuestInfo.Caption = GetLangText("ADDRESS","TXT_GUESTINFO")
		*		.InfoPage.pagCommunication.lblAd_Phone.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
		*		.InfoPage.pagCommunication.lblAd_Phone2.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2/3"
		*		.InfoPage.pagCommunication.lblAd_Fax.Caption = GetLangText("ADDRESS","TXT_FAX")
		*		.InfoPage.pagCommunication.lblAd_Email.Caption = GetLangText("ADDRESS","TXT_EMAIL")
		*		.InfoPage.pagCommunication.lblAd_website.Caption = GetLangText("ADDRESS","T_WEB")
		*		.InfoPage.pagCommunication.lblAd_ustidnr.Caption = GetLangText("ADDRESS","TXT_FORIGN_VAT_NR")
		*		.InfoPage.pagCommunication.chkad_novat.Caption = GetLangText("ADDRESS","TXT_NO_VAT")
		*		.InfoPage.pagCommunication.chkad_save.Caption = GetLangText("ADDRESS","TXT_SAVEADDRESS")
		*		.InfoPage.pagGuestInfo.lblAd_Mail1.Caption = GetLangText("ADDRESS","TXT_MAILING")
		*		.InfoPage.pagGuestInfo.lblAd_Ratecod.Caption = GetLangText("RATES","TXT_RATECODE")
		*		.InfoPage.pagGuestInfo.lblAd_Feat1.Caption = GetLangText("ROOMFEAT","TW_FEATURE")
		*		.InfoPage.pagGuestInfo.lblAd_Member.Caption = GetLangText("ADDRESS","TXT_MEMBER")
		*		.InfoPage.pagGuestInfo.lblAd_Memdat.Caption = GetLangText("ADDRESS","TXT_MEMDAT")
		*		.lblAd_Fname.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
		*		.lbAD_titcod.Caption = GetLangText("ADDRESS","TXT_ATTITLE")
		*		.InfoPage.pagGuestInfo.lblAd_Billins.Caption = GetLangText("ADDRESS","TXT_BILLINS")
		*		.InfoPage.pagGuestInfo.lblAd_Birth.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
		*		.InfoPage.pagGuestInfo.lblAd_adrtype.Caption = GetLangText("ADDRESS","TXT_ADDRESS_TYPE")
		*		.InfoPage.pagGuestInfo.lblAd_vipstat.Caption = GetLangText("ADDRESS","TXT_VIP_STATUS")
		*	*	.lblAd_Userid.Caption = GetLangText("ACT","T_USER")
		*		.lbAD_Compkey.Caption = GetLangText("ADDRESS","TXT_KEYSEARCH")
		*		.InfoPage.pagGuestInfo.ChkNomail.Caption = GetLangText("ADDRESS","TXT_NOMAIL")
		*		.InfoPage.pagGuestInfo.lblWishRoom.Caption = GetLangText("ADDRESS","T_WISHROOMNUM")
		*		.InfoPage.pagGuestInfo.chkAd_Vip2.Caption = GetLangText("ADDRESS","TXT_VIP_2")
		*	ENDWITH
		
		*	* Initializing User 1-10 Fields in "Free Page"
		*	WITH this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user1))
		*			.LFree1.Caption  = TRIM(ParamTAlias.pa_user1)
		
		*			*** Set Textboxes or Checkboxes in FreePage
		*			IF SUBSTR(PARAM.PA_SETUSAD,1,1)="C"
		*				.tcheckbox1.Visible = .t.
		*				.freeText1.Visible = .f.
		*			ELSE
		*				.FreeText1.visible = .T.
		*				.FreeText1.ControlSource  = [thisformset.DataCopy.ad_usr1]
		*			ENDIF
		*		ELSE
		*			.LFree1.Caption = ""
		*			.FreeText1.visible = .F.
		
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user2))
		*			.LFree2.Caption  = TRIM(ParamTAlias.pa_user2)
		*			IF SUBSTR(PARAM.PA_SETUSAD,2,1)="C"
		*				.tcheckbox2.Visible = .t.
		*				.freeText2.Visible = .f.
		*			ELSE
		*				.FreeText2.visible = .T.
		*				.FreeText2.ControlSource  = [thisformset.DataCopy.ad_usr2]
		*			ENDIF
		
		*		ELSE
		*			.LFree2.Caption = ""
		*			.FreeText2.visible = .F.
		
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user3))
		*			.LFree3.Caption = TRIM(ParamTAlias.pa_user3)
		*			IF SUBSTR(PARAM.PA_SETUSAD,3,1)="C"
		*				.tcheckbox3.Visible = .t.
		*				.freeText3.Visible = .f.
		*			ELSE
		*				.FreeText3.visible = .T.
		*				.FreeText3.ControlSource  = [thisformset.DataCopy.ad_usr3]
		*			ENDIF
		
		*		ELSE
		*			.LFree3.Caption = ""
		*			.FreeText3.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user4))
		*			.LFree4.Caption = TRIM(ParamTAlias.pa_user4)
		*			IF SUBSTR(PARAM.PA_SETUSAD,4,1)="C"
		*				.tcheckbox4.Visible = .t.
		*				.freeText4.Visible = .f.
		*			ELSE
		*				.FreeText4.visible = .T.
		*				.FreeText4.ControlSource  = [thisformset.DataCopy.ad_usr4]
		*			ENDIF
		
		*		ELSE
		*			.LFree4.Caption = ""
		*			.FreeText4.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user5))
		*			.LFree5.Caption = TRIM(ParamTAlias.pa_user5)
		*			IF SUBSTR(PARAM.PA_SETUSAD,5,1)="C"
		*				.tcheckbox5.Visible = .t.
		*				.freeText5.Visible = .f.
		*			ELSE
		*				.FreeText5.visible = .T.
		*				.FreeText5.ControlSource  = [thisformset.DataCopy.ad_usr5]
		*			ENDIF
		
		*		ELSE
		*			.LFree5.Caption = ""
		*			.FreeText5.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user6))
		*			.LFree6.Caption = TRIM(ParamTAlias.pa_user6)
		*			IF SUBSTR(PARAM.PA_SETUSAD,6,1)="C"
		*				.tcheckbox6.Visible = .t.
		*				.freeText6.Visible = .f.
		*			ELSE
		*				.FreeText6.visible = .T.
		*				.FreeText6.ControlSource  = [thisformset.DataCopy.ad_usr6]
		*			ENDIF
		*		ELSE
		*			.LFree6.Caption = ""
		*			.FreeText6.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user7))
		*			.LFree7.Caption = TRIM(ParamTAlias.pa_user7)
		*			IF SUBSTR(PARAM.PA_SETUSAD,7,1)="C"
		*				.tcheckbox7.Visible = .t.
		*				.freeText7.Visible = .f.
		*			ELSE
		*				.FreeText7.visible = .T.
		*				.FreeText7.ControlSource  = [thisformset.DataCopy.ad_usr7]
		*			ENDIF
		*		ELSE
		*			.LFree7.Caption = ""
		*			.FreeText7.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user8))
		*			.LFree8.Caption = TRIM(ParamTAlias.pa_user8)
		*			IF SUBSTR(PARAM.PA_SETUSAD,8,1)="C"
		*				.tcheckbox8.Visible = .t.
		*				.freeText8.Visible = .f.
		*			ELSE
		*				.FreeText8.visible = .T.
		*				.FreeText8.ControlSource  = [thisformset.DataCopy.ad_usr8]
		*			ENDIF
		*		ELSE
		*			.LFree8.Caption = ""
		*			.FreeText8.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user9))
		*			.LFree9.Caption = TRIM(ParamTAlias.pa_user9)
		*			IF SUBSTR(PARAM.PA_SETUSAD,9,1)="C"
		*				.tcheckbox9.Visible = .t.
		*				.freeText9.Visible = .f.
		*			ELSE
		*				.FreeText9.visible = .T.
		*				.FreeText9.ControlSource  = [thisformset.DataCopy.ad_usr9]
		*			ENDIF
		*		ELSE
		*			.LFree9.Caption = ""
		*			.FreeText9.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user10))
		*			.LFree10.Caption = TRIM(ParamTAlias.pa_user10)
		*			IF SUBSTR(PARAM.PA_SETUSAD,10,1)="C"
		*				.tcheckbox10.Visible = .t.
		*				.freeText10.Visible = .f.
		*			ELSE
		*				.FreeText10.visible = .T.
		*				.FreeText10.ControlSource  = [thisformset.DataCopy.ad_usr10]
		*			ENDIF
		*		ELSE
		*			.LFree10.Caption = ""
		*			.FreeText10.visible = .F.
		*		ENDIF
		*	ENDWITH
		
		*	IF this.p_UserFieldsForAccountInfo
		*		openfile(.F.,"banken")
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.tcbCallBankForm.Visible = .T.
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageFree.FreeText8.InputMask = "99999999"
		*	ENDIF
		
		*	WITH this.AddressSearchDialog
		*		LTop = 238
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user1))
		*			.LUsr1.Caption = TRIM(ParamTAlias.pa_user1)
		*			IF SUBSTR(PARAM.PA_SETUSAD,1,1)="C"
		*				.Tcheckbox1.visible = .T.
		*				.tcheckbox11.Visible = .t.
		*				.txtAd_usr1.visible = .F.
		*				.Tcheckbox1.value = .f.
		*				.Tcheckbox1.top = LTop
		*				.tcheckbox11.top = LTop
		*			ELSE
		*				.txtAd_usr1.visible = .T.
		*				.txtAd_usr1.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr1.value = ""
		*				.txtAd_usr1.top = LTop
		*			ENDIF
		*			.LUsr1.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr1.Caption = ""
		*			.txtAd_usr1.visible = .F.
		
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user2))
		*			.LUsr2.Caption = TRIM(ParamTAlias.pa_user2)
		*			IF SUBSTR(PARAM.PA_SETUSAD,2,1)="C"
		*				.Tcheckbox2.visible = .T.
		*				.tcheckbox12.Visible = .t.			
		*				.txtAd_usr2.visible = .F.
		*				.Tcheckbox2.value = .f.
		*				.Tcheckbox2.top = LTop
		*				.tcheckbox12.top = LTop
		*			ELSE
		*				.txtAd_usr2.visible = .T.
		*				.txtAd_usr2.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr2.value = ""
		*				.txtAd_usr2.top = LTop
		*			ENDIF		
		*			.LUsr2.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr2.Caption = ""
		*			.txtAd_usr2.visible = .F.
		
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user3))
		*			.LUsr3.Caption = TRIM(ParamTAlias.pa_user3)
		*			IF SUBSTR(PARAM.PA_SETUSAD,3,1)="C"
		*				.Tcheckbox3.visible = .T.
		*				.tcheckbox13.Visible = .t.			
		*				.txtAd_usr3.visible = .F.
		*				.Tcheckbox3.value = .f.
		*				.Tcheckbox3.top = LTop
		*				.tcheckbox13.top = LTop
		*			ELSE
		*				.txtAd_usr3.visible = .T.
		*				.txtAd_usr3.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr3.value = ""
		*				.txtAd_usr3.top = LTop
		*			ENDIF		
		*			.LUsr3.top = LTop+4
		*			LTop = LTop + 21
		
		*		ELSE
		*			.LUsr3.Caption = ""
		*			.txtAd_usr3.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user4))
		*			.LUsr4.Caption = TRIM(ParamTAlias.pa_user4)
		*			IF SUBSTR(PARAM.PA_SETUSAD,4,1)="C"
		*				.Tcheckbox4.visible = .T.
		*				.tcheckbox14.Visible = .t.
		*				.txtAd_usr4.visible = .F.
		*				.Tcheckbox4.value = .f.
		*				.Tcheckbox4.top = LTop
		*				.tcheckbox14.top = LTop
		*			ELSE
		*				.txtAd_usr4.visible = .T.
		*				.txtAd_usr4.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr4.value = ""
		*				.txtAd_usr4.top = LTop
		*			ENDIF		
		*			.LUsr4.top = LTop+4
		*			LTop = LTop + 21
		
		*		ELSE
		*			.LUsr4.Caption = ""
		*			.txtAd_usr4.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user5))
		*			.LUsr5.Caption = TRIM(ParamTAlias.pa_user5)
		*			IF SUBSTR(PARAM.PA_SETUSAD,5,1)="C"
		*				.Tcheckbox5.visible = .T.
		*				.tcheckbox15.Visible = .t.
		*				.txtAd_usr5.visible = .F.
		*				.Tcheckbox5.value = .f.
		*				.Tcheckbox5.top = LTop
		*				.tcheckbox15.top = LTop
		*			ELSE
		*				.txtAd_usr5.visible = .T.
		*				.txtAd_usr5.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr5.value = ""
		*				.txtAd_usr5.top = LTop
		*			ENDIF		
		*			.LUsr5.top = LTop+4
		*			LTop = LTop + 21
		
		*		ELSE
		*			.LUsr5.Caption = ""
		*			.txtAd_usr5.visible = .F.
		*		ENDIF
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user6))
		*			.LUsr6.Caption = TRIM(ParamTAlias.pa_user6)
		*			IF SUBSTR(PARAM.PA_SETUSAD,6,1)="C"
		*				.Tcheckbox6.visible = .T.
		*				.tcheckbox16.Visible = .t.
		*				.txtAd_usr6.visible = .F.
		*				.Tcheckbox6.value = .f.
		*				.Tcheckbox6.top = LTop
		*				.tcheckbox16.top = LTop
		*			ELSE
		*				.txtAd_usr6.visible = .T.
		*				.txtAd_usr6.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr6.value = ""
		*				.txtAd_usr6.top = LTop
		*			ENDIF		
		*			.LUsr6.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr6.Caption = ""
		*			.txtAd_usr6.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user7))
		*			.LUsr7.Caption = TRIM(ParamTAlias.pa_user7)
		*			IF SUBSTR(PARAM.PA_SETUSAD,7,1)="C"
		*				.Tcheckbox7.visible = .T.
		*				.tcheckbox17.Visible = .t.
		*				.txtAd_usr7.visible = .F.
		*				.Tcheckbox7.value = .f.
		*				.Tcheckbox7.top = LTop
		*				.tcheckbox17.top = LTop
		*			ELSE
		*				.txtAd_usr7.visible = .T.
		*				.txtAd_usr7.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr7.value = ""
		*				.txtAd_usr7.top = LTop
		*			ENDIF		
		*			.LUsr7.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr7.Caption = ""
		*			.txtAd_usr7.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user8))
		*			.LUsr8.Caption = TRIM(ParamTAlias.pa_user8)
		*			IF SUBSTR(PARAM.PA_SETUSAD,8,1)="C"
		*				.Tcheckbox8.visible = .T.
		*				.tcheckbox18.Visible = .t.
		*				.txtAd_usr8.visible = .F.
		*				.Tcheckbox8.value = .f.
		*				.Tcheckbox8.top = LTop
		*				.tcheckbox18.top = LTop
		*			ELSE
		*				.txtAd_usr8.visible = .T.
		*				.txtAd_usr8.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr8.value = ""
		*				.txtAd_usr8.top = LTop
		*			ENDIF		
		*			.LUsr8.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr8.Caption = ""
		*			.txtAd_usr8.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user9))
		*			.LUsr9.Caption = TRIM(ParamTAlias.pa_user9)
		*			IF SUBSTR(PARAM.PA_SETUSAD,9,1)="C"
		*				.Tcheckbox9.visible = .T.
		*				.txtAd_usr9.visible = .F.
		*				.tcheckbox19.Visible = .t.
		*				.Tcheckbox9.value = .f.
		*				.Tcheckbox9.top = LTop
		*				.tcheckbox19.top = LTop
		*			ELSE
		*				.txtAd_usr9.visible = .T.
		*				.txtAd_usr9.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr9.value = ""
		*				.txtAd_usr9.top = LTop
		*			ENDIF
		*			.LUsr9.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr9.Caption = ""
		*			.txtAd_usr9.visible = .F.
		*		ENDIF
		
		*		IF ( .NOT. EMPTY(ParamTAlias.pa_user10))
		*			.LUsr10.Caption = TRIM(ParamTAlias.pa_user10)
		*			IF SUBSTR(PARAM.PA_SETUSAD,10,1)="C"
		*				.Tcheckbox10.visible = .T.
		*				.tcheckbox20.Visible = .t.
		*				.txtAd_usr10.visible = .F.
		*				.Tcheckbox10.value = .f.
		*				.Tcheckbox10.top = LTop
		*				.tcheckbox20.top = LTop
		*			ELSE
		*				.txtAd_usr10.visible = .T.
		*				.txtAd_usr10.InputMask = REPLICATE("X", 100)
		*				.txtAd_usr10.value = ""
		*				.txtAd_usr10.top = LTop
		*			ENDIF		
		*			.LUsr10.top = LTop+4
		*			LTop = LTop + 21
		*		ELSE
		*			.LUsr10.Caption = ""
		*			.txtAd_usr10.visible = .F.
		*		ENDIF
		
		*		IF !(LTop = 159)
		*			LTop = LTop + 5
		*		ENDIF
		*		.TSearchAll.top = LTop
		*		.LSearchAll.top = LTop
		*		.chapartner.top=ltop+25
		*		.chexactsearch.top = ltop+25
		*		.chexactsearch.Value = 1
		*		.chkmainserver.top = .chapartner.top + 20
		*		.Shape1.height = LTop + 48 + 20
		*		.height = LTop + 51 + 20
		
		*		.TAd_company.InputMask = REPLICATE("X", 50)
		*		.TAd_compkey.InputMask = REPLICATE("X", 15)
		*		.TAd_compnum.InputMask = REPLICATE("9", 10)
		*		.TAd_lname.InputMask = REPLICATE("X", 30)
		*		.TAd_fname.InputMask = REPLICATE("X", 20)
		*		.TAd_city.InputMask = REPLICATE("X", 30)
		*		.TAd_member.InputMask = REPLICATE("9", 10)
		*		.TAd_addrid.InputMask = REPLICATE("9", 8)
		*		.TAd_compnum.value = 0
		*		.TSearchAll.InputMask = REPLICATE("X", 40)
		
		*		.LFirma.Caption = GetLangText("ADDRESS","TXT_COMPANY")
		*		.LSuchname.Caption = GetLangText("ADDRESS","TXT_KEYSEARCH")
		*		.LSuchnummer.Caption = GetLangText("ADDRESS","T_KEYNR")
		*		.LName.Caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.FName.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
		*		.LOrt.Caption = GetLangText("ADDRESS","TXT_CITY")
		*		.LMemberNumber.Caption = GetLangText("ADDRESS","TXT_MEMBER")
		*		.CSearch.Caption = GetLangText("COMMON","TXT_OK")
		*		.CCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
		*		.LSearchAll.Caption = GetLangText("ADDRESS","T_SEARCHALL")
		*		.LAddressType.Caption = GetLangText("ADDRESS","TXT_ADDRESS_TYPE")
		*		.LEmail.Caption = GetLangText("ADDRESS","TXT_EMAIL")
		*		.LPhone.Caption = GetLangText("ADDRESS","TXT_PHONE")
		*		.LAddrid.Caption = GetLangText("ADDRESS","T_ADDRESSID")
		
		*		STORE ;
		*			"SELECT pl_lang" + g_langnum + ", pl_charcod FROM picklist " + ;
		*			"WHERE pl_label = 'ADRTYPE   ' " + ;
		*			"UNION SELECT SPACE(25) AS pl_lang" + g_langnum + " , SPACE(3) AS pl_charcod FROM param " + ;
		*			"ORDER BY 2" ;
		*			TO .TAd_adrtype.jsql
		*		.TAd_adrtype.Init()
		
		*		.TAd_company.value = ""
		*		.TAd_compkey.value = ""
		*		.TAd_compnum.value = 0
		*		.TAd_lname.value = ""
		*		.TAd_fname.value = ""
		*		.TAd_city.value = ""
		*		.TAd_member.value = 0
		*		.TAd_addrid.value = 0
		*		.TAd_adrtype.value = ""
		*		.TAd_email.value = ""
		*		.TPhone.value = ""
		*		.TSearchAll.value = ""
		
		*	ENDWITH
		
		*	WITH this.SelectForm.MCodeGrid
		*		.RecordSource = ""
		*		.Column1.ControlSource = ""
		*		.Column2.ControlSource = ""
		*	ENDWITH
		
		*	this.ChangeApartnerDialog.AddProperty('DataCopy', .F.)
		
		*	SELECT ApartnerTAlias
		*	SCATTER Name this.ChangeApartnerDialog.DataCopy Memo
		
		*	WITH this.ChangeApartnerDialog
		*		.Tap_apid.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_apid]
		*		.TAp_Title.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.Ap_title]
		*		.TAp_Fname.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_fname]
		*		.TAp_Lname.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_lname]
		*		.TAp_Phone1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_phone1]
		*		.TAp_Phone2.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_phone2]
		*		.TAp_Fax.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_fax]
		*		.TAp_Email.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_email]
		*		.CAp_Vip1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_vip1]
		*		.TAp_Gebdate.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_gebdate]
		*		.TAp_User1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user1]
		*		.TAp_User2.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user2]
		*		.TAp_User3.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_user3]
		*		.Combo1.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_titlcod]
		*		.TAp_Salute.ControlSource = [thisformset.ChangeApartnerDialog.DataCopy.ap_salute]
		
		
		*		.Lap_apid.Caption = GetLangText("ADDRESS","T_APARTNERID")
		*		.LAp_Title.Caption = GetLangText("ADDRESS","T_APARTNERTITCOD")
		*		.LAp_Fname.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
		*		.LAp_Lname.Caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.LAp_Phone1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
		*		.LAp_Phone2.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2"
		*		.LAp_Fax.Caption = GetLangText("ADDRESS","TXT_FAX")
		*		.LAp_Email.Caption = GetLangText("ADDRESS","TXT_EMAIL")
		*		.LAp_Vip1.Caption = GetLangText("WALKIN","T_VIP")
		*		.LAp_Gebdate.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
		*		.LAp_User1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 1"
		*		.LAp_User2.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 2"
		*		.LAp_User3.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + " 3"
		*		.LAp_Salute.Caption = GetLangText("ADDRESS","TXT_SALUTE")
		
		
		*		.COk.Caption = GetLangText("COMMON","TXT_OK")
		*		.CCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
		*		.CUndo.Caption = GetLangText("ADDRESS","T_UNDO")
		*	ENDWITH
		
		*	WITH this.FAddressMask
		*		.CAddressNew.ToolTipText = GetLangText("ADDRESS","TT_BNEW")
		*		.cCopyNewRecord.ToolTipText = GetLangText("ADDRESS","TT_BCOPY")
		*		.cEditAddress.ToolTipText = GetLangText("ADDRESS","TT_BEDIT")
		*		.CDelAddress.ToolTipText = GetLangText("ADDRESS","TT_BDELETE")
		*		.CSave.ToolTipText = GetLangText("ADDRESS","TT_BSAVE")
		*		.CUndo.ToolTipText = GetLangText("ADDRESS","TT_BUNDO")
		*		.cSearchAddress.ToolTipText = GetLangText("ADDRESS","TT_BSEARCH")
		*		.next100.ToolTipText = GetLangText("ADDRESS","TT_BSEARCHMORE")
		*		.Command8.ToolTipText = GetLangText("ADDRESS","TT_BPRINT")
		*		.CTop.ToolTipText = GetLangText("ADDRESS","TT_BGOTOP")
		*		.CPrev.ToolTipText = GetLangText("ADDRESS","TT_BPREVIOUS")
		*		.CNext.ToolTipText = GetLangText("ADDRESS","TT_BNEXT")
		*		.CBottom.ToolTipText = GetLangText("ADDRESS","TT_BGOBOTTOM")
		*		.cExit.ToolTipText = GetLangText("ADDRESS","TT_BEXIT")
		*		.MainPage.PageAddress.Caption = GetLangText("ADDRESS","PT_ADDRESSNAME")
		*		.MainPage.PageGridAddress.Caption = GetLangText("ADDRESS","PT_ADDRESSBROWSE")
		*		.MainPage.PageAddress.InfoPage.pagCommunication.btnBrowse.ToolTipText = GetLangText("ADDRESS","TT_BWEBADDRESS")
		*	ENDWITH
		
		*	WITH this.FAddressMask.MainPage.PageAddress.SlavePage
		*		.PageApartner.Caption = GetLangText("ADDRESS","PT_APARTNERNAME")
		*		.PageApartner.ToolTipText = GetLangText("ADDRESS","TT_PAPARTNER")
		*		.PageApartner.cmdNewAPart.ToolTipText =  GetLangText("ADDRESS","TT_BNEWAPARTNER")
		*		.PageApartner.cmdDelPart.ToolTipText =  GetLangText("ADDRESS","TT_BDELAPARTNER")
		*		.PageApartner.CUpdateApartner.ToolTipText =  GetLangText("ADDRESS","TT_BEDITAPARTNER")
		*		.PageApartner.cmdNewAPart.Caption = .PageApartner.cmdNewAPart.ToolTipText
		*		.PageApartner.cmdDelPart.Caption = .PageApartner.cmdDelPart.ToolTipText
		*		.PageApartner.CUpdateApartner.Caption = .PageApartner.CUpdateApartner.ToolTipText
		*		.PageNote.Caption = GetLangText("ADDRESS","PT_NOTENAME")
		*		.PageNote.ToolTipText = GetLangText("ADDRESS","TT_PNOTE")
		*		.PageNote.lblAd_Created.Caption = GetLangText("RESERVAT","T_CREATED")
		*		.PageNote.lblAd_Updated.Caption = GetLangText("RESERVAT","T_CHANGED")
		*		.PageDokument.Caption = GetLangText("ADDRESS","PT_DOCUMENTNAME")
		*		.PageDokument.ToolTipText = GetLangText("ADDRESS","TT_PDOCUMENT")
		*		.PageDokument.BDokEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITDOCUMENT")
		*		.PageDokument.BDokNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWDOCUMENT")
		*		.PageDokument.BDokDel.ToolTipText = GetLangText("ADDRESS","TT_BDELDOCUMENT")
		*		.PageDokument.TcPhoneNote.ToolTipText = GetLangText("ADDRESS","TXT_NEW_PHONE_NOTE")
		*		.PageDokument.btnMail.ToolTipText = GetLangText("ADDRESS","TT_BMAILADDRESS")
		*		.PageDokument.btnMail.Enabled = parights(135)
		*		.pageDokument.btnReply.ToolTipText = GetLangText("ADDRESS","TT_BMAILREPLY")
		*		.PageDokument.tcChange.ToolTipText = GetLangText("ADDRESS","TXT_CHOOSE_DOCUMENT_TYPE")
		*		.pageDokument.BDokEdit.Caption = .pageDokument.BDokEdit.ToolTipText
		*		.pageDokument.BDokNew.Caption = .pageDokument.BDokNew.ToolTipText
		*		.pageDokument.BDokDel.Caption = .pageDokument.BDokDel.ToolTipText
		*		.pageDokument.TcPhoneNote.Caption = .pageDokument.TcPhoneNote.ToolTipText
		*		.pageDokument.btnMail.Caption = .pageDokument.btnMail.ToolTipText
		*		.pageDokument.btnReply.Caption = .pageDokument.btnReply.ToolTipText
		*		.pageDokument.tcChange.Caption = .pageDokument.tcChange.ToolTipText
		*		.PageRevnue.Caption = GetLangText("ADDRESS","PT_HISTORYNAME")
		*		.PageRevnue.ToolTipText = GetLangText("ADDRESS","TT_PHISTORY")
		*		.PageRevnue.AddProperty("cHrFilter",".T.")
		*		.pagerevnue.BHistPrint.Enabled = parights(131)
		*		.pagerevnue.BHistPrint.ToolTipText = GetLangText("ADDRESS","TT_PRINT_HISTORY")
		*		.pagerevnue.cmdShowReservation.ToolTipText = GetLangText("ADDRESS","TT_SHOW_RESERVATION")
		*		.pagerevnue.cmdCopyReservation.ToolTipText = GetLangText("ADDRESS","TT_COPY_RESERVATION")
		*		.pagerevnue.cmdSearchReservation.ToolTipText = GetLangText("ADDRESS","TT_SEARCH_RESERVATION")
		*		.pagerevnue.cmdBillPreview.ToolTipText = GetLangText("ADDRESS","TT_BILL_PREVIEW")
		*		.pagerevnue.BHistPrint.Caption = .pagerevnue.BHistPrint.ToolTipText
		*		.pagerevnue.cmdShowReservation.Caption = .pagerevnue.cmdShowReservation.ToolTipText
		*		.pagerevnue.cmdCopyReservation.Caption = .pagerevnue.cmdCopyReservation.ToolTipText
		*		.pagerevnue.cmdSearchReservation.Caption = .pagerevnue.cmdSearchReservation.ToolTipText
		*		.pagerevnue.cmdBillPreview.Caption = .pagerevnue.cmdBillPreview.ToolTipText
		*		.PageHistory.Caption = GetLangText("ADDRESS","PT_REVNUENAME")
		*		.PageHistory.ToolTipText = GetLangText("ADDRESS","TT_PREVNUE")
		*		.PageFuture.Caption = GetLangText("ADDRESS","PT_FUTURENAME")
		*		.PageFuture.ToolTipText = GetLangText("ADDRESS","TT_PFUTURE")
		*		.PageFuture.BFutEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITRESERVATION")
		*		.PageFuture.BFutNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWRESERVATION")
		*		.PageFuture.BFutDel.ToolTipText = GetLangText("ADDRESS","TT_BDELRESERVATION")
		*		.PageFuture.cmdFutAlt.ToolTipText = GetLangText("ADDRESS","TT_ALLOTMENT")
		*		.PageFuture.BFutEdit.Caption = .PageFuture.BFutEdit.ToolTipText
		*		.PageFuture.BFutNew.Caption = .PageFuture.BFutNew.ToolTipText
		*		.PageFuture.BFutDel.Caption = .PageFuture.BFutDel.ToolTipText
		*		.PageFuture.cmdFutAlt.Caption = .PageFuture.cmdFutAlt.ToolTipText
		*		.PageFree.Caption = GetLangText("ADDRESS","PT_INFO")
		*		.PageFree.ToolTipText = GetLangText("ADDRESS","TT_PINFO")
		*		.pageReferral.bRDelete.ToolTipText = GetLangText("ADDRESS","TT_BDELETEREFERRAL")
		*		.pageReferral.brEdit.ToolTipText = GetLangText("ADDRESS","TT_BEDITREFERRAL")
		*		.pageReferral.brNew.ToolTipText = GetLangText("ADDRESS","TT_BNEWREFERRAL")
		*		.pageReferral.brGoto.ToolTipText = GetLangText("ADDRESS","TT_BGOTOREFERRAL")
		*		.pageReferral.cmdshowreferrals.ToolTipText = GetLangText("ADDRESS","TT_BSTRUCTREFERRAL")
		*		.pageReferral.Caption = GetLangText("ADDRESS","TXT_REFERRAL_PAGE")
		*		.pageReferral.ToolTipText = GetLangText("ADDRESS","TT_REFERRAL_PAGE")
		*		.pageReferral.Enabled = parights(129)
		*		.pageReferral.bRDelete.Caption = .pageReferral.bRDelete.ToolTipText
		*		.pageReferral.brEdit.Caption = .pageReferral.brEdit.ToolTipText
		*		.pageReferral.brNew.Caption = .pageReferral.brNew.ToolTipText
		*		.pageReferral.brGoto.Caption = .pageReferral.brGoto.ToolTipText
		*		.pageReferral.cmdshowreferrals.Caption = .pageReferral.cmdshowreferrals.ToolTipText
		*		.PageSales.Caption = GetLangText("ADDRESS","PT_SALES")
		*		.PageSales.ToolTipText = GetLangText("ADDRESS","TT_PSALES")
		*		.PageSales.Enabled = parights(134) AND _SCREEN.US
		*	ENDWITH
		*	SELECT address
		*	this.AddressFieldsDisable()
		*	this.FAddressMask.alwaysontop=.f.
		
		*	DO CASE
		*	CASE thisformset.AddressStart == "EDITL" OR thisformset.AddressStart == "EDITC"
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BDokNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokDel.Enabled = .F.
		*		*** Disable using of Referral Page, when called from Valids from "old" Fox forms
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
		*		this.p_disablereferral = (.T. AND NOT g_newversionactive) OR (NOT EMPTY(nmode) AND nmode == 16)
		*		***
		*		IF this.addresscall= "RSC" OR this.addresscall= "RSL" OR this.addresscall= "ARC" OR this.addresscall= "RSI"
		*				for i=1 to _screen.formcount
		*				IF _screen.forms(i).name != "FAddressMask" AND ;
		*					_screen.forms(i).name != "ChangeApartnerDialog" AND ;
		*					_screen.forms(i).name != "SelectForm" AND ;
		*					_screen.forms(i).name != "AddressSearchDialog" AND ;
		*					UPPER(_screen.forms(i).BaseClass)<>'TOOLBAR' AND ;
		*					_screen.forms(i).name != "Tform1"
		*					
		*					_screen.forms(i).enabled=.f.
		*			    endif
		*			NEXT
		*			this.screenformsdisabled = .T.
		*		*	this.killtoolbar = .T.
		*			this.FAddressMask.MinButton = .F.
		*			this.FAddressMask.mainPage.Tabs = .F.
		*			this.FAddressMask.Visible=.t.
		*			this.FAddressMask.CAddressNew.click()
		*		ELSE
		*			this.FAddressMask.MinButton = .F.
		*			this.FAddressMask.Visible=.t.
		*			this.FAddressMask.CAddressNew.click()
		*			this.FAddressMask.timer1.enabled=.t.
		*		ENDIF
		*	CASE thisformset.AddressStart == "EDITAKTION" OR thisformset.AddressStart == "EDITAR"
		*		IF EMPTY(naddrid)
		*			IF rn>0 .and. rn<=reccount()
		*				GO rn
		*			ENDIF
		*		ELSE
		*			= SEEK(naddrid, "address", "tag1")
		*		ENDIF
		*		SET ORDER TO addtagno
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BDokNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokDel.Enabled = .F.
		*		*** Disable using of Referral Page, when called from Valids from "old" Fox forms
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
		*		this.p_disablereferral = .T. AND NOT g_newversionactive
		*		***
		*			for i=1 to _screen.formcount
		*			IF _screen.forms(i).name != "FAddressMask" AND ;
		*				_screen.forms(i).name != "ChangeApartnerDialog" AND ;
		*				_screen.forms(i).name != "SelectForm" AND ;
		*				_screen.forms(i).name != "AddressSearchDialog" AND ;
		*				UPPER(_screen.forms(i).BaseClass)<>'TOOLBAR' AND ;
		*				_screen.forms(i).name != "Tform1"
		*				_screen.forms(i).enabled=.f.
		*		    endif
		*		NEXT
		*	*	PUSH KEY CLEAR 
		*		this.screenformsdisabled = .T.
		*	*	this.killtoolbar = .T.
		*	*	thisformset.tpypahd = .T.
		*		this.FAddressMask.MinButton = .F.
		*		this.FAddressMask.alwaysontop=.t.
		*	*	this.FAddressMask.mainPage.Tabs = .F.
		*		this.FAddressMask.Visible=.t.
		*		this.FAddressMask.cEditAddress.click()
		*		this.FAddressMask.timer1.enabled=.t.
		*	CASE thisformset.AddressStart == "EDITQ"
		*	*	IF rn>0 .and. rn<=(reccount()+1)
		*	*		GO rn
		*	*	ENDIF
		*		SET ORDER TO addtagno
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.BDokNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageDokument.bDokDel.Enabled = .F.
		*		*** Disable using of Referral Page, when called from Valids from "old" Fox forms
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
		*		this.p_disablereferral = .T. AND NOT g_newversionactive
		*		***
		*	*	this.FAddressMask.mainPage.Tabs = .F.
		*		this.FAddressMask.MinButton = .F.
		*		this.FAddressMask.alwaysontop=.t.
		*		this.FAddressMask.Visible=.t.
		*		this.FAddressMask.cAddressNew.click()
		*		this.FAddressMask.timer1.enabled=.t.
		*		
		*	CASE thisformset.AddressStart == "BRWC" .OR. thisformset.AddressStart=='BRWL'
		*		SELECT address
		*		SET order to tag addtagno
		*		IF rn > 0
		*			GO rn
		*		else
		*			IF NOT EMPTY(lp_nAdId)
		*				l_lWrite = .T.
		*				thisformset.fAddressMask.oProcAddress.AdrMainGetAddress(lp_nAdId, l_lWrite)
		*			ELSE
		
		*				SET near on
		*		*		SET order to tag addtagno
		*				SEEK(thisformset.AddressText)
		*			ENDIF
		*		ENDIF
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutNew.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.bFutDel.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.BFutEdit.Enabled = .F.
		*		this.fAddressMask.mainPage.pageAddress.slavePage.pageFuture.cmdFutAlt.Enabled = .F.
		*		*** Disable using of Referral Page, when called from Valids from "old" Fox forms
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRDelete.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BREdit.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRGoto.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.cmdshowreferrals.Enabled = .F.
		*		this.faddressMask.mainPage.pageAddress.slavePage.pageReferral.BRNew.Enabled = .F.
		*		this.p_disablereferral = .T. AND NOT g_newversionactive
		*		***
		*		IF this.addresscall= "RSC" OR this.addresscall= "RSL" OR this.addresscall= "ARC" OR this.addresscall= "RSI"
		*			for i=1 to _screen.formcount
		*				IF _screen.forms(i).name != "FAddressMask" AND ;
		*					_screen.forms(i).name != "ChangeApartnerDialog" AND ;
		*					_screen.forms(i).name != "SelectForm" AND ;
		*					_screen.forms(i).name != "AddressSearchDialog" AND ;
		*					UPPER(_screen.forms(i).BaseClass)<>'TOOLBAR' AND ;
		*					_screen.forms(i).name != "Tform1"
		*					
		*					_screen.forms(i).enabled=.f.
		*			    endif
		*			NEXT
		*			this.screenformsdisabled = .T.
		*		*	this.killtoolbar = .T.
		*		*	this.FAddressMask.timer1.enabled=.t.
		*			this.FAddressMask.MinButton = .F.
		*			this.FAddressMask.mainPage.Tabs = .F.
		*			this.FAddressMask.MainPage.activepage=2
		*			this.FAddressMask.Visible=.t.
		*		ELSE
		*			this.FAddressMask.MinButton = .F.
		*			this.FAddressMask.MainPage.activepage=2
		*			this.FAddressMask.Visible=.t.
		*			this.FAddressMask.timer2.enabled=.t.
		*		ENDIF	
		*		
		*	CASE thisformset.AddressStart=='EDIT'
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		thisformset.tpypahd = .T.
		*		this.FAddressMask.Visible=.t.
		*		IF this.addresscall= "INHOUSE"
		*	*		this.FAddressMask.alwaysontop =.t.
		*			this.FAddressMask.cEditAddress.click()
		*			this.FAddressMask.timer1.enabled=.t.		
		*		else
		*			this.FAddressMask.alwaysontop =.f.
		*			this.FAddressMask.cEditAddress.click()
		*		endif
		*		*this.fAddressMask.mainPage.PageAddress.slavePage.ActivePage = 2
		*		*this.fAddressMask.mainPage.pageAddress.SetFocus()
		
		*	CASE thisformset.AddressStart=='EDITR'
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		thisformset.tpypahd = .T.
		*		this.FAddressMask.Visible=.t.
		*		this.FAddressMask.alwaysontop =.f.
		*		this.FAddressMask.cEditAddress.click()
		*	CASE thisformset.AddressStart = "NORMAL"
		*		thisformset.tpypahd = .T.
		*		this.FAddressMask.alwaysontop=.f.
		*		IF (SUBSTR(thisformset.buttonrights, 6, 1)="1")
		*			this.FAddressMask.CDelAddress.enabled = .T.
		*		ENDIF
		*		this.firstsearch = .T.
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = parights(109)
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = parights(109)
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
		*	*	this.addressSearchDialog.tAd_company.SetFocus()
		*	CASE thisformset.AddressStart = "SELECT_ADDRESSES"
		*		this.AddressSearchDialog.visible = .F.
		*		this.AddressSearchDialog.caption = ""
		*		IF EMPTY(this.mode)
		*			this.mode = 24
		*		ENDIF
		*		DO CASE
		*			CASE this.mode = 24
		*				this.fAddressMask.Caption = getlangtext("COMMON","TXT_CHOOSE")
		*			CASE this.mode = 25
		*				this.fAddressMask.Caption = getlangtext("ADDRESS","TXT_REFERRALSEARCH")
		*		ENDCASE
		*		thisformset.tpypahd = .T.
		*		this.FAddressMask.alwaysontop=.f.
		*		this.FAddressMask.CDelAddress.enabled = .F.
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.CUpdateApartner.enabled = parights(109)
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdDelPart.enabled = parights(109)
		*		this.FAddressMask.MainPage.PageAddress.SlavePage.PageApartner.cmdNewAPart.enabled = parights(109)
		*		*this.screenformsdisabled = .T.
		*		*this.FAddressMask.MinButton = .F.
		*		*this.FAddressMask.mainPage.Tabs = .F.
		*		this.FAddressMask.MainPage.activepage=2
		*		*this.FAddressMask.Visible=.T.
		*	ENDCASE
		
		*	*this.FAddressMask.LockScreen = .F.
		
		*	IF this.firstsearch
		*		this.addressSearchDialog.Show()
		*	ENDIF
	ENDPROC

	PROCEDURE mode_assign
		LPARAMETERS tnNewVal
		* EDIT_MODE		1 - Edit mode
		* READONLY_MODE	5 - Show mode
		
		IF this.Mode <> tnNewVal
			this.Mode = tnNewVal
			DO CASE
				CASE NOT PEMSTATUS(this.pgfMain.pagEdit, "oAddressEdit", 5)
				CASE this.Mode = READONLY_MODE
					this.pgfMain.pagEdit.oAddressEdit.Enabled = .F.
					this.pgfMain.pagEdit.pgfInfoPage.pagCommunication.oAddressEdit.Enabled = .F.
					this.pgfMain.pagEdit.pgfInfoPage.pagGuestInfo.oAddressEdit.Enabled = .F.
					this.ActivateToolbar()
				CASE this.Mode = EDIT_MODE
					this.pgfMain.pagEdit.oAddressEdit.Enabled = .T.
					this.pgfMain.pagEdit.pgfInfoPage.pagCommunication.oAddressEdit.Enabled = .T.
					this.pgfMain.pagEdit.pgfInfoPage.pagGuestInfo.oAddressEdit.Enabled = .T.
					this.ActivateToolbar()
				OTHERWISE
			ENDCASE
		ENDIF
	ENDPROC

	PROCEDURE nextpage
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		*this.pgfMain.pagBrowse.grdAddress.CursorAddPage()
	ENDPROC

	PROCEDURE onappendpage
	ENDPROC

	PROCEDURE onbottom
		LOCAL lnSelect
		
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		lnSelect = SELECT()
		this.GridActivate()
		SELECT (this.pgfMain.pagBrowse.grdAddress.RecordSource)
		LOCATE FOR .F.
		TRY
			SKIP -1 IN (this.pgfMain.pagBrowse.grdAddress.RecordSource)
		CATCH
		ENDTRY
		SELECT (lnSelect)
		
		this.OnRefresh()
		
		RETURN .T.
	ENDPROC

	PROCEDURE onclose
		IF this.Mode = EDIT_MODE
			this.OnUndo()
		ELSE
			DODEFAULT()
		ENDIF
	ENDPROC

	PROCEDURE onedit
		IF this.Mode <> EDIT_MODE
			this.pgfMain.ActivePage = 1
			this.Mode = EDIT_MODE
			this.OnRefresh()
		ENDIF
	ENDPROC

	PROCEDURE onfilter
		LOCAL lcFilter
		
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		lcFilter = this.oSearchHandler.OnFilter()
		IF NOT EMPTY(lcFilter)
			this.cFilter = lcFilter
			this.cOrder = IIF(this.cFilter = "1=1", this.oSearchHandler.cPrimaryKeyExpr, this.oSearchHandler.cOrder)
			*this.pgfMain.pagBrowse.grdAddress.ResetGrid()
			*this.pgfMain.pagBrowse.grdAddress.CursorRequery()
			IF RECCOUNT(this.pgfMain.pagBrowse.grdAddress.RecordSource) = 0
				Alert(GetText("COMMON", "TXT_FIELD_NOT_FOUND"))
			ENDIF
			this.OnRefresh()
		ENDIF
		
		RETURN NOT EMPTY(lcFilter)
	ENDPROC

	PROCEDURE onnext
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		this.GridActivate()
		TRY
			SKIP IN (this.pgfMain.pagBrowse.grdAddress.RecordSource)
			IF EOF(this.pgfMain.pagBrowse.grdAddress.RecordSource)
				SKIP -1 IN (this.pgfMain.pagBrowse.grdAddress.RecordSource)
			ENDIF
		CATCH
		ENDTRY
		
		this.OnRefresh()
	ENDPROC

	PROCEDURE onprevious
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		this.GridActivate()
		TRY
			SKIP -1 IN (this.pgfMain.pagBrowse.grdAddress.RecordSource)
		CATCH
		ENDTRY
		
		this.OnRefresh()
	ENDPROC

	PROCEDURE onrefresh
		IF this.pgfMain.ActivePage = 1
			this.oBizAddress.AdrGetByAddrId(EVALUATE(this.pgfMain.pagBrowse.grdAddress.RecordSource+".ad_addrid"))
			DODEFAULT()
		ENDIF
	ENDPROC

	PROCEDURE onsave
		return
		
		LOCAL llSuccess, lnErrCode
		
		IF this.Mode # EDIT_MODE
			RETURN .T.
		ENDIF
		
		this.ControlRefresh()
		
		lnErrCode = this.oProcAddress.AdrMainValid(thisform.DataEnvironment.oCAAdrMain.Alias)
		IF lnErrCode = 0
			this.oProcAddress.AdrMainChangeUpdTime(thisform.DataEnvironment.oCAAdrMain.Alias, _screen.oGlobal.oParam2.pa_hotcode)
			llSuccess = thisform.DataEnvironment.oCAAdrMain.DoTableUpdate()
		ELSE
			Alert(this.oProcAddress.cValidError)
		ENDIF
		IF llSuccess
			this.pgfMain.pagBrowse.grdAddress.CursorRequery()
			this.Mode = READONLY_MODE
		ENDIF
		
		RETURN llSuccess
	ENDPROC

	PROCEDURE onsearch
		this.OnFilter()
	ENDPROC

	PROCEDURE ontop
		LOCAL lnSelect
		
		IF this.Mode = EDIT_MODE
			RETURN .T.
		ENDIF
		
		lnSelect = SELECT()
		this.GridActivate()
		SELECT (this.pgfMain.pagBrowse.grdAddress.RecordSource)
		LOCATE
		SELECT (lnSelect)
		
		this.OnRefresh()
		
		RETURN .T.
	ENDPROC

	PROCEDURE ontransfer
		return
		
		LOCAL l_oParam AS Collection, l_nMainAddrid
		LOCAL ARRAY l_aParams(11)
		
		l_nMainAddrid = address.ad_addrid
		l_oParam = CREATEOBJECT("Collection")
		l_oParam.Add(l_nMainAddrid, "MAIN_ADDRID")
		
		l_aParams(1) = "SELECT_ADDRESSES"
		l_aParams(2) = ""
		l_aParams(3) = .F.
		l_aParams(4) = .F.
		l_aParams(5) = .F.
		l_aParams(6) = .F.
		l_aParams(7) = 0
		l_aParams(8) = .F.
		l_aParams(9) = this.fAddressMask
		l_aParams(10) = 0
		l_aParams(11) = l_oParam
		
		doform('searchadr','forms\addressmask', , .T., @l_aParams)
		
		l_oParam = .NULL.
		
		RETURN .T.
	ENDPROC

	PROCEDURE onundo
		IF this.Mode = EDIT_MODE
			this.Mode = READONLY_MODE
			this.OnRefresh()
		ENDIF
	ENDPROC

	PROCEDURE refreshrecordstate
		return
		LOCAL lcTTText, lcRecordSource, lcInstText, lcNoteText
		
		lcTTText = this.GetToolTipText()
		this.Rsbgrid.ToolTipText = lcTTText
		lcRecordSource = this.Rsbgrid.RecordSource
		IF NOT EMPTY(this.cTbrClass)
			lcInstText = IIF(EMPTY(&lcRecordSource..rs_billins), [GetLangText("RESERVAT","TXT_BILLINST")], [GetLangText("RESERVAT","TXT_EDITBILLINST")])
			lcNoteText = IIF(EMPTY(&lcRecordSource..rs_note), [GetLangText("RESERVAT","TXT_RSNOTE")], [GetLangText("RESERVAT","TXT_EDITRSNOTE")])
			this.TbrCtrl.ChangeCaption(P_INSTRUCTION, lcInstText)
			this.TbrCtrl.ChangeCaption(P_NOTE, lcNoteText)
		ENDIF
	ENDPROC

	PROCEDURE Resize
		LPARAMETERS nwidth,nheight
		*
	ENDPROC

	PROCEDURE oSearchHandler.fill
		* Fill search handler on initialization with search criteriums from grid columns.
		* and put extended filter criteriums in collection like this:
		* thisform.oSearchHandler.CreateCriterium(<Caption>, <ControlSource>, <FieldSource>)
		* thisform.oSearchHandler.CreateCriterium(<Caption>, <FieldType>, <FieldSource>, .T.)
		
		*	this.cPrimaryKeyExpr = "ad_addrid"
		*	SELECT (thisform.pgfMain.pagBrowse.grdAddress.cCurName)
		*	this.CreateCriterium(Str2Msg("<%s>", "%s", GetText("COMMON", "TXT_ALL")))
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_ADDRESS_ID"), "ad_adid", "ad_adid")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_FNAME"), "ad_fname", "ad_fname")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_LNAME"), "ad_lname", "ad_lname")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_COMPANY"), "ad_company", "ad_company")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_COMPKEY"), "ad_compkey", "ad_compkey")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_COMPNUM"), "ad_compnum", "ad_compnum")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_COUNTRY"), "ad_country", "ad_country")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_DEPARTMENT"), "ad_departm", "ad_departm")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_STREET"), "ad_street", "ad_street")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_CITY"), "ad_city", "ad_city")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_ZIP"), "ad_zip", "ad_zip")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_STATE"), "ad_state", "ad_state")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_EMAIL"), "ad_email", "ad_email")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_FAX"), "ad_fax", "ad_fax")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_PHONE"), "ad_phone", "ad_phone")
		*	this.CreateCriterium(GetText("ADDRMAIN", "TXT_WEBSITE"), "ad_website", "ad_website")
		
		
		*	this.CreateCriterium(GetText("ADDRESS","TXT_COMPANY")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_KEYSEARCH")
		*	this.CreateCriterium(GetText("ADDRESS","T_KEYNR")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_LNAME")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_FIRSTNAME")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_CITY")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_MEMBER")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_ADDRESS_TYPE")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_EMAIL")
		*	this.CreateCriterium(GetText("ADDRESS","TXT_PHONE")
		*	this.CreateCriterium(GetText("ADDRESS","T_ADDRESSID")
		
	ENDPROC

	PROCEDURE pgfMain.pagBrowse.Activate
		IF thisform.Mode = EDIT_MODE
			thisform.OnUndo()
		ENDIF
		thisform.GridActivate()
	ENDPROC

	PROCEDURE pgfMain.pagBrowse.grdAddress.AfterRowColChange
		LPARAMETERS nColIndex
		
		DODEFAULT(nColIndex)
		
		thisform.RefreshRecordState()
	ENDPROC

	PROCEDURE pgfMain.pagBrowse.grdAddress.Init
		LPARAMETERS lp_lDoIt
		
		IF NOT lp_lDoIt
			RETURN .T.
		ENDIF
		this.SetAll('Movable',.F.,'Column')
		this.SetAll('ReadOnly',.T.,'Column')
		
		*	    this.DefaultPropertiesSet(1, "gr_order", 4)
		*	    this.DefaultPropertiesSet(2, "gr_order", 5)
		*	    this.DefaultPropertiesSet(3, "gr_order", 6)
		*	    this.DefaultPropertiesSet(4, "gr_order", 7)
		*		this.DefaultPropertiesSet(5, "gr_activ", .F.)
		*		this.DefaultPropertiesSet(5, "gr_show", .F.)
		*	    this.DefaultPropertiesSet(5, "gr_order", 14)
		*	    this.DefaultPropertiesSet(6, "gr_order", 2)
		*	    this.DefaultPropertiesSet(7, "gr_order", 1)
		*		this.DefaultPropertiesSet(8, "gr_activ", .F.)
		*		this.DefaultPropertiesSet(8, "gr_show", .F.)
		*	    this.DefaultPropertiesSet(8, "gr_order", 15)
		*	    this.DefaultPropertiesSet(9, "gr_order", 8)
		*		this.DefaultPropertiesSet(10, "gr_activ", .F.)
		*		this.DefaultPropertiesSet(10, "gr_show", .F.)
		*	    this.DefaultPropertiesSet(10, "gr_order", 16)
		*		this.DefaultPropertiesSet(11, "gr_activ", .F.)
		*		this.DefaultPropertiesSet(11, "gr_show", .F.)
		*	    this.DefaultPropertiesSet(11, "gr_order", 17)
		*	    this.DefaultPropertiesSet(12, "gr_order", 3)
		*	    this.DefaultPropertiesSet(13, "gr_order", 9)
		*		this.DefaultPropertiesSet(14, "gr_activ", NOT _screen.oGlobal.oParam.pa_noagent)
		*		this.DefaultPropertiesSet(14, "gr_show", NOT _screen.oGlobal.oParam.pa_noagent)
		*	    this.DefaultPropertiesSet(14, "gr_order", 11)
		*	    this.DefaultPropertiesSet(15, "gr_order", 10)
		
		this.RecordSource = ""
		DIMENSION this.aColumns(14, ALEN(this.aColumns, 2))
		this.aColumns(1, 1) = [ad_compkey]
		this.aColumns(1, 3) = GetLangText("ADDRESS","TXT_KEYSEARCH")
		this.aColumns(2, 1) = [ad_departm]
		this.aColumns(2, 3) = GetLangText("ADDRESS","TXT_DEPARTM")
		this.aColumns(3, 1) = [ad_company]
		this.aColumns(3, 3) = GetLangText("ADDRESS","TXT_COMPANY")
		this.aColumns(4, 1) = [ALLTRIM(ad_lname) + ', ' + ALLTRIM(ad_fname)]
		this.aColumns(4, 3) = GetLangText("ADDRESS","TXT_LNAME") + ", " + GetLangText("ADDRESS","TXT_FIRSTNAME")
		this.aColumns(5, 1) = [ad_title]
		this.aColumns(5, 3) = GetLangText("ADDRESS","TXT_TITLE")
		this.aColumns(6, 1) = [ad_street]
		this.aColumns(6, 3) = GetLangText("ADDRESS","TXT_STREET")
		this.aColumns(7, 1) = [ad_zip]
		this.aColumns(7, 3) = GetLangText("ADDRESS","TXT_CITYZIP")
		this.aColumns(8, 1) = [ad_city]
		this.aColumns(8, 3) = GetLangText("ADDRESS","TXT_CITY")
		this.aColumns(9, 1) = [ad_phone]
		this.aColumns(9, 3) = GetLangText("ADDRESS","TXT_PHONE")
		this.aColumns(10, 1) = []&&c_ref_xc
		this.aColumns(10, 3) = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" "+GetLangText("ADDRESS","TXT_COMPANY")
		this.aColumns(11, 1) = []&&c_ref_xi
		this.aColumns(11, 3) = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" "+GetLangText("RESERVAT","T_INVOICE")
		this.aColumns(12, 1) = []&&c_ref_ma
		this.aColumns(12, 3) = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")+" "+GetLangText("REFERRAL","TXT_LINK_MAIN_ADDRESS")
		this.aColumns(13, 1) = []&&c_ref_ot
		this.aColumns(13, 3) = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID_OTHER")
		this.aColumns(14, 1) = []&&c_selected
		this.aColumns(14, 3) = GetLangText("CONFWEEK","TW_SELECT")
		
		DODEFAULT(.T.)
		
		this.SetAll('Alignment',2,'tHeader')
		
		RETURN .T.
	ENDPROC

	PROCEDURE pgfMain.pagEdit.Activate
		IF NOT PEMSTATUS(this, "oAddressEdit", 5)
			thisform.LockScreen = .T.
			IF g_lDevelopment
				this.AddObject("oAddressEdit", "AddressEdit")
				this.pgfInfoPage.pagCommunication.AddObject("oAddressEdit", "AddressEditCom")
				this.pgfInfoPage.pagGuestInfo.AddObject("oAddressEdit", "AddressEditGst")
			ELSE
				this.NewObject("oAddressEdit", "AddressEdit", "libs\cit_address.vcx", "citadel.exe")
				this.pgfInfoPage.pagCommunication.NewObject("oAddressEdit", "AddressEditCom", "libs\cit_address.vcx", "citadel.exe")
				this.pgfInfoPage.pagGuestInfo.NewObject("oAddressEdit", "AddressEditGst", "libs\cit_address.vcx", "citadel.exe")
			ENDIF
			this.oAddressEdit.InitAfter(this.pgfInfoPage.Left, this.pgfSlave.Top)
			this.pgfInfoPage.pagCommunication.oAddressEdit.InitAfter()
			this.pgfInfoPage.pagGuestInfo.oAddressEdit.InitAfter()
			thisform.LockScreen = .F.
			thisform.Mode = READONLY_MODE
		ENDIF
		
		IF curAddress.ad_addrid <> EVALUATE(thisform.pgfMain.pagBrowse.grdAddress.RecordSource+".ad_addrid")
			thisform.OnRefresh()
		ENDIF
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagApartners.Activate
		*	LOCAL l_nCol
		*	WITH this
		*		.recordsource = 'Apartner'
		*		*.linkmaster = 'address'
		*		*.childorder = 'tag1'
		*		*.relationalexpr ='ad_addrid'
		*		.Column1.controlsource = 'Apartner.ap_title'
		*		.Column2.controlsource = 'Apartner.ap_fname'
		*		.Column3.controlsource = 'Apartner.ap_lname'
		*		.Column4.controlsource = 'Apartner.ap_phone1'
		*		.Column5.controlsource = 'Apartner.ap_phone2'
		*		.Column6.controlsource = 'Apartner.ap_fax'
		*		.Column7.controlsource = 'Apartner.ap_email'
		*		.Column8.controlsource = 'Apartner.ap_vip1'
		*		.Column9.controlsource = 'Apartner.ap_gebdate'
		*		.Column10.controlsource = 'Apartner.ap_user1'
		*		.Column11.controlsource = 'Apartner.ap_user2'
		*		.Column12.controlsource = 'Apartner.ap_user3'
		*		.Column13.ControlSource = 'Apartner.ap_salute'
		
		*		.Column1.Header1.Caption = GetLangText("ADDRESS","TXT_TITLE")
		*		.Column2.Header1.Caption = GetLangText("ADDRESS","TXT_FIRSTNAME")
		*		.Column3.Header1.Caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.Column4.Header1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "1"
		*		.Column5.Header1.Caption = GetLangText("ADDRESS","TXT_PHONE") + "2"
		*		.Column6.Header1.Caption = GetLangText("ADDRESS","TXT_FAX")
		*		.Column7.Header1.Caption = GetLangText("ADDRESS","TXT_EMAIL")
		*		.Column8.Header1.Caption = GetLangText("WALKIN","T_VIP")
		*		.Column9.Header1.Caption = GetLangText("ADDRESS","TXT_BIRTHDAY")
		*		.Column10.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "1"
		*		.Column11.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "2"
		*		.Column12.Header1.Caption = GetLangText("MGRRESER","TXT_FREE_ROOMS") + "3"
		*		.Column13.Header1.Caption = GetLangText("ADDRESS","TXT_SALUTE")
		*	ENDWITH
		*	FOR l_nCol = 1 TO this.ColumnCount
		*		this.Columns(l_nCol).controls(2).ToolTipText = "Zwei mal clicken für änderungen"
		*	ENDFOR
		*	DODEFAULT()
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagDocuments.Activate
		*	SELECT *, RECNO() AS dc_recno, 00000000 AS dc_eiid, 00000000 AS dc_esid, SPACE(30) AS dc_phcname, ;
		*			SPACE(5) AS dc_attachment, .F. AS dc_doctosend, 00000000 AS dc_agid FROM document WHERE .F. INTO CURSOR curDocument READWRITE
		*	SET RELATION TO dc_recno INTO document IN curDocument
		*	INDEX ON dc_date TAG TAG1 DESCENDING
		*	INDEX ON dc_phcname TAG TAG2 DESCENDING
		*	INDEX ON dc_userid TAG TAG3 DESCENDING
		*	INDEX ON dc_type TAG TAG4 DESCENDING
		*	WITH this
		*		.Column1.Header1.Caption = GetLangText("DOC","T_DOC")
		*		.Column2.Header1.Caption = GetLangText("DOC","T_DESCR")
		*		.Column3.Header1.Caption = GetLangText("DOC","T_DATE")
		*		.Column4.Header1.Caption = GetLangText("DOC","T_TIME")
		*		.Column5.Header1.Caption = GetLangText("DOC","T_USER")
		*		.Column6.Header1.Caption = GetLangText("DOC","TXT_DOCUMENT_TYPE")
		*		.Column7.Header1.Caption = GetLangText("DOC","TXT_CONTACT_NAME")
		*		.Column8.Header1.Caption = GetLangText("EMBROWS","TXT_ATTACHMENT")
		*		.Column9.Header1.Caption = GetLangText("EMBROWS","TXT_MARK")
		*		
		*		.RecordSource = [curDocument]
		*		.Column1.ControlSource = [curDocument.dc_file]
		*		.Column2.ControlSource = [curDocument.dc_descr]
		*		.Column3.ControlSource = [curDocument.dc_date]
		*		.Column4.ControlSource = [curDocument.dc_time]
		*		.Column5.ControlSource = [curDocument.dc_userid]
		*		.Column6.ControlSource = [thisformset.m_DocumentGetTypeText(curDocument.dc_type)]
		*		.Column7.ControlSource = [curDocument.dc_phcname]
		*		.Column8.ControlSource = [curDocument.dc_attachment]
		*		.Column9.ControlSource = [curDocument.dc_doctosend]
		*	ENDWITH
		*	DODEFAULT()
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagFuture.Activate
		*	SELECT * FROM reservat WHERE .F. INTO CURSOR (thisformset.FutureFileName) READWRITE
		
		*	WITH this
		*		.Column1.Header1.caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.Column2.Header1.caption = GetLangText("ADDRESS","TXT_ARRDATE")
		*		.Column3.Header1.caption = GetLangText("ADDRESS","TXT_DEPDATE")
		*		.Column4.Header1.caption = GetLangText("ADDRESS","TXT_FROM")
		*		.Column5.Header1.caption = GetLangText("ADDRESS","TXT_TO")
		*		.Column6.Header1.caption = GetLangText("ADDRESS","TXT_ROOMS")
		*		.Column7.Header1.caption = GetLangText("ADDRESS","TXT_ROOMTYPE")
		*		.Column8.Header1.caption = GetLangText("ADDRESS","TXT_ROOMNUM")
		*		.Column9.Header1.caption = GetLangText("ADDRESS","TXT_PERS")
		*		.Column10.Header1.caption = GetLangText("ADDRESS","TXT_RATE")
		*		.Column11.Header1.caption = GetLangText("ADDRESS","TXT_RATECOD")
		*		.Column12.Header1.caption = GetLangText("ADDRESS","TXT_STATUS")
		*		          
		*		.RecordSource = thisformset.FutureFileName
		*		.Column1.ControlSource = thisformset.FutureFileName + [.rs_lname]
		*		.Column2.ControlSource = thisformset.FutureFileName + [.rs_arrdate]
		*		.Column3.ControlSource = thisformset.FutureFileName + [.rs_depdate]
		*		.Column4.ControlSource = thisformset.FutureFileName + [.rs_arrtime]
		*		.Column5.ControlSource = thisformset.FutureFileName + [.rs_deptime]
		*		.Column6.ControlSource = thisformset.FutureFileName + [.rs_rooms]
		*		.Column7.ControlSource = [get_rt_roomtyp(]+thisformset.FutureFileName + [.rs_roomtyp)]
		*		.Column8.ControlSource = [Get_rm_rmname(]+thisformset.FutureFileName+[.rs_roomnum)]
		*		.Column9.ControlSource = thisformset.FutureFileName + [.rs_adults + ] + ;
		*				thisformset.FutureFileName + [.rs_childs + ] + ;
		*				thisformset.FutureFileName + [.rs_childs2 + ] + ;
		*				thisformset.FutureFileName + [.rs_childs3]
		*		.Column10.ControlSource = thisformset.FutureFileName + [.rs_rate]
		*		.Column11.ControlSource = thisformset.FutureFileName + [.rs_ratecod]
		*		.Column12.ControlSource = thisformset.FutureFileName + [.rs_status]
		*	ENDWITH
		
		*	DODEFAULT()
		
		*	RETURN .T.
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagHistory.Activate
		*	LOCAL ARRAY l_aHistresCur(1)
		*	= AFIELDS(l_aHistresCur, "histres")
		*	DO CursorAddField IN ProcBill WITH l_aHistresCur, "al_allott", "C", 30, 0
		*	CREATE CURSOR cTmpHistres FROM ARRAY l_aHistresCur
		*	* If new column added then it must be added in listsdata.prg too. (addresshistory printing)
		*	INDEX ON DTOS(hr_arrdate) TAG TAG1
		*	INDEX ON DTOS(hr_depdate) TAG TAG2
		*	INDEX ON hr_lname TAG TAG3
		*	INDEX ON hr_roomtyp TAG TAG4
		*	INDEX ON al_allott TAG TAG5
		
		*	WITH this
		*		.RecordSource = [cTmpHistres]
		*		.column1.ControlSource = [cTmpHistres.hr_lname]
		*		.column2.ControlSource = [cTmpHistres.hr_arrdate]
		*		.column3.ControlSource = [cTmpHistres.hr_depdate]
		*		.column4.ControlSource = [cTmpHistres.hr_arrtime]
		*		.column5.ControlSource = [cTmpHistres.hr_deptime]
		*		.column6.ControlSource = [cTmpHistres.hr_rooms]
		*		.column7.ControlSource = [get_rt_roomtyp(cTmpHistres.hr_roomtyp)]
		*		.column8.ControlSource = [Get_rm_rmname(cTmpHistres.hr_roomnum)]
		*		.column9.ControlSource = [cTmpHistres.hr_adults + cTmpHistres.hr_childs + ;
		*			cTmpHistres.hr_childs2 + cTmpHistres.hr_childs3]
		*		.column10.ControlSource = [cTmpHistres.hr_rate]
		*		.column11.ControlSource = [cTmpHistres.hr_ratecod]
		*		.column12.ControlSource = [cTmpHistres.hr_status]
		*		.column13.ControlSource = [cTmpHistres.hr_company]
		*		.column14.ControlSource = [cTmpHistres.hr_group]
		*		.column15.ControlSource = [cTmpHistres.al_allott]
		*		.Column1.Header1.caption = GetLangText("ADDRESS","TXT_LNAME")
		*		.Column2.Header1.caption = GetLangText("ADDRESS","TXT_ARRDATE")
		*		.Column3.Header1.caption = GetLangText("ADDRESS","TXT_DEPDATE")
		*		.Column4.Header1.caption = GetLangText("ADDRESS","TXT_FROM")
		*		.Column5.Header1.caption = GetLangText("ADDRESS","TXT_TO")
		*		.Column6.Header1.caption = GetLangText("ADDRESS","TXT_ROOMS")
		*		.Column7.Header1.caption = GetLangText("ADDRESS","TXT_ROOMTYPE")
		*		.Column8.Header1.caption = GetLangText("ADDRESS","TXT_ROOMNUM")
		*		.Column9.Header1.caption = GetLangText("ADDRESS","TXT_PERS")
		*		.Column10.Header1.caption = GetLangText("ADDRESS","TXT_RATE")
		*		.Column11.Header1.caption = GetLangText("ADDRESS","TXT_RATECOD")
		*		.Column12.Header1.caption = GetLangText("ADDRESS","TXT_STATUS")
		*		.Column13.Header1.caption = GetLangText("ADDRESS","TXT_COMPANY")
		*		.Column14.Header1.caption = GetLangText("RESERV2","TXT_GROUP")
		*		.Column15.Header1.caption = GetLangText("RESERVAT","T_ALLOTT")
		*	ENDWITH
		*	DODEFAULT()
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagReferrals.Activate
		*	CREATE CURSOR tgridreferralcursor ;
		*		(re_id N(8), ;
		*		 re_to N(8), ;
		*		 re_lnkf N(3), ;
		*		 re_lnkt N(3), ;
		*		 re_date D(8), ;
		*		 re_user C(10), ;
		*		 re_reftext C(25), ;
		*		 re_addtext C(50), ;
		*		 re_linkres C(20), ;
		*		 re_mainadi C(82), ;
		*		 re_fulladr C(250))
		*	INDEX ON re_reftext TAG tag1
		
		*	CREATE CURSOR curLinkedAddress ;
		*		(re_mark l(1), ;
		*		re_from N(8), ;
		*		re_to N(8), ;
		*		re_addtext C(50), ;
		*		re_addrid n(8), ;
		*		re_city c(30))
		*	INDEX ON re_addrid TAG Tag1
		*	INDEX ON re_mark TAG Tag2
		*	SET ORDER TO
		
		*	WITH this
		*		.RecordSource = [tgridreferralcursor]
		*		.column1.ControlSource = [tgridreferralcursor.re_reftext]
		*		.column2.ControlSource = [tgridreferralcursor.re_addtext]
		*		.column3.ControlSource = [tgridreferralcursor.re_date]
		*		.column4.ControlSource = [tgridreferralcursor.re_user]
		*		.column5.ControlSource = [tgridreferralcursor.re_linkres]
		*		.column6.ControlSource = [tgridreferralcursor.re_fulladr]
		*		.column7.ControlSource = [tgridreferralcursor.re_mainadi]
		*		.column1.header1.Caption = GetLangText("REFERRAL","TXT_REFERRAL_IN_GRID")
		*		.column2.header1.Caption = GetLangText("REFERRAL","TXT_REFERRENCE_IN_GRID")
		*		.column3.header1.Caption = GetLangText("MGRRESER","TXT_DATE")
		*		.column4.header1.Caption = GetLangText("DOC","T_USER")
		*		.column5.header1.Caption = GetLangText("REFERRAL","TXT_LINKED_IN_RESERVAT")
		*		.column6.header1.Caption = GetLangText("ADDRESS","TXT_ADDRESS")
		*		.column7.header1.Caption = GetLangText("REFERRAL","TXT_LINK_MAIN_ADDRESS")
		*		.SetAll('movable',.f.,'column')
		*	ENDWITH
		
		*	DODEFAULT()
		
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagRevenue.Activate
		*	thisform.LockScreen = .T.
		*	IF NOT PEMSTATUS(this, "oRevenuePage", 5)
		*		SELECT 0
		*		this.AddObject("oRevenuePage", "RevenuePage")
		*		this.oRevenuePage.cmdSum.Enabled = .F.
		*		this.oRevenuePage.Mode = "ADRMAIN"
		*		this.oRevenuePage.cSource = thisform.pgfMain.pagBrowse.grdAddress.cCurName
		*		REPLACE cur_selected WITH .T. FOR ho_hotcode = _screen.oGlobal.oParam2.pa_hotcode IN (this.oRevenuePage.cStatDataHotelsCur)
		*		this.oRevenuePage.InitAfter()
		*	ENDIF
		*	this.oRevenuePage.Activate()
		*	thisform.LockScreen = .F.
	ENDPROC

	PROCEDURE pgfMain.pagEdit.pgfSlave.pagSales.Activate
		*	DODEFAULT()
		*	thisformset.AddProperty("aPageSalesData(12)","")
		*	thisformset.aPageSalesData(11) = {}
		*	thisformset.AddProperty("aAraccountData(6)",0)
		*	thisformset.AddProperty("aForecastData(10)",0)
		*	LOCAL l_nChild
		
		*	this.lblLast.Caption = GetLangText("ADDRESS","TXT_LAST")+":"
		*	this.lblLastRatecode.Caption = GetLangText("RESERVAT","T_RATECODE")+":"
		*	this.lblLastPrice.Caption = GetLangText("RESERVAT","T_PRICE")+":"
		*	this.lblRatecode.Caption = GetLangText("RATES","TXT_RATECODE")+":"
		*	this.lblPriceAdult1.Caption = "1."+GetLangText("RESERVAT","T_ADULTS")+":"
		*	this.lblPriceAdult2.Caption = "2."+GetLangText("RESERVAT","T_ADULTS")+":"
		*	this.lblPriceAdult3.Caption = "3."+GetLangText("RESERVAT","T_ADULTS")+":"
		*	this.lblLastPriceChild1.Caption = GetLangText("RESERVAT","T_CHILDS")+"1:"
		*	this.lblLastPriceChild2.Caption = GetLangText("RESERVAT","T_CHILDS")+"2:"
		*	this.lblLastPriceChild3.Caption = GetLangText("RESERVAT","T_CHILDS")+"3:"
		*	this.lblLastRoomtype.Caption = GetLangText("RESERVAT","T_ROOMTYPE")+":"
		*	this.lblLastRoom.Caption = GetLangText("DP","T_ROOM")+":"
		*	this.lblLastStay.Caption = GetLangText("RESERVAT","T_STAY")+":"
		*	this.lblLastContact.Caption = GetLangText("ADDRESS","TXT_LASTCONTACT")+":"
		*	this.lblLastContactType.Caption = GetLangText("ADDRESS","TXT_LASTCONTACT_TYPE")+":"
		*	this.lblMarket.Caption = GetLangText("DENIAL","T_MARKET")+":"
		*	this.lblSource.Caption = GetLangText("DENIAL","T_SOURCE")+":"
		
		*	this.txtLastRatecode.ControlSource = [laststay.ls_ratecod]
		*	this.txtLastPrice.ControlSource = [laststay.ls_rate]
		*	this.txtRatecode.ControlSource = [thisformset.aPageSalesData(9)]
		*	this.txtPriceAdults1.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceAdults2.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceAdults3.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceChild1.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceChild2.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceChild3.InputMask = REPLICATE("9", 6) + ".99"
		*	this.txtPriceAdults1.ControlSource = [thisformset.aPageSalesData(3)]
		*	this.txtPriceAdults2.ControlSource = [thisformset.aPageSalesData(4)]
		*	this.txtPriceAdults3.ControlSource = [thisformset.aPageSalesData(5)]
		*	this.txtPriceChild1.ControlSource = [thisformset.aPageSalesData(6)]
		*	this.txtPriceChild2.ControlSource = [thisformset.aPageSalesData(7)]
		*	this.txtPriceChild3.ControlSource = [thisformset.aPageSalesData(8)]
		*	this.txtLastRoomtype.ControlSource = [Get_rt_roomtyp(laststay.ls_roomtyp)]
		*	this.txtLastRoom.ControlSource = [Get_rm_rmname(laststay.ls_roomnum)]
		*	this.txtLastStayArr.ControlSource = [laststay.ls_arrdat]
		*	this.txtLastStayDep.ControlSource = [laststay.ls_depdate]
		*	this.txtContactDate.ControlSource = [thisformset.aPageSalesData(11)]
		*	this.txtContactType.ControlSource = [thisformset.aPageSalesData(12)]
		*	this.txtMarket.ControlSource = [laststay.ls_market]
		*	this.txtSource.ControlSource = [laststay.ls_source]
		
		*	l_nChild = lstcount(param.pa_childs)
		*	DO CASE
		*		CASE l_nChild = 0
		*			this.lblLastPriceChild1.Visible = .F.
		*			this.txtPriceChild1.Visible = .F.
		*			this.lblLastPriceChild2.Visible = .F.
		*			this.txtPriceChild2.Visible = .F.
		*			this.lblLastPriceChild3.Visible = .F.
		*			this.txtPriceChild3.Visible = .F.
		*		CASE l_nChild = 1
		*			this.lblLastPriceChild2.Visible = .F.
		*			this.txtPriceChild2.Visible = .F.
		*			this.lblLastPriceChild3.Visible = .F.
		*			this.txtPriceChild3.Visible = .F.
		*		CASE l_nChild = 2
		*			this.lblLastPriceChild3.Visible = .F.
		*			this.txtPriceChild3.Visible = .F.
		*	ENDCASE
		
		*	this.lblOpenBalance.Caption = GetLangText("ADDRESS","TXT_OPEN_BALANCE")+":"
		*	this.lblRem0.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 0"
		*	this.lblRem1.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 1"
		*	this.lblRem2.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 2"
		*	this.lblRem3.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 3"
		*	this.lblRemX.Caption = GetLangText("ADDRESS","TXT_REMAINDER_LEVEL")+" 4"
		
		*	this.txtOpenBalance.ControlSource = [thisformset.aAraccountData(1)]
		*	this.txtRem0.ControlSource = [thisformset.aAraccountData(2)]
		*	this.txtRem1.ControlSource = [thisformset.aAraccountData(3)]
		*	this.txtRem2.ControlSource = [thisformset.aAraccountData(4)]
		*	this.txtRem3.ControlSource = [thisformset.aAraccountData(5)]
		*	this.txtRemX.ControlSource = [thisformset.aAraccountData(6)]
		
		*	IF NOT _screen.dv
		*		this.lblOpenBalance.Visible = .F.
		*		this.lblRem0.Visible = .F.
		*		this.lblRem1.Visible = .F.
		*		this.lblRem2.Visible = .F.
		*		this.lblRem3.Visible = .F.
		*		this.lblRemX.Visible = .F.
		*		this.txtOpenBalance.Visible = .F.
		*		this.txtRem0.Visible = .F.
		*		this.txtRem1.Visible = .F.
		*		this.txtRem2.Visible = .F.
		*		this.txtRem3.Visible = .F.
		*		this.txtRemX.Visible = .F.
		*		this.linArHorizontal1.Visible = .F.
		*		this.linArHorizontal2.Visible = .F.
		*		this.linArVertical1.Visible = .F.
		*		this.linArVertical2.Visible = .F.
		*		this.linArVertical3.Visible = .F.
		*		this.linArVertical4.Visible = .F.
		*		this.linArVertical5.Visible = .F.
		*	ENDIF
		
		*	this.lblForecast.Caption = GetLangText("ADDRESS","TXT_FORECAST")
		*	this.lblExpectedRevOcc.Caption = GetLangText("ADDRESS","TXT_EXPECTED_REV_OCC")+":"
		*	this.lblUntilMonthEnd.Caption = GetLangText("ADDRESS","TXT_UNTIL_MONTH_END")+":"
		*	this.lblNext30days.Caption = GetLangText("ADDRESS","TXT_NEXT_30_DAYS")+":"
		*	this.lblUntilYearEnd.Caption = GetLangText("ADDRESS","TXT_UNTIL_YEAR_END")+":"
		*	this.lblNext365Days.Caption = GetLangText("ADDRESS","TXT_NEXT_365_DAYS")+":"
		*	this.lblRoom1.Caption = GetLangText("RATES","TXT_ROOM")
		*	this.lblRoom2.Caption = GetLangText("RATES","TXT_ROOM")
		*	this.lblRoom3.Caption = GetLangText("RATES","TXT_ROOM")
		*	this.lblRoom4.Caption = GetLangText("RATES","TXT_ROOM")
		*	this.lblRoom5.Caption = GetLangText("RATES","TXT_ROOM")
		
		*	this.txtExpectedRev.ControlSource = [thisformset.aForecastData(1)]
		*	this.txtExpectedOcc.ControlSource = [thisformset.aForecastData(2)]
		*	this.txtRevUntilMonthEnd.ControlSource = [thisformset.aForecastData(3)]
		*	this.txtOccUntilMonthEnd.ControlSource = [thisformset.aForecastData(4)]
		*	this.txtRevNext30days.ControlSource = [thisformset.aForecastData(5)]
		*	this.txtOccNext30days.ControlSource = [thisformset.aForecastData(6)]
		*	this.txtRevUntilYearEnd.ControlSource = [thisformset.aForecastData(7)]
		*	this.txtOccUntilYearEnd.ControlSource = [thisformset.aForecastData(8)]
		*	this.txtRevNext365Days.ControlSource = [thisformset.aForecastData(9)]
		*	this.txtOccNext365Days.ControlSource = [thisformset.aForecastData(10)]
		
		*	this.lblIntrests.Caption = GetLangText("ADDRESS","TXT_INTRESTS")
		*	this.lblResIntervals.Caption = GetLangText("ADDRESS","TXT_EXPECTED_RES_INTERVALS")
		
		*	this.edtIntrests.ControlSource = [thisformset.aPageSalesData(1)]
		*	this.edtResIntervals.ControlSource = [thisformset.aPageSalesData(2)]
		*	thisformset.aPageSalesData(10) = 0 && Enable initial refresh
		*	RETURN .T.
		
	ENDPROC

ENDDEFINE

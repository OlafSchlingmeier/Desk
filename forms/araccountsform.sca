*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="araccountsform.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\constdefines.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 648
	InitialSelectedAlias = "aracct"
	Left = 0
	Name = "Dataenvironment"
	Top = 2
	Width = 716

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "aracct", ;
		BufferModeOverride = 1, ;
		CursorSource = ..\data\aracct.dbf, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Order = "", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "paymetho", ;
		CursorSource = ..\data\paymetho.dbf, ;
		Height = 90, ;
		Left = 410, ;
		Name = "Cursor12", ;
		Order = "tag1", ;
		Top = 267, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "article1", ;
		CursorSource = ..\data\article.dbf, ;
		Height = 90, ;
		Left = 410, ;
		Name = "Cursor13", ;
		Order = "tag1", ;
		Top = 388, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "reservat", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 90, ;
		Left = 280, ;
		Name = "Cursor14", ;
		Top = 385, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "histres", ;
		CursorSource = ..\data\histres.dbf, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor15", ;
		Top = 384, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "histpost", ;
		CursorSource = ..\data\histpost.dbf, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor16", ;
		Top = 380, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "apartner", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 90, ;
		Left = 153, ;
		Name = "Cursor17", ;
		Top = 142, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "address1", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 90, ;
		Left = 149, ;
		Name = "Cursor18", ;
		Top = 505, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "arpcond", ;
		CursorSource = ..\data\arpcond.dbf, ;
		Height = 90, ;
		Left = 284, ;
		Name = "Cursor19", ;
		Top = 509, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "arpost", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\arpost.dbf, ;
		Height = 90, ;
		Left = 284, ;
		Name = "Cursor2", ;
		Order = "", ;
		Top = 16, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "arremd", ;
		CursorSource = ..\data\arremd.dbf, ;
		Height = 90, ;
		Left = 410, ;
		Name = "Cursor20", ;
		Top = 511, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "arbilsta", ;
		CursorSource = ..\data\arbilsta.dbf, ;
		Height = 90, ;
		Left = 529, ;
		Name = "Cursor21", ;
		Top = 13, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "picklist1", ;
		CursorSource = ..\data\picklist.dbf, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "post", ;
		CursorSource = ..\data\post.dbf, ;
		Height = 90, ;
		Left = 11, ;
		Name = "Cursor5", ;
		Top = 503, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "address", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 90, ;
		Left = 155, ;
		Name = "Cursor7", ;
		Top = 21, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "address", ;
		ChildOrder = "tag1", ;
		Name = "Relation1", ;
		ParentAlias = "aracct", ;
		RelationalExpr = "ac_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation2' AS relation WITH ;
		ChildAlias = "apartner", ;
		ChildOrder = "tag3", ;
		Name = "Relation2", ;
		ParentAlias = "aracct", ;
		RelationalExpr = "ac_apid"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS formset AS formset 
 	*< CLASSDATA: Baseclass="formset" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="FormARAccounts" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.lFindNext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.lFindPrevious" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.ckonto.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.ckonto.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.ccompkey.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.ccompkey.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cname.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cname.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cfirma.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cfirma.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cbalance.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cbalance.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem0.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem0.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.disputed.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.disputed.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cfreepayments.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cfreepayments.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cinactiv.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cinactiv.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cselrem.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cselrem.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cselpaycond.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.cselpaycond.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.gdaraccounts.crem4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.ogkontofilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.ogpostfilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.lkonto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.tbkonto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.lpostfilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.lkontofilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormARAccounts.oSearchHandlerAracct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.cbField" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.lField" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.lValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.tbValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.chExactSearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.lFindNext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormSearch.lFindPrevious" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.ogsearchfield" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.ogpostfilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbdebitor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lDebitor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lpostfilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lsearchfield" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lFirma" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbfirma" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemLev3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemLev2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemLev3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemLev1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemLev2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbdebit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemLev1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lDebit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lCredit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbcredit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbbalance" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lBalance" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbsearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lSearchString" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbillno.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbillno.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdate.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdate.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbelgdat.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbelgdat.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cpaynum.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cpaynum.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdebit.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdebit.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.ccredit.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.ccredit.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbalance.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbalance.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.creference.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.creference.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cmark.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cmark.Tcheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cDispute.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cDispute.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cremeinderlevel.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cremeinderlevel.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.clastremainder.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.clastremainder.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cduedat.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cduedat.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.ccollectagent.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.ccollectagent.Tchkgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdisuputeduntil.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cdisuputeduntil.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbillstatus.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.gdpostings.cbillstatus.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemLev4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemLev4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbbalancemarked" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lbalancemarked" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.TBPaymentsMarked" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.linSeparator" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lFindNext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lFindPrevious" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.oSearchHandlerPost" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemKeyNo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemKeyDescript" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemCondNo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.tbRemCondDescript" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemKey" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPosting.lRemCondition" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.cmdClose" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.la7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAging.lamt7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.dbfrom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.dbto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.chIncludeUnallocated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.lBillDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrintStatements.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormTransfer" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormTransfer.laccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormTransfer.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormTransfer.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormTransfer.tbaccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate.lbillnr" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate.tbbillnr" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormAllocate.ltext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lbelgdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.tbrate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.dbdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.dbbelgdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.ldate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lpaymethod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lrate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.tbamount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lamount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.tbreference" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lReference" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.chUnallocated" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.chPayAllMarked" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.cbpaymethod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPay.lsaypaymethod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.cbField" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.lField" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.lValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.tbValue" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.chExactSearch" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.lFindNext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="formsearchpost.lFindPrevious" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrint.OGPrintType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrint.cmdPrint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="FormPrint.cmdCancel" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: lforbidenrem4_assign
		*m: madjust		&& Call adjust form
		*m: maging		&& Call aging form
		*m: mallocate		&& Call alocate form
		*m: mallocatepayment		&& Move payment from one bill to another bill
		*m: mallpostfind		&& Find postings, search all arpost and aracct table
		*m: mbalancebills
		*m: mbalanceoutcondition
		*m: mbillstatus
		*m: mcalcbalance
		*m: mcalcremlevbalance
		*m: mcollectingagency
		*m: mdispute		&& Call dispute form
		*m: mgetarconditionnumber
		*m: mgetarremaindernumber
		*m: mgetdisputed
		*m: mgetdisputedbalance
		*m: mgetfreepayments
		*m: mgetgrdbalance
		*m: mgetgrdrem0
		*m: mgetgrdrem1
		*m: mgetgrdrem2
		*m: mgetgrdrem3
		*m: mgetgrdrem4
		*m: mgetinactive
		*m: mgetlastdate
		*m: mgetpostings		&& Get postings for account
		*m: mgetreccount
		*m: mgettooltip
		*m: mmark		&& Mark posting
		*m: moncanceldispute
		*m: mpay		&& Call pay form
		*m: mpaypostment		&& Check payment and writes into tables
		*m: mpaypostmentvoucher
		*m: mpostdelete		&& Delete postings
		*m: mpostfilter		&& Set filter into postings table
		*m: mpostfind		&& Find Postings
		*m: mpostfindnext		&& Find next posting (CTRL+G)
		*m: mpostfindprevious
		*m: mprintbillcopy
		*m: mprintpostings		&& Print showed postings.
		*m: mprintstatement		&& Print statement for account
		*m: mrefreshgridonskip		&& Called when refeshing of gdpost grid needed.
		*m: mremedit
		*m: msearchbillnr		&& Search ap_billnr in arpost.dbf
		*m: msearchclose		&& Close Search dialog (Cancel Button)
		*m: msetcaption		&& Set caption of labels on all forms
		*m: msetcontrolsource		&& Set control souce for all objects
		*m: msetgriddynamiccolor		&& Sets Grids Dynamic colors
		*m: msetmark
		*m: msetorderoncarpost		&& Sets order on Carpost cursor, when doble clicked on heador of column in gdpostings
		*m: mstatement		&& Print statement
		*m: mtransfer		&& Call transfer form
		*m: mtransferbill		&& Transfer bill from account to another account
		*m: mupdatearpost
		*m: mupdatetable
		*m: onaddress		&& Call addressmask from toolbar
		*m: onclose		&& Close A/R account form and exit
		*m: onfind		&& Find (OK button, Search form)
		*m: onpostings		&& Open postings grid
		*m: refresharconditions
		*p: araccdata
		*p: caccount		&& Stores information about selecte account
		*p: ccompany		&& Company from address
		*p: ccontact		&& Contact person
		*p: cname		&& Name from addres
		*p: cno
		*p: cpaycondlabel
		*p: cref		&& Reference (payform)
		*p: cremainderlabel
		*p: csearch		&& Value searching in postings form
		*p: cyes
		*p: dap_belgdate		&& Belg Date (payform)
		*p: dap_date		&& Date (payform)
		*p: dlastreminder		&& Variable  for last reminder sent date
		*p: dlaststatement		&& Variable  for last statement sent date
		*p: laddresenterkey
		*p: lbillnumfound
		*p: lcreditors
		*p: lforbidenrem4
		*p: lgennew		&& if .t., generates new bill (Adjust form), if .f., adjust selected bill
		*p: lmarked		&& .t. if some record is marked
		*p: lpayall		&& .t. i Pay all marked postings is marked, .f. otherwise
		*p: lunalloc		&& .t. if Unallocated payment postigs, .f. if not (payform)
		*p: mode
		*p: namt		&& Store amount (payform)
		*p: nam_number
		*p: naracct
		*p: nartinum		&& Stores article number (Adjust form)
		*p: nay_number
		*p: nbalance		&& A/R account balance
		*p: nbalancemarked		&& Store balance for marked postings
		*p: nbillnumber
		*p: ncalcrate		&& Store calculated rate for paymethod (payform)
		*p: ncredit		&& Summary credit for A/R Account
		*p: ncuraracct
		*p: ncurbalance
		*p: ncurrem0
		*p: ncurrem1
		*p: ncurrem2
		*p: ncurrem3
		*p: ncurrem4
		*p: ndebit		&& Summary debit for A/R Account
		*p: ndefamt		&& Stores recalculated value of nbalancemarked (depending of rate)
		*p: ndisprate		&& Store rate for paymethod
		*p: ndisputed
		*p: nfreepayments
		*p: nmaxamt		&& Maximum Amount for pay postment
		*p: npaymentsmarked		&& Stores sum of marked payments.
		*p: npaynum		&& Paynum (payform)
		*p: nposfilter
		*p: npostfilter		&& Filter for postings
		*p: nprice		&& Stores price for artice (Adjust form)
		*p: nqty		&& Stores quantity (Adjust form)
		*p: nsearchfield		&& What field to search in postings
		*p: nselectedaccount
		*p: pcvalue		&& This property contains information about value searched
		*p: plexactsearch		&& If .t., perform exact search, in other case search for occurence pValue in pField
		*p: pnfield		&& This property contains information about field user selected from combobox in search dialog
		*a: aremlevbalance[4,0]
	*</DefinedPropArrayMethod>

	AutoRelease = .T.
	cpaycondlabel = 
	cremainderlabel = 
	csearch = 		&& Value searching in postings form
	DataSession = 2
	dlaststatement = 		&& Variable  for last statement sent date
	lcreditors = .F.
	Name = "Formset"
	namt = 0.00		&& Store amount (payform)
	nartinum = 0		&& Stores article number (Adjust form)
	nbalance = 0.00		&& A/R account balance
	nbalancemarked = 0.00		&& Store balance for marked postings
	ncalcrate = 0.00		&& Store calculated rate for paymethod (payform)
	ncredit = 0.00		&& Summary credit for A/R Account
	ndebit = 0.00		&& Summary debit for A/R Account
	ndefamt = 0.00		&& Stores recalculated value of nbalancemarked (depending of rate)
	ndisprate = 0.00		&& Store rate for paymethod
	npaynum = 0		&& Paynum (payform)
	nposfilter = 1
	npostfilter = 1		&& Filter for postings
	nprice = 0.00		&& Stores price for artice (Adjust form)
	nqty = 0.00		&& Stores quantity (Adjust form)
	nsearchfield = 1		&& What field to search in postings
	pcvalue = 		&& This property contains information about value searched

	ADD OBJECT 'FormAging' AS tform WITH ;
		Caption = "FormAging", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 217, ;
		Icon = ..\bitmap\icons\graph06.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormAging", ;
		Visible = .F., ;
		Width = 229
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormAging.cmdClose' AS tcommandbutton WITH ;
		Caption = "cmdClose", ;
		Left = 72, ;
		Name = "cmdClose", ;
		TabIndex = 6, ;
		Top = 186
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormAging.la1' AS tlabel WITH ;
		Caption = "la1", ;
		Left = 12, ;
		Name = "la1", ;
		TabIndex = 14, ;
		Top = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la2' AS tlabel WITH ;
		Caption = "la2", ;
		Left = 12, ;
		Name = "la2", ;
		TabIndex = 16, ;
		Top = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la3' AS tlabel WITH ;
		Caption = "la3", ;
		Left = 12, ;
		Name = "la3", ;
		TabIndex = 19, ;
		Top = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la4' AS tlabel WITH ;
		Caption = "la4", ;
		Left = 12, ;
		Name = "la4", ;
		TabIndex = 14, ;
		Top = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la5' AS tlabel WITH ;
		Caption = "la5", ;
		Left = 12, ;
		Name = "la5", ;
		TabIndex = 16, ;
		Top = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la6' AS tlabel WITH ;
		Caption = "la6", ;
		Left = 12, ;
		Name = "la6", ;
		TabIndex = 19, ;
		Top = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.la7' AS tlabel WITH ;
		Caption = "la7", ;
		Left = 12, ;
		Name = "la7", ;
		TabIndex = 19, ;
		Top = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt1' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt1", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt1", ;
		TabIndex = 14, ;
		Top = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt2' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt2", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt2", ;
		TabIndex = 16, ;
		Top = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt3' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt3", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt3", ;
		TabIndex = 19, ;
		Top = 60
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt4' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt4", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt4", ;
		TabIndex = 14, ;
		Top = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt5' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt5", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt5", ;
		TabIndex = 16, ;
		Top = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt6' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt6", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt6", ;
		TabIndex = 19, ;
		Top = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAging.lamt7' AS tlabel WITH ;
		Alignment = 1, ;
		Caption = "lamt7", ;
		ForeColor = 0,0,255, ;
		Left = 120, ;
		Name = "lamt7", ;
		TabIndex = 19, ;
		Top = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAllocate' AS tform WITH ;
		Caption = "FormAllocate", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 82, ;
		Icon = ..\bitmap\icons\pencil03.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormAllocate", ;
		Visible = .F., ;
		Width = 359
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormAllocate.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 272, ;
		Name = "cmdCancel", ;
		TabIndex = 3, ;
		Top = 49
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormAllocate.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Default = .F., ;
		Left = 272, ;
		Name = "cmdOK", ;
		TabIndex = 2, ;
		Top = 20
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormAllocate.lbillnr' AS tlabel WITH ;
		Caption = "lbillnr", ;
		Height = 17, ;
		Left = 5, ;
		Name = "lbillnr", ;
		TabIndex = 4, ;
		Top = 31, ;
		Width = 139
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAllocate.ltext' AS tlabel WITH ;
		Caption = "ltext", ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 5, ;
		Name = "ltext", ;
		TabIndex = 5, ;
		Top = 4, ;
		Width = 355
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormAllocate.tbbillnr' AS ttext WITH ;
		Height = 23, ;
		InputMask = "!999999999", ;
		Left = 144, ;
		Name = "tbbillnr", ;
		TabIndex = 1, ;
		Top = 28, ;
		Width = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts' AS tform WITH ;
		AlwaysOnTop = .F., ;
		Caption = "FormARAccounts", ;
		ControlBox = .T., ;
		ctbrclass = ctbrARAcount, ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 407, ;
		Icon = ..\bitmap\icons\crdfle06.ico, ;
		KeyPreview = .T., ;
		Name = "FormARAccounts", ;
		saveformsize = .T., ;
		savegridwidths = .T., ;
		ShowTips = .T., ;
		Visible = .F., ;
		Width = 800
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormARAccounts.gdaraccounts' AS tgrid WITH ;
		ColumnCount = 15, ;
		DeleteMark = .F., ;
		GridLineColor = 192,192,192, ;
		GridLines = 2, ;
		Height = 275, ;
		HighlightRow = .F., ;
		Left = 1, ;
		lresizecolumns = .F., ;
		Name = "gdaraccounts", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		resizefontsize = .F., ;
		ScrollBars = 2, ;
		setcolumns = .T., ;
		TabIndex = 6, ;
		Top = 132, ;
		Width = 798, ;
		ZOrderSet = 2, ;
		Column1.Alignment = 1, ;
		Column1.ControlSource = "", ;
		Column1.Movable = .F., ;
		Column1.Name = "ckonto", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 50, ;
		Column10.Name = "disputed", ;
		Column10.ReadOnly = .T., ;
		Column10.Width = 55, ;
		Column11.Name = "cfreepayments", ;
		Column11.ReadOnly = .T., ;
		Column11.Width = 55, ;
		Column12.Name = "cinactiv", ;
		Column12.ReadOnly = .T., ;
		Column12.Width = 25, ;
		Column13.Name = "cselrem", ;
		Column13.ReadOnly = .T., ;
		Column13.Width = 40, ;
		Column14.Name = "cselpaycond", ;
		Column14.ReadOnly = .T., ;
		Column14.Width = 40, ;
		Column15.Name = "crem4", ;
		Column15.ReadOnly = .T., ;
		Column15.Width = 55, ;
		Column2.ControlSource = "", ;
		Column2.Movable = .F., ;
		Column2.Name = "ccompkey", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 60, ;
		Column3.ControlSource = "", ;
		Column3.Movable = .F., ;
		Column3.Name = "cname", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 75, ;
		Column4.ControlSource = "", ;
		Column4.Movable = .F., ;
		Column4.Name = "cfirma", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 84, ;
		Column5.ControlSource = "", ;
		Column5.Movable = .F., ;
		Column5.Name = "cbalance", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 60, ;
		Column6.Name = "crem0", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 55, ;
		Column7.Name = "crem1", ;
		Column7.ReadOnly = .T., ;
		Column7.Width = 55, ;
		Column8.Name = "crem2", ;
		Column8.ReadOnly = .T., ;
		Column8.Width = 55, ;
		Column9.Name = "crem3", ;
		Column9.ReadOnly = .T., ;
		Column9.Width = 55
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cbalance.Header1' AS header WITH ;
		Caption = "hbalance", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cbalance.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.ccompkey.Header1' AS header WITH ;
		Caption = "hcompkey", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.ccompkey.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 15, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cfirma.Header1' AS header WITH ;
		Caption = "hfirma", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cfirma.Tbgrid1' AS tbgrid WITH ;
		Left = 27, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cfreepayments.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cfreepayments.Tbgrid1' AS tbgrid WITH ;
		Left = 14, ;
		Name = "Tbgrid1", ;
		Top = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cinactiv.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cinactiv.Tbgrid1' AS tbgrid WITH ;
		Left = 6, ;
		Name = "Tbgrid1", ;
		Top = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.ckonto.Header1' AS header WITH ;
		Caption = "hkonto", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.ckonto.Tbgrid1' AS tbgrid WITH ;
		Left = 23, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cname.Header1' AS header WITH ;
		Caption = "hname", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cname.Tbgrid1' AS tbgrid WITH ;
		Left = 10, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem0.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem0.Tbgrid1' AS tbgrid WITH ;
		Left = 76, ;
		Name = "Tbgrid1", ;
		Top = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem1.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem1.Tbgrid1' AS tbgrid WITH ;
		Left = 20, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem2.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem2.Tbgrid1' AS tbgrid WITH ;
		Left = 24, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem3.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem3.Tbgrid1' AS tbgrid WITH ;
		Left = 28, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem4.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.crem4.Tbgrid1' AS tbgrid WITH ;
		Left = 36, ;
		Name = "Tbgrid1", ;
		Top = 59
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cselpaycond.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cselpaycond.Tbgrid1' AS tbgrid WITH ;
		Left = 41, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cselrem.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.cselrem.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.disputed.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormARAccounts.gdaraccounts.disputed.Tbgrid1' AS tbgrid WITH ;
		Left = 37, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormARAccounts.lFindNext' AS tlabel WITH ;
		Caption = "lFindNext", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 213, ;
		Name = "lFindNext", ;
		TabIndex = 6, ;
		Top = 100, ;
		Width = 579, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormARAccounts.lFindPrevious' AS tlabel WITH ;
		Caption = "lFindPrevious", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 213, ;
		Name = "lFindPrevious", ;
		TabIndex = 7, ;
		Top = 114, ;
		Width = 579, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormARAccounts.lkonto' AS tlabel WITH ;
		Caption = "lkonto", ;
		Left = 3, ;
		Name = "lkonto", ;
		TabIndex = 7, ;
		Top = 104, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormARAccounts.lkontofilter' AS tlabel WITH ;
		Caption = "lkontofilter", ;
		Left = 15, ;
		Name = "lkontofilter", ;
		TabIndex = 1, ;
		Top = 8, ;
		Width = 141, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormARAccounts.lpostfilter' AS tlabel WITH ;
		Caption = "lpostfilter", ;
		Left = 15, ;
		Name = "lpostfilter", ;
		TabIndex = 3, ;
		Top = 49, ;
		Width = 140, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormARAccounts.ogkontofilter' AS toptiongroup WITH ;
		ButtonCount = 2, ;
		Height = 30, ;
		Left = 3, ;
		Name = "ogkontofilter", ;
		TabIndex = 2, ;
		Top = 19, ;
		Width = 645, ;
		ZOrderSet = 3, ;
		Option1.Caption = "Option1", ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 220, ;
		Option2.Caption = "Option2", ;
		Option2.Height = 17, ;
		Option2.Left = 182, ;
		Option2.Name = "Option2", ;
		Option2.Top = 5, ;
		Option2.Width = 263
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'FormARAccounts.ogpostfilter' AS toptiongroup WITH ;
		ButtonCount = 3, ;
		Height = 30, ;
		Left = 3, ;
		Name = "ogpostfilter", ;
		TabIndex = 4, ;
		Top = 60, ;
		Width = 645, ;
		ZOrderSet = 4, ;
		Option1.Caption = "Option1", ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 230, ;
		Option2.Caption = "Option2", ;
		Option2.Height = 17, ;
		Option2.Left = 181, ;
		Option2.Name = "Option2", ;
		Option2.Top = 5, ;
		Option2.Width = 260, ;
		Option3.Caption = "Option3", ;
		Option3.Height = 17, ;
		Option3.Left = 377, ;
		Option3.Name = "Option3", ;
		Option3.Top = 5, ;
		Option3.Width = 260
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'FormARAccounts.oSearchHandlerAracct' AS searchhnd WITH ;
		Height = 17, ;
		Left = 168, ;
		Name = "oSearchHandlerAracct", ;
		Top = 0, ;
		Width = 20
		*< END OBJECT: ClassLib="..\libs\searchhnd.vcx" BaseClass="custom" />

	ADD OBJECT 'FormARAccounts.tbkonto' AS ttext WITH ;
		Format = "KR", ;
		Height = 23, ;
		InputMask = (REPLICATE("9",10)), ;
		Left = 110, ;
		Name = "tbkonto", ;
		TabIndex = 5, ;
		Top = 101, ;
		Width = 96, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPay' AS tform WITH ;
		Caption = "FormPay", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 238, ;
		Icon = ..\bitmap\icons\note01.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormPay", ;
		ShowTips = .T., ;
		Visible = .F., ;
		Width = 338
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormPay.cbpaymethod' AS tcombobox WITH ;
		BoundTo = .T., ;
		ColumnCount = 3, ;
		ColumnLines = .F., ;
		ColumnWidths = "30,150,80", ;
		Height = 24, ;
		InputMask = "999", ;
		Left = 120, ;
		Name = "cbpaymethod", ;
		RowSourceType = 6, ;
		TabIndex = 3, ;
		Top = 60, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FormPay.chPayAllMarked' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chPayAllMarked", ;
		Height = 17, ;
		Left = 12, ;
		Name = "chPayAllMarked", ;
		TabIndex = 8, ;
		Top = 180, ;
		Width = 288
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormPay.chUnallocated' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chUnallocated", ;
		Height = 17, ;
		Left = 12, ;
		Name = "chUnallocated", ;
		TabIndex = 7, ;
		Top = 156, ;
		Width = 288
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormPay.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 156, ;
		Name = "cmdCancel", ;
		TabIndex = 10, ;
		Top = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPay.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Default = .F., ;
		Left = 60, ;
		Name = "cmdOK", ;
		TabIndex = 9, ;
		Top = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPay.dbbelgdate' AS tdatectrl WITH ;
		Left = 120, ;
		Name = "dbbelgdate", ;
		TabIndex = 2, ;
		Top = 36
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPay.dbdate' AS tdatectrl WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 120, ;
		Name = "dbdate", ;
		TabIndex = 1, ;
		Top = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPay.lamount' AS tlabel WITH ;
		Caption = "lamount", ;
		Height = 17, ;
		Left = 12, ;
		Name = "lamount", ;
		TabIndex = 16, ;
		Top = 111, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.lbelgdate' AS tlabel WITH ;
		Caption = "lbelgdate", ;
		Height = 17, ;
		Left = 12, ;
		Name = "lbelgdate", ;
		TabIndex = 11, ;
		Top = 39, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.ldate' AS tlabel WITH ;
		Caption = "ldate", ;
		Height = 17, ;
		Left = 12, ;
		Name = "ldate", ;
		TabIndex = 13, ;
		Top = 15, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.lpaymethod' AS tlabel WITH ;
		Caption = "lpaymethod", ;
		Height = 17, ;
		Left = 12, ;
		Name = "lpaymethod", ;
		TabIndex = 15, ;
		Top = 64, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.lrate' AS tlabel WITH ;
		Caption = "lRate", ;
		Height = 17, ;
		Left = 12, ;
		Name = "lrate", ;
		TabIndex = 14, ;
		Top = 87, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.lReference' AS tlabel WITH ;
		Caption = "lReference", ;
		Height = 17, ;
		Left = 12, ;
		Name = "lReference", ;
		TabIndex = 12, ;
		Top = 135, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.lsaypaymethod' AS tlabel WITH ;
		Caption = "lsaypaymethod", ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 207, ;
		Name = "lsaypaymethod", ;
		TabIndex = 17, ;
		Top = 64, ;
		Width = 120
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPay.tbamount' AS ttext WITH ;
		Height = 23, ;
		InputMask = (RIGHT(gcCurrcy, 12)), ;
		Left = 120, ;
		Name = "tbamount", ;
		TabIndex = 5, ;
		Top = 108, ;
		Width = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPay.tbrate' AS ttext WITH ;
		DisabledForeColor = 0,0,255, ;
		Enabled = .F., ;
		ForeColor = 0,0,255, ;
		Height = 23, ;
		InputMask = "99999.999999", ;
		Left = 120, ;
		Name = "tbrate", ;
		TabIndex = 4, ;
		Top = 84, ;
		Width = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPay.tbreference' AS ttext WITH ;
		Height = 23, ;
		InputMask = (REPLICATE('X', 25)), ;
		Left = 120, ;
		Name = "tbreference", ;
		TabIndex = 6, ;
		Top = 132, ;
		Width = 180
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting' AS tform WITH ;
		AlwaysOnTop = .F., ;
		Caption = "FormPostings", ;
		ControlBox = .T., ;
		ctbrclass = ctbrARPost, ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 486, ;
		Icon = ..\bitmap\icons\folder06.ico, ;
		KeyPreview = .T., ;
		Name = "FormPosting", ;
		saveformsize = .T., ;
		savegridwidths = .T., ;
		ShowTips = .T., ;
		Visible = .F., ;
		Width = 738
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormPosting.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Height = 27, ;
		Left = 672, ;
		Name = "cmdOK", ;
		TabIndex = 12, ;
		Top = 416, ;
		Width = 60, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPosting.gdpostings' AS tgrid WITH ;
		AllowAddNew = .F., ;
		ColumnCount = 16, ;
		DeleteMark = .F., ;
		GridLineColor = 192,192,192, ;
		GridLines = 2, ;
		Height = 258, ;
		Left = 0, ;
		lnotusesortcursor = .T., ;
		lresizecolumns = .F., ;
		Name = "gdpostings", ;
		Panel = 1, ;
		RecordMark = .F., ;
		resizefontsize = .F., ;
		ScrollBars = 2, ;
		setcolumns = .T., ;
		TabIndex = 7, ;
		Top = 135, ;
		Width = 732, ;
		ZOrderSet = 19, ;
		Column1.Alignment = 1, ;
		Column1.ControlSource = "", ;
		Column1.Name = "cbillno", ;
		Column1.ReadOnly = .F., ;
		Column1.Width = 79, ;
		Column10.ColumnOrder = 11, ;
		Column10.Name = "cDispute", ;
		Column10.ReadOnly = .F., ;
		Column10.Width = 34, ;
		Column11.ColumnOrder = 9, ;
		Column11.Name = "cremeinderlevel", ;
		Column11.Width = 25, ;
		Column12.ColumnOrder = 10, ;
		Column12.Name = "clastremainder", ;
		Column12.Width = 40, ;
		Column13.Name = "cduedat", ;
		Column13.Width = 52, ;
		Column14.Name = "ccollectagent", ;
		Column14.Sparse = .F., ;
		Column14.Width = 30, ;
		Column15.Name = "cdisuputeduntil", ;
		Column16.Name = "cbillstatus", ;
		Column2.ControlSource = "", ;
		Column2.Name = "cdate", ;
		Column2.ReadOnly = .F., ;
		Column2.Width = 70, ;
		Column3.ControlSource = "", ;
		Column3.Name = "cbelgdat", ;
		Column3.ReadOnly = .F., ;
		Column3.Width = 73, ;
		Column4.ControlSource = "", ;
		Column4.Name = "cpaynum", ;
		Column4.ReadOnly = .F., ;
		Column4.Width = 45, ;
		Column5.ControlSource = "", ;
		Column5.Name = "cdebit", ;
		Column5.ReadOnly = .F., ;
		Column5.Width = 65, ;
		Column6.Name = "ccredit", ;
		Column6.ReadOnly = .F., ;
		Column6.Width = 64, ;
		Column7.Alignment = 1, ;
		Column7.Name = "cbalance", ;
		Column7.ReadOnly = .F., ;
		Column7.Width = 66, ;
		Column8.Name = "creference", ;
		Column8.ReadOnly = .F., ;
		Column8.Width = 115, ;
		Column9.ColumnOrder = 12, ;
		Column9.Name = "cmark", ;
		Column9.ReadOnly = .F., ;
		Column9.Sparse = .F., ;
		Column9.Width = 22
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'FormPosting.gdpostings.cbalance.header1' AS header WITH ;
		Caption = "hbalance", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cbalance.Tbgrid1' AS tbgrid WITH ;
		Alignment = 1, ;
		Left = 14, ;
		Name = "Tbgrid1", ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cbelgdat.header1' AS header WITH ;
		Caption = "hbelgdat", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cbelgdat.Tbgrid1' AS tbgrid WITH ;
		Left = 10, ;
		Name = "Tbgrid1", ;
		ReadOnly = .F., ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cbillno.header1' AS header WITH ;
		Caption = "hbillno", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cbillno.Tbgrid1' AS tbgrid WITH ;
		Left = 23, ;
		Name = "Tbgrid1", ;
		ReadOnly = .F., ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cbillstatus.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cbillstatus.Tbgrid1' AS tbgrid WITH ;
		Left = 53, ;
		Name = "Tbgrid1", ;
		Top = 68
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.ccollectagent.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.ccollectagent.Tchkgrid1' AS tchkgrid WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "", ;
		DisabledForeColor = 0,0,0, ;
		Left = 16, ;
		Name = "Tchkgrid1", ;
		SpecialEffect = 1, ;
		Top = 32
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormPosting.gdpostings.ccredit.header1' AS header WITH ;
		Caption = "hcredit", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.ccredit.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 7, ;
		Name = "Tbgrid1", ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cdate.header1' AS header WITH ;
		Caption = "hdate", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cdate.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 15, ;
		Name = "Tbgrid1", ;
		ReadOnly = .F., ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cdebit.header1' AS header WITH ;
		Caption = "hdebit", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cdebit.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		ReadOnly = .F., ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cDispute.header1' AS header WITH ;
		Caption = "hdispute", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cDispute.Tbgrid1' AS tbgrid WITH ;
		Left = 6, ;
		Name = "Tbgrid1", ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cdisuputeduntil.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cdisuputeduntil.Tbgrid1' AS tbgrid WITH ;
		Left = 33, ;
		Name = "Tbgrid1", ;
		Top = 44
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cduedat.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cduedat.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 32
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.clastremainder.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.clastremainder.Tbgrid1' AS tbgrid WITH ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 50
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cmark.header1' AS header WITH ;
		Caption = "cmark", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cmark.Tcheckbox1' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Left = 6, ;
		Name = "Tcheckbox1", ;
		ReadOnly = .F., ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormPosting.gdpostings.cpaynum.header1' AS header WITH ;
		Caption = "hpaynum", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cpaynum.Tbgrid1' AS tbgrid WITH ;
		Left = 27, ;
		Name = "Tbgrid1", ;
		ReadOnly = .F., ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.creference.header1' AS header WITH ;
		Caption = "hreference", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.creference.Tbgrid1' AS tbgrid WITH ;
		Left = 7, ;
		Name = "Tbgrid1", ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.gdpostings.cremeinderlevel.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'FormPosting.gdpostings.cremeinderlevel.Tbgrid1' AS tbgrid WITH ;
		Left = 8, ;
		Name = "Tbgrid1", ;
		Top = 26
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.lBalance' AS tlabel WITH ;
		Caption = "lBalance", ;
		Left = 524, ;
		Name = "lBalance", ;
		TabIndex = 18, ;
		Top = 54, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lbalancemarked' AS tlabel WITH ;
		Caption = "Summe (markierte Rechnungen)", ;
		Left = 245, ;
		Name = "lbalancemarked", ;
		Top = 6, ;
		Width = 180
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lCredit' AS tlabel WITH ;
		Caption = "lCredit", ;
		Left = 524, ;
		Name = "lCredit", ;
		TabIndex = 17, ;
		Top = 30, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lDebit' AS tlabel WITH ;
		Caption = "lDebit", ;
		Left = 524, ;
		Name = "lDebit", ;
		TabIndex = 15, ;
		Top = 6, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lDebitor' AS tlabel WITH ;
		Caption = "lDebitor", ;
		Height = 17, ;
		Left = 3, ;
		Name = "lDebitor", ;
		TabIndex = 14, ;
		Top = 6, ;
		Width = 120, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lFindNext' AS tlabel WITH ;
		Caption = "lFindNext", ;
		Height = 15, ;
		Left = 480, ;
		Name = "lFindNext", ;
		TabIndex = 6, ;
		Top = 447, ;
		Width = 252
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lFindPrevious' AS tlabel WITH ;
		Caption = "lFindPrevious", ;
		Height = 15, ;
		Left = 480, ;
		Name = "lFindPrevious", ;
		TabIndex = 7, ;
		Top = 463, ;
		Width = 252
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lFirma' AS tlabel WITH ;
		Caption = "lfirma", ;
		Height = 17, ;
		Left = 3, ;
		Name = "lFirma", ;
		TabIndex = 16, ;
		Top = 30, ;
		Width = 120, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.linSeparator' AS ln WITH ;
		BorderColor = 128,128,128, ;
		Height = 0, ;
		Left = 3, ;
		Name = "linSeparator", ;
		Top = 102, ;
		Width = 732
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="line" />

	ADD OBJECT 'FormPosting.lname' AS tlabel WITH ;
		Caption = "lname", ;
		Height = 17, ;
		Left = 3, ;
		Name = "lname", ;
		TabIndex = 19, ;
		Top = 54, ;
		Width = 120, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lpostfilter' AS tlabel WITH ;
		Caption = "lpostfilter", ;
		Left = 15, ;
		Name = "lpostfilter", ;
		TabIndex = 8, ;
		Top = 396, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemCondition' AS tlabel WITH ;
		Caption = "lRemCondition", ;
		Left = 374, ;
		Name = "lRemCondition", ;
		Top = 78, ;
		Width = 120
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemKey' AS tlabel WITH ;
		Caption = "lRemKey", ;
		Left = 3, ;
		Name = "lRemKey", ;
		Top = 78, ;
		Width = 120
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemLev1' AS tlabel WITH ;
		Caption = "lRemLev1", ;
		Height = 17, ;
		Left = 16, ;
		Name = "lRemLev1", ;
		TabIndex = 15, ;
		Top = 110, ;
		Width = 81, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemLev2' AS tlabel WITH ;
		Caption = "lRemLev2", ;
		Height = 17, ;
		Left = 193, ;
		Name = "lRemLev2", ;
		TabIndex = 15, ;
		Top = 110, ;
		Width = 81, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemLev3' AS tlabel WITH ;
		Caption = "lRemLev3", ;
		Height = 17, ;
		Left = 370, ;
		Name = "lRemLev3", ;
		TabIndex = 15, ;
		Top = 110, ;
		Width = 81, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lRemLev4' AS tlabel WITH ;
		Caption = "lRemLev4", ;
		Height = 17, ;
		Left = 547, ;
		Name = "lRemLev4", ;
		TabIndex = 15, ;
		Top = 110, ;
		Width = 81, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lsearchfield' AS tlabel WITH ;
		Caption = "lsearchfield", ;
		Left = 195, ;
		Name = "lsearchfield", ;
		TabIndex = 13, ;
		Top = 396, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.lSearchString' AS tlabel WITH ;
		Caption = "lSearchString", ;
		Height = 17, ;
		Left = 480, ;
		Name = "lSearchString", ;
		TabIndex = 20, ;
		Top = 398, ;
		Width = 180, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormPosting.ogpostfilter' AS toptiongroup WITH ;
		ButtonCount = 3, ;
		Height = 78, ;
		Left = 3, ;
		Name = "ogpostfilter", ;
		TabIndex = 9, ;
		Top = 405, ;
		Width = 168, ;
		ZOrderSet = 1, ;
		Option1.Caption = "Option1", ;
		Option1.Height = 17, ;
		Option1.Left = 12, ;
		Option1.Name = "Option1", ;
		Option1.Top = 6, ;
		Option1.Width = 153, ;
		Option2.Caption = "Option2", ;
		Option2.Height = 17, ;
		Option2.Left = 12, ;
		Option2.Name = "Option2", ;
		Option2.Top = 30, ;
		Option2.Width = 131, ;
		Option3.Caption = "Option3", ;
		Option3.Height = 17, ;
		Option3.Left = 12, ;
		Option3.Name = "Option3", ;
		Option3.Top = 54, ;
		Option3.Width = 139
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'FormPosting.ogsearchfield' AS toptiongroup WITH ;
		ButtonCount = 6, ;
		Height = 77, ;
		Left = 183, ;
		Name = "ogsearchfield", ;
		TabIndex = 10, ;
		Top = 405, ;
		Width = 285, ;
		ZOrderSet = 0, ;
		Option1.Caption = "Option1", ;
		Option1.Height = 17, ;
		Option1.Left = 9, ;
		Option1.Name = "Option1", ;
		Option1.Top = 6, ;
		Option1.Width = 132, ;
		Option2.Caption = "Option2", ;
		Option2.Height = 17, ;
		Option2.Left = 9, ;
		Option2.Name = "Option2", ;
		Option2.Top = 30, ;
		Option2.Width = 132, ;
		Option3.Caption = "Option3", ;
		Option3.Height = 17, ;
		Option3.Left = 9, ;
		Option3.Name = "Option3", ;
		Option3.Top = 54, ;
		Option3.Width = 132, ;
		Option4.Caption = "Option4", ;
		Option4.Height = 17, ;
		Option4.Left = 141, ;
		Option4.Name = "Option4", ;
		Option4.Top = 6, ;
		Option4.Width = 132, ;
		Option5.Caption = "Option5", ;
		Option5.Height = 17, ;
		Option5.Left = 141, ;
		Option5.Name = "Option5", ;
		Option5.Top = 30, ;
		Option5.Width = 132, ;
		Option6.Caption = "Option6", ;
		Option6.Height = 17, ;
		Option6.Left = 141, ;
		Option6.Name = "Option6", ;
		Option6.Top = 54, ;
		Option6.Width = 132
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'FormPosting.oSearchHandlerPost' AS searchhnd WITH ;
		Left = 312, ;
		Name = "oSearchHandlerPost", ;
		Top = 399
		*< END OBJECT: ClassLib="..\libs\searchhnd.vcx" BaseClass="custom" />

	ADD OBJECT 'FormPosting.tbbalance' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 627, ;
		Name = "tbbalance", ;
		TabIndex = 6, ;
		Top = 51, ;
		Width = 108, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbbalancemarked' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 425, ;
		Name = "tbbalancemarked", ;
		Top = 3, ;
		Width = 90
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbcredit' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 627, ;
		Name = "tbcredit", ;
		TabIndex = 5, ;
		Top = 27, ;
		Width = 108, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbdebit' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 627, ;
		Name = "tbdebit", ;
		TabIndex = 4, ;
		Top = 3, ;
		Width = 108, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbdebitor' AS ttext WITH ;
		ControlSource = "aracct.ac_aracct", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		InputMask = (REPLICATE("9",10)), ;
		Left = 125, ;
		Name = "tbdebitor", ;
		TabIndex = 1, ;
		Top = 3, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbfirma' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		InputMask = (REPLICATE("!", 30)), ;
		Left = 125, ;
		Name = "tbfirma", ;
		TabIndex = 2, ;
		Top = 27, ;
		Width = 309, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbname' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		InputMask = (REPLICATE("!", 30)), ;
		Left = 125, ;
		Name = "tbname", ;
		TabIndex = 3, ;
		Top = 51, ;
		Width = 309, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.TBPaymentsMarked' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 24, ;
		Left = 444, ;
		Name = "TBPaymentsMarked", ;
		Top = 36, ;
		Visible = .T., ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemCondDescript' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 543, ;
		Name = "tbRemCondDescript", ;
		Top = 75, ;
		Width = 192
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemCondNo' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 496, ;
		Name = "tbRemCondNo", ;
		Top = 75, ;
		Width = 43
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemKeyDescript' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 172, ;
		Name = "tbRemKeyDescript", ;
		Top = 75, ;
		Width = 188
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemKeyNo' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Left = 125, ;
		Name = "tbRemKeyNo", ;
		Top = 75, ;
		Width = 43
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemLev1' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 98, ;
		Name = "tbRemLev1", ;
		TabIndex = 4, ;
		Top = 107, ;
		Width = 94, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemLev2' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 275, ;
		Name = "tbRemLev2", ;
		TabIndex = 4, ;
		Top = 107, ;
		Width = 94, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemLev3' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 452, ;
		Name = "tbRemLev3", ;
		TabIndex = 4, ;
		Top = 107, ;
		Width = 94, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbRemLev4' AS ttext WITH ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 629, ;
		Name = "tbRemLev4", ;
		TabIndex = 4, ;
		Top = 107, ;
		Width = 94, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPosting.tbsearch' AS ttext WITH ;
		Height = 23, ;
		Left = 480, ;
		Name = "tbsearch", ;
		TabIndex = 11, ;
		Top = 417, ;
		Width = 180, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPrint' AS tform WITH ;
		Caption = "FormPrint", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		Height = 77, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormPrint", ;
		Visible = .F., ;
		Width = 336
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormPrint.cmdCancel' AS tcommandbutton WITH ;
		Cancel = .T., ;
		Caption = "cmdCancel", ;
		Height = 24, ;
		Left = 240, ;
		Name = "cmdCancel", ;
		TabIndex = 3, ;
		Top = 40
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPrint.cmdPrint' AS tcommandbutton WITH ;
		Caption = "cmdPrint", ;
		Default = .F., ;
		Height = 24, ;
		Left = 240, ;
		Name = "cmdPrint", ;
		TabIndex = 2, ;
		Top = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPrint.OGPrintType' AS toptiongroup WITH ;
		ButtonCount = 3, ;
		Height = 63, ;
		Left = 3, ;
		Name = "OGPrintType", ;
		TabIndex = 1, ;
		Top = 7, ;
		Width = 228, ;
		Option1.Caption = "Option1", ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 211, ;
		Option2.Caption = "Option2", ;
		Option2.Height = 17, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 211, ;
		Option3.Caption = "Option3", ;
		Option3.Height = 17, ;
		Option3.Left = 5, ;
		Option3.Name = "Option3", ;
		Option3.Top = 43, ;
		Option3.Width = 211
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'FormPrintStatements' AS tform WITH ;
		Caption = "FormPrintStatements", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 68, ;
		Icon = ..\bitmap\icons\pencil03.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormPrintStatements", ;
		ShowTips = .T., ;
		Visible = .F., ;
		Width = 437
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormPrintStatements.chIncludeUnallocated' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chIncludeUnallocated", ;
		Height = 17, ;
		Left = 5, ;
		Name = "chIncludeUnallocated", ;
		TabIndex = 3, ;
		Top = 34, ;
		Width = 312
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormPrintStatements.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 348, ;
		Name = "cmdCancel", ;
		TabIndex = 5, ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPrintStatements.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Left = 348, ;
		Name = "cmdOK", ;
		TabIndex = 4, ;
		Top = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormPrintStatements.dbfrom' AS tdatectrl WITH ;
		Left = 113, ;
		Name = "dbfrom", ;
		TabIndex = 1, ;
		Top = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPrintStatements.dbto' AS tdatectrl WITH ;
		Left = 221, ;
		Name = "dbto", ;
		TabIndex = 2, ;
		Top = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormPrintStatements.lBillDate' AS tlabel WITH ;
		Caption = "lBillDate", ;
		Height = 17, ;
		Left = 5, ;
		Name = "lBillDate", ;
		TabIndex = 6, ;
		Top = 8, ;
		Width = 108
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormSearch' AS tform WITH ;
		Caption = "FormSearch", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 87, ;
		Icon = ..\bitmap\icons\binoculr.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormSearch", ;
		Visible = .F., ;
		Width = 380
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormSearch.cbField' AS tcombobox WITH ;
		Height = 24, ;
		Left = 113, ;
		Name = "cbField", ;
		Style = 2, ;
		TabIndex = 1, ;
		Top = 5, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'FormSearch.chExactSearch' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chExactSearch", ;
		Height = 17, ;
		Left = 5, ;
		Name = "chExactSearch", ;
		TabIndex = 3, ;
		Top = 65, ;
		Width = 144
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'FormSearch.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 293, ;
		Name = "cmdCancel", ;
		TabIndex = 5, ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormSearch.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Left = 293, ;
		Name = "cmdOK", ;
		TabIndex = 4, ;
		Top = 5
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormSearch.lField' AS tlabel WITH ;
		Caption = "lField", ;
		Left = 5, ;
		Name = "lField", ;
		TabIndex = 8, ;
		Top = 9
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormSearch.lFindNext' AS tlabel WITH ;
		Caption = "lFindNext", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 168, ;
		Name = "lFindNext", ;
		TabIndex = 6, ;
		Top = 61, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormSearch.lFindPrevious' AS tlabel WITH ;
		Caption = "lFindPrevious", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 168, ;
		Name = "lFindPrevious", ;
		TabIndex = 7, ;
		Top = 73, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormSearch.lValue' AS tlabel WITH ;
		Caption = "lValue", ;
		Left = 5, ;
		Name = "lValue", ;
		TabIndex = 7, ;
		Top = 32
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormSearch.tbValue' AS ttext WITH ;
		Height = 23, ;
		Left = 113, ;
		Name = "tbValue", ;
		TabIndex = 2, ;
		Top = 29, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'formsearchpost' AS tform WITH ;
		Caption = "formsearchpost", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 91, ;
		Icon = ..\bitmap\icons\binoculr.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "formsearchpost", ;
		Visible = .F., ;
		Width = 386
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'formsearchpost.cbField' AS tcombobox WITH ;
		Height = 24, ;
		Left = 115, ;
		Name = "cbField", ;
		Style = 2, ;
		TabIndex = 1, ;
		Top = 4, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="combobox" />

	ADD OBJECT 'formsearchpost.chExactSearch' AS tcheckbox WITH ;
		Alignment = 0, ;
		Caption = "chExactSearch", ;
		Height = 17, ;
		Left = 7, ;
		Name = "chExactSearch", ;
		TabIndex = 3, ;
		Top = 64, ;
		Width = 144
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="checkbox" />

	ADD OBJECT 'formsearchpost.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 295, ;
		Name = "cmdCancel", ;
		TabIndex = 5, ;
		Top = 33
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'formsearchpost.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Left = 295, ;
		Name = "cmdOK", ;
		TabIndex = 4, ;
		Top = 4
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'formsearchpost.lField' AS tlabel WITH ;
		Caption = "lField", ;
		Left = 7, ;
		Name = "lField", ;
		TabIndex = 9, ;
		Top = 8
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'formsearchpost.lFindNext' AS tlabel WITH ;
		Caption = "lFindNext", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 168, ;
		Name = "lFindNext", ;
		TabIndex = 6, ;
		Top = 61, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'formsearchpost.lFindPrevious' AS tlabel WITH ;
		Caption = "lFindPrevious", ;
		FontSize = 7, ;
		Height = 12, ;
		Left = 168, ;
		Name = "lFindPrevious", ;
		TabIndex = 7, ;
		Top = 75, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'formsearchpost.lValue' AS tlabel WITH ;
		Caption = "lValue", ;
		Left = 7, ;
		Name = "lValue", ;
		TabIndex = 8, ;
		Top = 31
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'formsearchpost.tbValue' AS ttext WITH ;
		Height = 23, ;
		Left = 115, ;
		Name = "tbValue", ;
		TabIndex = 2, ;
		Top = 28, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'FormTransfer' AS tform WITH ;
		Caption = "FormTransfer", ;
		ControlBox = .T., ;
		DoCreate = .T., ;
		formname = araccountsform, ;
		Height = 70, ;
		Icon = ..\bitmap\icons\pencil03.ico, ;
		MaxButton = .F., ;
		MinButton = .F., ;
		Name = "FormTransfer", ;
		Visible = .F., ;
		Width = 354
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="form" />

	ADD OBJECT 'FormTransfer.cmdCancel' AS tcommandbutton WITH ;
		Caption = "cmdCancel", ;
		Left = 264, ;
		Name = "cmdCancel", ;
		TabIndex = 3, ;
		Top = 39
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormTransfer.cmdOK' AS tcommandbutton WITH ;
		Caption = "cmdOK", ;
		Default = .F., ;
		Left = 264, ;
		Name = "cmdOK", ;
		TabIndex = 2, ;
		Top = 6
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'FormTransfer.laccount' AS tlabel WITH ;
		Caption = "lAccount", ;
		Height = 17, ;
		Left = 7, ;
		Name = "laccount", ;
		TabIndex = 4, ;
		Top = 9, ;
		Width = 137
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="label" />

	ADD OBJECT 'FormTransfer.tbaccount' AS ttext WITH ;
		InputMask = (REPLICATE("9",10)), ;
		Left = 144, ;
		Name = "tbaccount", ;
		TabIndex = 1, ;
		Top = 6
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />
	
	PROCEDURE Init
		LPARAMETERS lp_lCreditors
		this.lCreditors = lp_lCreditors
		IF this.lCreditors
			this.formARAccounts.formname = "craccountsform"
			this.formARAccounts.cformlabel = "craccounts"
			this.formARAccounts.gdaraccounts.cgridlabelname = "gdaraccountscr"
		
			this.formposting.formname = "craccountsform"
			this.formposting.cformlabel = "crpostings"
			this.formPosting.gdpostings.cgridlabelname = "gdpostingscr"
		
			this.cPayCondLabel = PADR(CREDITOR_PAY_COND_LABEL,10)
			this.cRemainderLabel = PADR(CREDITOR_REMAINDER_LABEL,10)
			*STORE .F. TO ;
				this.formPosting.lremKey.Visible, ;
				this.formPosting.tbRemKeyNo.Visible, ;
				this.formPosting.tbremKeyDescript.Visible
		ELSE
			this.cPayCondLabel = PADR(DEBITOR_PAY_COND_LABEL,10)
			this.cRemainderLabel = PADR(DEBITOR_REMAINDER_LABEL,10)
		ENDIF
		
		this.PNField=1
		this.PCValue=''
		this.plexactsearch=.T.
		this.formARAccounts.tbkonto.Value = 0
		STORE 0 TO this.aRemLevBalance
		
		this.msetcontrolsource()
		this.msetcaption()
		this.formARAccounts.Init(.T.)
		this.formPosting.Init(.T.)
		SET ORDER TO TAG1 IN aracct
		GO TOP IN aracct
		this.lForbidenRem4 = param.pa_noreml4
		this.msetgriddynamiccolor()
		this.formARAccounts.Show()
		
		RETURN .T.
	ENDPROC

	PROCEDURE lforbidenrem4_assign
		LPARAMETERS vNewVal
		IF m.vNewVal
			this.FormPosting.tbRemLev4.Visible = .F.
			this.FormPosting.lRemLev4.Visible = .F.
			this.FormARAccounts.gdaraccounts.RemoveObject("crem4")
		ENDIF
		
		THIS.lforbidenrem4 = m.vNewVal
		
	ENDPROC

	PROCEDURE Load
		ini(.T.,,this.DataEnvironment)
		
		openfiledirect(.F.,"article")
		SET ORDER TO TAG1 IN article
		openfiledirect(.F.,"lists")
		SET ORDER TO TAG1 IN lists
		
		this.naracct = 0
		this.nselectedaccount = 0
		this.ncurbalance = 0
		this.ncurrem0 = 0
		this.ncurrem1 = 0
		this.ncurrem2 = 0
		this.ncurrem3 = 0
		this.ncurrem4 = 0
		this.ndisputed = 0
		this.nfreepayments = 0
		this.cyes = GetLangText("AR","T_YES")
		this.cno = GetLangText("AR","T_NO")
		
		RETURN .T.
	ENDPROC

	PROCEDURE madjust		&& Call adjust form
		LOCAL ARRAY LArray(2)
		
		IF NOT USED("reservat")
			openfile(.F.,"reservat")
		ENDIF
		DO CASE
		 CASE EMPTY(carpost.ap_reserid) AND NOT EMPTY(ap_billnr)
		
		 	* Bill not entered in bills form. Created manualy here.
			LOCAL l_oData, l_nSelect, l_lSuccess
			IF dlocate("arpost","ap_lineid = " + sqLcnv(carpost.ap_lineid))
				l_nSelect = SELECT()
				SELECT arpost
				SCATTER NAME l_oData MEMO
				DO FORM forms\arcreatebill WITH l_oData, "EDIT", this.lCreditors TO l_lSuccess
				IF l_lSuccess
					DO ArUpdateBill IN araccount WITH l_oData
					this.mGetPostings()
					dlocate("carpost","ap_lineid = " + sqlcnv(l_oData.ap_lineid))
				ENDIF
				SELECT (l_nSelect)
			ENDIF
		
		 CASE EMPTY(carpost.ap_reserid) OR (carpost.ap_reserid == 0.7)
			= Alert(GetLangText("AR","TA_NOSELBILL"))
		 CASE carpost.ap_reserid == 0.1
			= Alert(GetLangText("AR","TXT_PASSERBY_NOHIST"))
		 OTHERWISE
			IF NOT SEEK(carpost.ap_reserid,"reservat","tag1")
				IF SEEK(carpost.ap_reserid, "histres", "tag1")
					= Alert(GetLangText("AR","TXT_BILL_HISTORY"))
				ELSE
					= Alert(GetLangText("AR","TA_NODATAFOUND"))
					RETURN .T.
				ENDIF
			ENDIF
			LArray(1) = carpost.ap_reserid
			LArray(2) = this.FormPosting
			doform('frmbills','forms\bills','',.T.,@LArray)
		ENDCASE
		RETURN .T.
	ENDPROC

	PROCEDURE maging		&& Call aging form
		PRIVATE naRea, aaMt, nbAl, nbUcket,lcFilter
		DIMENSION aaMt[7]
		STORE 0 TO aaMt
		naRea = SELECT()
		SELECT carPost
		lcFilter=SET("Filter")
		SET FILTER TO 
		nrEc = RECNO()
		SCAN ALL FOR (ap_lineid=ap_headid .OR. ap_headid=0)
			nbAl = arPstbal(ap_headid,ap_lineid,.T.)
			nbUcket = arBucket(ap_date,ArAccount("ArIsDisputed", ap_dispute, ap_disdate))
			aaMt[nbUcket] = aaMt(nbUcket)+nbAl
		ENDSCAN
		SET FILTER TO &lcFilter
		GOTO nrEc
		SELECT (naRea)
		
		
		thisformset.formAging.lamt1.Caption=TRANSFORM(aaMt[1],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt2.Caption=TRANSFORM(aaMt[2],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt3.Caption=TRANSFORM(aaMt[3],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt4.Caption=TRANSFORM(aaMt[4],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt5.Caption=TRANSFORM(aaMt[5],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt6.Caption=TRANSFORM(aaMt[6],RIGHT(gcCurrcydisp, 12))
		thisformset.formAging.lamt7.Caption=TRANSFORM(aaMt[7],RIGHT(gcCurrcydisp, 12))
		
		thisformset.formPosting.Enabled=.f.
		thisformset.formAging.Show
		thisformset.formAging.cmdClose.SetFocus
	ENDPROC

	PROCEDURE mallocate		&& Call alocate form
		LOCAL l_cMarkedRowsCur, l_nSelect, l_lAllocateMarkedRows, l_nMarkedRecords, l_nRecNo, l_lSaveIntoTable
		LOCAL l_cCarpostOrder
		l_cCarpostOrder = ""
		l_nSelect = SELECT()
		l_cMarkedRowsCur = SYS(2015)
		l_nMarkedRecords = 0
		
		SELECT carpost
		l_cCarpostOrder = ORDER()
		l_nRecNo = RECNO()
		SET ORDER TO
		SCAN ALL FOR cap_marker WHILE l_nMarkedRecords < 2
			l_nMarkedRecords = l_nMarkedRecords + 1
		ENDSCAN
		SET ORDER TO TAG &l_cCarpostOrder IN carpost
		GO l_nRecNo IN carpost
		
		this.FormPosting.Enabled = .F.
		DO CASE
			CASE l_nMarkedRecords = 0
				alert(GetLangText("AR","TXT_NOTHING_MARKED"))
				l_lAllocateMarkedRows = .F.
				this.FormPosting.Enabled = .T.
				
			CASE l_nMarkedRecords = 1
				this.FormAllocate.Show()
				this.FormAllocate.tbbillnr.Value = ''
				this.FormAllocate.tbbillnr.SetFocus()
				l_lAllocateMarkedRows = .F.
				
			OTHERWISE
				l_lAllocateMarkedRows = .T.
		
		ENDCASE
		IF l_lAllocateMarkedRows
			LOCAL l_nCountRecords
			l_nCountRecords = 0
			SELECT *, 0.000000 AS ap_balance, " " AS ap_type, "  " AS ap_dettype, .F. AS ap_chkball, 00 AS ap_countrn ;
					FROM carpost ;
					WHERE cap_marker ;
					INTO CURSOR &l_cMarkedRowsCur ;
					READWRITE
		
			INDEX ON STR(ap_headid, 8)+IIF(ap_headid=ap_lineid,'A','B') + DTOS(ap_date) +STR(ap_lineid, 8) TAG TAG1
			INDEX ON STR(ap_headid, 8)+IIF(ap_headid=ap_lineid,'A','B') + ap_billnr + DTOS(ap_date) +STR(ap_lineid, 8) TAG TAG2 DESCENDING
			INDEX ON DTOS(ap_date) TAG TAG3 DESCENDING
			INDEX ON DTOS(ap_belgdat) TAG TAG4 DESCENDING
			INDEX ON ap_debit  TAG TAG5 DESCENDING
			INDEX ON ap_credit TAG TAG6 DESCENDING
			INDEX ON UPPER(ap_ref) TAG TAG7 DESCENDING
			SET ORDER TO TAG1
			SCAN
				l_nCountRecords = l_nCountRecords + 1
				REPLACE ap_countrn WITH l_nCountRecords
			ENDSCAN
			INDEX ON ap_countrn TAG TAG8 ASCENDING
			
			DO ArAllocateMarkedRows IN ArAccount WITH l_cMarkedRowsCur, l_lSaveIntoTable
			IF l_lSaveIntoTable
				LOCAL l_oChangedRecord, l_nChangedRecordRecNo
				SELECT (l_cMarkedRowsCur)
				
				SCAN
					SCATTER NAME l_oChangedRecord
					SELECT arpost
					l_nChangedRecordRecNo = EVALUATE(l_cMarkedRowsCur+".cap_rn")
					IF EMPTY(l_nChangedRecordRecNo)
						APPEND BLANK
					ELSE
						GO l_nChangedRecordRecNo IN arpost
					ENDIF
					GATHER NAME l_oChangedRecord
					IF &l_cMarkedRowsCur..ap_chkball
						REPLACE ap_headid WITH &l_cMarkedRowsCur..ap_headid ALL ;
								FOR ap_headid = &l_cMarkedRowsCur..ap_lineid AND ap_headid <> ap_lineid
					ENDIF
					SELECT (l_cMarkedRowsCur)
				ENDSCAN
				= TABLEUPDATE(.T., .T., "arpost")
			ENDIF
			
			this.mgetpostings()
			this.FormPosting.Refresh()
			USE IN &l_cMarkedRowsCur
			this.FormPosting.Enabled = .T.
		ENDIF
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE mallocatepayment		&& Move payment from one bill to another bill
		LOCAL l_nBillNumber, l_lMarkedDebitOrCredit, l_lBillNumDebitOrCredit, l_lDebitorAndCreditSelected, l_nRecNo
		l_nBillNumber = this.FormAllocate.tbbillnr.Value
		
		IF EMPTY(l_nBillNumber)
			= alert(strfmt(GetLangText("AR","TA_NOBILL"),""))
			thisformset.FormAllocate.Hide()
			this.FormPosting.Enabled = .T.
			REPLACE cap_marker WITH .F. ALL FOR cap_marker
			GO TOP IN carpost
			RETURN .F.
		ENDIF
		
		SELECT carpost
		LOCATE FOR carpost.cap_marker
		IF FOUND()
			* FOUND() should be allways .T.
			l_lMarkedDebitOrCredit = (ap_headid = ap_lineid AND ap_debit > 0) OR ;
					(ap_headid = 0 AND ap_credit < 0)
		ENDIF
		
		LOCATE FOR PADR(carpost.ap_billnr,10) == PADR(l_nBillNumber,10)
		IF NOT FOUND("carpost")
			= alert(strfmt(GetLangText("AR","TA_NOBILL"),""))
			thisformset.FormAllocate.Hide()
			this.FormPosting.Enabled = .T.
			REPLACE cap_marker WITH .F. ALL FOR cap_marker
			GO TOP IN carpost
			RETURN .F.
		ENDIF
		l_lBillNumDebitOrCredit = (ap_headid = ap_lineid AND ap_debit > 0) OR ;
				(ap_headid = 0 AND ap_credit < 0)
		* EXOR bit operation - we need different values - one debit and one credit
		* anything else we do not need
		l_lDebitorAndCreditSelected = (l_lMarkedDebitOrCredit OR l_lBillNumDebitOrCredit) AND ;
				NOT (l_lMarkedDebitOrCredit AND l_lBillNumDebitOrCredit)
		
		thisformset.FormAllocate.Hide()
		this.FormPosting.Enabled = .T.
		IF l_lDebitorAndCreditSelected
			REPLACE cap_marker WITH .T. FOR ap_billnr = l_nBillNumber IN carpost
			thisformset.mallocate()
		ELSE
			alert(GetLangText("AR","TXT_BADBILL_NUMBER"))
			REPLACE cap_marker WITH .F. ALL FOR cap_marker
			GO TOP IN carpost
		ENDIF
	ENDPROC

	PROCEDURE mallpostfind		&& Find postings, search all arpost and aracct table
		LOCAL lcField,lcExp,lnRn,lcExact,lcTable,lcAlias,l_nArractRecNo, l_nErrorCode, lcOrder
		
		IF EMPTY(thisformset.csearch)
			RETURN
		ENDIF
		l_nArractRecNo = RECNO("aracct")
		lcAlias=ALIAS()
		lcExact=SET("Exact")
		SET EXACT OFF
		lcField=''
		lcExp=''
		DO CASE
		CASE thisformset.nsearchfield=1 && Account
			lcTable='aracct'
			lcOrder = 'Tag1'
			lcField='aracct.ac_aracct'
		CASE thisformset.nsearchfield=2 && Comp key
			lcTable='aracct'
			lcOrder = 'Tag1'
			lcField='address.ad_compkey'
		CASE thisformset.nsearchfield=3 && Bill no.
			lcTable='arpost'
			lcOrder = 'Tag3'
			lcField='arpost.ap_billnr'
		CASE thisformset.nsearchfield=4 && Company
			lcTable='aracct'
			lcOrder = 'Tag1'
			lcField='address.ad_company'
		CASE thisformset.nsearchfield=5 && Name
			lcTable='aracct'
			lcOrder = 'Tag1'
			lcField='address.ad_lname'
		CASE thisformset.nsearchfield=6 && Debit
			lcTable='arpost'
			lcOrder = 'Tag3'
			lcField='arpost.ap_debit'
		OTHERWISE
			RETURN
		ENDCASE
		
		
		lcExp='UPPER(PADR('+lcField+',30))="'+UPPER(ALLTRIM(PADR(thisformset.csearch,30)))+'" AND NOT EMPTY('+lcField+')'
		IF lcTable='arpost'
			lcExp = lcExp + " AND arpost.ap_aracct > 0 AND SEEK(arpost.ap_aracct,'aracct','tag1')"
		ENDIF
		l_nErrorCode = this.FormPosting.oSearchHandlerPost.Find(lcTable, lcExp, lcOrder)
		IF (l_nErrorCode = 1) AND (lcTable = 'arpost')
			lnRn=RECNO('arpost')
		ENDIF
		
		SET EXACT &lcExact
		IF !EMPTY(lcAlias)
			SELECT &lcAlias
		ENDIF
		
		DO CASE
			CASE l_nErrorCode = -1
				Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
			CASE l_nErrorCode = 1
				IF this.naracct <> aracct.ac_aracct
					this.naracct = aracct.ac_aracct
					this.ccompany = LEFT(address.ad_company, 30)
					this.ccontact = LEFT(IIF(EMPTY(aracct.ac_apid), address.ad_lname, apartner.ap_lname), 30)
					this.mgetpostings()
					this.FormPosting.Refresh()
				ENDIF
				IF LOWER(this.FormPosting.oSearchHandlerPost.GetAlias()) == "arpost"
					l_nArea = SELECT()
					SELECT carpost
					LOCATE FOR cap_rn = lnRn
					IF NOT FOUND()
						GO TOP IN carpost
					ENDIF
					SELECT (l_nArea)
				ENDIF
				this.FormPosting.gdpostings.SetFocus()
		ENDCASE
	ENDPROC

	PROCEDURE mbalancebills
		LOCAL l_nArea, l_nRecNo, l_lCondition, l_nHeadIdNeg, l_nHeadIdPoz
		l_nArea = SELECT()
		SELECT carpost
		l_nRecNo = RECNO()
		LOCATE FOR cap_marker AND (ap_headid = ap_lineid) AND (ap_debit < 0)
		IF FOUND()
			l_nHeadIdNeg = ap_headid
			CONTINUE
			l_lCondition = NOT FOUND()
		ELSE
			l_lCondition = .F.
		ENDIF
		IF l_lCondition
			LOCATE FOR cap_marker AND (ap_headid = ap_lineid) AND (ap_debit > 0)
			IF FOUND()
				l_nHeadIdPoz = ap_headid
				CONTINUE
				l_lCondition = NOT FOUND()
			ELSE
				l_lCondition = .F.
			ENDIF
		ENDIF
		GO l_nRecNo
		IF l_lCondition
			l_nRecNo = RECNO("arpost")
			REPLACE ap_headid WITH l_nHeadIdPoz, ;
					ap_dispute WITH .F., ;
					ap_disdate WITH {} FOR ap_headid = l_nHeadIdNeg IN arpost
			GO l_nRecNo IN arpost
		ENDIF
		SELECT(l_nArea)
		RETURN l_lCondition
	ENDPROC

	PROCEDURE mbalanceoutcondition
		LOCAL l_nArea, l_nRecNo
		l_nArea = SELECT()
		SELECT carpost
		l_nRecNo = RECNO()
		LOCATE FOR cap_marker AND ap_lineid == ap_headid
		GO l_nRecNo
		SELECT(l_nArea)
		RETURN FOUND("carpost")
	ENDPROC

	PROCEDURE mbillstatus
		LOCAL ARRAY l_aDialogData(2, 10)
		
		IF this.mgetreccount()=0
			RETURN .T.
		ENDIF
		
		IF EMPTY(carpost.ap_billnr)
			= alert(GetLangText("AR","TXT_NOT_BILL"))
			RETURN .T.
		ENDIF
		
		l_nBillStatus = carpost.ap_ahid
		l_aDialogData(1,1) = "txtBillNr"
		l_aDialogData(1,2) = GetLangText("AR","TT_BILLNR")
		l_aDialogData(1,3) = "["+carpost.ap_billnr+"]"
		l_aDialogData(1,4) = "9999999999"
		l_aDialogData(1,5) = 20
		l_aDialogData(1,6) = ""
		l_aDialogData(1,10) = .T.
		l_aDialogData(2,1) = "cbobillstatus"
		l_aDialogData(2,2) = GetLangText("ARBILSTA","TXT_AR_BILL_STATUS")
		l_aDialogData(2,3) = ALLTRIM(STR(l_nBillStatus))
		l_aDialogData(2,4) = "@G"
		l_aDialogData(2,5) = 40
		l_aDialogData(2,6) = ""
		l_aDialogData(2,7) = ""
		l_aDialogData(2,9) = "SELECT ah_text"+g_Langnum+", ah_ahid " + ;
				"FROM arbilsta " + ;
				"UNION (SELECT SPACE(50) AS ahtext3, 0 AS ah_ahid FROM arbilsta) " + ;
				"ORDER BY 1" && Union is used to have empty record in combobox
		IF dialog(GetLangText("ARBILSTA","TXT_AR_BILL_STATUS"), "", @l_aDialogData)
			l_nBillStatus = INT(VAL(TRANSFORM(l_aDialogData(2,8))))
			IF dlocate("arpost","ap_lineid = " + sqLcnv(carpost.ap_lineid))
				REPLACE ap_ahid WITH l_nBillStatus IN arpost
				this.mupdatetable("arpost","ap_lineid",ap_lineid)
				REPLACE ap_ahid WITH l_nBillStatus, ;
						cap_billst WITH dblookup("arbilsta","tag1",l_nBillStatus,"ah_text"+g_langnum) ;
						IN carpost
			ENDIF
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE mcalcbalance
		LOCAL l_nSelect, l_nBalance, l_nRem0, l_nRem1, l_nRem2, l_nRem3, l_nRem4, l_cForecRemLev, l_nDisputed, l_nFreePayments, ;
				l_nCountCA, l_nCountX, l_lNoForecast
		l_nSelect = SELECT()
		this.nselectedaccount = aracct.ac_aracct
		l_lNoForecast = .T.
		DO ArAcctRemainders IN araccount WITH this.nselectedaccount, l_nBalance, l_nRem0, l_nRem1, l_nRem2, l_nRem3, l_nRem4, ;
				l_cForecRemLev, l_nDisputed, l_nFreePayments, l_nCountCA, l_nCountX, l_lNoForecast
		this.ncurbalance = l_nBalance
		this.ncurrem0 = l_nRem0
		this.ncurrem1 = l_nRem1
		this.ncurrem2 = l_nRem2
		this.ncurrem3 = l_nRem3
		this.ncurrem4 = l_nRem4
		this.ndisputed = l_nDisputed
		this.nfreepayments = l_nFreePayments
		SELECT (l_nSelect)
		RETURN .T.
	ENDPROC

	PROCEDURE mcalcremlevbalance
		LOCAL l_nSelect, l_nRecNo, l_cFilter
		l_nSelect = SELECT()
		this.FormPosting.cmdOK.SetFocus()
		STORE 0 TO this.aRemLevBalance
		SELECT carpost
		l_cFilter = FILTER()
		SET FILTER TO
		l_nRecNo = RECNO()
		SCAN ALL
			DO CASE
				CASE ap_remlev = 4
					this.aRemLevBalance(4) = this.aRemLevBalance(4) + cap_balanc
				CASE ap_remlev = 3
					this.aRemLevBalance(3) = this.aRemLevBalance(3) + cap_balanc
				CASE ap_remlev = 2
					this.aRemLevBalance(2) = this.aRemLevBalance(2) + cap_balanc
				CASE ap_remlev = 1
					this.aRemLevBalance(1) = this.aRemLevBalance(1) + cap_balanc
			ENDCASE
		ENDSCAN
		this.FormPosting.tbRemLev1.Refresh()
		this.FormPosting.tbRemLev2.Refresh()
		this.FormPosting.tbRemLev3.Refresh()
		this.FormPosting.tbRemLev4.Refresh()
		SET FILTER TO &l_cFilter
		GO l_nRecNo
		this.FormPosting.gdpostings.nrecno = l_nRecNo
		this.FormPosting.gdpostings.SetFocus()
		SELECT (l_nSelect)
		RETURN .T.
	ENDPROC

	PROCEDURE mcollectingagency
		LOCAL l_lDone, l_nMarked, l_nRecNo, l_nSelect, l_oArData, l_lCancel
		
		IF this.mgetreccount()=0
			RETURN .T.
		ENDIF
		l_nSelect = SELECT()
		this.msetmark(@l_nMarked)
		l_nRecNo = RECNO("carpost")
		this.FormPosting.cmdOK.SetFocus()
		
		IF dlocate("carpost","cap_marker = " + sqLcnv(.T.)) AND carpost.ap_headid = carpost.ap_lineid AND ;
					dlocate("arpost","ap_lineid = " + sqlcnv(carpost.ap_lineid))
			IF l_nMarked = 1
				SELECT arpost
				SCATTER MEMO NAME l_oArData
			ELSE
				SELECT arpost
				SCATTER MEMO NAME l_oArData BLANK
			ENDIF
			DO FORM forms\arcollectingagency WITH l_oArData TO l_oArData
			l_lCancel = ISNULL(l_oArData)
			IF NOT l_lCancel
				SELECT carpost
				SCAN FOR cap_marker AND ap_headid = ap_lineid
					l_oArData.ap_lineid = ap_lineid
					DO ArCollectingAgencyUpdate IN ar WITH l_oArData
					REPLACE ap_colagnt WITH l_oArData.ap_colagnt IN carpost
				ENDSCAN
			ENDIF
		ENDIF
		GO l_nRecNo IN carpost
		this.FormPosting.gdpostings.nrecno = RECNO()
		this.FormPosting.gdpostings.SetFocus()
		SELECT (l_nSelect)
		RETURN .T.
	ENDPROC

	PROCEDURE mdispute		&& Call dispute form
		LOCAL l_oData, l_lContinue, l_lSuccess, l_cLocalCur, l_oDisputeData, l_nLastRecord, l_nMarked, l_cReasonText, ;
				l_nSelect, l_nBalance, l_nDisBal, l_lUpdated, l_dDisDate, l_lDisputed
		IF this.mgetreccount()=0
			RETURN .T.
		ENDIF
		l_nSelect = SELECT()
		this.msetmark(@l_nMarked)
		l_nRecNo = RECNO("carpost")
		this.FormPosting.cmdOK.SetFocus()
		
		l_cReasonText = ""
		l_dDisDate = {}
		l_lDisputed = .F.
		IF l_nMarked = 1
			= dlocate("carpost","cap_marker = " + sqLcnv(.T.))
			IF dlocate("arpost","ap_lineid = " + sqlcnv(carpost.ap_lineid))
				l_cReasonText = arpost.ap_disreas
				l_dDisDate = arpost.ap_disdate
				l_lDisputed = arpost.ap_dispute
			ENDIF
		ENDIF
		
		l_nLastRecord = 0
		l_cLocalCur = "carpost"
		l_oDisputeData = CREATEOBJECT("custom")
		l_oDisputeData.AddProperty("ap_dispute",l_lDisputed)
		l_oDisputeData.AddProperty("ap_disdate",l_dDisDate)
		l_oDisputeData.AddProperty("ap_disreas",l_cReasonText)
		DO FORM forms\ardispute WITH l_oDisputeData TO l_oDisputeData
		l_lContinue = NOT ISNULL(l_oDisputeData)
		IF NOT l_lContinue
			this.FormPosting.cmdOK.SetFocus()
			RETURN .T.
		ENDIF
		
		
		SELECT carpost
		SCAN FOR cap_marker AND dlocate("ArPost","ap_lineid = "+sqLcnv(carpost.ap_lineid))
			IF ap_lineid <> ap_headid
				REPLACE cap_marker WITH .F.
			ELSE
				SELECT arpost
				SCATTER NAME l_oData
				SELECT carpost
				l_oData.ap_dispute = l_oDisputeData.ap_dispute
				l_oData.ap_disdate = l_oDisputeData.ap_disdate
				l_oData.ap_disreas = l_oDisputeData.ap_disreas
				DO ArDispute IN ar WITH l_oData, l_cLocalCur, l_lSuccess
				IF l_lSuccess
					IF l_oData.ap_dispute
						l_nBalance = arPstbal(ap_headid, 0, .F.)
						l_nDisBal = thisformset.mgetdisputedbalance(ap_headid)
						REPLACE ap_dispute WITH .T., ;
								ap_disdate WITH l_oData.ap_disdate, ;
								cap_balanc WITH l_nBalance, ;
								cap_disbal WITH l_nDisBal
					ELSE
			        	REPLACE ap_dispute WITH l_oData.ap_dispute, ;
			        			ap_disdate WITH l_oData.ap_disdate, ;
			        			ap_remlast WITH l_oData.ap_remlast, ;
			        			ap_remlev WITH l_oData.ap_remlev
					ENDIF
					this.mupdatetable("arpost","ap_lineid",ap_lineid)
					IF NOT l_lUpdated
						l_lUpdated = .T.
					ENDIF
				ENDIF
				l_nLastRecord = RECNO()
			ENDIF
		ENDSCAN
		IF l_lUpdated
			this.mcalcremlevbalance()
		ENDIF
		GO l_nLastRecord
		this.FormPosting.gdpostings.nrecno = RECNO()
		this.FormPosting.gdpostings.SetFocus()
		l_nSelect = SELECT()
		RETURN .T.
	ENDPROC

	PROCEDURE mgetarconditionnumber
		LOCAL l_nAyID
		l_nAyID = aracct.ac_ayid
		IF l_nAyID = 0
			RETURN dblookup("picklist", "tag4", this.cPayCondLabel + "DEF", "pl_numcod")
		ELSE
			RETURN dblookup("arpcond", "tag1", l_nAyID, "ay_number")
		ENDIF
	ENDPROC

	PROCEDURE mgetarremaindernumber
		LOCAL l_nAmID
		l_nAmID = aracct.ac_amid
		IF l_nAmID = 0
			RETURN dblookup("picklist", "tag4", this.cRemainderLabel + "DEF", "pl_numcod")
		ELSE
			RETURN dblookup("arremd", "tag1", l_nAmID, "am_number")
		ENDIF
	ENDPROC

	PROCEDURE mgetdisputed
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ndisputed
	ENDPROC

	PROCEDURE mgetdisputedbalance
		LPARAMETERS lp_nHeadId
		
		RETURN Araccount("ArGetDisputed",lp_nHeadId,"arpost")
	ENDPROC

	PROCEDURE mgetfreepayments
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.nfreepayments
	ENDPROC

	PROCEDURE mgetgrdbalance
		IF this.nselectedaccount<> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurbalance
	ENDPROC

	PROCEDURE mgetgrdrem0
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurrem0
	ENDPROC

	PROCEDURE mgetgrdrem1
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurrem1
	ENDPROC

	PROCEDURE mgetgrdrem2
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurrem2
	ENDPROC

	PROCEDURE mgetgrdrem3
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurrem3
	ENDPROC

	PROCEDURE mgetgrdrem4
		IF this.nselectedaccount <> aracct.ac_aracct
			this.mcalcbalance()
		ENDIF
		
		RETURN this.ncurrem4
	ENDPROC

	PROCEDURE mgetinactive
		LPARAMETERS lp_lInactive
		RETURN IIF(lp_lInactive,thisformset.cyes,thisformset.cno)
	ENDPROC

	PROCEDURE mgetlastdate
		LPARAMETERS lp_nAccountNumber, lp_dDebitDate, lp_dCreditDate
		LOCAL l_nOldArea, l_cArPostOrder
		LOCAL l_IsCreditFP, l_IsCreditPB, l_IsCreditCN, l_IsCreditNB, l_IsCredit
		LOCAL l_IsDebitRE, l_IsDebitBL, l_IsDebitRB, l_IsDebit
		l_nOldArea = SELECT()
		SELECT arpost
		l_cArPostOrder = ORDER()
		SET ORDER TO
		lp_dDebitDate = {}
		lp_dCreditDate = {}
		
		* Free Payment (FP)
		l_IsCreditFP = [ap_headid = 0 AND ap_paynum > 0 AND ap_credit > 0]
		* Payment on bill (PB)
		l_IsCreditPB = [ap_headid <> 0 AND ap_headid <> ap_lineid AND ap_paynum > 0 AND ap_credit > 0]
		* Credit Note (CN)
		l_IsCreditCN = [ap_headid = ap_lineid AND ap_debit < 0]
		* Credit Note which is aligned with bill (NB)
		l_IsCreditNB = [ap_headid <> 0 AND ap_headid <> ap_lineid AND ap_paynum > 0 AND ap_debit < 0]
		l_IsCredit = sqlor(l_IsCredit, l_IsCreditFP)
		l_IsCredit = sqlor(l_IsCredit, l_IsCreditPB)
		l_IsCredit = sqlor(l_IsCredit, l_IsCreditCN)
		l_IsCredit = sqlor(l_IsCredit, l_IsCreditNB)
		* Regress (RE)
		l_IsDebitRE = [ap_headid = 0 AND ap_paynum > 0 AND ap_credit < 0]
		* Regress that is aligned with bill (RB)
		l_IsDebitRB = [ap_headid <> 0 AND ap_headid <> ap_lineid AND ap_paynum > 0 AND ap_credit < 0]
		* Bill paid with debitor payment (BL)
		l_IsDebitBL = [ap_headid = ap_lineid AND ap_paynum > 0 AND ap_debit > 0]
		l_IsDebit = sqlor(l_IsDebit, l_IsDebitRE)
		l_IsDebit = sqlor(l_IsDebit, l_IsDebitBL)
		l_IsDebit = sqlor(l_IsDebit, l_IsDebitRB)
		
		SELECT MAX(ap_sysdate) FROM arpost WHERE ap_aracct = lp_nAccountNumber AND NOT ap_hiden AND (&l_IsDebit) ;
				GROUP BY ap_aracct INTO CURSOR curDebit
		lp_dDebitDate = curDebit.max_ap_sysdate
		USE IN "curDebit"
		SELECT MAX(ap_sysdate) FROM arpost WHERE ap_aracct = lp_nAccountNumber AND NOT ap_hiden AND (&l_IsCredit) ;
				GROUP BY ap_aracct INTO CURSOR curCredit
		SELECT "curCredit"
		lp_dCreditDate = curCredit.max_ap_sysdate
		USE IN "curCredit"
		
		SELECT arpost
		SET ORDER TO &l_cArPostOrder
		SELECT(l_nOldArea)
		RETURN .T.
	ENDPROC

	PROCEDURE mgetpostings		&& Get postings for account
		LOCAL lnAracct, l_lMoveFocus, l_dRemainder1Date, l_dStartRemFee
		STORE 0 TO this.ndebit, this.ncredit, this.aRemLevBalance
		lnAracct = IIF(EMPTY(this.naracct), aracct.ac_aracct, this.naracct)
		l_lMoveFocus = TYPE("this.FormPosting.ActiveControl") = "O" AND ;
			(LOWER(this.FormPosting.ActiveControl.Name) == "gdpostings")
		IF l_lMoveFocus
			this.FormPosting.cmdOK.SetFocus()
		ENDIF
		
		SET FILTER TO IN cArpost
		ZAP IN cArPost
		* In some cases CMark check box remains checked, then first inserted record is checked and balance is zero.
		IF TYPE("this.formposting.gdpostings.cmark")<>"U"
			this.FormPosting.GdPostings.CMark.TCheckBox1.Value = .F.
		ENDIF
		
		SELECT *, .F. as cap_marker, RECNO() AS cap_rn , 0 AS cap_balanc, .F. AS cap_rlevx, SPACE(50) AS cap_billst ;
				FROM arpost ;
				WHERE ap_aracct = lnAracct ;
				INTO CURSOR cTmpArpost READWRITE
		
		SELECT cTmpArpost
		SCAN FOR EMPTY(ap_hiden)
			this.mupdatearpost(cTmpArpost.ap_postid)
			SCATTER MEMVAR MEMO
			m.cap_balanc = arPstbal(cTmpArpost.ap_headid, cTmpArpost.ap_lineid, .F.)
			IF cTmpArpost.ap_headid = cTmpArpost.ap_lineid && Only blue records can be disputed!
				m.cap_disbal = thisformset.mgetdisputedbalance(cTmpArpost.ap_headid)
			ELSE
				m.cap_disbal = 0
			ENDIF
			IF EMPTY(m.ap_hiden)
				this.ndebit = this.ndebit + m.ap_debit
				this.ncredit = this.ncredit + m.ap_credit
				ArAccount("ArGetDueDate", ap_aracct, ap_sysdate, ap_duedat, @l_dRemainder1Date, @l_dStartRemFee)
				m.ap_duedat = l_dRemainder1Date
			ENDIF
			IF NOT EMPTY(m.ap_ahid)
				m.cap_billst = dblookup("arbilsta","tag1",m.ap_ahid,"ah_text"+g_langnum)
			ENDIF
			INSERT INTO cArPost FROM MEMVAR
		ENDSCAN
		SELECT cArPost
		this.mcalcremlevbalance()
		GO TOP IN cArpost
		
		this.mpostfilter
		
		IF l_lMoveFocus
			this.FormPosting.gdpostings.SetFocus()
		ENDIF
		this.nbalance=this.ndebit-this.ncredit
		*this.formPosting.tbbalance.Refresh()
		this.formPosting.Refresh()
		this.nbalancemarked = 0
		this.npaymentsmarked = 0
		
	ENDPROC

	PROCEDURE mgetreccount
		LOCAL l_cCurLocal, l_nRecNo, l_nRecCount, l_nSelect
		l_nSelect = SELECT()
		l_nRecCount = 0
		l_cCurLocal = "carpost"
		l_nRecNo = RECNO(l_cCurLocal)
		this.FormPosting.cmdOK.SetFocus()
		SELECT &l_cCurLocal
		COUNT TO l_nRecCount
		GO l_nRecNo IN &l_cCurLocal
		this.FormPosting.gdpostings.nrecno = RECNO(l_cCurLocal)
		this.FormPosting.gdpostings.SetFocus()
		SELECT (l_nSelect)
		RETURN l_nRecCount
	ENDPROC

	PROCEDURE mgettooltip
		LPARAMETERS lp_cGridName
		LOCAL l_cText, l_dDebitDate, l_dCreditDate, l_cDebitDateText, l_cCreditDateText, l_nArAccountNo
		l_dDebitDate = {}
		l_dCreditDate = {}
		l_cDebitDateText = ""
		l_cCreditDateText = ""
		l_cText = ""
		
		DO CASE
			CASE ALLTRIM(UPPER(lp_cGridName)) = "POSTINGS"
				DO CASE
					CASE cArpost.ap_headid = 0
						l_cText = GetLangText("AR","T_UNALLOC")
					CASE cArpost.ap_headid = cArpost.ap_lineid
						IF NOT EMPTY(cArpost.ap_inclev1)
							l_cText = l_cText + GetLangText("AR","TXT_REMEINDER_NO") + " I:   " + DTOC(cArpost.ap_inclev1) + CHR(10)
						ENDIF
						IF NOT EMPTY(cArpost.ap_inclev2)
							l_cText = l_cText + GetLangText("AR","TXT_REMEINDER_NO") + " II:  " + DTOC(cArpost.ap_inclev2) + CHR(10)
						ENDIF
						IF NOT EMPTY(cArpost.ap_inclev3)
							l_cText = l_cText + GetLangText("AR","TXT_REMEINDER_NO") + " III: " + DTOC(cArpost.ap_inclev3) + CHR(10)
						ENDIF
						IF EMPTY(l_cText)
							IF cArpost.ap_remlev = 0
								l_cText = GetLangText("AR","TXT_NOT_REMINDERED")
							ELSE
								l_cText = Str2Msg(GetLangText("AR","TXT_LAST_REMINDERED"),"%s",DTOC(cArpost.ap_remlast))
							ENDIF
						ELSE
							l_cText = LEFT(l_cText, LEN(l_cText)-1)
						ENDIF
					OTHERWISE
						l_cText = GetLangText("AR","TXT_PAYMENT")
				ENDCASE
			CASE ALLTRIM(UPPER(lp_cGridName)) = "ACCOUNTS"
				l_nArAccountNo = aracct.ac_aracct
				this.mgetlastdate(l_nArAccountNo, @l_dDebitDate, @l_dCreditDate)
				IF NOT EMPTY(l_dDebitDate)
					l_cDebitDateText = RIGHT(DTOS(l_dDebitDate),2)+"."+SUBSTR(DTOS(l_dDebitDate),5,2)+"."+LEFT(DTOS(l_dDebitDate),4)
				ENDIF
				IF NOT EMPTY(l_dCreditDate)
					l_cCreditDateText = RIGHT(DTOS(l_dCreditDate),2)+"."+SUBSTR(DTOS(l_dCreditDate),5,2)+"."+LEFT(DTOS(l_dCreditDate),4)
				ENDIF
				l_cText = GetLangText("AR","TT_LAST_DEBIT")+" "
				l_cText = l_cText + l_cDebitDateText+CHR(13)
				l_cText = l_cText + GetLangText("AR","TT_LAST_CREDIT")+" "
				l_cText = l_cText + l_cCreditDateText
		ENDCASE
		RETURN l_cText
	ENDPROC

	PROCEDURE mmark		&& Mark posting
		LPARAMETERS lp_lSkip
		LOCAL l_nRecno
		IF (cArpost.ap_artinum<>0) AND (cArpost.ap_headid<>cArpost.ap_lineid) && Only payments and bills can be marked.
			REPLACE cap_marker WITH .F. IN cArpost
			this.FormPosting.gdpostings.cmark.tcheckbox1.Value = .F.
		ELSE
			REPLACE cap_marker WITH !cap_marker IN cArpost
			this.FormPosting.gdpostings.cmark.tcheckbox1.Value = cArpost.cap_marker
			
			LOCAL l_nBalance
			IF cArpost.cap_marker
				IF cArpost.ap_headid == cArpost.ap_lineid
					l_nBalance = arpstbal(cArpost.ap_headid, 0, .F.)
					*IF l_nBalance > 0
						this.nbalancemarked = this.nbalancemarked + l_nBalance
					*ENDIF
				ELSE
					l_nBalance = cArpost.ap_credit - cArpost.ap_debit
					this.npaymentsmarked = this.npaymentsmarked + l_nBalance
				ENDIF
			ELSE
				IF cArpost.ap_headid == cArpost.ap_lineid
					l_nBalance = arpstbal(cArpost.ap_headid, 0, .F.)
					*IF l_nBalance > 0
						this.nbalancemarked = this.nbalancemarked - l_nBalance
					*ENDIF
				ELSE
					l_nBalance = cArpost.ap_credit - cArpost.ap_debit
					this.npaymentsmarked = this.npaymentsmarked - l_nBalance
				ENDIF
			ENDIF
			IF lp_lSkip
				l_nRecno = RECNO("carpost")
				SKIP 1 IN carpost
				IF EOF("carpost")
					GO l_nRecno IN carpost
				ENDIF
				this.formPosting.gdpostings.nrecno = RECNO("carpost")
			ENDIF
			this.FormPosting.tbbalancemarked.Refresh()
			this.FormPosting.TBPaymentsMarked.Refresh()
		ENDIF
	ENDPROC

	PROCEDURE moncanceldispute
		LOCAL l_lSuccess, l_nLastRecord, l_nBalance, l_nDisBal, l_lUpdated
		IF this.mgetreccount()=0
			RETURN .T.
		ENDIF
		l_nLastRecord = 0
		this.msetmark()
		this.FormPosting.cmdOK.SetFocus()
		SELECT carpost
		SCAN FOR cap_marker
			IF ap_lineid <> ap_headid
				REPLACE cap_marker WITH .F.
			ELSE
				DO ArCancelDispute IN ar WITH carpost.ap_lineid, l_lSuccess
				IF l_lSuccess
					l_nBalance = arPstbal(ap_headid, 0, .F.)
					l_nDisBal = thisformset.mgetdisputedbalance(ap_headid)
					REPLACE ap_dispute WITH .F., ;
							ap_disdate WITH {}, ;
							cap_balanc WITH l_nBalance, ;
							cap_disbal WITH l_nDisBal
					this.mupdatetable("arpost","ap_lineid",ap_lineid)
					IF NOT l_lUpdated
						l_lUpdated = .T.
					ENDIF
				ENDIF
				l_nLastRecord = RECNO()
			ENDIF
		ENDSCAN
		IF l_lUpdated
			this.mcalcremlevbalance()
		ENDIF
		GO l_nLastRecord
		this.FormPosting.gdpostings.nrecno = RECNO()
		this.FormPosting.gdpostings.SetFocus()
	ENDPROC

	PROCEDURE mpay		&& Call pay form
		LOCAL l_nArea, l_nRecNo, l_nBalanceMarked, l_nBalance, l_nHeadId, l_CarpostRecNo
		IF EMPTY(PARAM.pa_payonld)
			= alErt(GetLangText("AR","TA_NOPAYONLDG"))
			RETURN
		ENDIF
		l_CarpostRecNo = RECNO("carpost")
		IF DLocate("cArPost","ap_headid==ap_lineid AND cap_marker")
			l_nBalanceMarked = this.nBalanceMarked
			SELECT cArPost
			SCAN FOR cap_marker AND (ap_headid == ap_lineid) AND (cap_balanc < 0)
				l_nRecNo = RECNO()
				l_nBalance = cArPost.cap_balanc
				l_nHeadId = cArPost.ap_headid
				l_nBalanceMarked = l_nBalanceMarked - l_nBalance
				SCAN FOR (ap_headid == l_nHeadId) AND (ap_artinum==0) AND ;
						(ap_headid <> ap_lineid) AND (ap_debit < ap_credit)
					IF NOT cap_marker
						this.nPaymentsMarked = this.nPaymentsMarked - (ap_debit - ap_credit)
					ENDIF
					REPLACE cap_marker WITH .T.
					* ap_headid WITH 0,
					l_nBalance = l_nBalance - (ap_debit - ap_credit)
				ENDSCAN
				GO l_nRecNo
				*REPLACE cap_balanc WITH l_nBalance
				l_nBalanceMarked = l_nBalanceMarked + l_nBalance
			ENDSCAN
			IF l_nBalanceMarked <> this.nBalanceMarked AND ;
					YesNo(GetLangText("AR", "TXT_BALANCE_BILLS"))
				this.FormPosting.Enabled = .F.
				DO ArApBalanceOut IN ArAccount WITH l_nBalanceMarked, this.nPaymentsMarked
				= TABLEUPDATE(.T., .T., "arpost")
				this.FormPosting.Enabled = .T.
				*this.nBalanceMarked = 0
				*SELECT cArPost
				*SCAN
					*l_nBalance = ArPstBal(ap_headid, ap_lineid, .F.)
					*REPLACE cap_balanc WITH l_nBalance
					*IF cap_marker AND ap_headid == ap_lineid
					*	this.nBalanceMarked = this.nBalanceMarked + l_nBalance
					*ENDIF
				*ENDSCAN
				*l_nBalance = this.nBalanceMarked
				this.mGetPostings()
				*this.nBalanceMarked = l_nBalance
				this.FormPosting.Refresh()
				*= Alert(GetLangText("AR", "TXT_BILLS_BALANCED"))
				*IF this.nBalanceMarked == 0
				KEYBOARD '{ENTER}'
				RETURN .T.
				*ENDIF
			ENDIF
			thisformset.lmarked=.T.
			thisformset.nMaxAmt = this.nBalanceMarked
			thisformset.formpay.chPayAllMarked.Enabled=.T.
			thisformset.formpay.chPayAllMarked.Value=.T.
			thisformset.FormPay.chUnallocated.Enabled=.F.
			thisformset.FormPay.chUnallocated.Value=.F.
		ELSE
			thisformset.lmarked=.F.
			thisformset.formpay.chPayAllMarked.Enabled=.F.
			thisformset.formpay.chPayAllMarked.Value=.F.
			thisformset.FormPay.chUnallocated.Enabled=.T.
			thisformset.FormPay.chUnallocated.Value=.T.
			thisformset.nbalancemarked = arPstbal(cArpost.ap_headid,0,.F.)
			GO l_CarpostRecNo IN carpost
		ENDIF
		
		thisformset.dap_date = sySdate()
		thisformset.dap_belgdate = sysdate()
		thisformset.ndisprate = 0
		thisformset.ncalcrate = 0.000000
		thisformset.namt = 0.00
		thisformset.lunalloc = .F.
		thisformset.cref=''
		thisformset.formPay.lsaypaymethod.Caption=''
		thisformset.npaynum=0
		
		thisformset.formposting.Enabled=.F.
		thisformset.formpay.SHOW
		thisformset.formpay.dbdate.SetFocus
		
	ENDPROC

	PROCEDURE mpaypostment		&& Check payment and writes into tables
		LOCAL lcMessage,naMtleft ,naPrec,ntOpay,nrOunddiff,lnRn,lnheadid
		LOCAL loArpost, loPost, l_nUnits, l_cNumber
		
		IF cpaymetho.pm_paytyp = 7
			* Voucher
			l_nUnits = thisformset.namt
			l_cNumber = ""
			DO VoucherUse IN ProcVoucher WITH l_nUnits, l_cNumber, .T.
			IF EMPTY(l_cNumber)
				RETURN .F.
			ELSE
				thisformset.namt = l_nUnits
			ENDIF
		ENDIF
		
		lcMessage=''
		lnRn = RECNO('carpost')
		DO arappayvalid IN araccount WITH thisformset.dap_date,thisformset.npaynum,thisformset.namt,thisformset.ndefamt,thisformset.lpayall,lcMessage
		IF !EMPTY(lcMessage)
			=alert(lcMessage)
			RETURN
		ENDIF
		
		* write postings into arpost table
		SELECT arpost
		SCATTER MEMO NAME loArpost BLANK
		loArpost.ap_aracct = aracct.ac_aracct
		loArpost.ap_date = thisformset.dap_date
		loArpost.ap_paynum = thisformset.npaynum
		loArpost.ap_ref = thisformset.cref
		loArpost.ap_belgdat = thisformset.dap_belgdate
		
		SELECT post
		SCATTER MEMO NAME loPost BLANK
		loPost.ps_tano = .T.
		
		IF thisformset.lpayall
			SELECT COUNT(*) AS c_marked FROM carpost WHERE ap_headid=ap_lineid AND cap_marker INTO CURSOR curmarkedbills881
			IF NOT EMPTY(l_cNumber)
				IF curmarkedbills881.c_marked>1
					alert(GetLangText("AR","TXT_PAY_MORE_BILLS_WITH_VOUCH"))
					RETURN .F.
				ENDIF
			ENDIF
			IF curmarkedbills881.c_marked=1 OR yeSno(GetLangText("AR","TA_PAYALLMARKED"))
				naMtleft = ROUND(thisformset.namt*thisformset.ncAlcrate, PARAM.pa_currdec)
				naPrec = RECNO()
		
				SELECT carpost
				SCAN ALL FOR ap_headid=ap_lineid .AND. cap_marker
					REPLACE cap_marker WITH .F.
					ntOpay = arPstbal(ap_headid,0,.F.)
					IF ntOpay<=0
						LOOP
					ENDIF
					IF ntOpay>naMtleft
						ntOpay = naMtleft
					ENDIF
					coRgbillnr = dlOokup('cArPost','ap_headid = ap_lineid AND ap_headid = '+ sqLcnv(carPost.ap_headid),'ap_billnr')
		
					loPost.ps_postid = neXtid('POST')
					loPost.ps_addrid = 0
					loPost.ps_artinum = 0
					loPost.ps_cancel = .F.
					loPost.ps_cashier = g_cashier
					loPost.ps_userid = g_userid
					loPost.ps_date = sysdate()
					loPost.ps_ifc = carPost.ap_billnr
					loPost.ps_origid = carPost.ap_reserid
					loPost.ps_reserid = carPost.ap_reserid
					loPost.ps_price = 1
					loPost.ps_prtype = 0
					loPost.ps_setid = 0
					loPost.ps_split = .F.
					loPost.ps_supplem = DTOC(thisformset.dap_date)+thisformset.cref
					loPost.ps_time = TIME()
					loPost.ps_touched = .F.
					loPost.ps_window = 0
					
					loArpost.ap_sysdate = sysdate()
					loArpost.ap_credit = ntOpay
					loArpost.ap_headid = carPost.ap_headid
					loArpost.ap_reserid = carPost.ap_reserid
					loArpost.ap_userid = g_userid
					loArpost.ap_cashier = g_cashier
					loArpost.ap_lineid = neXtid('ARPOST')
					loArpost.ap_postid = loPost.ps_postid
					SELECT arpost
					APPEND BLANK
					GATHER NAME loArpost MEMO
					=TABLEUPDATE(.f.,.t.,'arpost')
					lnRn=RECNO('ArPost')
				
					loPost.ps_units = loArpost.ap_credit
					IF NOT EMPTY(l_cNumber)
						* Allowed only when 1 record in carpost cursor!
						this.mpaypostmentvoucher(l_cNumber, loPost)
					ENDIF
					loPost.ps_amount = -loPost.ps_units
					loPost.ps_paynum = loArpost.ap_paynum
					SELECT post
					APPEND BLANK
					GATHER NAME loPost MEMO
					FLUSH
					
					loPost.ps_postid = neXtid('POST')
					loPost.ps_units = -loArpost.ap_credit
					loPost.ps_amount = -loPost.ps_units
					loPost.ps_paynum = param.pa_payonld
					SELECT post
					APPEND BLANK
					GATHER NAME loPost MEMO
					FLUSH
					
					SELECT carpost
					naMtleft = ROUND(naMtleft-ntOpay, PARAM.pa_currdec)
					IF naMtleft<=0
						EXIT
					ENDIF
				ENDSCAN
				GOTO naPrec
			ENDIF
			dclose("curmarkedbills881")
		ELSE
			coRgbillnr = dlOokup('cArPost','ap_headid = ap_lineid AND ap_headid = '+ sqLcnv(carPost.ap_headid),'ap_billnr')
			loArpost.ap_sysdate = sysdate()
			loArpost.ap_credit = ROUND(thisformset.namt*thisformset.ncAlcrate, PARAM.pa_currdec)
			thisformset.ndefamt = ROUND(loArpost.ap_credit/thisformset.ncAlcrate, PARAM.pa_currdec)
			IF thisformset.ndefamt<>thisformset.namt
				nrOunddiff = thisformset.ndefamt-thisformset.namt
				IF nrOunddiff<>0.00
					loArpost.ap_credit = loArpost.ap_credit+nrOunddiff
				ENDIF
			ELSE
				nrOunddiff = 0
			ENDIF
			loPost.ps_postid = neXtid('POST')
			loPost.ps_addrid=0
			loPost.ps_artinum=0
			loPost.ps_cancel=.F.
			loPost.ps_cashier=g_cashier
			loPost.ps_userid=g_userid
			loPost.ps_date=sysdate()
			loPost.ps_ifc=carPost.ap_billnr
			loPost.ps_price=1
			loPost.ps_prtype=0
			loPost.ps_setid=0
			loPost.ps_split=.F.
			loPost.ps_supplem=DTOC(thisformset.dap_date)+thisformset.cref
			loPost.ps_time=TIME()
			loPost.ps_touched=.F.
			loPost.ps_window=0
			loPost.ps_units=loArpost.ap_credit
			IF NOT EMPTY(l_cNumber)
				this.mpaypostmentvoucher(l_cNumber, loPost)
			ENDIF
		
			IF thisformset.luNalloc OR (RECCOUNT("carpost") = 0) OR (carpost.ap_headid = 0)
				loArpost.ap_headid = 0
				loArpost.ap_reserid = 0.7
				loArpost.ap_userid = g_userid
				loArpost.ap_cashier = g_cashier
				loArpost.ap_lineid = neXtid('ARPOST')
				loArpost.ap_postid = loPost.ps_postid
				SELECT arpost
				APPEND BLANK
				GATHER NAME loArpost MEMO
				=TABLEUPDATE(.f.,.t.,'arpost')
				lnRn=RECNO('ArPost')
		
				loPost.ps_amount = -loPost.ps_units
				loPost.ps_reserid = 0.7
				loPost.ps_origid = 0.7
				loPost.ps_paynum = loArpost.ap_paynum
				loPost.ps_ifc = ''
				SELECT post
				APPEND BLANK
				GATHER NAME loPost MEMO
				FLUSH
		
				loPost.ps_paynum = PARAM.pa_payonld
				loPost.ps_postid = neXtid('POST')
				loPost.ps_units = -loArpost.ap_credit
				loPost.ps_amount = -loPost.ps_units
				SELECT post
				APPEND BLANK
				GATHER NAME loPost MEMO
				FLUSH
			ELSE
				loArpost.ap_headid = carPost.ap_headid
				loArpost.ap_reserid = carPost.ap_reserid
				loArpost.ap_userid = g_userid
				loArpost.ap_cashier = g_cashier
				loArpost.ap_lineid = neXtid('ARPOST')
				loArpost.ap_postid = loPost.ps_postid
				SELECT arpost
				APPEND BLANK
				GATHER NAME loArpost MEMO
				=TABLEUPDATE(.f.,.t.,'arpost')
				lnRn=RECNO('ArPost')
				
				loPost.ps_origid = carPost.ap_reserid
				loPost.ps_reserid = carPost.ap_reserid
				loPost.ps_amount = -loPost.ps_units
				loPost.ps_paynum = loArpost.ap_paynum
				SELECT post
				APPEND BLANK
				GATHER NAME loPost MEMO
				FLUSH
				
				loPost.ps_postid = neXtid('POST')
				loPost.ps_units = -loArpost.ap_credit
				loPost.ps_amount = -loPost.ps_units
				loPost.ps_paynum = param.pa_payonld
				SELECT post
				APPEND BLANK
				GATHER NAME loPost MEMO
				FLUSH
			ENDIF
		ENDIF
		
		thisformset.mgetpostings
		SELECT cArPost
		LOCATE FOR cap_rn=lnRn
		IF !thisformset.lunalloc
			lnheadid=ap_headid
			LOCATE FOR ap_lineid=lnheadid
			IF !FOUND()
				GO TOP 
			ENDIF
		ENDIF
		thisformset.formPosting.Refresh
		thisformset.formPosting.Enabled=.T.
		thisformset.formPay.Hide
		thisformset.formPosting.Activate
		thisformset.formPosting.tbsearch.SetFocus()
		RETURN .T.
	ENDPROC

	PROCEDURE mpaypostmentvoucher
		LPARAMETERS lp_cNumber, lp_oPost
		
		* Voucher
		DO VoucherUse IN ProcVoucher WITH lp_oPost.ps_units, lp_cNumber
		IF EMPTY(lp_cNumber)
			RETURN .F.
		ELSE
			lp_oPost.ps_voucnum = VAL(SUBSTR(ALLTRIM(lp_cNumber), 1, LEN(ALLTRIM(lp_cNumber)) - 2))
			lp_oPost.ps_vouccpy = VAL(SUBSTR(ALLTRIM(lp_cNumber), LEN(ALLTRIM(lp_cNumber)) - 1, 2))
			DO VoucherPrint IN ProcVoucher WITH lp_cNumber, .T.
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE mpostdelete		&& Delete postings
		LOCAL l_nArea, l_nRecNo, l_lDelete, l_lHide, l_dLastTran, l_nSelected, l_lMultiple, l_lUpdate
		l_nArea = SELECT()
		SELECT carpost
		l_nRecNo = RECNO()
		COUNT FOR cap_marker TO l_nSelected
		GO l_nRecNo
		DO CASE
			CASE l_nSelected = 0
				REPLACE cap_marker WITH .T.
			CASE l_nSelected > 1
				l_lMultiple = .T.
				IF NOT YesNo(GetLangText("AR","TXT_MULTIPLE_DELETE"))
					RETURN .F.
				ENDIF
		ENDCASE
		l_lUpdate = .F.
		SCAN FOR cap_marker
			l_lDelete = .T.
			l_lHide = .F.
			DO CASE
				CASE ap_sysdate < sysdate()
					IF NOT l_lMultiple
						Alert(GetLangText("CHKOUT2","TA_IMPOSSIBLE")+"!;"+GetLangText("AR","TA_DELETE_ONLY_TODAY"))
					ENDIF
					l_lDelete = .F.
				CASE EMPTY(carpost.ap_headid)
					IF l_lMultiple OR YesNo(GetLangText("AR","T_UNALLOC")+";"+GetLangText("AR","TA_YESDELETE"))
						l_lHide = .T.
					ELSE
						l_lDelete = .F.
					ENDIF
				CASE carpost.ap_headid = carpost.ap_lineid
					IF ArPstBal(carPost.ap_headid,0,.F.) <> 0
						IF l_lMultiple OR YesNo(GetLangText("AR","TA_HASBAL")+";"+GetLangText("AR","TA_YESDELETE"))
							l_lHide = .T.
						ELSE
							l_lDelete = .F.
						ENDIF
					ENDIF
					IF l_lDelete AND ArAccount("ArIsDisputed", carPost.ap_dispute, carPost.ap_disdate)
						IF l_lMultiple OR YesNo(GetLangText("AR","TA_ISDISPUTE")+";"+GetLangText("AR","TA_YESDELETE"))
							l_lHide = .T.
						ELSE
							l_lDelete = .F.
						ENDIF
					ENDIF
					*l_dLastTran = {}
					*DO ArLastTransact WITH carpost.ap_headid, l_dLastTran IN araccount
					*IF l_dLastTran = sysdate() AND l_lDelete
					*	IF yesno(GetLangText("AR","TA_TODAYTRANS")+";"+GetLangText("AR","TA_YESDELETE"))
					*		l_lHide = .T.
					*	ELSE
					*		l_lDelete = .F.
					*		l_lHide = .F.
					*	ENDIF
					*ENDIF
				OTHERWISE
					IF l_lMultiple OR YesNo(GetLangText("AR","TA_YESDELETE"))
						l_lHide = .T.
					ELSE
						l_lDelete = .F.
					ENDIF
			ENDCASE
			IF l_lDelete
				IF NOT l_lHide
					IF l_lMultiple OR YesNo(GetLangText("AR","TA_YESDELETE"))
						DO ApDel WITH carpost.ap_headid IN ar
						l_lUpdate = .T.
					ENDIF
				ELSE
					IF carpost.ap_headid = carpost.ap_lineid
						DO ArApHide WITH carpost.ap_headid, carpost.ap_lineid IN araccount
					ELSE
						DO ArApHide WITH 0, carpost.ap_lineid IN araccount
					ENDIF
					l_lUpdate = .T.
				ENDIF
			ENDIF
		ENDSCAN
		IF l_lUpdate
			=TABLEUPDATE(.T.,.T.,'arpost')
			IF CURSORGETPROP("Buffering","post") <> 1
				=TABLEUPDATE(.T.,.T.,'post')
			ELSE
				FLUSH
			ENDIF
			thisformset.mgetpostings()
			GO l_nRecNo-1 IN carpost
			thisformset.FormPosting.Refresh()
			IF RECCOUNT('cArPost')>0&&Needed to refresh Grid. In some cases, records are not shown, until ENTER is pressed
				KEYBOARD '{ENTER}'
			ENDIF
			thisformset.FormPosting.gdpostings.SetFocus()	
		ENDIF
		SELECT (l_nArea)
	ENDPROC

	PROCEDURE mpostfilter		&& Set filter into postings table
		SET FILTER TO IN cArpost
		DO CASE
		CASE thisformset.nposfilter=1 && all 
			SET FILTER TO EMPTY(ap_hiden) IN carpost
		CASE thisformset.nposfilter=2 && open postings
			SET FILTER TO (cap_balanc <> 0 OR cap_disbal <> 0) AND EMPTY(ap_hiden) IN carpost
		CASE thisformset.nposfilter=3 && closed postings
			SET FILTER TO (cap_balanc == 0) AND EMPTY(ap_hiden) IN carpost
		ENDCASE
		GO TOP IN carpost
		
	ENDPROC

	PROCEDURE mpostfind		&& Find Postings
		LOCAL lcField,lcExp,lcExact
		lcExact=SET("Exact")
		SET EXACT OFF 
		lcField=''
		lcExp=''
		DO CASE
			CASE thisformset.pnfield=1
				lcField='carpost.ap_billnr'
			CASE thisformset.pnfield=2
				lcField='carpost.ap_date'
			CASE thisformset.pnfield=3
				lcField='carpost.ap_credit'
			CASE thisformset.pnfield=4
				lcField='carpost.ap_debit'
			CASE thisformset.pnfield=5
				lcField='carpost.ap_ref'
		ENDCASE
		IF thisformset.plexactsearch
			lcExp='UPPER(PADR('+lcField+',30))="'+UPPER(ALLTRIM(PADR(thisformset.pcvalue,30)))+'" .AND. !EMPTY('+lcField+')'
		ELSE
			lcExp='OCCURS("'+UPPER(ALLTRIM(PADR(thisformset.pcvalue,30)))+'",UPPER(ALLTRIM(PADR('+lcField+',30))))>0'
		ENDIF
		
		IF -1 = this.FormPosting.oSearchHandlerPost.Find("carpost", lcExp)
			Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
		ENDIF
		
		SET EXACT &lcExact
		
		thisformset.pnField = 1
		thisformset.pcValue = ''
		thisformset.formPosting.Enabled=.t.
		thisformset.formsearchpost.Hide
		thisformset.formposting.gdpostings.SetFocus
	ENDPROC

	PROCEDURE mpostfindnext		&& Find next posting (CTRL+G)
		LOCAL l_nErrorCode, l_cExact, l_nArea
		
		l_cExact = SET("Exact")
		SET EXACT OFF 
		
		l_nErrorCode = this.FormPosting.oSearchHandlerPost.FindNext()
		
		IF (l_nErrorCode = 1) AND (LOWER(this.FormPosting.oSearchHandlerPost.GetAlias()) == "arpost")
			l_nRecno = RECNO("arpost")
		ENDIF
		
		SET EXACT &l_cExact
		
		DO CASE
			CASE l_nErrorCode = -1
				Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
			CASE l_nErrorCode = 1
				IF this.naracct <> aracct.ac_aracct
					this.naracct = aracct.ac_aracct
					this.ccompany = LEFT(address.ad_company, 30)
					this.ccontact = LEFT(IIF(EMPTY(aracct.ac_apid), address.ad_lname, apartner.ap_lname), 30)
					this.mgetpostings()
				ENDIF
				IF LOWER(this.FormPosting.oSearchHandlerPost.GetAlias()) == "arpost"
					l_nArea = SELECT()
					SELECT carpost
					LOCATE FOR cap_rn = l_nRecno
					IF NOT FOUND()
						GO TOP IN carpost
					ENDIF
					SELECT (l_nArea)
				ENDIF
				this.FormPosting.Refresh()
		ENDCASE
	ENDPROC

	PROCEDURE mpostfindprevious
		LOCAL l_nErrorCode, l_cExact, l_nArea
		
		l_cExact = SET("Exact")
		SET EXACT OFF 
		
		l_nErrorCode = this.FormPosting.oSearchHandlerPost.FindPrevious()
		
		IF (l_nErrorCode = 1) AND (LOWER(this.FormPosting.oSearchHandlerPost.GetAlias()) == "arpost")
			l_nRecno = RECNO("arpost")
		ENDIF
		
		SET EXACT &l_cExact
		
		DO CASE
			CASE l_nErrorCode = -1
				Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
			CASE l_nErrorCode = 1
				IF this.naracct <> aracct.ac_aracct
					this.naracct = aracct.ac_aracct
					this.ccompany = LEFT(address.ad_company, 30)
					this.ccontact = LEFT(IIF(EMPTY(aracct.ac_apid), address.ad_lname, apartner.ap_lname), 30)
					this.mgetpostings()
				ENDIF
				IF LOWER(this.FormPosting.oSearchHandlerPost.GetAlias()) == "arpost"
					l_nArea = SELECT()
					SELECT carpost
					LOCATE FOR cap_rn = l_nRecno
					IF NOT FOUND()
						GO TOP IN carpost
					ENDIF
					SELECT (l_nArea)
				ENDIF
				this.FormPosting.Refresh()
		ENDCASE
	ENDPROC

	PROCEDURE mprintbillcopy
		this.formPosting.Enabled = .F.
		DO PrintBillCopy IN ArAccount WITH carpost.ap_billnr, carpost.ap_reserid
		this.formPosting.Enabled = .T.
		
		RETURN .T.
		
	ENDPROC

	PROCEDURE mprintpostings		&& Print showed postings.
		LOCAL l_cFrx, l_cFormPreview, l_nRecNo, l_cSql 
		PRIVATE p_aFields, p_aRecord
		PRIVATE p_cTitle, p_cDebitor, p_cFirma, p_cName, p_cDebit, p_cCredit, p_cBalance
		PRIVATE p_cDebValue, p_cFirValue, p_cNamValue, p_nCredit, p_nDebit, p_nBalance
		PRIVATE p_cBillno, p_cDate, p_cBelgdat, p_cPaynum, p_cReference, p_cDispute
		PRIVATE p_cYes, p_cNo
		
		p_cTitle   = GetLangText("AR","TW_POSTACCT")
		p_cDebitor = GetLangText("AR","T_ACCOUNT")
		p_cFirma   = GetLangText("AR","T_COMPANY")
		p_cName    = GetLangText("AR","T_CONTACT")
		p_cDebit   = GetLangText("AR","T_DEBIT")
		p_cCredit  = GetLangText("AR","T_CREDIT")
		p_cBalance = GetLangText("AR","T_BALANCE")
		p_cDebit     = GetLangText("AR","T_DEBIT")
		p_cCredit    = GetLangText("AR","T_CREDIT")
		p_cBalance   = GetLangText("AR","T_BALANCE")
		
		p_cDebValue = aracct.ac_aracct
		p_cFirValue = thisformset.ccompany
		p_cNamValue = thisformset.cname
		p_nCredit   = thisformset.ncredit
		p_nDebit    = thisformset.ndebit
		p_nBalance  = thisformset.nbalance
		
		p_cBillno    = GetLangText("AR","T_BILLNR")
		p_cDate      = GetLangText("AR","T_DATE")
		p_cBelgdat   = GetLangText("AR","T_BEGDATE")
		p_cPaynum    = GetLangText("AR","T_DEPT")
		p_cReference = GetLangText("AR","T_REFERENCE")
		p_cDispute   = GetLangText("AR","T_DISP")
		
		p_cYes = GetLangText("AR", "T_YES")
		p_cNo  = GetLangText("AR", "T_NO")
		
		this.FormPosting.cmdOK.SetFocus()
		
		SELECT * FROM carpost WHERE .F. INTO CURSOR query_ar READWRITE
		SELECT carpost
		l_nRecNo = RECNO()
		SCAN ALL
			SCATTER MEMO NAME l_oData
			SELECT query_ar
			APPEND BLANK
			GATHER NAME l_oData MEMO
			SELECT carpost
		ENDSCAN
		
		TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
		SELECT ad_title, ad_fname, ad_lname, ad_company, ad_departm, ad_street, ad_street2, ad_zip, ad_city, ad_country 
			FROM address 
			WHERE ad_addrid = <<TRANSFORM(aracct.ac_addrid)>>
		ENDTEXT
		
		sqlcursor(l_cSql,"curaracaddr80012",,,,,,.T.)
		
		IF NOT EMPTY(aracct.ac_apid)
			TEXT TO l_cSql TEXTMERGE NOSHOW PRETEXT 15
			SELECT ap_title, ap_lname, ap_fname 
				FROM apartner 
				WHERE ap_apid = <<TRANSFORM(aracct.ac_apid)>>
			ENDTEXT
			sqlcursor(l_cSql,"curaracap80012",,,,,,.T.)
			REPLACE ad_title WITH curaracap80012.ap_title, ;
					ad_fname WITH curaracap80012.ap_fname, ;
					ad_lname WITH curaracap80012.ap_lname ;
					IN curaracaddr80012
		ENDIF
		
		SELECT query_ar
		l_cFrx = gcReportdir+"_arap100.frx"
		
		REPORT FORM (l_cFrx) TO PRINTER PROMPT NOCONSOLE
		USE IN query_ar
		
		dclose("curaracaddr80012")
		dclose("curaracap80012")
		
		GO l_nRecNo IN carpost
		this.FormPosting.gdpostings.nrecno = l_nRecNo
		
		this.FormPosting.gdpostings.SetFocus()
		
		DO ArSetStatusLine IN ar
		
		RETURN .T.
	ENDPROC

	PROCEDURE mprintstatement		&& Print statement for account
		LOCAL nacct,narea,ddAtefrom,ddAteend,liNclude  
		LOCAL l_title, l_fname, l_lname
		naCct = carpost.ap_aracct
		ddAtefrom = thisformset.formPrintStatements.dbfrom.Value
		ddAteend = thisformset.formPrintStatements.dbto.Value
		liNclude = thisformset.formPrintStatements.chIncludeUnallocated.Value
		
		IF EMPTY(ddAtefrom)
			ddAtefrom = {^1900-01-01}
		ENDIF
		
		IF EMPTY(ddAteend)
			ddAteend = {^2000-01-02}
		ENDIF
		naRea = SELECT()
		IF liNclude
			SELECT *, SPACE(20) AS cur_title, SPACE(20) AS cur_fname, SPACE(30) AS cur_lname, SPACE(50) AS cur_salute ;
			    FROM ArAcct LEFT JOIN apartner ON ac_apid = ap_apid, ArPost, Address ;
			    WHERE ac_aracct=naCct  ;
				AND (ap_lineid=ap_headid OR ap_headid=0) AND  ;
				ac_addrid=ad_addrid AND ac_aracct=ap_aracct AND  ;
				BETWEEN(ap_sysdate, ddAtefrom, ddAteend) AND  NOT  ;
				ArAccount("ArIsDisputed", ap_dispute, ap_disdate) HAVING arPstbal(ap_headid,ap_lineid,.F.)<> ;
				0 ORDER BY ap_headid, ap_lineid INTO CURSOR QUERY READWRITE
		ELSE
			SELECT *, SPACE(20) AS cur_title, SPACE(20) AS cur_fname, SPACE(30) AS cur_lname, SPACE(50) AS cur_salute ;
			    FROM ArAcct LEFT JOIN apartner ON ac_apid = ap_apid, ArPost, Address ;
			    WHERE ac_aracct=naCct  ;
				AND ap_lineid=ap_headid AND ac_addrid=ad_addrid AND  ;
				ac_aracct=ap_aracct AND BETWEEN(ap_sysdate, ddAtefrom,  ;
				ddAteend) AND  NOT ArAccount("ArIsDisputed", ap_dispute, ap_disdate) HAVING  ;
				arPstbal(ap_headid,ap_lineid,.F.)<>0 ORDER BY  ;
				ap_headid, ap_lineid INTO CURSOR QUERY READWRITE
		ENDIF
		IF _TALLY>0
			IF yeSno(stRfmt(GetLangText("AR","TA_RECSCONT"),_TALLY))
				SCAN ALL
				     * prepare address
				     IF NOT EMPTY(ac_apid)
				          REPLACE cur_title WITH IIF(ISNULL(ap_title),"",ap_title), ;
				                    cur_fname WITH IIF(ISNULL(ap_fname),"",ap_fname), ;
				                    cur_lname WITH IIF(ISNULL(ap_lname),"",ap_lname), ;
				                    cur_salute WITH IIF(ISNULL(ap_salute),"",ap_salute)
				     ELSE
				          REPLACE cur_title WITH IIF(ISNULL(ad_title),"",ad_title), ;
				                    cur_fname WITH IIF(ISNULL(ad_fname),"",ad_fname), ;
				                    cur_lname WITH IIF(ISNULL(ad_lname),"",ad_lname), ;
				                    cur_salute WITH IIF(ISNULL(ad_salute),"",ad_salute)
				     ENDIF
				ENDSCAN
				GO TOP
				cfRx = gcReportdir+'ARSTMT.FRX'
				IF FILE(cfRx)
					REPORT FORM (cfRx) TO PRINTER PROMPT NOCONSOLE
					DO seTstatus IN SETUP
					SELECT query
					SCAN ALL
						DO updstatement IN ar WITH ap_lineid
				    ENDSCAN
					=TABLEUPDATE(.t.,.t.,'arpost')
				ELSE
					= alErt(stRfmt(GetLangText("AR","TA_NOFRX"),cfRx))
				ENDIF
			ENDIF
		ELSE
			= alErt(GetLangText("AR","TA_NOSTMTDATA"))
		ENDIF
		USE IN query
		SELECT (naRea)
		
		thisformset.formPrintStatements.Hide
		thisformset.formPosting.Enabled=.t.
		
	ENDPROC

	PROCEDURE mrefreshgridonskip		&& Called when refeshing of gdpost grid needed.
		this.naracct = aracct.ac_aracct
		this.nselectedaccount = this.naracct
		this.refresharconditions()
		this.ccompany = LEFT(address.ad_company, 30)
		this.ccontact = LEFT(IIF(EMPTY(aracct.ac_apid), address.ad_lname, apartner.ap_lname), 30)
		thisformset.mgetpostings()
		thisformset.FormPosting.Refresh()
		IF RECCOUNT('cArPost')>0&&Needed to refresh Grid. In some cases, records are not shown, until ENTER is pressed
			KEYBOARD '{ENTER}'
		ENDIF
		thisformset.FormPosting.gdpostings.SetFocus()
		
		RETURN
		
	ENDPROC

	PROCEDURE mremedit
		LOCAL l_lDone, l_nMarked, l_cDefRelLev, l_nRecNo, l_dDefLastRemDate, l_lUpdated, l_lDontCheckPrintStatus
		PRIVATE p_dDefLastRemDate
		DIMENSION adLg[2, 8]
		
		IF this.mgetreccount()=0
			RETURN .T.
		ENDIF
		
		this.msetmark(@l_nMarked)
		l_nRecNo = RECNO("carpost")
		this.FormPosting.cmdOK.SetFocus()
		
		l_cDefRelLev = "0"
		p_dDefLastRemDate = sysdate()
		
		IF l_nMarked = 1
			IF dlocate("carpost","cap_marker = " + sqLcnv(.T.)) AND ap_headid = ap_lineid
				l_cDefRelLev = STR(carpost.ap_remlev,1)
				p_dDefLastRemDate = IIF(EMPTY(carpost.ap_remlast),sysdate(),carpost.ap_remlast)
			ENDIF
			GO l_nRecNo IN carpost
		ENDIF
		
		DO ArGetRemainderDialog IN ar WITH adLg, l_cDefRelLev, this.lForbidenRem4
		
		IF diAlog(GetLangText("ARREMPRI","TXT_EDIT_REMLEV"),'',@adLg)
			l_lDontCheckPrintStatus = .T.
			l_lDone = .F.
			SELECT carpost
			SCAN FOR cap_marker AND ap_headid = ap_lineid
				IF ap_remlev <> adLg(1,8)
					DO ArChangeRemainder IN ar WITH adLg(1,8), "carpost", adLg[2, 8], l_lDontCheckPrintStatus
					IF dlocate("arpost","ap_lineid = " + sqLcnv(carpost.ap_lineid))
						this.mupdatetable("arpost","ap_lineid",ap_lineid)
						REPLACE ap_remlev WITH arpost.ap_remlev, ;
								ap_remlast WITH arpost.ap_remlast, ;
								ap_inclev1 WITH arpost.ap_inclev1, ;
								ap_inclev2 WITH arpost.ap_inclev2, ;
								ap_inclev3 WITH arpost.ap_inclev3, ;
								ap_inclev4 WITH arpost.ap_inclev4, ;
								ap_remcnt WITH arpost.ap_remcnt IN carpost
						IF NOT l_lUpdated
							l_lUpdated = .T.
						ENDIF
					ENDIF
				ENDIF
			ENDSCAN
		ENDIF
		IF l_lUpdated
			this.mcalcremlevbalance()
		ENDIF
		GO l_nRecNo IN carpost
		this.FormPosting.gdpostings.nrecno = RECNO()
		this.FormPosting.gdpostings.SetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE msearchbillnr		&& Search ap_billnr in arpost.dbf
		LPARAMETERS plcBillNr
		LOCAL l_nErrorCode
		
		l_nErrorCode = this.FormPosting.oSearchHandlerPost.Find("arpost", "ap_billnr = RTRIM(" + SqlCnv(plcBillNr) + ;
			") AND NOT ap_hiden AND SEEK(ap_aracct, 'aracct', 'tag1')")
		
		RETURN l_nErrorCode
	ENDPROC

	PROCEDURE msearchclose		&& Close Search dialog (Cancel Button)
		thisformset.formARAccounts.Enabled=.t.
		thisformset.formSearch.Hide
	ENDPROC

	PROCEDURE msetcaption		&& Set caption of labels on all forms
		IF this.lCreditors
			thisformset.formARAccounts.Caption=GetLangText("AR","TXT_CREDITORS")
		ELSE
			thisformset.formARAccounts.Caption=GetLangText("AR","TW_ACCTS")
		ENDIF
		thisformset.formARAccounts.gdaraccounts.ccompkey.Header1.Caption=GetLangText("AR","T_COMPKEY")
		thisformset.formARAccounts.gdaraccounts.cbalance.Header1.Caption=GetLangText("AR","T_BALANCE")
		thisformset.formARAccounts.gdaraccounts.cfirma.Header1.Caption=GetLangText("AR","T_COMPANY")
		IF this.lCreditors
			thisformset.formARAccounts.gdaraccounts.ckonto.Header1.Caption=GetLangText("AR","TXT_CREDITOR_ACCOUNT")
		ELSE
			thisformset.formARAccounts.gdaraccounts.ckonto.Header1.Caption=GetLangText("AR","T_ACCOUNT")
		ENDIF
		thisformset.formARAccounts.gdaraccounts.cname.Header1.Caption=GetLangText("AR","T_CONTACT")
		thisformset.formARAccounts.gdaraccounts.crem0.header1.Caption=GetLangText("AR","TXT_REMEINDER_NO") + " 0"
		thisformset.formARAccounts.gdaraccounts.crem1.header1.Caption=GetLangText("AR","TXT_REMEINDER_NO") + " 1"
		thisformset.formARAccounts.gdaraccounts.crem2.header1.Caption=GetLangText("AR","TXT_REMEINDER_NO") + " 2"
		thisformset.formARAccounts.gdaraccounts.crem3.header1.Caption=GetLangText("AR","TXT_REMEINDER_NO") + " 3"
		IF NOT this.lForbidenRem4
			thisformset.formARAccounts.gdaraccounts.crem4.header1.Caption=GetLangText("AR","TXT_REMEINDER_NO") + " 4"
		ENDIF
		thisformset.formARAccounts.gdaraccounts.disputed.header1.Caption=GetLangText("AR","T_DISPUTED")
		thisformset.formARAccounts.gdaraccounts.cfreepayments.header1.Caption=GetLangText("AR","T_FREEPAY")
		thisformset.formARAccounts.gdaraccounts.cinactiv.header1.Caption=GetLangText("AR","T_INACTIVE")
		thisformset.formARAccounts.gdaraccounts.cselrem.header1.Caption=GetLangText("AR","TXT_SELECTED_REMAINDER")
		thisformset.formARAccounts.gdaraccounts.cselpaycond.header1.Caption=GetLangText("AR","TXT_SELECTED_PAY_CONDITION")
		
		thisformset.formARAccounts.lkontofilter.Caption=GetLangText("AR","T_ACCOUNT_FILTER")
		thisformset.formARAccounts.lpostfilter.Caption=GetLangText("AR","T_POSTINGS_FILTER")
		IF this.lCreditors
			thisformset.formARAccounts.lkonto.Caption=GetLangText("AR","TXT_CREDITOR_ACCOUNT")
		ELSE
			thisformset.formARAccounts.lkonto.Caption=GetLangText("AR","T_ACCOUNT")
		ENDIF
		thisformset.formARAccounts.tbkonto.tooltiptext = "SHIFT + D"
		
		thisformset.formARAccounts.ogkontofilter.option1.Caption=GetLangText("AR","TT_ALL_ACCOUNTS")
		thisformset.formARAccounts.ogkontofilter.option2.Caption=GetLangText("AR","TT_OPEN_ACCOUNTS")
		
		thisformset.formARAccounts.ogpostfilter.option1.Caption=GetLangText("AR","TT_ALL_POSTINGS")
		thisformset.formARAccounts.ogpostfilter.option2.Caption=GetLangText("AR","TT_OPEN_POSTINGS")
		thisformset.formARAccounts.ogpostfilter.option3.Caption=GetLangText("AR","TT_CLOSED_POSTINGS")
		
		thisformset.formARAccounts.lfindNext.Caption=GetLangText("AR","TW_FIND_NEXT")
		thisformset.formARAccounts.lFindPrevious.Caption=GetLangText("AR","TW_FIND_PREV")
		
		
		* Search Form
		thisformset.formsearch.Caption=GetLangText("AR","TW_SEARCH")
		thisformset.formSearch.lfield.Caption=GetLangText("AR","TW_FIELD")
		thisformset.formSearch.lvalue.Caption=GetLangText("AR","TW_VALUE")
		thisformset.formSearch.lfindNext.Caption=GetLangText("AR","TW_FIND_NEXT")
		thisformset.formSearch.lFindPrevious.Caption=GetLangText("AR","TW_FIND_PREV")
		thisformset.formSearch.chExactSearch.Caption=GetLangText("AR","TW_EXACT_SEARCH")
		thisformset.formSearch.cmdOK.Caption=GetLangText("AR","TB_OK")
		thisformset.formSearch.cmdCancel.Caption=GetLangText("AR","TB_CANCEL")
		
		* Postings Form
		IF this.lCreditors
			thisformset.formposting.Caption=GetLangText("AR","TXT_POST_CREDITORS")
			thisformset.formposting.lDebitor.Caption=GetLangText("AR","TXT_CREDITOR_ACCOUNT")
		ELSE
			thisformset.formposting.Caption=GetLangText("AR","TW_POSTACCT")
			thisformset.formposting.lDebitor.Caption=GetLangText("AR","T_ACCOUNT")
		ENDIF
		
		thisformset.formposting.lFirma.Caption=GetLangText("AR","T_COMPANY")
		thisformset.formposting.lname.Caption=GetLangText("AR","T_CONTACT")
		IF this.lCreditors
			thisformset.formposting.lDebit.Caption=GetLangText("AR","T_CREDIT")
			thisformset.formposting.lcredit.Caption=GetLangText("AR","T_DEBIT")
		ELSE
			thisformset.formposting.lDebit.Caption=GetLangText("AR","T_DEBIT")
			thisformset.formposting.lcredit.Caption=GetLangText("AR","T_CREDIT")
		ENDIF
		thisformset.formposting.lbalance.Caption=GetLangText("AR","T_BALANCE")
		thisformset.formposting.lsearchfield.Caption = " " + GetLangText("AR","TXT_SEARCHED_FIELDS")
		thisformset.formposting.lpostfilter.Caption = " " + GetLangText("AR","T_POSTINGS_FILTER")
		thisformset.formposting.lSearchString.Caption = GetLangText("AR","TXT_SEARCH_STRING")
		thisformset.formposting.tbsearch.tooltiptext = "SHIFT + S"
		thisformset.formposting.lbalancemarked.Caption = GetLangText("AR","TXT_SUM_MARKED")
		
		thisformset.formposting.cmdOK.Caption=GetLangText("AR","TXT_START_SEARCH")
		thisformset.formposting.lfindNext.Caption=GetLangText("AR","TW_FIND_NEXT")
		thisformset.formposting.lFindPrevious.Caption=GetLangText("AR","TW_FIND_PREV")
		thisformset.formposting.ogpostfilter.option1.Caption=GetLangText("AR","TT_ALL_POSTINGS")
		thisformset.formposting.ogpostfilter.option2.Caption=GetLangText("AR","TT_OPEN_POSTINGS")
		thisformset.formposting.ogpostfilter.option3.Caption=GetLangText("AR","TT_CLOSED_POSTINGS")
		
		IF this.lCreditors
			thisformset.formposting.ogsearchfield.option1.Caption=GetLangText("AR","TT_CREDITOR_ACCOUNT")
		ELSE
			thisformset.formposting.ogsearchfield.option1.Caption=GetLangText("AR","TT_ACCOUNT")
		ENDIF
		
		thisformset.formposting.ogsearchfield.option2.Caption=GetLangText("AR","TT_COMPKEY")
		thisformset.formposting.ogsearchfield.option3.Caption=GetLangText("AR","TT_BILLNR")
		thisformset.formposting.ogsearchfield.option4.Caption=GetLangText("AR","TT_COMPANY")
		thisformset.formposting.ogsearchfield.option5.Caption=GetLangText("AR","TT_CONTACT")
		thisformset.formposting.ogsearchfield.option6.Caption=GetLangText("AR","TT_DEBIT")
		
		
		thisformset.formposting.gdpostings.cbillno.header1.Caption=GetLangText("AR","T_BILLNR")
		thisformset.formposting.gdpostings.cdate.header1.Caption=GetLangText("AR","T_DATE")
		thisformset.formposting.gdpostings.cbelgdat.header1.Caption=GetLangText("AR","T_BEGDATE")
		thisformset.formposting.gdpostings.cpaynum.header1.Caption=GetLangText("AR","T_DEPT")
		
		IF this.lCreditors
			thisformset.formposting.gdpostings.cdebit.header1.Caption=GetLangText("AR","T_CREDIT")
			thisformset.formposting.gdpostings.ccredit.header1.Caption=GetLangText("AR","T_DEBIT")
		ELSE
			thisformset.formposting.gdpostings.cdebit.header1.Caption=GetLangText("AR","T_DEBIT")
			thisformset.formposting.gdpostings.ccredit.header1.Caption=GetLangText("AR","T_CREDIT")
		ENDIF
		
		thisformset.formposting.gdpostings.cbalance.header1.Caption=GetLangText("AR","T_BALANCE")
		thisformset.formposting.gdpostings.creference.header1.Caption=GetLangText("AR","T_REFERENCE")
		thisformset.formposting.gdpostings.cdispute.header1.Caption=GetLangText("AR","T_DISP")
		thisformset.formposting.gdpostings.cmark.header1.Caption='<<'
		thisformset.formposting.gdpostings.cremeinderlevel.header1.Caption = GetLangText("AR","TXT_REM_LEVEL")
		thisformset.formposting.gdpostings.clastremainder.header1.Caption = GetLangText("AR","TXT_REMLAST_DATE")
		thisformset.formposting.gdpostings.cduedat.header1.Caption = GetLangText("ARREMPRI","TXT_DUE_FROM")
		thisformset.formposting.gdpostings.ccollectagent.header1.Caption = GetLangText("AR","TXT_COLUMN_COL_AGENT")
		thisformset.formposting.gdpostings.cdisuputeduntil.header1.Caption = GetLangText("AR","TXT_DISPUTED_UNTIL")
		thisformset.formposting.gdpostings.cbillstatus.header1.Caption = GetLangText("AR","TXT_BILL_STATUS")
		thisformset.formPosting.lRemLev1.Caption = GetLangText("AR","TXT_REMEINDER_NO") + " I"
		thisformset.formPosting.lRemLev2.Caption = GetLangText("AR","TXT_REMEINDER_NO") + " II"
		thisformset.formPosting.lRemLev3.Caption = GetLangText("AR","TXT_REMEINDER_NO") + " III"
		thisformset.formPosting.lRemLev4.Caption = GetLangText("AR","TXT_REMEINDER_NO") + " IV"
		thisformset.formPosting.lRemKey.Caption = GetLangText("AR","TXT_REMAINDER_KEY")
		thisformset.formPosting.lRemCondition.Caption = GetLangText("AR","TXT_PAY_CONDITION")
		
		* Aging form
		thisformset.formAging.Caption=GetLangText("AR","TW_AGING")
		thisformset.formAging.la1.Caption='< '+ntOc(paRam.pa_arage1)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la2.Caption=ntOc(paRam.pa_arage1)+' - '+ntOc(paRam.pa_arage2)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la3.Caption=ntOc(paRam.pa_arage2)+' - '+ntOc(paRam.pa_arage3)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la4.Caption=ntOc(paRam.pa_arage3)+' - '+ntOc(paRam.pa_arage4)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la5.Caption=ntOc(paRam.pa_arage4)+' - '+ntOc(paRam.pa_arage5)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la6.Caption='>= '+ntOc(paRam.pa_arage5)+' '+GetLangText("AR","T_DAYS")
		thisformset.formAging.la7.Caption=GetLangText("AR","T_DISPUTED")
		thisformset.formAging.cmdClose.Caption=GetLangText("AR","TB_CLOSE")
		
		* Print Statement
		thisformset.formPrintStatements.Caption=GetLangText("AR","TW_PRTSTMT")
		thisformset.formPrintStatements.lBillDate.Caption=GetLangText("AR","T_BILLDATE")
		thisformset.formPrintStatements.chIncludeUnallocated.Caption=GetLangText("AR","T_INCLUNALLOC")
		thisformset.formPrintStatements.cmdCancel.Caption=GetLangText("AR","TB_CANCEL")
		thisformset.formPrintStatements.cmdOK.Caption=GetLangText("AR","TB_OK")
		
		* Transfer
		IF this.lCreditors
			thisformset.formTransfer.Caption=GetLangText("AR","TW_TRANSFER_CREDITOR")
			thisformset.formTransfer.lAccount.caption=GetLangText("AR","TXT_CREDITOR_ACCOUNT")
		ELSE
			thisformset.formTransfer.Caption=GetLangText("AR","TW_TRANSFER")
			thisformset.formTransfer.lAccount.caption=GetLangText("AR","T_ACCOUNT")
		ENDIF
		thisformset.formTransfer.cmdOK.Caption=GetLangText("AR","TB_OK")
		thisformset.formTransfer.cmdCancel.Caption=GetLangText("AR","TB_CANCEL")
		
		* Allocate
		thisformset.formAllocate.Caption=GetLangText("AR","TW_ALLOC")
		thisformset.formAllocate.ltext.Caption=GetLangText("AR","T_INFOALLOC")
		thisformset.formAllocate.lbillnr.Caption=GetLangText("AR","T_BILLNUMBER")
		thisformset.formAllocate.cmdCancel.caption=GetLangText("AR","TB_CANCEL")
		thisformset.formAllocate.cmdoK.Caption=GetLangText("AR","TB_OK")
		
		* Pay
		thisformset.formPay.Caption=GetLangText("AR","TW_PAY")
		thisformset.formPay.ldate.Caption=GetLangText("AR","T_DATE")
		thisformset.formPay.lbelgdate.Caption=GetLangText("AR","T_BEGDATE")
		thisformset.formPay.lpaymethod.Caption=GetLangText("AR","T_PAYMETHOD")
		thisformset.formPay.lrate.Caption=GetLangText("AR","T_RATE")
		thisformset.formPay.lamount.Caption=GetLangText("AR","T_AMOUNT")
		thisformset.formPay.lreference.Caption=GetLangText("AR","T_REFERENCE")
		thisformset.formPay.chUnallocated.Caption=GetLangText("AR","T_UNALLOC")
		thisformset.formPay.chPayAllMarked.Caption=GetLangText("AR", "T_MARKED")
		thisformset.formPay.cmdCancel.Caption=GetLangText("AR","TB_CANCEL")
		thisformset.formPay.cmdOK.Caption=GetLangText("AR","TB_OK")
		
		* Post search
		IF this.lCreditors
			thisformset.formsearchpost.Caption=GetLangText("AR","TW_CREDITOR_SEARCH")
		ELSE
			thisformset.formsearchpost.Caption=GetLangText("AR","TW_SEARCH")
		ENDIF
		thisformset.formsearchpost.lfield.Caption=GetLangText("AR","TW_FIELD")
		thisformset.formsearchpost.lvalue.Caption=GetLangText("AR","TW_VALUE")
		thisformset.formsearchpost.lfindNext.Caption=GetLangText("AR","TW_FIND_NEXT")
		thisformset.formsearchpost.lFindPrevious.Caption=GetLangText("AR","TW_FIND_PREV")
		thisformset.formsearchpost.chExactSearch.Caption=GetLangText("AR","TW_EXACT_SEARCH")
		thisformset.formsearchpost.cmdCancel.Caption=GetLangText("AR","TB_CANCEL")
		thisformset.formsearchpost.cmdOK.Caption=GetLangText("AR","TB_OK")
		
		* Print Commatnd
		this.FormPrint.Caption = GetLangText("AR","TXT_PRINT")
		this.FormPrint.OGPrintType.Option1.Caption = GetLangText("AR","TXT_PRN_STATEMENT")
		this.FormPrint.OGPrintType.Option2.Caption = GetLangText("AR","TXT_PRN_BILL_COPY")
		this.FormPrint.OGPrintType.Option3.Caption = GetLangText("AR","TXT_PRN_POSTINGS")
		this.FormPrint.cmdPrint.Caption = GetLangText("AR","TB_PRINT")
		this.FormPrint.cmdCancel.Caption = GetLangText("AR","TB_CANCEL")
	ENDPROC

	PROCEDURE msetcontrolsource		&& Set control souce for all objects
		LOCAL cTmp,laFields, l_cMacro
		DECLARE laFields(1)
		
		IF this.lCreditors
			SET FILTER TO ac_credito IN aracct
		ELSE
			SET FILTER TO NOT ac_credito IN aracct
		ENDIF
		
		l_cMacro = "IIF(EMPTY(aracct.ac_apid),LTRIM(TRIM(address.ad_title)+' '+TRIM(address.ad_fname)+' '+Flip(address.ad_lname)),"+;
			"LTRIM(TRIM(apartner.ap_title)+' '+TRIM(apartner.ap_fname)+' '+Flip(apartner.ap_lname)))"
		thisformset.formARAccounts.gdaraccounts.RecordSource='aracct'
		thisformset.formARAccounts.gdaraccounts.cbalance.ControlSource='thisformset.mgetgrdbalance()'
		thisformset.formARAccounts.gdaraccounts.ccompkey.ControlSource='address.ad_compkey'
		thisformset.formARAccounts.gdaraccounts.cfirma.ControlSource='address.ad_company'
		thisformset.formARAccounts.gdaraccounts.ckonto.ControlSource='aracct.ac_aracct'
		thisformset.formARAccounts.gdaraccounts.cname.ControlSource=l_cMacro
		thisformset.formARAccounts.gdaraccounts.crem0.ControlSource='thisformset.mgetgrdrem0()'
		thisformset.formARAccounts.gdaraccounts.crem1.ControlSource='thisformset.mgetgrdrem1()'
		thisformset.formARAccounts.gdaraccounts.crem2.ControlSource='thisformset.mgetgrdrem2()'
		thisformset.formARAccounts.gdaraccounts.crem3.ControlSource='thisformset.mgetgrdrem3()'
		IF NOT this.lForbidenRem4
			thisformset.formARAccounts.gdaraccounts.crem4.ControlSource='thisformset.mgetgrdrem4()'
		ENDIF
		thisformset.formARAccounts.gdaraccounts.disputed.ControlSource='thisformset.mgetdisputed()'
		thisformset.formARAccounts.gdaraccounts.cfreepayments.ControlSource='thisformset.mgetfreepayments()'
		thisformset.formARAccounts.gdaraccounts.cinactiv.ControlSource='thisformset.mgetinactive(aracct.ac_inactiv)'
		thisformset.formARAccounts.gdaraccounts.cselrem.ControlSource=[thisformset.mgetarremaindernumber()]
		thisformset.formARAccounts.gdaraccounts.cselpaycond.ControlSource=[thisformset.mgetarconditionnumber()]
		
		thisformset.formARAccounts.ogkontofilter.Value=1
		thisformset.formARAccounts.ogpostfilter.Value=1
		thisformset.formARAccounts.ogpostfilter.ControlSource='thisformset.nposfilter'
		
		thisformset.ccontact = ""
		
		* search form
		thisformset.formSearch.cbfield.RowSourceType= 1
		thisformset.formSearch.cbField.RowSource=GetLangText("AR","T_ACCOUNT")+','+;
													  GetLangText("AR","T_COMPANY")+','+;
													  GetLangText("AR","T_CONTACT")+;
													  ' ('+GetLangText("ADDRESS","TXT_LASTNAME")+')'+','+;
													  GetLangText("AR","T_COMPKEY")+','+;
													  GetLangText("AR","T_BILLNUMBER")
		thisformset.formSearch.cbField.ControlSource='thisformset.pnField'
		thisformset.formSearch.tbValue.ControlSource='thisformset.pcValue'
		thisformset.formSearch.chExactSearch.ControlSource='thisformset.plExactSearch'
		
		* postings form
		thisformset.formPosting.tbdebitor.ControlSource='aracct.ac_aracct'
		thisformset.formPosting.tbfirma.ControlSource='thisformset.ccompany'
		thisformset.formPosting.tbname.ControlSource='thisformset.ccontact'
		thisformset.formPosting.tbcredit.ControlSource='thisformset.ncredit'
		thisformset.formPosting.tbdebit.ControlSource='thisformset.ndebit'
		thisformset.formPosting.tbbalance.ControlSource='thisformset.nbalance'
		thisformset.formPosting.tbbalancemarked.ControlSource='thisformset.nbalancemarked'
		thisformset.formPosting.tbpaymentsMarked.ControlSource='thisformset.npaymentsmarked'
		thisformset.formPosting.tbsearch.ControlSource='thisformset.csearch'
		thisformset.formPosting.ogpostfilter.ControlSource='thisformset.nposfilter'
		thisformset.formPosting.ogsearchfield.ControlSource='thisformset.nsearchfield'
		thisformset.formPosting.tbRemKeyNo.ControlSource='arremd.am_number'
		thisformset.formPosting.tbRemKeyDescript.ControlSource='arremd.am_label'
		thisformset.formPosting.tbRemCondNo.ControlSource='arpcond.ay_number'
		thisformset.formPosting.tbRemCondDescript.ControlSource='arpcond.ay_label'
		
		SELECT ARPOST
		=AFIELDS(laFields)
		CREATE CURSOR carpost FROM ARRAY laFields
		ALTER TABLE carpost ADD cap_marker  L
		ALTER TABLE carpost ADD cap_rn      I
		ALTER TABLE carpost ADD cap_balanc B
		ALTER TABLE carpost ADD cap_disbal B && Disputed balance
		ALTER TABLE carpost ADD cap_headid N (8)
		ALTER TABLE carpost ADD cap_billst C (50)
		
		INDEX ON STR(ap_headid, 8)+IIF(ap_headid=ap_lineid,'A','B') + DTOS(ap_date) +STR(ap_lineid, 8) TAG TAG1
		INDEX ON STR(ap_headid, 8)+IIF(ap_headid=ap_lineid,'A','B') + ap_billnr + DTOS(ap_date) +STR(ap_lineid, 8) TAG TAG2 DESCENDING
		INDEX ON DTOS(ap_date) TAG TAG3 DESCENDING
		INDEX ON DTOS(ap_belgdat) TAG TAG4 DESCENDING
		INDEX ON ap_debit  TAG TAG5 DESCENDING
		INDEX ON ap_credit TAG TAG6 DESCENDING
		INDEX ON UPPER(ap_ref) TAG TAG7 DESCENDING
		
		SET ORDER TO TAG1 IN cArPost
		
		thisformset.formPosting.gdpostings.RecordSource='carpost'
		thisformset.formPosting.gdpostings.cbillno.ControlSource='carpost.ap_billnr'
		thisformset.formPosting.gdpostings.cdate.ControlSource='carpost.ap_date'
		thisformset.formPosting.gdpostings.cbelgdat.ControlSource='carpost.ap_belgdat'
		thisformset.formPosting.gdpostings.cpaynum.ControlSource='carpost.ap_paynum + carpost.ap_artinum'
		thisformset.formPosting.gdpostings.cdebit.ControlSource='carpost.ap_debit'
		thisformset.formPosting.gdpostings.ccredit.ControlSource='carpost.ap_credit'
		thisformset.formPosting.gdpostings.cbalance.ControlSource='IIF(carpost.ap_headid=carpost.ap_lineid .OR. '+;
			'carpost.ap_headid=0,TRANSFORM(carpost.cap_balanc,RIGHT(gcCurrcydisp, 12)),"")'
		thisformset.formPosting.gdpostings.creference.ControlSource='carpost.ap_ref'
		thisformset.formPosting.gdpostings.cdispute.controlsource= ;
			'Iif(ArAccount("ArIsDisputed", carpost.ap_dispute, carpost.ap_disdate), GetLangText("AR", "T_YES"), GetLangText("AR", "T_NO"))'
		thisformset.formPosting.gdpostings.cmark.ControlSource='carpost.cap_marker'
		thisformset.formPosting.gdpostings.cremeinderlevel.ControlSource = 'carpost.ap_remlev'
		thisformset.formPosting.gdpostings.clastremainder.ControlSource = 'carpost.ap_remlast'
		thisformset.formPosting.gdpostings.cduedat.ControlSource = 'carpost.ap_duedat'
		thisformset.formPosting.gdpostings.ccollectagent.ControlSource = 'carpost.ap_colagnt'
		thisformset.formPosting.gdpostings.cdisuputeduntil.ControlSource = 'carpost.ap_disdate'
		thisformset.formPosting.gdpostings.cbillstatus.ControlSource = 'carpost.cap_billst'
		
		thisformset.formPosting.gdpostings.SetAll('readonly',.t.)
		IF TYPE("this.formposting.gdpostings.cmark")<>"U"
			thisformset.formPosting.gdpostings.cmark.ReadOnly=.f.
		ENDIF
		*thisformset.formPosting.gdpostings.SetAll( 'Movable', .F., 'COLUMN' )
		
		* Pay form
		thisformset.formPay.cbpaymethod.ControlSource='thisformset.npaynum'
		thisformset.formPay.tbrate.ControlSource='thisformset.ndisprate'
		thisformset.formPay.tbamount.ControlSource='thisformset.namt'
		thisformset.formPay.tbreference.ControlSource='thisformset.cref'
		thisformset.formPay.chUnallocated.ControlSource='thisformset.lunalloc'
		thisformset.formPay.chPayAllMarked.ControlSource='thisformset.lpayall'
		cTmp='pm_lang'+g_langnum
		SELECT pm_paynum,&cTmp AS pm_lang,IIF(paymetho.pm_paytyp = 2, STR(paymetho.pm_rate,12,6), SPACE(12) ) AS disprate,pm_rate, ;
			pm_calcrat, pm_paytyp ;
			FROM paymetho ;
			WHERE INLIST(pm_paytyp, 1, 2, 7) AND NOT INLIST(pm_paynum, param.pa_payonld, param.pa_rndpay) AND NOT pm_inactiv AND pm_aronly ;
			INTO CURSOR cpaymetho ;
			ORDER BY pm_paynum
		thisformset.formPay.cbpaymethod.RowSource='cpaymetho.pm_paynum,pm_lang,disprate'
		
		* Post search form
		thisformset.formsearchpost.cbfield.RowSourceType= 1
		thisformset.formsearchpost.cbField.RowSource=GetLangText("AR","T_BILLNR")+','+GetLangText("AR","T_DATE")+','+GetLangText("AR","T_CREDIT")+','+GetLangText("AR","T_DEBIT")+','+GetLangText("AR","T_REFERENCE")
		thisformset.formsearchpost.cbField.ControlSource='thisformset.pnField'
		thisformset.formsearchpost.tbValue.ControlSource='thisformset.pcValue'
		thisformset.formsearchpost.chExactSearch.ControlSource='thisformset.plExactSearch'
		
		this.formPosting.tbRemLev1.ControlSource = 'thisformset.aRemLevBalance(1)'
		this.formPosting.tbRemLev2.ControlSource = 'thisformset.aRemLevBalance(2)'
		this.formPosting.tbRemLev3.ControlSource = 'thisformset.aRemLevBalance(3)'
		IF NOT this.lForbidenRem4
			this.formPosting.tbRemLev4.ControlSource = 'thisformset.aRemLevBalance(4)'
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE msetgriddynamiccolor		&& Sets Grids Dynamic colors
		LOCAL lcBackColor
		IF _screen.oglobal.oparam2.pa_vodebch
			* Mark red when some balanced debitor is not deleted, becouse of voucher which is not used.
			lcBackColor = 'IIF(carpost.ap_headid=carpost.ap_lineid, IIF(carpost.ap_vblock,rgb(255,130,130),rgb(0,255,255)),'
		ELSE
			lcBackColor = 'IIF(carpost.ap_headid=carpost.ap_lineid, rgb(0,255,255),'
		ENDIF
		lcBackColor = lcBackColor + 'IIF(carpost.ap_headid=0,65535,RGB(255,255,255)))'
		thisformset.formPosting.gdpostings.SetAll( 'DynamicBackColor', lcBackColor, 'COLUMN' )
		thisformset.formPosting.gdpostings.SetAll( 'DynamicForeColor', 'RGB(0,0,0)', 'COLUMN' )
	ENDPROC

	PROCEDURE msetmark
		LPARAMETERS lp_nMarked, lp_lDontMark
		LOCAL l_cCurLocal, l_nRecNo, l_nMarkedRecords
		l_nMarkedRecords = 0
		l_cCurLocal = "carpost"
		l_nRecNo = RECNO(l_cCurLocal)
		this.FormPosting.cmdOK.SetFocus()
		COUNT FOR cap_marker TO l_nMarkedRecords
		GO l_nRecNo IN &l_cCurLocal
		this.FormPosting.gdpostings.nrecno = RECNO(l_cCurLocal)
		IF l_nMarkedRecords = 0 AND NOT lp_lDontMark
			lp_nMarked = 1
			REPLACE cap_marker WITH .T. IN &l_cCurLocal
		ELSE
			lp_nMarked = l_nMarkedRecords
		ENDIF
		this.FormPosting.gdpostings.SetFocus()
		RETURN .T.
	ENDPROC

	PROCEDURE msetorderoncarpost		&& Sets order on Carpost cursor, when doble clicked on heador of column in gdpostings
		LPARAMETERS pcTag, pcHeaderCaption
		LOCAL lnRecno, i
		lnRecno = RECNO('carpost')
		FOR i = 1 TO this.formPosting.gdpostings.ColumnCount
			this.formPosting.gdpostings.Columns(i).header1.caption = STRTRAN(this.formPosting.gdpostings.Columns(i).header1.caption, "\", "")
			this.formPosting.gdpostings.Columns(i).header1.caption = STRTRAN(this.formPosting.gdpostings.Columns(i).header1.caption, "/", "")
		NEXT i
		pcHeaderCaption = STRTRAN(pcHeaderCaption, "\", "")
		pcHeaderCaption = STRTRAN(pcHeaderCaption, "/", "")
		pcHeaderCaption = ALLTRIM(pcHeaderCaption)
		
		IF DESCENDING(pcTag, 'carpost')
			SET ORDER TO pcTag IN carpost ASCENDING
			pcHeaderCaption = pcHeaderCaption + " /\"
		ELSE
			SET ORDER TO pcTag IN carpost DESCENDING
			pcHeaderCaption = pcHeaderCaption + " \/"
		ENDIF
		GOTO TOP IN carpost
		this.formPosting.gdpostings.Refresh()
		GO lnRecno IN carpost
		this.formPosting.gdpostings.SetFocus()
		
		RETURN pcHeaderCaption
		
	ENDPROC

	PROCEDURE mstatement		&& Print statement
		thisformset.formPosting.Enabled=.f.
		thisformset.formPrintStatements.dbfrom.Value={}
		thisformset.formPrintStatements.dbto.Value={}
		thisformset.formPrintStatements.chIncludeUnallocated.Value=.f.
		thisformset.formPrintStatements.Show
		thisformset.formPrintStatements.dbfrom.SetFocus
		
	ENDPROC

	PROCEDURE mtransfer		&& Call transfer form
		thisformset.formTransfer.tbaccount.Value=0
		thisformset.formPosting.Enabled=.f.
		thisformset.formTransfer.Show
		thisformset.formTransfer.tbaccount.setfocus
	ENDPROC

	PROCEDURE mtransferbill		&& Transfer bill from account to another account
		LOCAL nAracct, l_cFilter
		naracct=aracct.ac_aracct
		GO carpost.cap_rn IN arpost
		DO arapTransfer IN araccount WITH thisformset.formTransfer.tbaccount.Value
		=TABLEUPDATE(.t.,.t.,'arpost')
		l_cFilter = FILTER('aracct')
		SET FILTER TO IN aracct
		=SEEK(naracct,'aracct','tag1')
		thisformset.formPosting.Enabled=.t.
		thisformset.mgetpostings
		thisformset.formPosting.Refresh
		thisformset.formTransfer.Hide
		SET FILTER TO &l_cFilter IN aracct
	ENDPROC

	PROCEDURE mupdatearpost
		LPARAMETERS lp_nAp_PostId
		LOCAL l_nReserId, l_nWindow, l_cBillNum, l_lRecordUpdated, l_nDpReceipt, l_cDpReceipt
		IF NOT EMPTY(lp_nAp_PostId)
			l_lRecordUpdated = .F.
			l_nReserId = 0
			l_nWindow = 0
			l_cBillNum = ""
			l_nDpReceipt = 0
			l_cDpReceipt = ""
			IF SEEK(lp_nAp_PostId,"post","tag3")
				l_nWindow = post.ps_window
				IF l_nWindow > 0 AND SEEK(post.ps_reserid,"reservat","tag1")
					l_nReserId = reservat.rs_reserid
					l_cBillNum = FNGetBillData(reservat.rs_reserid, l_nWindow, "bn_billnum")
					l_nDpLineId = dlookup("deposit","dp_postid= " + sqlcnv(lp_nAp_PostId),"dp_headid")
					IF l_nDpLineId > 0
						l_nDpReceipt = dlookup("deposit","dp_lineid = " + sqlcnv(l_nDpLineId),"dp_receipt")
						l_cDpReceipt = TRANSFORM(l_nDpReceipt)
					ENDIF
				ENDIF
			ELSE
				IF SEEK(lp_nAp_PostId,"histpost","tag3")
					l_nWindow = histpost.hp_window
					IF l_nWindow > 0 AND SEEK(histpost.hp_reserid,"histres","tag1")
						l_nReserId = histres.hr_reserid
						IF l_nReserId = 0.100 && PasserBy
							l_cBillNum = histpost.hp_billnum
						ELSE
							l_cBillNum = FNGetBillData(histres.hr_reserid, l_nWindow, "bn_billnum")
							l_nDpLineId = dlookup("hdeposit","dp_postid= " + sqlcnv(lp_nAp_PostId),"dp_headid")
							IF l_nDpLineId > 0
								l_nDpReceipt = dlookup("hdeposit","dp_lineid = " + sqlcnv(l_nDpLineId),"dp_receipt")
								l_cDpReceipt = TRANSFORM(l_nDpReceipt)
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
			IF NOT EMPTY(l_nReserId)
				l_nRecno = RECNO("arpost")
				IF SEEK(lp_nAp_PostId,"arpost","tag4")
					IF arpost.ap_reserid <> l_nReserId
						REPLACE ap_reserid WITH l_nReserId IN arpost
						REPLACE ap_reserid WITH l_nReserId IN cTmpArpost
						l_lRecordUpdated = .T.
					ENDIF
					IF l_nDpReceipt > 0
						IF ALLTRIM(arpost.ap_billnr) <> l_cDpReceipt
							REPLACE ap_billnr WITH l_cDpReceipt IN arpost
							REPLACE ap_billnr WITH l_cDpReceipt IN cTmpArpost
							l_lRecordUpdated = .T.
						ENDIF
					ELSE
						IF arpost.ap_billnr <> l_cBillNum
							REPLACE ap_billnr WITH l_cBillNum IN arpost
							REPLACE ap_billnr WITH l_cBillNum IN cTmpArpost
							l_lRecordUpdated = .T.
						ENDIF
					ENDIF
					IF l_lRecordUpdated
						=TABLEUPDATE(.F.,.T.,'arpost')
					ENDIF
				ENDIF
				GO l_nRecno IN arpost
			ENDIF
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE mupdatetable
		LPARAMETERS lp_cTable, lp_cField, lp_nId
		LOCAL l_lSuccess
		IF dlocate(lp_cTable, lp_cField + " = " + sqlcnv(lp_nId))
			= TABLEUPDATE(0,.T.,lp_cTable)
			FLUSH
			l_lSuccess = .T.
		ENDIF
		
		RETURN l_lSuccess
		
	ENDPROC

	PROCEDURE onaddress		&& Call addressmask from toolbar
		LOCAL ARRAY LArray(12)
		
		LArray(1) = "EDITAR"
		LArray(2) = ""
		LArray(3) = 1
		LArray(4) = "ARAA"
		LArray(5) = RECNO("address")
		LArray(6) = 0
		LArray(7) = 13
		LArray(12) = .T.
		doform('addressmask','forms\addressmask','',.T.,@LArray)
		
		RETURN .T.
	ENDPROC

	PROCEDURE onclose		&& Close A/R account form and exit
		LOCAL i
		
		FOR i = this.FormCount TO 1 STEP -1
		     this.Forms(i).Release()
		NEXT
		*this.Release()		&& C0005 error on ESC pressed
	ENDPROC

	PROCEDURE onfind		&& Find (OK button, Search form)
		LOCAL lcField,lcExp,l_lFound,lcExact, l_nErrorCode
		lcExact=SET("Exact")
		SET EXACT OFF 
		lcField=''
		lcExp=''
		DO CASE
			CASE thisformset.pnfield=1
				lcField='aracct.ac_aracct'
			CASE thisformset.pnfield=2
				lcField='address.ad_company'
			CASE thisformset.pnfield=3
				lcField='IIF(EMPTY(aracct.ac_apid),address.ad_lname,apartner.ap_lname)'
			CASE thisformset.pnfield=4
				lcField='address.ad_compkey'
		ENDCASE
		
		IF thisformset.pnfield=5 &&Search for BillNr in arpost.dbf
			l_nErrorCode = this.mSearchBillNr(this.pcvalue)
		ELSE
			IF thisformset.plexactsearch
				lcExp='UPPER(PADR('+lcField+',30))="'+UPPER(ALLTRIM(padr(thisformset.pcvalue,30)))+'" .AND. !EMPTY('+lcField+')'
			ELSE
				lcExp='OCCURS("'+UPPER(ALLTRIM(PADR(thisformset.pcvalue,30)))+'",UPPER(ALLTRIM(PADR('+lcField+',30))))>0'
			ENDIF
			l_nErrorCode = this.FormARAccounts.oSearchHandlerAracct.Find("aracct", lcExp)
		ENDIF
		
		SET EXACT &lcExact
		thisformset.pnField = 1
		thisformset.pcValue = ''
		thisformset.formARAccounts.Enabled=.t.
		thisformset.formSearch.Hide
		this.formARAccounts.gdaraccounts.SetFocus()
		DO CASE
			CASE l_nErrorCode = -1
				Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
			CASE l_nErrorCode = 1
				IF thisformset.pnfield=5	&& If BillNr Founded in arpost.dbf, with function mSearchBillNr, then go to postings grid
					this.OnPostings()
					SELECT carpost
					LOCATE FOR carpost.ap_billnr = ALLTRIM(this.pcvalue)
					this.formPosting.gdpostings.SetFocus()
				ENDIF
		ENDCASE
	ENDPROC

	PROCEDURE onpostings		&& Open postings grid
		this.formaraccounts.Enabled = .F.
		this.naracct = aracct.ac_aracct
		this.refresharconditions()
		this.ccompany = LEFT(address.ad_company, 30)
		this.ccontact = LEFT(IIF(EMPTY(aracct.ac_apid), address.ad_lname, apartner.ap_lname), 30)
		this.mgetpostings()
		this.formposting.gdpostings.Refresh()
		this.formposting.Show()
		IF TYPE("this.formposting.gdpostings.cbillno")<>"U"
			this.formposting.gdpostings.cbillno.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE refresharconditions
		LOCAL l_nAmid, l_nAyid
		l_nAmid = MAX(1, aracct.ac_amid)
		l_nAyid = MAX(1, aracct.ac_ayid)
		IF NOT SEEK(l_nAmid,"arremd","tag1")
			GO BOTTOM IN arremd
			SKIP 1 IN arremd
		ENDIF
		IF NOT SEEK(l_nAyid,"arpcond","tag1")
			GO BOTTOM IN arpcond
			SKIP 1 IN arpcond
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE Unload
		DODEFAULT()
		
		DO ArSetStatusLine IN ar
	ENDPROC

	PROCEDURE FormAging.cmdClose.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormAging.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormAging.onclose
		this.Hide()
		thisformset.formPosting.Enabled = .T.
	ENDPROC

	PROCEDURE FormAging.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormAllocate.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormAllocate.cmdOK.Click
		thisformset.mallocatepayment
	ENDPROC

	PROCEDURE FormAllocate.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormAllocate.onclose
		thisformset.formPosting.Enabled = .T.
		this.Hide()
	ENDPROC

	PROCEDURE FormAllocate.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormARAccounts.findnext
		LOCAL l_cExact
		
		l_cExact = SET("Exact")
		SET EXACT OFF 
		
		IF -1 = this.oSearchHandlerAracct.FindNext()
			Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
		ENDIF
		
		SET EXACT &l_cExact
		
		this.gdaraccounts.Refresh()
	ENDPROC

	PROCEDURE FormARAccounts.findprev
		LOCAL l_cExact
		
		l_cExact = SET("Exact")
		SET EXACT OFF 
		
		IF -1 = this.oSearchHandlerAracct.FindPrevious()
			Alert(GetLangText("AR","T_FIELD_NOT_FOUND"))
		ENDIF
		
		SET EXACT &l_cExact
		
		this.gdaraccounts.Refresh()
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.AfterRowColChange
		LPARAMETERS nColIndex
		
		* Prevent error when closing form
		IF TYPE("thisform.tbkonto.Value")="U"
			RETURN .T.
		ENDIF
		
		LOCAL l_cToolTipText, l_cParameterMode
		DODEFAULT()
		thisform.tbkonto.Value=aracct.ac_aracct
		thisform.tbkonto.Refresh
		l_cParameterMode = "ACCOUNTS"
		l_cToolTipText = thisformset.mgettooltip(l_cParameterMode)
		this.tooltiptext = l_cToolTipText
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.cbalance.Tbgrid1.When
		DODEFAULT()
		IF INLIST(LASTKEY(),9,15)
			RETURN .f.
		endif
		
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.ccompkey.Tbgrid1.When
		DODEFAULT()
		IF INLIST(LASTKEY(),9,15)
			RETURN .f.
		endif
		
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.cfirma.Tbgrid1.When
		DODEFAULT()
		IF INLIST(LASTKEY(),9,15)
			RETURN .f.
		endif
		
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.ckonto.Header1.DblClick
		LOCAL l_cHeaderCaption, l_nRecno
		
		l_nRecno = RECNO('aracct')
		l_cHeaderCaption = this.Caption
		l_cHeaderCaption = STRTRAN(l_cHeaderCaption, "\", "")
		l_cHeaderCaption = STRTRAN(l_cHeaderCaption, "/", "")
		l_cHeaderCaption = ALLTRIM(l_cHeaderCaption)
		
		IF DESCENDING(1, "aracct")
			SET ORDER TO "tag1" IN aracct ASCENDING
			l_cHeaderCaption = l_cHeaderCaption + " /\"
		ELSE
			SET ORDER TO "tag1" IN aracct DESCENDING
			l_cHeaderCaption = l_cHeaderCaption + " \/"
		ENDIF
		
		this.Caption = l_cHeaderCaption
		
		GOTO TOP IN aracct
		this.parent.parent.Refresh()
		GO l_nRecno IN aracct
		this.parent.parent.SetFocus()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.ckonto.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		DO CASE
		CASE nkeycode=9 AND nShiftAltCtrl = 0 && TAB
			KEYBOARD '{DNARROW}'
			SKIP 1 IN ARACCT
			IF EOF('ARACCT')
				SKIP -1 IN ARACCT
				NODEFAULT
			ELSE
				SKIP -1 IN ARACCT
			ENDIF
		CASE nkeycode=15 AND nShiftAltCtrl = 1 && SHIFT+TAB
			KEYBOARD '{UPARROW}'
			SKIP -1 IN ARACCT
			IF BOF('ARACCT')
				SKIP 1 IN ARACCT
				KEYBOARD '{DNARROW}'		
				thisform.tbkonto.SetFocus
				NODEFAULT
			ELSE
				SKIP 1 IN ARACCT
			ENDIF
		OTHERWISE
			DODEFAULT(nKeyCode, nShiftAltCtrl)
		ENDCASE
		
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.cname.Tbgrid1.When
		DODEFAULT()
		IF INLIST(LASTKEY(),9,15)
			RETURN .f.
		endif
		
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.DblClick
		thisformset.OnPostings()
	ENDPROC

	PROCEDURE FormARAccounts.gdaraccounts.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		
		DODEFAULT()
	ENDPROC

	PROCEDURE FormARAccounts.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		
		this.gdaraccounts.Init(.T.)
		
		DODEFAULT()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormARAccounts.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		LOCAL l_nRow, l_nCol
		
		DO CASE
			CASE nKeyCode = 127 AND nShiftAltCtrl = 2	&& Ctrl+H	- ToolTipText
				l_nRow = this.gdaraccounts.Top + this.gdaraccounts.HeaderHeight + 2*this.gdaraccounts.GridLineWidth + ;
					(this.gdaraccounts.RelativeRow-0.5) * this.gdaraccounts.RowHeight - 1
				l_nCol = MCOL(this.Name,3)
				IF NOT BETWEEN(l_nCol, this.gdaraccounts.Left, this.gdaraccounts.Left+this.gdaraccounts.Width)
					l_nCol = this.gdaraccounts.Left + this.gdaraccounts.Width/2
				ENDIF
				MOUSE AT l_nRow, l_nCol PIXELS WINDOW "FormPosting"
				FoxGUI_ShowToolTip(this.gdaraccounts, thisform, 0, 0, 0)
				NODEFAULT
			CASE nKeyCode = 68 AND nShiftAltCtrl = 1	&& Shift+D
				thisform.tbkonto.SetFocus()
				NODEFAULT
			OTHERWISE
				DODEFAULT(nKeyCode, nShiftAltCtrl)
		ENDCASE
	ENDPROC

	PROCEDURE FormARAccounts.ogkontofilter.InteractiveChange
		IF this.Value=1
			IF thisformset.lCreditors
				SET FILTER TO ac_credito IN aracct
			ELSE
				SET FILTER TO NOT ac_credito IN aracct
			ENDIF
		ELSE
			IF thisformset.lCreditors
				SET FILTER TO ArActBal(aracct.ac_aracct,.t.)<>0 AND ac_credito IN aracct
			ELSE
				SET FILTER TO ArActBal(aracct.ac_aracct,.t.)<>0 AND NOT ac_credito IN aracct
			ENDIF
		ENDIF
		
		thisform.gdaraccounts.SetFocus()
		
	ENDPROC

	PROCEDURE FormARAccounts.onclose
		thisformset.OnClose()
	ENDPROC

	PROCEDURE FormARAccounts.ondelete
		IF yeSno(stRfmt(GetLangText("AR","TA_ACCTDEL")+'@2',aracct.ac_aracct,ALLTRIM(address.ad_Company)))
			IF dlOokup('ArPost','ap_aracct = '+sqLcnv(aracct.ac_aracct),'ap_lineid')=0
				SELECT arAcct
				DELETE
				thisformset.Refresh()
			ELSE
				= alErt(GetLangText("AR","TA_DELNOTPOSS"))
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE FormARAccounts.onedit
		IF thisformset.lCreditors
			DO FORM forms\arcreditoredit WITH "EDIT", this, 0
		ELSE
			DO FORM forms\araccedit WITH "EDIT", this, 0
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormARAccounts.onnew
		IF thisformset.lCreditors
			DO FORM forms\arcreditoredit WITH "NEW", this, 0
		ELSE
			DO FORM forms\araccedit WITH "NEW", this, 0
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormARAccounts.onprint
		*DO ArPrint IN ArAccount
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormARAccounts.onsearch
		this.Enabled = .F.
		thisformset.FormSearch.Show()
		thisformset.FormSearch.cbField.SetFocus()
	ENDPROC

	PROCEDURE FormARAccounts.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormARAccounts.tbkonto.LostFocus
		LOCAL lcMessage, lnRecno, lnValue
		lnValue = IIF(EMPTY(this.Value), 0, this.Value)
		lcMessage = GetLangText("AR","TA_NOACCT")
		lcMessage = STRTRAN(lcMessage, "%s1", ALLTRIM(STR(lnValue)))
		lnRecno = RECNO('aracct')
		IF NOT EMPTY(lnValue)
			IF !SEEK(lnValue,'aracct','tag1')
				GO lnRecno IN aracct
				=alert(lcMessage)
			ENDIF
		ENDIF
		
		RETURN
	ENDPROC

	PROCEDURE FormPay.cbpaymethod.Valid
		LOCAL cTmp
		LOCAL LOk
		IF !EMPTY(this.DisplayValue)
			FOR i = 1 TO this.ListCount
				IF ALLTRIM(UPPER(this.DisplayValue)) == ALLTRIM(UPPER(this.List(i,1)))
					*this.ListIndex = i
					LOk = .T.
					EXIT
				ENDIF
			NEXT
		ELSE
			LOk = .F.
		ENDIF
		IF !LOk
			KEYBOARD '{ALT+DNARROW}'
			RETURN 0
		ENDIF
		
		thisformset.npaynum = cpaYmetho.pm_paynum
		thisformset.ndisprate = IIF(EMPTY(cpaYmetho.pm_rate) .OR. cpaYmetho.pm_paynum=1,1.00, cpaYmetho.pm_rate)
		thisformset.nCalcrate = cpaYmetho.pm_calcrat
		thisformset.nAmt = ROUND(thisformset.nbalancemarked/thisformset.nCalcrate, paRam.pa_currdec)
		thisformset.nMaxAmt=thisformset.namt
		thisformset.ndefamt=thisformset.namt
		thisformset.formPay.lsaypaymethod.Caption=cpaymetho.pm_lang
		
		thisformset.formPay.Refresh
	ENDPROC

	PROCEDURE FormPay.chUnallocated.Valid
		IF this.Value
			thisform.CHPayAllMarked.Enabled=.F.
			thisformset.LPayall=.F.
		ELSE
			IF thisformset.lmarked
				thisform.chPayAllMarked.Enabled=.t.
				thisformset.lpayall=.f.
			ENDIF
		ENDIF
		thisform.Refresh
	ENDPROC

	PROCEDURE FormPay.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormPay.cmdOK.Click
		thisformset.mpaypostment()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormPay.dbbelgdate.LostFocus
		thisformset.dap_belgdate=this.Value
	ENDPROC

	PROCEDURE FormPay.dbdate.LostFocus
		thisformset.dap_date=this.Value
	ENDPROC

	PROCEDURE FormPay.Init
		this.dbdate.ToolTipText = ""
		DODEFAULT()
		
	ENDPROC

	PROCEDURE FormPay.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormPay.onclose
		thisformset.nbalancemarked = thisformset.FormPosting.tbbalancemarked.Value
		*LOCAL l_nRecNo, l_nBalance
		*l_nRecNo = RECNO()
		*thisformset.nbalancemarked = 0
		*SCAN ALL FOR (ap_headid = ap_lineid) .AND. cap_marker
		*	l_nBalance = arpstbal(ap_headid, 0, .F.)
		*	IF l_nBalance > 0
		*		thisformset.nbalancemarked = thisformset.nbalancemarked + l_nBalance
		*	ENDIF
		*ENDSCAN
		*GOTO l_nRecNo
		thisformset.formPosting.Enabled = .T.
		this.Hide()
	ENDPROC

	PROCEDURE FormPay.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormPay.tbamount.GotFocus
		thisformset.ndefamt=thisformset.namt
	ENDPROC

	PROCEDURE FormPay.tbamount.LostFocus
		IF thisformset.lmarked AND EMPTY(thisformset.cref)
			thisformset.cref = ALLTRIM(STR(this.Value,10,2))
		ENDIF
	ENDPROC

	PROCEDURE FormPay.tbamount.Valid
		IF thisformset.lpayall .AND. this.Value>thisformset.nmaxamt
			RETURN .f.
		ENDIF
		
	ENDPROC

	PROCEDURE FormPosting.cmdOK.Click
		thisformset.mAllPostFind
	ENDPROC

	PROCEDURE FormPosting.findnext
		thisformset.mpostfindnext()
	ENDPROC

	PROCEDURE FormPosting.findprev
		thisformset.mpostfindprevious()
	ENDPROC

	PROCEDURE FormPosting.gdpostings.AfterRowColChange
		LPARAMETERS nColIndex
		
		LOCAL l_Text, l_cParameterMode
		l_cParameterMode = "POSTINGS"
		l_Text = thisformset.mgettooltip(l_cParameterMode)
		this.tooltiptext = l_Text
		
		DODEFAULT()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cbalance.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cbelgdat.header1.DblClick
		this.Caption =thisformset.mSetOrderOnCArPost(4, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cbelgdat.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cbillno.header1.DblClick
		this.Caption = thisformset.mSetOrderOnCArPost(2, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cbillno.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.ccollectagent.Tchkgrid1.InteractiveChange
		NODEFAULT
	ENDPROC

	PROCEDURE FormPosting.gdpostings.ccredit.header1.DblClick
		this.Caption = thisformset.mSetOrderOnCArPost(6, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.ccredit.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cdate.header1.DblClick
		this.Caption =thisformset.mSetOrderOnCArPost(3, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cdate.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cdebit.header1.DblClick
		this.Caption = thisformset.mSetOrderOnCArPost(5, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cdebit.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cDispute.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cmark.Tcheckbox1.DblClick
		this.Parent.Parent.DblClick()
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cmark.Tcheckbox1.InteractiveChange
		thisformset.mmark()
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cmark.Tcheckbox1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cmark.Tcheckbox1.MouseUp
		LPARAMETERS nButton, nShift, nXCoord, nYCoord
		this.Parent.Parent.MouseUp(nButton, nShift, nXCoord, nYCoord)
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cmark.Tcheckbox1.When
		DODEFAULT()
		this.BackColor=this.Parent.Parent.cbalance.tbgrid1.SelectedBackColor
		this.ForeColor=this.Parent.Parent.cbalance.tbgrid1.SelectedForeColor
		This.Parent.Parent.nRecNo = RECNO( This.Parent.Parent.RecordSource )
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.cpaynum.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.creference.header1.DblClick
		this.Caption = thisformset.mSetOrderOnCArPost(7, this.Caption)
		RETURN
		
	ENDPROC

	PROCEDURE FormPosting.gdpostings.creference.Tbgrid1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
		 CASE nKeyCode = 9 AND nShiftAltCtrl = 0	&& TAB
		 	KEYBOARD '{CTRL+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 15 AND nShiftAltCtrl = 1	&& SHIFT + TAB
		 	KEYBOARD '{CTRL+SHIFT+TAB}'
		 	NODEFAULT
		 CASE nKeyCode = 4 AND nShiftAltCtrl = 0	&& RIGHT ARROW
			NODEFAULT
		 CASE nKeyCode = 19 AND nShiftAltCtrl = 0	&& LEFT ARROW
			NODEFAULT
		 CASE nKeyCode = 13 AND nShiftAltCtrl = 0	&& ENTER
			NODEFAULT
		 CASE nKeyCode = 32 AND nShiftAltCtrl = 0	&& SPACEBAR
			thisformset.mmark()
			NODEFAULT
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.gdpostings.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		
		DODEFAULT()
	ENDPROC

	PROCEDURE FormPosting.Init
		LPARAMETERS lp_lDoInit
		IF NOT lp_lDoInit
			RETURN .T.
		ENDIF
		
		this.gdpostings.Init(.T.)
		
		DODEFAULT()
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormPosting.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		LOCAL l_nRow, l_nCol
		
		DO CASE
			CASE nKeyCode = 127 AND nShiftAltCtrl = 2	&& Ctrl+H	- ToolTipText
				l_nRow = this.gdpostings.Top + this.gdpostings.HeaderHeight + 2*this.gdpostings.GridLineWidth+;
					(this.gdpostings.RelativeRow-0.5)*(this.gdpostings.RowHeight) - 1
				l_nCol = MCOL("FormPosting",3)
				IF NOT BETWEEN(l_nCol, this.gdpostings.Left, this.gdpostings.Left+this.gdpostings.Width)
					l_nCol = this.gdpostings.Left+this.gdpostings.Width/2
				ENDIF
				MOUSE AT l_nRow, l_nCol PIXELS WINDOW "FormPosting"
				FoxGUI_ShowToolTip(this.gdpostings, thisform, 0, 0, 0)
				NODEFAULT
			CASE nKeyCode = 83 AND nShiftAltCtrl = 1	&& Shift+S	- search text box
				thisform.tbsearch.SetFocus()
				NODEFAULT
			OTHERWISE
				DODEFAULT(nKeyCode, nShiftAltCtrl)
		ENDCASE
	ENDPROC

	PROCEDURE FormPosting.ogpostfilter.InteractiveChange
		thisformset.nposfilter=this.Value
		thisformset.mpostfilter()
		thisformset.formPosting.Refresh
		IF TYPE("this.formposting.gdpostings.cbillno")<>"U"
			thisformset.formPosting.gdpostings.cbillno.tbgrid1.SetFocus()
		ENDIF
	ENDPROC

	PROCEDURE FormPosting.onbottom
		GO BOTTOM IN aracct
		thisformset.mrefreshgridonskip()
	ENDPROC

	PROCEDURE FormPosting.onclose
		thisformset.nselectedaccount = 0 && Force balance refresh in thisformset.formARAccounts.gdaraccounts!
		this.Visible = .F.
		this.Hide()
		thisformset.formARAccounts.Enabled = .T.
		thisformset.formARAccounts.Refresh()
		thisformset.formARAccounts.gdaraccounts.SetFocus()
	ENDPROC

	PROCEDURE FormPosting.ondelete
		thisformset.mpostdelete()
	ENDPROC

	PROCEDURE FormPosting.onedit
		thisformset.mremedit()
	ENDPROC

	PROCEDURE FormPosting.onnew
		LOCAL l_oData, l_nSelect, l_lSuccess
		
		l_nSelect = SELECT()
		
		SELECT arpost
		SCATTER NAME l_oData MEMO BLANK
		DO FORM forms\arcreatebill WITH l_oData, "NEW", thisformset.lCreditors TO l_lSuccess
		IF l_lSuccess
			l_oData.ap_aracct = aracct.ac_aracct
			DO ArCreateBill IN araccount WITH l_oData
			thisformset.mGetPostings()
			dlocate("carpost","ap_lineid = " + sqlcnv(l_oData.ap_lineid))
		ENDIF
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE FormPosting.onnext
		SKIP IN aracct
		IF NOT EOF('aracct')
			thisformset.mrefreshgridonskip()
		ELSE
			SKIP -1 IN aracct
		ENDIF
	ENDPROC

	PROCEDURE FormPosting.onprevious
		IF !BOF('aracct')
			SKIP -1 IN aracct
			thisformset.mrefreshgridonskip()
		ENDIF
	ENDPROC

	PROCEDURE FormPosting.onprint
		this.Enabled = .F.
		thisformset.FormPrint.OGPrintType.Value = 1
		thisformset.FormPrint.Show()
	ENDPROC

	PROCEDURE FormPosting.onsearch
		this.Enabled = .F.
		thisformset.Formsearchpost.Show()
		thisformset.Formsearchpost.cbField.SetFocus()
	ENDPROC

	PROCEDURE FormPosting.ontop
		GO TOP IN aracct
		thisformset.mrefreshgridonskip()
	ENDPROC

	PROCEDURE FormPosting.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormPrint.Activate
		this.OGPrintType.Option2.Enabled = NOT EMPTY(carpost.ap_billnr)
		
		DODEFAULT()
	ENDPROC

	PROCEDURE FormPrint.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormPrint.cmdPrint.Click
		thisform.Hide()
		thisformset.FormPosting.Enabled = .T.
		DO CASE
		 CASE thisform.OGPrintType.Value = 1
			thisformset.mstatement()
		 CASE thisform.OGPrintType.Value = 2
			thisformset.mprintbillcopy()
		 CASE thisform.OGPrintType.Value = 3
			thisformset.mprintpostings()
		ENDCASE
	ENDPROC

	PROCEDURE FormPrint.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		* Don't do default procedure!
	ENDPROC

	PROCEDURE FormPrint.onclose
		this.Hide()
		thisformset.FormPosting.Enabled = .T.
	ENDPROC

	PROCEDURE FormPrint.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormPrintStatements.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormPrintStatements.cmdOK.Click
		thisformset.mprintstatement
	ENDPROC

	PROCEDURE FormPrintStatements.dbfrom.Valid
		IF !EMPTY(thisform.dbto.value) .and. this.Value>thisform.dbTO.Value
		*	=alert(getlangtext("AR","T_FROMDATE_MUST_BE_SMALLER_THAN_TODATE"))
			RETURN .F.
		ENDIF
		
	ENDPROC

	PROCEDURE FormPrintStatements.dbto.Valid
		IF this.Value<thisform.dbfrom.Value
		*	=alert(getlangtext("AR","T_FROMDATE_MUST_BE_SMALLER_THAN_TODATE"))
			RETURN .F.
		ENDIF
		
	ENDPROC

	PROCEDURE FormPrintStatements.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormPrintStatements.onclose
		thisformset.formPosting.Enabled = .T.
		this.Hide()
	ENDPROC

	PROCEDURE FormPrintStatements.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormSearch.cbField.LostFocus
		IF thisformset.pnfield = 5
			thisformset.plexactsearch = .T.
			thisform.chExactSearch.Refresh()
			thisform.chExactSearch.Enabled = .F.
		ELSE
			thisform.chExactSearch.Enabled = .T.
		ENDIF
	ENDPROC

	PROCEDURE FormSearch.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormSearch.cmdOK.Click
		thisformset.OnFind()
	ENDPROC

	PROCEDURE FormSearch.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormSearch.onclose
		thisformset.mSearchClose()
	ENDPROC

	PROCEDURE FormSearch.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE formsearchpost.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE formsearchpost.cmdOK.Click
		thisformset.mPostFind()
	ENDPROC

	PROCEDURE formsearchpost.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE formsearchpost.onclose
		thisformset.FormPosting.Enabled = .T.
		this.Hide()
	ENDPROC

	PROCEDURE formsearchpost.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

	PROCEDURE FormTransfer.cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE FormTransfer.cmdOK.Click
		thisformset.mtransferbill
	ENDPROC

	PROCEDURE FormTransfer.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode = 27
			this.OnClose()
			NODEFAULT
		ENDIF
	ENDPROC

	PROCEDURE FormTransfer.onclose
		thisformset.FormPosting.Enabled = .T.
		this.Hide()
	ENDPROC

	PROCEDURE FormTransfer.QueryUnload
		this.OnClose()
		NODEFAULT
	ENDPROC

ENDDEFINE

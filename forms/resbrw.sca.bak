*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="resbrw.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\constdefines.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor38" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor39" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor40" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor45" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor49" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor52" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor53" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor43" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor54" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor55" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor56" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor58" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor59" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor60" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor61" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor63" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor64" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor46" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor47" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor57" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor50" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor62" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor65" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor44" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor51" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor66" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor67" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor68" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor69" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor70" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor71" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor72" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor73" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor74" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor75" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor76" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor35" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 756
	InitialSelectedAlias = "reservat3"
	Left = 12
	Name = "Dataenvironment"
	Top = -10
	Width = 942

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "reservat3", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 138, ;
		Left = 7, ;
		Name = "Cursor1", ;
		Order = "", ;
		Top = 4, ;
		Width = 114
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "address", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\address.dbf, ;
		Height = 96, ;
		Left = 170, ;
		Name = "Cursor10", ;
		Top = 206, ;
		Width = 110
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "room", ;
		CursorSource = ..\data\room.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor11", ;
		Order = "tag1", ;
		Top = 167, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "events", ;
		CursorSource = ..\data\events.dbf, ;
		Height = 1, ;
		Left = 521, ;
		Name = "Cursor12", ;
		Top = 346, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "roomplan", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\roomplan.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor13", ;
		Order = "tag1", ;
		Top = 194, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "paymetho", ;
		CursorSource = ..\data\paymetho.dbf, ;
		Height = 1, ;
		Left = 803, ;
		Name = "Cursor14", ;
		Order = "tag1", ;
		Top = 64, ;
		Width = 126
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "availab", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\availab.dbf, ;
		Height = 1, ;
		Left = 515, ;
		Name = "Cursor15", ;
		Order = "tag1", ;
		Top = 112, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "althead", ;
		CursorSource = ..\data\althead.dbf, ;
		Height = 1, ;
		Left = 513, ;
		Name = "Cursor16", ;
		Order = "tag1", ;
		Top = 34, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "picklist2", ;
		CursorSource = ..\data\picklist.dbf, ;
		Height = 1, ;
		Left = 805, ;
		Name = "Cursor17", ;
		Order = "tag1", ;
		Top = 89, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "altsplit", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\altsplit.dbf, ;
		Height = 1, ;
		Left = 515, ;
		Name = "Cursor18", ;
		Order = "tag1", ;
		Top = 62, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "apartner1", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 1, ;
		Left = 333, ;
		Name = "Cursor19", ;
		Top = 58, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "billinst", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\billinst.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor2", ;
		Top = 351, ;
		Width = 94
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "roomtype2", ;
		CursorSource = ..\data\roomtype.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor20", ;
		Order = "tag2", ;
		Top = 271, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "title", ;
		CursorSource = ..\data\title.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor21", ;
		Order = "tag1", ;
		Top = 110, ;
		Width = 93
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "article", ;
		CursorSource = ..\data\article.dbf, ;
		Height = 1, ;
		Left = 513, ;
		Name = "Cursor22", ;
		Order = "tag1", ;
		Top = 10, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor23' AS cursor WITH ;
		Alias = "apartner", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 1, ;
		Left = 169, ;
		Name = "Cursor23", ;
		Order = "tag1", ;
		Top = 141, ;
		Width = 107
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor24' AS cursor WITH ;
		Alias = "address1", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 514, ;
		Name = "Cursor24", ;
		Top = 88, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor25' AS cursor WITH ;
		Alias = "season", ;
		CursorSource = ..\data\season.dbf, ;
		Height = 1, ;
		Left = 517, ;
		Name = "Cursor25", ;
		Top = 165, ;
		Width = 116
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor26' AS cursor WITH ;
		Alias = "ratecode", ;
		CursorSource = ..\data\ratecode.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor26", ;
		Order = "tag1", ;
		Top = 115, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor27' AS cursor WITH ;
		Alias = "ratearti", ;
		CursorSource = ..\data\ratearti.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor27", ;
		Order = "tag1", ;
		Top = 89, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor28' AS cursor WITH ;
		Alias = "banquet", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\banquet.dbf, ;
		Height = 1, ;
		Left = 515, ;
		Name = "Cursor28", ;
		Top = 139, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor29' AS cursor WITH ;
		Alias = "roomfeat", ;
		CursorSource = ..\data\roomfeat.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor29", ;
		Top = 298, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "citcolor", ;
		CursorSource = ..\data\citcolor.dbf, ;
		Height = 89, ;
		Left = 249, ;
		Name = "Cursor3", ;
		Top = 482, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor30' AS cursor WITH ;
		Alias = "reservat1", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 1, ;
		Left = 517, ;
		Name = "Cursor30", ;
		Top = 190, ;
		Width = 114
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor31' AS cursor WITH ;
		Alias = "user", ;
		CursorSource = ..\data\user.dbf, ;
		Height = 1, ;
		Left = 806, ;
		Name = "Cursor31", ;
		Order = "tag1", ;
		Top = 166, ;
		Width = 121
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor32' AS cursor WITH ;
		Alias = "group", ;
		CursorSource = ..\data\group.dbf, ;
		Height = 1, ;
		Left = 662, ;
		Name = "Cursor32", ;
		Top = 62, ;
		Width = 118
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor33' AS cursor WITH ;
		Alias = "address3", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor33", ;
		Top = 85, ;
		Width = 93
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor34' AS cursor WITH ;
		Alias = "reservatforbrowse", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 89, ;
		Left = 200, ;
		Name = "Cursor34", ;
		Top = 608, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor35' AS cursor WITH ;
		Alias = "resrartRSG", ;
		CursorSource = ..\data\resrart.dbf, ;
		Height = 1, ;
		Left = 333, ;
		Name = "Cursor35", ;
		Top = 139, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor36' AS cursor WITH ;
		Alias = "lists", ;
		CursorSource = ..\data\lists.dbf, ;
		Height = 1, ;
		Left = 517, ;
		Name = "Cursor36", ;
		Order = "tag1", ;
		Top = 216, ;
		Width = 114
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor37' AS cursor WITH ;
		Alias = "action", ;
		CursorSource = ..\data\action.dbf, ;
		Height = 1, ;
		Left = 517, ;
		Name = "Cursor37", ;
		Top = 241, ;
		Width = 114
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor38' AS cursor WITH ;
		Alias = "document", ;
		CursorSource = ..\data\document.dbf, ;
		Height = 1, ;
		Left = 810, ;
		Name = "Cursor38", ;
		Top = 274, ;
		Width = 116
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor39' AS cursor WITH ;
		Alias = "groupres", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\groupres.dbf, ;
		Height = 1, ;
		Left = 807, ;
		Name = "Cursor39", ;
		Top = 247, ;
		Width = 119
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "roomtype", ;
		CursorSource = ..\data\roomtype.dbf, ;
		Height = 2, ;
		Left = 169, ;
		Name = "Cursor4", ;
		Order = "tag1", ;
		Top = 86, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor40' AS cursor WITH ;
		Alias = "roomplan1", ;
		CursorSource = ..\data\roomplan.dbf, ;
		Height = 1, ;
		Left = 664, ;
		Name = "Cursor40", ;
		Top = 218, ;
		Width = 118
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor41' AS cursor WITH ;
		Alias = "room1", ;
		CursorSource = ..\data\room.dbf, ;
		Height = 1, ;
		Left = 806, ;
		Name = "Cursor41", ;
		Top = 139, ;
		Width = 118
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor42' AS cursor WITH ;
		Alias = "address4", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 169, ;
		Name = "Cursor42", ;
		Top = 5, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor43' AS cursor WITH ;
		Alias = "cashier", ;
		CursorSource = ..\data\cashier.dbf, ;
		Height = 1, ;
		Left = 518, ;
		Name = "Cursor43", ;
		Top = 293, ;
		Width = 113
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor44' AS cursor WITH ;
		Alias = "apartner_fbgrd", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 89, ;
		Left = 897, ;
		Name = "Cursor44", ;
		Top = 493, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor45' AS cursor WITH ;
		Alias = "sheet", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\sheet.dbf, ;
		Height = 1, ;
		Left = 810, ;
		Name = "Cursor45", ;
		Top = 299, ;
		Width = 115
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor46' AS cursor WITH ;
		Alias = "resrate", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\resrate.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor46", ;
		Order = "tag2", ;
		Top = 379, ;
		Width = 94
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor47' AS cursor WITH ;
		Alias = "resrmshr", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\resrmshr.dbf, ;
		Height = 1, ;
		Left = 331, ;
		Name = "Cursor47", ;
		Top = 271, ;
		Width = 94
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor49' AS cursor WITH ;
		Alias = "address5", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor49", ;
		Top = 33, ;
		Width = 92
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "deposit", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\deposit.dbf, ;
		Height = 1, ;
		Left = 661, ;
		Name = "Cursor5", ;
		Top = 11, ;
		Width = 118
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor50' AS cursor WITH ;
		Alias = "resrateRSG", ;
		CursorSource = ..\data\resrate.dbf, ;
		Height = 1, ;
		Left = 333, ;
		Name = "Cursor50", ;
		Top = 165, ;
		Width = 109
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor51' AS cursor WITH ;
		Alias = "address_fbgrd", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 89, ;
		Left = 736, ;
		Name = "Cursor51", ;
		Top = 491, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor52' AS cursor WITH ;
		Alias = "addrcom", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 170, ;
		Name = "Cursor52", ;
		Top = 59, ;
		Width = 107
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor53' AS cursor WITH ;
		Alias = "addrag", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 169, ;
		Name = "Cursor53", ;
		Top = 114, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor54' AS cursor WITH ;
		Alias = "reservatTT", ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 1, ;
		Left = 9, ;
		Name = "Cursor54", ;
		Top = 326, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor55' AS cursor WITH ;
		Alias = "addressTT", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor55", ;
		Top = 326, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor56' AS cursor WITH ;
		Alias = "apartnerTT", ;
		CursorSource = ..\data\apartner.dbf, ;
		Height = 1, ;
		Left = 136, ;
		Name = "Cursor56", ;
		Top = 355, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor57' AS cursor WITH ;
		Alias = "resrooms", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\resrooms.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor57", ;
		Top = 407, ;
		Width = 94
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor58' AS cursor WITH ;
		Alias = "laststayTT", ;
		CursorSource = ..\data\laststay.dbf, ;
		Height = 1, ;
		Left = 138, ;
		Name = "Cursor58", ;
		Top = 412, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor59' AS cursor WITH ;
		Alias = "roomtypeTT", ;
		CursorSource = ..\data\roomtype.dbf, ;
		Height = 1, ;
		Left = 137, ;
		Name = "Cursor59", ;
		Top = 442, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "post", ;
		BufferModeOverride = 1, ;
		CursorSource = ..\data\post.dbf, ;
		Height = 1, ;
		Left = 804, ;
		Name = "Cursor6", ;
		Top = 38, ;
		Width = 125
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor60' AS cursor WITH ;
		Alias = "resfixRSG", ;
		CursorSource = ..\data\resfix.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor60", ;
		Top = 190, ;
		Width = 110
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor61' AS cursor WITH ;
		Alias = "sharing", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\sharing.dbf, ;
		Height = 1, ;
		Left = 331, ;
		Name = "Cursor61", ;
		Top = 245, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor62' AS cursor WITH ;
		Alias = "resroomsRSG", ;
		CursorSource = ..\data\resrooms.dbf, ;
		Height = 1, ;
		Left = 332, ;
		Name = "Cursor62", ;
		Top = 215, ;
		Width = 110
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor63' AS cursor WITH ;
		Alias = "billnum", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\billnum.dbf, ;
		Height = 1, ;
		Left = 331, ;
		Name = "Cursor63", ;
		Top = 296, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor64' AS cursor WITH ;
		Alias = "respict", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\respict.dbf, ;
		Height = 1, ;
		Left = 331, ;
		Name = "Cursor64", ;
		Top = 323, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor65' AS cursor WITH ;
		Alias = "evint", ;
		CursorSource = ..\data\evint.dbf, ;
		Height = 1, ;
		Left = 521, ;
		Name = "Cursor65", ;
		Top = 377, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor66' AS cursor WITH ;
		Alias = "addrcom_fbgrd", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 89, ;
		Left = 577, ;
		Name = "Cursor66", ;
		Top = 490, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor67' AS cursor WITH ;
		Alias = "addrag_fbgrd", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 90, ;
		Left = 34, ;
		Name = "Cursor67", ;
		Top = 484, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor68' AS cursor WITH ;
		Alias = "addrmemb", ;
		CursorSource = ..\data\address.dbf, ;
		Height = 90, ;
		Left = 366, ;
		Name = "Cursor68", ;
		Order = "TAG1", ;
		Top = 612, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor69' AS cursor WITH ;
		Alias = "roomtypeforbrowse", ;
		CursorSource = ..\data\roomtype.dbf, ;
		Height = 89, ;
		Left = 357, ;
		Name = "Cursor69", ;
		Order = "TAG1", ;
		Top = 733, ;
		Width = 138
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "post1", ;
		CursorSource = ..\data\post.dbf, ;
		Height = 1, ;
		Left = 169, ;
		Name = "Cursor7", ;
		Top = 31, ;
		Width = 108
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor70' AS cursor WITH ;
		Alias = "building", ;
		CursorSource = ..\data\building.dbf, ;
		Height = 90, ;
		Left = 537, ;
		Name = "Cursor70", ;
		Top = 617, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor71' AS cursor WITH ;
		Alias = "altheadforsearch", ;
		CursorSource = ..\data\althead.dbf, ;
		Height = 1, ;
		Left = 170, ;
		Name = "Cursor71", ;
		Order = "tag1", ;
		Top = 173, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor72' AS cursor WITH ;
		Alias = "altheadforbrowse", ;
		CursorSource = ..\data\althead.dbf, ;
		Height = 92, ;
		Left = 355, ;
		Name = "Cursor72", ;
		Order = "tag1", ;
		Top = 853, ;
		Width = 146
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor73' AS cursor WITH ;
		Alias = "ressplit", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\ressplit.dbf, ;
		Height = 1, ;
		Left = 333, ;
		Name = "Cursor73", ;
		Top = 441, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor74' AS cursor WITH ;
		Alias = "resyield", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\resyield.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor74", ;
		Top = 332, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor75' AS cursor WITH ;
		Alias = "yioffer", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\yioffer.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor75", ;
		Top = 366, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor76' AS cursor WITH ;
		Alias = "yicond", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\yicond.dbf, ;
		Height = 1, ;
		Left = 663, ;
		Name = "Cursor76", ;
		Top = 400, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "resfix", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\resfix.dbf, ;
		Height = 1, ;
		Left = 661, ;
		Name = "Cursor8", ;
		Top = 141, ;
		Width = 121
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "reservat", ;
		BufferModeOverride = 5, ;
		CursorSource = ..\data\reservat.dbf, ;
		Height = 98, ;
		Left = 7, ;
		Name = "Cursor9", ;
		Top = 201, ;
		Width = 115
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "roomtype", ;
		ChildOrder = "tag1", ;
		Name = "Relation1", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_roomtyp"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation10' AS relation WITH ;
		ChildAlias = "laststayTT", ;
		ChildOrder = "tag1", ;
		Name = "Relation10", ;
		ParentAlias = "reservatTT", ;
		RelationalExpr = "rs_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation11' AS relation WITH ;
		ChildAlias = "roomtypeTT", ;
		ChildOrder = "tag1", ;
		Name = "Relation11", ;
		ParentAlias = "reservatTT", ;
		RelationalExpr = "rs_roomtyp"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation12' AS relation WITH ;
		ChildAlias = "addrmemb", ;
		ChildOrder = "tag1", ;
		Name = "Relation12", ;
		ParentAlias = "reservatforbrowse", ;
		RelationalExpr = "rs_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation13' AS relation WITH ;
		ChildAlias = "roomtypeforbrowse", ;
		ChildOrder = "tag1", ;
		Name = "Relation13", ;
		ParentAlias = "reservatforbrowse", ;
		RelationalExpr = "rs_roomtyp"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation14' AS relation WITH ;
		ChildAlias = "altheadforsearch", ;
		ChildOrder = "tag1", ;
		Name = "Relation14", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_altid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation15' AS relation WITH ;
		ChildAlias = "altheadforbrowse", ;
		ChildOrder = "tag1", ;
		Name = "Relation15", ;
		ParentAlias = "reservatforbrowse", ;
		RelationalExpr = "rs_altid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation2' AS relation WITH ;
		ChildAlias = "post1", ;
		ChildOrder = "tag1", ;
		Name = "Relation2", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_reserid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation3' AS relation WITH ;
		ChildAlias = "address4", ;
		ChildOrder = "tag1", ;
		Name = "Relation3", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation4' AS relation WITH ;
		ChildAlias = "apartner", ;
		ChildOrder = "tag3", ;
		Name = "Relation4", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_apid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation5' AS relation WITH ;
		ChildAlias = "addrcom", ;
		ChildOrder = "tag1", ;
		Name = "Relation5", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_compid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation6' AS relation WITH ;
		ChildAlias = "addrag", ;
		ChildOrder = "tag1", ;
		Name = "Relation6", ;
		ParentAlias = "reservat3", ;
		RelationalExpr = "rs_agentid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation7' AS relation WITH ;
		ChildAlias = "address", ;
		ChildOrder = "tag1", ;
		Name = "Relation7", ;
		ParentAlias = "reservat", ;
		RelationalExpr = "rs_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation8' AS relation WITH ;
		ChildAlias = "addressTT", ;
		ChildOrder = "tag1", ;
		Name = "Relation8", ;
		ParentAlias = "reservatTT", ;
		RelationalExpr = "rs_addrid"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation9' AS relation WITH ;
		ChildAlias = "apartnerTT", ;
		ChildOrder = "tag3", ;
		Name = "Relation9", ;
		ParentAlias = "reservatTT", ;
		RelationalExpr = "rs_apid"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS resbrw AS tform OF "..\libs\main.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="rsbgrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column1.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column2.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column3.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column4.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column5.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column6.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column7.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column8.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column9.Tcntgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column9.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column10.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column11.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column12.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column12.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column13.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column13.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column14.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column14.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column15.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column15.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column16.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column16.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column17.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column17.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column18.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column18.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column19.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column19.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column20.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column20.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column21.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column21.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column22.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column22.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column23.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column23.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column24.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column24.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column25.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column25.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column26.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column26.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column27.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="rsbgrid.Column27.Tbgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Checkreservat1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ogroupfunctions" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: checkin
		*m: checkinall
		*m: disablebuildsearch
		*m: getbuildingname
		*m: getbuildings
		*m: getcolumn18cs		&& Returns string for grids Column18
		*m: getdummybill
		*m: geteventname
		*m: getreserid
		*m: gettooltiptext
		*m: groupfunc
		*m: histres
		*m: markbuilding
		*m: messres
		*m: m_positionoverreservation		&& Seek reservation for given reservation id. Called from another form with private data session. Parameters: FirstReserId, SecondReserId
		*m: newinst
		*m: newnote
		*m: onaddress
		*m: onbill
		*m: onbuildings
		*m: oncellopen
		*m: onexit
		*m: qeupdsingle
		*m: quickout
		*m: recurring
		*m: refreshrecordstate
		*m: searchres
		*m: setaddress
		*m: setcolumnwidthandformsize
		*m: setcontrolsource
		*m: setwhileclause
		*m: takecontrolsource
		*p: cancelpressed		&& .T. when ESC Key or X on Window is pressed
		*p: cbuilding
		*p: cno
		*p: cyes
		*p: ddatesearched
		*p: fil
		*p: gridcontrolsource
		*p: lincludecxl
		*p: lincludens
		*p: lonlyconf
		*p: lonlydummies
		*p: lonlyrooms
		*p: mode
		*p: mydatasession
		*p: plcancel
		*a: abuildings[1,0]
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .F.
	AutoCenter = .F.
	cno = 
	ControlBox = .T.
	ctbrclass = cTbrResbrw
	cyes = 
	DataSession = 2
	DoCreate = .T.
	doini = .T.
	doiniopencommontables = .T.
	formname = resbrw
	Height = 335
	Icon = ..\bitmap\icons\crdfle03.ico
	KeyPreview = .T.
	Left = 0
	Name = "resbrw"
	resizeheaderfont = .F.
	saveformsize = .T.
	savegridwidths = .T.
	ShowTips = .T.
	Top = 5
	Visible = .F.
	Width = 800
	WindowState = 0

	ADD OBJECT 'Checkreservat1' AS checkreservat WITH ;
		Left = 288, ;
		Name = "Checkreservat1", ;
		Top = 48
		*< END OBJECT: ClassLib="..\libs\checkreservat.vcx" BaseClass="custom" />

	ADD OBJECT 'ogroupfunctions' AS cgroupfunctions WITH ;
		Left = 288, ;
		Name = "ogroupfunctions", ;
		Top = 72
		*< END OBJECT: ClassLib="..\libs\cit_reservat.vcx" BaseClass="custom" />

	ADD OBJECT 'rsbgrid' AS tbrowse WITH ;
		ColumnCount = 27, ;
		DeleteMark = .F., ;
		GridLines = 2, ;
		Height = 336, ;
		ladduserdefinedcolumns = .T., ;
		Left = 0, ;
		lresizecolumns = .F., ;
		Name = "rsbgrid", ;
		Panel = 1, ;
		RecordMark = .F., ;
		RecordSource = " ", ;
		resizefontsize = .F., ;
		ScrollBars = 2, ;
		setcolumns = .T., ;
		Top = 0, ;
		Width = 800, ;
		ZOrderSet = 0, ;
		Column1.ControlSource = "", ;
		Column1.Name = "Column1", ;
		Column1.Visible = .T., ;
		Column1.Width = 60, ;
		Column10.ControlSource = "", ;
		Column10.Name = "Column10", ;
		Column10.Visible = .T., ;
		Column10.Width = 58, ;
		Column11.ControlSource = "", ;
		Column11.InputMask = "999,999.99", ;
		Column11.Name = "Column11", ;
		Column11.Visible = .T., ;
		Column11.Width = 65, ;
		Column12.ControlSource = "", ;
		Column12.Name = "Column12", ;
		Column12.Visible = .T., ;
		Column13.ControlSource = "", ;
		Column13.Name = "Column13", ;
		Column13.Visible = .T., ;
		Column14.ControlSource = "", ;
		Column14.Name = "Column14", ;
		Column14.Visible = .T., ;
		Column14.Width = 60, ;
		Column15.ControlSource = "", ;
		Column15.Name = "Column15", ;
		Column15.Visible = .T., ;
		Column15.Width = 52, ;
		Column16.ControlSource = "", ;
		Column16.Name = "Column16", ;
		Column16.Visible = .T., ;
		Column16.Width = 47, ;
		Column17.ControlSource = "", ;
		Column17.Name = "Column17", ;
		Column17.Visible = .T., ;
		Column17.Width = 47, ;
		Column18.Name = "Column18", ;
		Column18.Visible = .T., ;
		Column18.Width = 75, ;
		Column19.InputMask = "", ;
		Column19.Name = "Column19", ;
		Column19.Visible = .T., ;
		Column19.Width = 30, ;
		Column2.ControlSource = "", ;
		Column2.Name = "Column2", ;
		Column2.Visible = .T., ;
		Column2.Width = 60, ;
		Column20.Alignment = 1, ;
		Column20.InputMask = "999,999,999.99", ;
		Column20.Name = "Column20", ;
		Column20.Visible = .T., ;
		Column21.Name = "Column21", ;
		Column22.Name = "Column22", ;
		Column23.Name = "Column23", ;
		Column24.Name = "Column24", ;
		Column25.Name = "Column25", ;
		Column26.Name = "Column26", ;
		Column27.Name = "Column27", ;
		Column3.ControlSource = "", ;
		Column3.Name = "Column3", ;
		Column3.Visible = .T., ;
		Column3.Width = 35, ;
		Column4.ControlSource = "", ;
		Column4.Name = "Column4", ;
		Column4.Visible = .T., ;
		Column4.Width = 35, ;
		Column5.ControlSource = "", ;
		Column5.Name = "Column5", ;
		Column5.Visible = .T., ;
		Column5.Width = 25, ;
		Column6.ControlSource = "", ;
		Column6.Name = "Column6", ;
		Column6.Visible = .T., ;
		Column6.Width = 60, ;
		Column7.ControlSource = "", ;
		Column7.Name = "Column7", ;
		Column7.Visible = .T., ;
		Column7.Width = 70, ;
		Column8.Alignment = 1, ;
		Column8.ControlSource = "", ;
		Column8.InputMask = "9999", ;
		Column8.Name = "Column8", ;
		Column8.Visible = .T., ;
		Column8.Width = 33, ;
		Column9.ControlSource = "", ;
		Column9.Name = "Column9", ;
		Column9.Sparse = .F., ;
		Column9.Visible = .T., ;
		Column9.Width = 40
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="grid" />

	ADD OBJECT 'rsbgrid.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column1.Tbgrid1' AS tbgrid WITH ;
		Left = 25, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column10.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column11.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 19, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T., ;
		Width = 12
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column12.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column12.Tbgrid1' AS tbgrid WITH ;
		Left = 16, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column13.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column13.Tbgrid1' AS tbgrid WITH ;
		Left = 12, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column14.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column14.Tbgrid1' AS tbgrid WITH ;
		Left = 8, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column15.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column15.Tbgrid1' AS tbgrid WITH ;
		BorderColor = 255,255,255, ;
		Left = 19, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column16.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column16.Tbgrid1' AS tbgrid WITH ;
		Left = 4, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column17.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column17.Tbgrid1' AS tbgrid WITH ;
		Left = 11, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column18.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column18.Tbgrid1' AS tbgrid WITH ;
		Left = 45, ;
		Name = "Tbgrid1", ;
		Top = 59, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column19.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column19.Tbgrid1' AS tbgrid WITH ;
		Alignment = 3, ;
		Left = 6, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column2.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column20.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column20.Tbgrid1' AS tbgrid WITH ;
		Alignment = 1, ;
		Left = 30, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column21.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column21.Tbgrid1' AS tbgrid WITH ;
		Left = 37, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column22.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column22.Tbgrid1' AS tbgrid WITH ;
		Left = 26, ;
		Name = "Tbgrid1", ;
		Top = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column23.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column23.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 35
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column24.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column24.Tbgrid1' AS tbgrid WITH ;
		Left = 34, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column25.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column25.Tbgrid1' AS tbgrid WITH ;
		Left = 50, ;
		Name = "Tbgrid1", ;
		Top = 47
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column26.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column26.Tbgrid1' AS tbgrid WITH ;
		Left = 22, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column27.Header1' AS header WITH ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column27.Tbgrid1' AS tbgrid WITH ;
		Left = 42, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column3.Tbgrid1' AS tbgrid WITH ;
		Left = 15, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column4.Tbgrid1' AS tbgrid WITH ;
		Left = 20, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column5.Tbgrid1' AS tbgrid WITH ;
		Left = 13, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column6.Tbgrid1' AS tbgrid WITH ;
		ControlSource = "reservat3.rs_roomtyp", ;
		Left = 23, ;
		Name = "Tbgrid1", ;
		Top = 23, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column7.Tbgrid1' AS tbgrid WITH ;
		Left = 18, ;
		Name = "Tbgrid1", ;
		Top = 35, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column8.Tbgrid1' AS tbgrid WITH ;
		Alignment = 1, ;
		Left = 20, ;
		Name = "Tbgrid1", ;
		Top = 23, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Header1", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'rsbgrid.Column9.Tbgrid1' AS tbgrid WITH ;
		Left = 21, ;
		Name = "Tbgrid1", ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="textbox" />

	ADD OBJECT 'rsbgrid.Column9.Tcntgrid1' AS tcntgrid WITH ;
		Left = 17, ;
		Name = "Tcntgrid1", ;
		Top = 35, ;
		Visible = .T., ;
		Ttext1.Name = "Ttext1", ;
		Ttext1.ReadOnly = .T.
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="container" />
	
	PROCEDURE Activate
		SetKeyLabel()
		DODEFAULT()
		this.RefreshRecordState()
	ENDPROC

	PROCEDURE assigncaption
		IF this.mode = 5
			this.Caption=GetLangText("RESERVAT","TW_PICK_SHARE")
		ELSE
			This.Caption=GetLangText("RESERVAT","TW_RSBROWSE")
		ENDIF
	ENDPROC

	PROCEDURE checkin
		this.Enabled = .F.
		CURSORSETPROP("Buffering",5,"post")
		=SEEK(reservat3.rs_addrid,"address","tag1")
		GO RECNO('reservat3') IN reservat
		CheckIn(this.Checkreservat1)
		IF NOT g_debug
			=TABLEUPDATE(.T.,.T.,"post")
			=TABLEUPDATE(.T.,.T.,"pswindow")
		ENDIF
		CURSORSETPROP("Buffering",1,"post")
		SELECT reservat3
		this.Enabled = .T.
		this.rsbgrid.Refresh()
		
		LOCAL l_lZapCursor, l_lBrowseFromSelected
		l_lZapCursor = .T.
		l_lBrowseFromSelected = .T.
		this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		this.ControlRefresh()
	ENDPROC

	PROCEDURE checkinall
		this.Enabled = .F.
		CURSORSETPROP("Buffering",5,"post")
		=SEEK(reservat3.rs_addrid,"address","tag1")
		GO RECNO('reservat3') IN reservat
		DO CheckInAll IN CheckIn
		IF NOT g_debug
			=TABLEUPDATE(.T.,.T.,"post")
		ENDIF
		CURSORSETPROP("Buffering",1,"post")
		SELECT reservat3
		this.Enabled = .T.
		this.rsbgrid.Refresh()
		
		LOCAL l_lZapCursor, l_lBrowseFromSelected
		l_lZapCursor = .T.
		l_lBrowseFromSelected = .T.
		this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		this.ControlRefresh()
	ENDPROC

	PROCEDURE Deactivate
		checkkeylabel()
		DODEFAULT()
	ENDPROC

	PROCEDURE Destroy
		this.Visible = .F.
		checkkeylabel()
		DODEFAULT()
	ENDPROC

	PROCEDURE disablebuildsearch
		LOCAL l_nBuildingCnt
		
		l_nBuildingCnt = 0
		CALCULATE CNT() TO l_nBuildingCnt IN building
		
		RETURN (l_nBuildingCnt = 0)
	ENDPROC

	PROCEDURE getbuildingname
		LPARAMETERS lp_nAltId
		IF EMPTY(lp_nAltId)
			RETURN ""
		ENDIF
		LOCAL ARRAY l_aRes(1)
		LOCAL l_cBuLang
		l_cBuLang = "bu_lang" + g_langnum
		SELECT TOP 1 &l_cBuLang FROM althead ;
				INNER JOIN building ON al_buildng = bu_buildng ;
				WHERE al_altid = lp_nAltId ;
				ORDER BY 1 ;
				INTO ARRAY l_aRes
		RETURN IIF(VARTYPE(l_aRes(1))="C",l_aRes(1),"")
	ENDPROC

	PROCEDURE getbuildings
		LOCAL l_cLangMacro
		
		l_cLangMacro = "bu_lang" + g_langnum
		SELECT bu_buildng, &l_cLangMacro AS bu_lang, .T. FROM building ;
			UNION SELECT [], [], .F. FROM building ;
			ORDER BY 1 INTO ARRAY this.aBuildings
		
		this.aBuildings(1,1) = GetLangText("RESBRW","TXT_ALL")
		this.aBuildings(1,2) = GetLangText("RESBRW","TXT_ALL_BUILDING")
	ENDPROC

	PROCEDURE getcolumn18cs		&& Returns string for grids Column18
		LPARAMETERS lp_cReservatAlias
		LOCAL l_cText, l_cResAlias
		IF PCOUNT() < 1
			l_cResAlias = "reservat3"
		ELSE
			l_cResAlias = lp_cReservatAlias
		ENDIF
		l_cText = ProcReservat("GetReserPrices", l_cResAlias)
		RETURN l_cText
	ENDPROC

	PROCEDURE getdummybill
		LPARAMETERS lp_dRateDat
		* Now is possible to issue postings for nonsplited group reservation.
		RETURN IIF(EMPTY(lp_dRateDat),this.cNo,this.cYes)
		
		*LPARAMETERS lp_nRsId
		*RETURN IIF(ProcReservat("GetDummyBill", lp_nRsId),GetLangText("MGRFINAN","TXT_YES"),GetLangText("AR","T_NO"))
	ENDPROC

	PROCEDURE geteventname
		LPARAMETERS lp_nAltId
		IF EMPTY(lp_nAltId)
			RETURN ""
		ENDIF
		LOCAL ARRAY l_aRes(1)
		SELECT TOP 1 ev_name FROM althead ;
				INNER JOIN evint ON al_eiid = ei_eiid ;
				INNER JOIN events ON ei_evid = ev_evid ;
				WHERE al_altid = lp_nAltId ;
				ORDER BY 1 ;
				INTO ARRAY l_aRes
		RETURN IIF(VARTYPE(l_aRes(1))="C",l_aRes(1),"")
	ENDPROC

	PROCEDURE getreserid
		RETURN reservat3.rs_reserid
	ENDPROC

	PROCEDURE gettooltiptext
		LOCAL l_cText, l_nSelected, l_cRatecod, l_cOrder, l_cRelocationText
		l_cText = ""
		l_cRelocationText = ""
		= SEEK(reservat3.rs_reserid, "reservatTT", "tag1")
		IF roomtypeTT.rt_group = 2
			l_cText = GetLangText("BANQUET","TW_BANQUET")+" "+GetLangText("RESERVAT","TP_SHEET")+":"
			l_cText = l_cText + IIF(SEEK(reservatTT.rs_reserid, "sheet", "tag1"), ;
				this.cYes, this.cNo)+CHR(13)
			l_cText = l_cText + GetLangText("BANQUET","TW_BANQUET")+" "+;
				GetLangText("ADDRESS","TXT_STATUS")+":"
			l_cText = l_cText + IIF(EMPTY(reservatTT.rs_cnfstat), "", ;
				dblookup("picklist","tag4","CONFSTATUS"+reservatTT.rs_cnfstat, "pl_lang"+g_langnum))
		ELSE
			l_cText = GetLangText("RESERVAT","T_LNAME")+":"+;
				GetReservatLongName("reservatTT","addressTT","apartnerTT")+CHR(10)+;
				GetLangText("RESERVAT","T_COMPANY")+":"+TRIM(PROPER(reservatTT.rs_company))+;
				CHR(10)+;
				GetLangText("RESERVAT","T_INVOICE")+":"+IIF(NOT EMPTY(reservatTT.rs_invid) AND ;
				SEEK(reservatTT.rs_invid, "addressTT", "tag1"), CompanyName("addressTT"),"")+CHR(10)+;
				IIF(EMPTY(reservatTT.rs_optdate), "", GetLangText("RESERVAT","T_OPTION")+":"+;
				DTOC(reservatTT.rs_optdate)+CHR(10))+;
				GetLangText("RESERVAT","T_ALLOTT")+":"+TRIM(PROPER(DbLookUp("althead","tag1",reservatTT.rs_altid,"al_allott")))+CHR(10)+;
				GetLangText("BILLINST","TXT_CONOTE")+":"+TRIM(reservatTT.rs_noteco)
		
				DO GetRelocationText IN procreservat WITH reservatTT.rs_reserid, reservatTT.rs_arrdate, l_cRelocationText
				IF NOT EMPTY(l_cRelocationText)
					l_cText = l_cText + CHR(10) + l_cRelocationText
				ENDIF
		
				IF NOT EMPTY(reservatTT.rs_addrid)
					l_cText = l_cText+CHR(10)+GetLangText("ADDRESS","T_LASTROOMTYPE")+":"+;
					Get_rt_roomtyp(laststayTT.ls_roomtyp)+CHR(10)+;
					GetLangText("ADDRESS","T_LASTROOM")+":"+;
					Get_rm_rmname(laststayTT.ls_roomnum)
				ENDIF
		
				IF _screen.oGlobal.oParam2.pa_noaddr AND reservatTT.rs_noaddr
					l_cText = l_cText + CHR(10) + PAResAddrGetRestGuestNames(this.Checkreservat1,"reservatTT",.T.)
				ENDIF
		ENDIF
		IF LEN(l_cText)>1700
			l_cText = LEFT(l_cText,1700)+" ..."
		ENDIF
		RETURN l_cText
	ENDPROC

	PROCEDURE groupfunc
	ENDPROC

	PROCEDURE histres
		LOCAL lcCaption, lcRsChanges
		
		lcCaption = GetReservatCaption(this.RsbGrid.RecordSource)
		lcRsChanges = DLookUp("reservat", "rs_rsid = " + SqlCnv(EVALUATE(this.RsbGrid.RecordSource + ".rs_rsid")), "rs_changes")
		
		DO FORM forms\rshistor WITH lcRsChanges, lcCaption, this
	ENDPROC

	PROCEDURE Init
		* Possible modes
		* 
		* resbrw.scx normal mode 1
		* resbrw.scx billinst select reservation mode 2
		* resbrw.scx availab filter mode 3
		* resbrw.scx allot filter mode 4
		* resbrw.scx reservat select shared reservation mode 5
		* resbrw.scx Anreisen nmode 50
		* resbrw.scx Abreisen nmode 51
		* resbrw.scx Inhause nmode 52
		* resbrw.scx Messages nmode 53
		* resbrw.scx Inhause Guest; Bills nmode 54
		
		LPARAMETERS nmode, nrn, cfilter, ntag, oCallRef
		LOCAL l_cFormCaption, l_nFound
		
		l_cFormCaption = ""
		l_nFound = 0
		this.dDateSearched = {}
		this.rsbgrid.cOrder = "tag20" && default order in grid
		this.rsbgrid.eSeekExpression = DTOS(g_sysdate)
		this.mode = nmode
		
		* Don't slow grid, with calling getlangtext too many times. Store values in form property.
		this.cYes = GetLangText("MGRFINAN","TXT_YES")
		this.cNo = GetLangText("AR","T_NO")
		
		DO CASE
			CASE this.mode = 50
				this.cformlabel = "RESBRWARR"
				this.rsbgrid.cgridlabelname = "RSBGRIDARR"
			CASE this.mode = 51
				this.cformlabel = "RESBRWDEP"
				this.rsbgrid.cgridlabelname = "RSBGRIDDEP"
			CASE this.mode = 52
				this.cformlabel = "RESBRWINH"
				this.rsbgrid.cgridlabelname = "RSBGRIDINH"
			CASE this.mode = 54
				this.cformlabel = "RESBRWINHGUEST"
				this.rsbgrid.cgridlabelname = "RSBGRIDINHGUEST"
			OTHERWISE
				this.cformlabel = "RESBRW"
				this.rsbgrid.cgridlabelname = "RSBGRID"
		ENDCASE
		
		this.rsbgrid.Init(.T.)
		DODEFAULT()
		
		this.AddProperty("aaolumns(19,2)")
		IF PCOUNT()=5
			this.oCallingObj = oCallRef
		ENDIF
		this.rsbgrid.cWhileClause = ".T."
		this.lOnlyRooms = .F.
		this.lOnlyConf = .F.
		this.oGroupFunctions.oCheckReservat = this.checkreservat1
		DO CASE
			CASE nmode = 2
				IF NOT EMPTY(cfilter)
					this.rsbgrid.cForClause = cFilter
				ELSE
					DO FORM forms\searchres WITH this, 53, "" TO l_nFound
					IF INLIST(l_nFound, 1, 2)
						this.mode = 0
						this.Release()
						RETURN .F.
					ENDIF
				ENDIF
				this.oCallingObj.Enabled = .F.
				this.AlwaysOnTop=.T.
				l_cFormCaption = GetLangText("PLAN","TW_SELECT")
			CASE nmode = 3
				this.rsbgrid.cForClause = cFilter
			CASE nmode = 4
				this.rsbgrid.cForClause = cFilter
			CASE this.mode = 5
				this.lOnlyRooms = .T.
				this.lOnlyConf = .F.
			CASE nmode = 50
				this.formname = "resbrw50"
				DO FORM forms\searchres WITH this, 50, "" TO l_nFound
				IF INLIST(l_nFound, 1, 2)
					this.Release()
					RETURN .F.
				ELSE
					this.SetWhileClause()
					l_cFormCaption = GetLangText("VIEW","TW_ARRIVALS")+" "+DTOC(this.dDateSearched)
				ENDIF
			CASE nmode = 51
				this.formname = "resbrw51"
				DO FORM forms\searchres WITH this, 51, "" TO l_nFound
				IF INLIST(l_nFound, 1, 2)
					this.Release()
					RETURN .F.
				ELSE
					this.SetWhileClause()
					l_cFormCaption = GetLangText("VIEW","TW_DEPARTS")+" "+DTOC(this.dDateSearched)
				ENDIF
			CASE nmode = 52
				this.formname = "resbrw52"
				DO FORM forms\searchres WITH this, 52, "" TO l_nFound
				IF INLIST(l_nFound, 1, 2)
					this.Release()
					RETURN .F.
				ELSE
					this.SetWhileClause()
					l_cFormCaption = GetLangText("VIEW","TW_INHOUSE")+" "+DTOC(this.dDateSearched)
				ENDIF
			CASE nmode = 53
				this.formname = "resbrw53"
				this.rsbgrid.cForClause = "rs_in == '1' AND EMPTY(rs_out) AND rs_status <> 'CXL' AND rs_status <> 'NS'"
				this.rsbgrid.cWhileClause = "rs_in == '1'"
				this.rsbgrid.cLocateForClause = ".F."
				this.rsbgrid.cOrder = "tag2"		&& rs_lname
				l_cFormCaption = GetLangText("VIEW","TW_INHOUSE")+" "+DTOC(sysdate())
			CASE nmode = 54
				this.formname = "resbrw54"
				DO FORM forms\searchres WITH this, 54, "" TO l_nFound
				IF l_nFound = 1
					RETURN .F.
				ENDIF
				this.SetWhileClause()
				l_cFormCaption = GetLangText("CHKOUT1","TW_INHOUSE")
				this.AutoCenter = .T.
				this.Icon = "bitmap\icons\inhouse.ico"
				this.rsbgrid.lNotFoundMessage = .F.
			CASE _screen.oGlobal.oParam.pa_resfind > 0
				DO FORM forms\searchres WITH this, _screen.oGlobal.oParam.pa_resfind, ""
				* Add NS, CXL etc. filter
				this.rsbgrid.cForClause = this.rsbgrid.cForClause + this.searchres(_screen.oGlobal.oParam.pa_resfind,.T.)
			OTHERWISE
				IF this.lOnlyDummies
					this.rsbgrid.cForClause = this.rsbgrid.cForClause + " AND roomtypeforbrowse.rt_group = 3"
				ENDIF
				IF NOT this.lIncludeNS
					this.rsbgrid.cForClause = this.rsbgrid.cForClause + " AND rs_status <> 'NS'"
				ENDIF
				IF NOT this.lIncludeCXL
					this.rsbgrid.cForClause = this.rsbgrid.cForClause + " AND rs_status <> 'CXL'"
				ENDIF
		ENDCASE
		
		IF EMPTY(this.rsbgrid.cForClause)
			this.rsbgrid.cForClause = ".T."
		ENDIF
		
		this.Assigncaption()
		IF NOT EMPTY(l_cFormCaption)
			this.Caption = l_cFormCaption
		ENDIF
		IF nmode <> 54 AND NOT this.DisableBuildSearch()
			this.Caption = this.Caption+" - "+GetLangText("MGRPLIST", "TXT_BUILDINGWINDOW") ;
					+ ": "+GetLangText("RESBRW","TXT_ALL")
			this.GetBuildings()
		ENDIF
		IF NOT EMPTY(ntag)
			this.rsbgrid.cOrder = "tag" + SqlCnv(nTag)
		ENDIF
		IF NOT EMPTY(NRN)
			IF nmode = 2
				this.rsbgrid.cLocateForClause = "rs_rsid = " + SqlCnv(nRn)
			ELSE
				this.rsbgrid.cLocateForClause = "RECNO() = " + SqlCnv(nRn)
			ENDIF
		ENDIF
		
		LOCAL l_lZapCursor, l_lBrowseFromSelected, l_lFound
		l_lZapCursor = .F.
		l_lBrowseFromSelected = .F.
		l_lFound = this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		IF nmode = 3
			RETURN l_lFound
		ELSE
			RETURN .T.
		ENDIF
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
			CASE nKeyCode = 13 AND nShiftAltCtrl = 0 AND this.Mode = 54	&& ENTER Bill
				_screen.oProcessHandler(ALLTRIM(STR(P_BILL))).Execute(this, "KeyPress")
				NODEFAULT
			CASE INLIST(nKeyCode, 5, 24) AND nShiftAltCtrl = 0		&& UP and DOWN ARROW
				this.RsbGrid.lUpdateCursorData = .T.
				this.RsbGrid.BrowseKeyPress(nKeyCode, nShiftAltCtrl)
				this.RsbGrid.lUpdateCursorData = .F.
			CASE INLIST(nKeyCode, 3, 18) AND nShiftAltCtrl = 0		&& PAGE UP and PAGE DOWN
				this.RsbGrid.BrowseKeyPress(nKeyCode, nShiftAltCtrl)
			CASE nkeycode = 127 AND nShiftAltCtrl = 2				&& Ctrl+H Tooltip
				LOCAL lnY
				lnY = this.RsbGrid.Top + this.RsbGrid.HeaderHeight + 2 * this.RsbGrid.GridLineWidth + ;
					this.RsbGrid.RelativeRow * (this.RsbGrid.RowHeight) - 2
				MOUSE AT lnY, 100 PIXELS WINDOW "RESBRW"
			OTHERWISE
				DODEFAULT(nKeyCode, nShiftAltCtrl)
		ENDCASE
	ENDPROC

	PROCEDURE markbuilding
		LPARAMETERS lp_nBuildingBarIndex
		LOCAL l_lMarkOrNot
		DO CASE
			CASE EMPTY(this.cBuilding) AND NOT this.aBuildings(lp_nBuildingBarIndex,3)
				l_lMarkOrNot = .T.
			CASE EMPTY(this.cBuilding) AND this.aBuildings(lp_nBuildingBarIndex,3)
				l_lMarkOrNot = .F.
			CASE NOT EMPTY(this.cBuilding) AND PADR(this.aBuildings(lp_nBuildingBarIndex,1),3)==this.cBuilding
				l_lMarkOrNot = .T.
			CASE NOT (EMPTY(this.cBuilding) OR PADR(this.aBuildings(lp_nBuildingBarIndex,1),3)==this.cBuilding)
				l_lMarkOrNot = .F.
		ENDCASE
		
		RETURN l_lMarkOrNot
	ENDPROC

	PROCEDURE messres
		LOCAL lcGuestName, lcCompanyName
		
		lcGuestName = GetReservatLongName(this.Rsbgrid.RecordSource,"address_fbgrd","apartner_fbgrd")
		lcCompanyName = CompanyName("address_fbgrd")
		
		DO FORM forms\msgedit WITH IIF(this.Mode = 53, 2, 1), EVALUATE(this.RsbGrid.RecordSource + ".rs_reserid"), lcGuestName, lcCompanyName
	ENDPROC

	PROCEDURE Moved
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this
				_screen.oCardReaderHandler.oHicHandler.oCr.MoveForm()
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE m_positionoverreservation		&& Seek reservation for given reservation id. Called from another form with private data session. Parameters: FirstReserId, SecondReserId
		LPARAMETERS pl_nReserId
		LOCAL l_nRecNo, l_nRetVal
		l_nRetVal = .T.
		l_nRecNo = RECNO("reservat3")
		IF NOT SEEK(pl_nReserId,"reservat3","tag1")
			GO l_nRecNo IN reservat3
			l_nRetVal = .F.
		ENDIF
		RETURN l_nRetVal
	ENDPROC

	PROCEDURE newinst
		DO FORM forms\billinst WITH reservat3.rs_rsid, 2, this
	ENDPROC

	PROCEDURE newnote
		LOCAL lcCaption, lnRsid
		
		lcCaption = GetReservatName(this.Rsbgrid.RecordSource,"address_fbgrd","apartner_fbgrd")
		lnRsid = EVALUATE(this.RsbGrid.RecordSource + ".rs_rsid")
		
		DO FORM forms\viewnote WITH lnRsid, lcCaption
	ENDPROC

	PROCEDURE onaddress
		LOCAL l_nResult, l_nAddrid, l_nAddTagNo, l_cAddStart, l_nMode, l_nRecNo, l_oAddrSelForm
		LOCAL ARRAY LArray(12)
		
		l_nResult = 0
		
		GO RECNO('reservat3') IN reservat
		DO FORM forms\frmSelectWhichAddress NAME l_oAddrSelForm LINKED TO l_nResult
		
		DO CASE
			CASE l_nResult = 1
				IF EMPTY(reservat.rs_addrid)
					= SEEK("A", "address", "tag2")
					l_nAddrid = address.ad_addrid
				ELSE	
					l_nAddrid = reservat.rs_addrid
				ENDIF
				l_nAddTagNo = 2
				l_cAddStart = "BRWL"
				l_nMode = 18
			CASE l_nResult = 2
				IF EMPTY(reservat.rs_compid)
					= SEEK("A", "address", "tag3")
					l_nAddrid = address.ad_addrid
				ELSE	
					l_nAddrid = reservat.rs_compid
				ENDIF
				l_nAddTagNo = 18
				l_cAddStart = "BRWC"
				l_nMode = 19
			OTHERWISE
				l_nResult = 0
		ENDCASE
		
		IF l_nResult <> 0
			= SEEK(l_nAddrid, "address", "tag1")
			LArray(1) = l_cAddStart
			LArray(2) = ""
			LArray(3) = l_nAddTagNo
			LArray(4) = "BILL"
			LArray(5) = RECNO("address")
			LArray(6) = 0
			LArray(7) = l_nMode
			LArray(8) = 0
			LArray(9) = this
			LArray(12) = .T.
			doform('addressmask','forms\addressmask','',.F.,@LArray)
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE onbill
		LOCAL ARRAY LArray(2)
		
		GO RECNO('reservat3') IN reservat
		
		IF NOT userpid()
			RETURN
		ENDIF
		g_Billstyle = MAX(_screen.oGlobal.oParam.pa_billsty, 1)
		
		LArray(1) = reservat.rs_reserid
		LArray(2) = this
		doform('frmbills','forms\bills','',.T.,@LArray)
		
		RETURN .T.
	ENDPROC

	PROCEDURE onbuildings
		LPARAMETERS lp_cBuilding
		#DEFINE CAPTION_DELIMITER ": "
		
		LOCAL l_cCaption, l_nDelimPos, l_cCaptionExtended, l_cPopUpText
		l_cCaptionExtended = ""
		l_cCaption = this.Caption
		l_nDelimPos = AT(CAPTION_DELIMITER,l_cCaption)
		l_cCaption = SUBSTR(l_cCaption,1,l_nDelimPos - 1)
		
		IF lp_cBuilding == "ALL" OR EMPTY(lp_cBuilding)
			l_cCaption = l_cCaption + CAPTION_DELIMITER + GetLangText("RESBRW","TXT_ALL")
			this.cBuilding = ""
		ELSE
			this.cBuilding = lp_cBuilding
			l_cCaption = l_cCaption + CAPTION_DELIMITER + this.cBuilding
		ENDIF
		
		this.Caption = childtitle(l_cCaption)
		
		#UNDEFINE CAPTION_DELIMITER
		RETURN
	ENDPROC

	PROCEDURE oncellopen
		LPARAMETERS lp_cOpenMode
		
		DO CASE
			CASE lp_cOpenMode = "OPEN_ACTION"
				IF DLocate("action", "at_reserid = " + SqlCnv(reservat3.rs_reserid,.T.) + " AND at_compl = " + SqlCnv({},.T.) + " AND NOT EMPTY(action.at_acttyp)")
					doform('activities','forms\activities WITH "RESBRW"')
		*		GO RECNO('reservat3') IN reservat
		*		=rscheck()
		*		=SEEK(reservat3.rs_addrid,"address","tag1")
		*		biRthday()
		
		*		LOCAL ARRAY l_aParameters(16)
		*		l_aParameters(1) = reservat3.rs_reserid
		*		l_aParameters(2) = "EDIT"
		*		l_aParameters(16) = this
		*		doform("reservat","forms\reservat","",.T.,@l_aParameters)
				ELSE
					RETURN .F.
				ENDIF
			OTHERWISE
		ENDCASE
		
		RETURN .T.
	ENDPROC

	PROCEDURE onclose
		thisform.cancelpressed = .T.
		thisform.Release()
	ENDPROC

	PROCEDURE oncopy
		IF deMomax("reservat")
			RETURN
		ENDIF
		LOCAL ARRAY l_aParameters(16)
		l_aParameters(1) = reservat3.rs_reserid
		l_aParameters(2) = "COPY"
		l_aParameters(16) = this
		doform("reservat","forms\reservat","",.T.,@l_aParameters)
	ENDPROC

	PROCEDURE ondelete
		LOCAL l_nRecno, l_nDelStatus, l_nRtGroup, l_cRoomtype, l_cForClause, l_lZapCursor, l_lBrowseFromSelected
		
		l_cRoomtype = reservat3.rs_roomtyp
		l_nRtGroup = roomtypeforbrowse.rt_group
		l_cForClause = "DTOS(rs_arrdate)+rs_lname = " + SqlCnv(DTOS(reservat3.rs_arrdate),.T.) + " AND rs_status = 'LST'"
		
		l_nRecno = RECNO('reservat3')
		GO l_nRecno IN reservat
		this.checkreservat1.DeleteReser(,,,,,,@l_nDelStatus)
		IF INLIST(l_nDelStatus, 1, 2) AND INLIST(l_nRtGroup, 1, 2, 4) AND DLocate("reservat3", l_cForClause + " AND rs_roomtyp = " + SqlCnv(l_cRoomtype,.T.)) AND ;
				YesNo(GetLangText("RESERVAT","TXT_SHOW_LST"))
			thisform.rsbgrid.cForClause = l_cForClause
		ELSE
			l_lBrowseFromSelected = .T.
		ENDIF
		l_lZapCursor = .T.
		this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
	ENDPROC

	PROCEDURE onedit
		GO RECNO('reservat3') IN reservat
		=rscheck()
		=SEEK(reservat3.rs_addrid,"address","tag1")
		biRthday()
		
		LOCAL ARRAY l_aParameters(16)
		l_aParameters(1) = reservat3.rs_reserid
		l_aParameters(2) = "EDIT"
		l_aParameters(16) = this
		doform("reservat","forms\reservat","",.T.,@l_aParameters)
	ENDPROC

	PROCEDURE onexit
	ENDPROC

	PROCEDURE onnew
		IF deMomax("reservat")
			RETURN
		ENDIF
		LOCAL ARRAY l_aParameters(16)
		l_aParameters(1) = 1
		l_aParameters(2) = "NEW"
		l_aParameters(16) = this
		doform("reservat","forms\reservat","",.T.,@l_aParameters)
	ENDPROC

	PROCEDURE onrefresh
		LOCAL l_lZapCursor, l_lBrowseFromSelected
		l_lZapCursor = .T.
		l_lBrowseFromSelected = .T.
		this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		this.ControlRefresh()
	ENDPROC

	PROCEDURE onselect
		thisform.Release()
	ENDPROC

	PROCEDURE qeupdsingle
	ENDPROC

	PROCEDURE QueryUnload
		NODEFAULT
		thisform.OnClose()
	ENDPROC

	PROCEDURE quickout
		GO RECNO('reservat3') IN reservat
		
		IF NOT userpid()
			RETURN
		ENDIF
		
		LOCAL l_lResult, l_lYesNo, l_nType, l_lSettled
		* Prepare for CheckOut.
		DO CheckOutPrepare IN ProcBill WITH reservat.rs_reserid
		DO CheckOutYesNo IN ProcBill WITH l_lYesNo
		IF NOT l_lYesNo
			RETURN .F.
		ENDIF
		
		* Block creating ACT files for interfaces. We do it on end of checkout process.
		_screen.oGlobal.lIfcCheckBlock = .T.
		
		* Determine CheckOut type.
		DO CheckOutType IN ProcBill WITH l_nType
		IF EMPTY(l_nType)
			_screen.oGlobal.lIfcCheckBlock = .F.
			RETURN .F.
		ENDIF
		
		this.Enabled = .F.
		DO RatecodePost IN RatePost WITH SysDate(), "CHECKOUT"
		* Create tblPostCursor
		DO CursorPostPayCreate IN ProcBill WITH .T.
		* CHECKOUT
		DO CheckOutProcess IN ProcBill WITH 0, .F., l_lResult
		* Close tblPostCursor
		USE IN tblPostCursor
		this.Enabled = .T.
		
		DoTableUpdate(.F.,.T.,"reservat")
		DoTableUpdate(.T.,.T.,"post")
		DoTableUpdate(.T.,.T.,"billnum")
		EndTransaction()
		
		_screen.oGlobal.lIfcCheckBlock = .F.
		DO ifccheck IN Interfac WITH reservat.rs_roomnum, "CHECKOUT"
		
		SELECT reservat3
		
		LOCAL l_lZapCursor, l_lBrowseFromSelected
		l_lZapCursor = .T.
		l_lBrowseFromSelected = .T.
		this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
		this.ControlRefresh()
	ENDPROC

	PROCEDURE recurring
		DO FORM forms\recurring WITH reservat3.rs_reserid, this
	ENDPROC

	PROCEDURE refreshrecordstate
		LOCAL lcTTText, lcInstText, lcNoteText
		
		lcTTText = this.GetToolTipText()
		this.Rsbgrid.ToolTipText = lcTTText
		
		IF NOT EMPTY(this.cTbrClass)
			lcInstText = IIF(EMPTY(reservat3.rs_billins), [GetLangText("RESERVAT","TXT_BILLINST")], [GetLangText("RESERVAT","TXT_EDITBILLINST")])
			lcNoteText = IIF(EMPTY(reservat3.rs_note), [GetLangText("RESERVAT","TXT_RSNOTE")], [GetLangText("RESERVAT","TXT_EDITRSNOTE")])
			this.TbrCtrl.ChangeCaption(P_INSTRUCTION, lcInstText)
			this.TbrCtrl.ChangeCaption(P_NOTE, lcNoteText)
		ENDIF
	ENDPROC

	PROCEDURE Resize
		LPARAMETERS nwidth,nheight
		
		DODEFAULT(nwidth,nheight)
		
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this
				_screen.oCardReaderHandler.oHicHandler.oCr.MoveForm()
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE searchres
		LPARAMETERS lnbarnum, lp_lOnlyGetForClause
		LOCAL l_cFilter, l_lFound, l_nFound, l_lZapCursor, l_lBrowseFromSelected, l_lLockScreen
		LOCAL l_nCurrentSelected, i, l_cForClause, l_cForClause1, l_cCondition
		
		l_lFound = .T.
		l_nFound = 0
		l_cFilter = ""
		DO CASE
			CASE lnbarnum = 12 && Search on rs_reserid
			CASE this.lOnlyRooms
				l_cFilter = " AND NOT INLIST(roomtypeforbrowse.rt_group, 2, 3)"
			CASE this.lOnlyConf
				l_cFilter = " AND roomtypeforbrowse.rt_group = 2"
			CASE this.lOnlyDummies
				l_cFilter = " AND roomtypeforbrowse.rt_group = 3"
			OTHERWISE
		ENDCASE
		IF NOT this.lIncludeCXL AND NOT INLIST(lnbarnum, 11, 12, 13)
			l_cFilter = l_cFilter + [ AND rs_status <> 'CXL']
		ENDIF
		IF NOT this.lIncludeNS AND NOT INLIST(lnbarnum, 11, 12)
			l_cFilter = l_cFilter + [ AND rs_status <> 'NS']
		ENDIF
		
		IF lp_lOnlyGetForClause
			* Called from init, to get filter when from init called searchres form.
			RETURN l_cFilter
		ENDIF
		
		IF NOT EMPTY(this.cBuilding)
			l_cFilter = l_cFilter + [ AND roomtypeforbrowse.rt_buildng = ']+this.cBuilding+[']
		ENDIF
		IF INLIST(lnbarnum, 15, 16)
			*display all records or apply rt_group and rs_status filters.
			l_lLockScreen = this.LockScreen
			this.LockScreen = .T.
			l_cFilter = STRTRAN(l_cFilter, "roomtype.", "roomtypeforbrowse.")
			IF lnbarnum = 15
				l_cForClause = ".T."
			ELSE
				l_cForClause = this.rsbgrid.cForClause
			ENDIF
			l_cForClause = STRTRAN(l_cForClause, " AND NOT INLIST(roomtypeforbrowse.rt_group, 2, 3)")
			l_cForClause = STRTRAN(l_cForClause, " AND roomtypeforbrowse.rt_group = 2")
			l_cForClause = STRTRAN(l_cForClause, " AND roomtypeforbrowse.rt_group = 3")
			l_cForClause = STRTRAN(l_cForClause, " AND rs_status <> 'CXL'")
			l_cForClause = STRTRAN(l_cForClause, " AND rs_status <> 'NS'")
			l_cForClause1 = l_cForClause
			FOR i = 1 TO OCCURS("AND",l_cForClause)+1
				l_nPos = AT("AND",l_cForClause1)
				l_cCondition = ALLTRIM(IIF(l_nPos = 0, l_cForClause1, LEFT(l_cForClause1,l_nPos-1)))
				l_cForClause1 = ALLTRIM(IIF(l_nPos = 0, "", SUBSTR(l_cForClause1,l_nPos+3)))
				IF "roomtypeforbrowse.rt_buildng" $ l_cCondition
					l_cForClause = STRTRAN(l_cForClause, " AND "+l_cCondition)
				ENDIF
			NEXT
			this.rsbgrid.cForClause = l_cForClause + l_cFilter
			this.rsbgrid.cLocateForClause = ""
			IF l_cForClause == ".T."
				this.rsbgrid.cOrder = "tag20" && default order in grid
				this.rsbgrid.eSeekExpression = DTOS(g_sysdate)
			ELSE
				this.rsbgrid.eSeekExpression = ""
			ENDIF
			l_lFound = DLocate("reservat3", this.rsbgrid.cForClause)
			GO TOP IN this.rsbgrid.cSourceAlias
			l_lZapCursor = .T.
			l_lBrowseFromSelected = .F.
			l_lFound = this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
			this.LockScreen = l_lLockScreen
		ELSE
			DO FORM forms\searchres WITH this, lnbarnum, l_cFilter TO l_nFound
			* Returned values:
			*	1 - Cancelled
			*	2 - Not found, leave old order and filter
			*	3 - Found
			*	4 - Found similar, seek near, leave old filter
			DO CASE
				CASE l_nFound = 2
					this.SetWhileClause(.T.)
					l_lZapCursor = .T.
					l_lBrowseFromSelected = .T.
					this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
				CASE l_nFound = 3
					this.SetWhileClause(.T.)
					l_lZapCursor = .T.
					this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
				CASE l_nFound = 4
					this.SetWhileClause(.T.)
					l_lZapCursor = .T.
					this.rsbgrid.requerycursor(l_lZapCursor, l_lBrowseFromSelected)
				OTHERWISE
					* when l_nFound = 1 do nothing
			ENDCASE
		ENDIF
		RETURN .T.
	ENDPROC

	PROCEDURE setaddress
		LPARAMETERS pl_nMode, pl_nAddrId
		
		GO RECNO('reservat3') IN reservat
		
		IF SEEK(pl_nAddrId, "address", "tag1")
			DO CASE
				CASE pl_nMode = 1
					this.Checkreservat1.rs_addrid_change()
					= TABLEUPDATE(.T.,.T.,"reservat")
				CASE pl_nMode = 2
					this.Checkreservat1.rs_compid_change("reservat", pl_nAddrId)
					= TABLEUPDATE(.T.,.T.,"reservat")
			ENDCASE
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE setcolumnwidthandformsize
	ENDPROC

	PROCEDURE setcontrolsource
		this.rsbgrid.RecordSource=this.gridcontrolsource
		FOR i = 1 TO this.rsbgrid.ColumnCount
			this.rsbgrid.columns(i).header1.caption=this.aaolumns(i,1)
			this.rsbgrid.columns(i).controlsource=this.aaolumns(i,2)
		NEXT
		
	ENDPROC

	PROCEDURE setformsize
		LPARAMETERS tlDontResize, tlDontRefresh, tlNoWhRatio
		
		DODEFAULT(tlDontResize, tlDontRefresh, tlNoWhRatio)
		
		this.lIncludeNS = this.oScreens.sc_usset1
		this.lIncludeCXL = this.oScreens.sc_usset2
		this.lOnlyDummies = this.oScreens.sc_usset3
	ENDPROC

	PROCEDURE setwhileclause
		LPARAMETERS lp_lFromSearchDialog
		DO CASE
			CASE this.mode = 54
				IF UPPER(thisform.rsbgrid.cOrder)="TAG31"
					* Only IN reservations. Add while clause to speedup data transfer, when working over network
					this.rsbgrid.cWhileClause = "rs_depdate>="+sqlcnv(sysdate())
				ELSE
					this.rsbgrid.cWhileClause = ".T."
				ENDIF
			CASE this.mode = 50
				IF EMPTY(this.dDateSearched) OR lp_lFromSearchDialog
					this.rsbgrid.cWhileClause = ".T."
				ELSE
					this.rsbgrid.cWhileClause = "rs_arrdate="+sqlcnv(this.dDateSearched)
				ENDIF
			CASE this.mode = 51
				IF EMPTY(this.dDateSearched) OR lp_lFromSearchDialog
					this.rsbgrid.cWhileClause = ".T."
				ELSE
					this.rsbgrid.cWhileClause = "rs_depdate="+sqlcnv(this.dDateSearched)
				ENDIF
			CASE this.mode = 52
				IF EMPTY(this.dDateSearched) OR lp_lFromSearchDialog OR ;
						NOT LEFT(this.rsbgrid.cForClause,20) = "RS_IN+RS_LNAME = '1'"
					this.rsbgrid.cWhileClause = ".T."
				ELSE
					this.rsbgrid.cWhileClause = "RS_IN+RS_LNAME = '1'"
				ENDIF
		ENDCASE
		RETURN .T.
	ENDPROC

	PROCEDURE takecontrolsource
		this.gridcontrolsource = this.rsbgrid.RecordSource
		FOR i = 1 TO this.rsbgrid.ColumnCount
			this.aaolumns(i,1)=this.rsbgrid.columns(i).header1.caption
			this.aaolumns(i,2)=this.rsbgrid.columns(i).controlsource
		NEXT
		
	ENDPROC

	PROCEDURE Unload
		LOCAL l_nI
		l_nI = 0
		
		DODEFAULT()
		
		IF TYPE("_screen.oCardReaderHandler.oHicHandler.oCr") = "O"
			IF _screen.oCardReaderHandler.oHicHandler.oCr.oParent = this
				_screen.oCardReaderHandler.oHicHandler.oCr.oParent = .NULL.
			ENDIF
		ENDIF
		
		DO CASE
			CASE this.mode = 2
				IF VARTYPE(this.oCallingObj) = "O"
					this.oCallingObj.Enabled = .T.
					IF NOT thisform.cancelpressed 
						this.oCallingObj.SetReservation(reservat3.rs_reserid)
						this.oCallingObj.tbtoreservation.SetFocus()
					ENDIF
				ENDIF
			CASE this.mode = 3
				FOR l_nI = 1 TO _screen.FormCount
					IF INLIST(UPPER(_screen.Forms(l_nI).Name), 'BRWAVAIL', 'BRWALLOTTAVAIL')
						_screen.Forms(l_nI).Enabled = .T.
						_screen.Forms(l_nI).GrdAvail.SetFocus()
						EXIT
					ENDIF
				ENDFOR
			CASE this.mode = 4
				FOR l_nI = 1 TO _screen.FormCount
					IF UPPER(_screen.Forms(l_nI).Name)='ZOOMINFORM'
						_screen.Forms(l_nI).Enabled = .T.
						_screen.Forms(l_nI).Activate()
					ENDIF
				ENDFOR
			CASE this.mode = 5
				IF TYPE("this.oCallingObj")="O" AND NOT ISNULL(this.oCallingObj)
					this.oCallingObj.Enabled = .T.
					this.oCallingObj.Activate()
					IF NOT thisform.cancelpressed 
						this.oCallingObj.Parent.resshareproc(reservat3.rs_reserid)
					ENDIF
				ENDIF
			OTHERWISE
		ENDCASE
	ENDPROC

	PROCEDURE writeformsize
		this.oScreens.sc_usset1 = this.lIncludeNS
		this.oScreens.sc_usset2 = this.lIncludeCXL
		this.oScreens.sc_usset3 = this.lOnlyDummies
		
		DODEFAULT()
	ENDPROC

	PROCEDURE ogroupfunctions.ongroupcolor
		LOCAL llZapCursor, llBrowseFromSelected
		
		IF DODEFAULT()
			llZapCursor = .T.
			llBrowseFromSelected = .T.
			thisform.Rsbgrid.RequeryCursor(llZapCursor, llBrowseFromSelected)
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE ogroupfunctions.ongroupnamechange
		LOCAL llZapCursor, llBrowseFromSelected
		
		IF DODEFAULT()
			llZapCursor = .T.
			llBrowseFromSelected = .T.
			thisform.Rsbgrid.RequeryCursor(llZapCursor, llBrowseFromSelected)
		ENDIF
		
		RETURN .T.
	ENDPROC

	PROCEDURE rsbgrid.AfterRowColChange
		LPARAMETERS nColIndex
		
		DODEFAULT(nColIndex)
		
		thisform.RefreshRecordState()
	ENDPROC

	PROCEDURE rsbgrid.DblClick
		IF thisform.Mode = 54
			_screen.oProcessHandler(ALLTRIM(STR(P_BILL))).Execute(thisform, "GridDblClick")
		ELSE
			DODEFAULT()
		ENDIF
	ENDPROC

	PROCEDURE rsbgrid.Init
		LPARAMETERS lp_lDoIt
		IF NOT lp_lDoIt
			RETURN .T.
		ENDIF
		this.SetAll('movable',thisform.mode <> 54,'column')
		this.SetAll('readonly',.T.,'column')
		*this.SetAll('resizable',.F.,'column')
		
		*!*	STORE .T. TO ;
		*!*		this.column3.Resizable, ;
		*!*		this.column4.Resizable, ;
		*!*		this.column5.Resizable, ;
		*!*		this.column6.Resizable, ;
		*!*		this.column7.Resizable, ;
		*!*		this.column9.Resizable, ;
		*!*		this.column10.Resizable, ;
		*!*		this.column11.Resizable, ;
		*!*		this.column12.Resizable, ;
		*!*		this.column13.Resizable, ;
		*!*		this.column14.Resizable, ;
		*!*		this.column15.Resizable, ;
		*!*		this.column16.Resizable, ;
		*!*		this.column17.Resizable, ;
		*!*		this.column18.Resizable, ;
		*!*		this.column19.Resizable, ;
		*!*		this.column20.Resizable, ;
		*!*		this.column21.Resizable, ;
		*!*		this.column22.Resizable
		
		IF thisform.mode = 54
			this.Column9.CurrentControl = "Tbgrid1"
			this.Column9.Sparse = .T.
		
			this.DefaultPropertiesSet(5, "gr_activ", .F.)
			this.DefaultPropertiesSet(5, "gr_show", .F.)
			this.DefaultPropertiesSet(8, "gr_activ", .F.)
			this.DefaultPropertiesSet(8, "gr_show", .F.)
			this.DefaultPropertiesSet(10, "gr_activ", .F.)
			this.DefaultPropertiesSet(10, "gr_show", .F.)
			this.DefaultPropertiesSet(11, "gr_activ", .F.)
			this.DefaultPropertiesSet(11, "gr_show", .F.)
			this.DefaultPropertiesSet(14, "gr_activ", NOT _screen.oGlobal.oParam.pa_noagent)
			this.DefaultPropertiesSet(14, "gr_show", NOT _screen.oGlobal.oParam.pa_noagent)
			this.DefaultPropertiesSet(16, "gr_activ", .F.)
			this.DefaultPropertiesSet(16, "gr_show", .F.)
			this.DefaultPropertiesSet(17, "gr_activ", .F.)
			this.DefaultPropertiesSet(17, "gr_show", .F.)
			this.DefaultPropertiesSet(18, "gr_activ", .F.)
			this.DefaultPropertiesSet(18, "gr_show", .F.)
			this.DefaultPropertiesSet(19, "gr_activ", .F.)
			this.DefaultPropertiesSet(19, "gr_show", .F.)
			this.DefaultPropertiesSet(21, "gr_activ", .F.)
			this.DefaultPropertiesSet(21, "gr_show", .F.)
			this.DefaultPropertiesSet(22, "gr_activ", .F.)
			this.DefaultPropertiesSet(22, "gr_show", .F.)
			this.DefaultPropertiesSet(23, "gr_activ", .F.)
			this.DefaultPropertiesSet(23, "gr_show", .F.)
			this.DefaultPropertiesSet(24, "gr_activ", .F.)
			this.DefaultPropertiesSet(24, "gr_show", .F.)
			this.DefaultPropertiesSet(25, "gr_activ", .F.)
			this.DefaultPropertiesSet(25, "gr_show", .F.)
		
			* Adjust initial column order
			this.DefaultPropertiesSet(7,  "gr_order", 1)	&& rs_roomnum
			this.DefaultPropertiesSet(6,  "gr_order", 2)	&& rs_roomtyp
			this.DefaultPropertiesSet(12, "gr_order", 3)	&& rs_lname
			this.DefaultPropertiesSet(1,  "gr_order", 4)	&& rs_arrdate
			this.DefaultPropertiesSet(2,  "gr_order", 5)	&& rs_depdate
			this.DefaultPropertiesSet(3,  "gr_order", 6)	&& rs_arrtime
			this.DefaultPropertiesSet(4,  "gr_order", 7)	&& rs_deptime
			this.DefaultPropertiesSet(9,  "gr_order", 8)	&& rs_status
			this.DefaultPropertiesSet(13, "gr_order", 9)	&& rs_company
			this.DefaultPropertiesSet(15, "gr_order", 10)	&& rs_group
			this.DefaultPropertiesSet(14, "gr_order", 11)	&& rs_agent
			this.DefaultPropertiesSet(20, "gr_order", 12)	&& Balance
			this.DefaultPropertiesSet(26, "gr_order", 13)	&& rs_paymeth
		ELSE
			this.DefaultPropertiesSet(1, "gr_show", .F.)
			this.DefaultPropertiesSet(2, "gr_show", .F.)
			this.DefaultPropertiesSet(5, "gr_show", .F.)
			this.DefaultPropertiesSet(7, "gr_show", .F.)
			this.DefaultPropertiesSet(8, "gr_show", .F.)
			this.DefaultPropertiesSet(9, "gr_show", .F.)
			this.DefaultPropertiesSet(10, "gr_show", .F.)
			this.DefaultPropertiesSet(12, "gr_show", .F.)
		
			this.DefaultPropertiesSet(14, "gr_activ", NOT _screen.oGlobal.oParam.pa_noagent)
			this.DefaultPropertiesSet(14, "gr_show", NOT _screen.oGlobal.oParam.pa_noagent)
			this.DefaultPropertiesSet(16, "gr_activ", NOT _screen.oGlobal.oParam2.pa_noresid)
			this.DefaultPropertiesSet(16, "gr_show", NOT _screen.oGlobal.oParam2.pa_noresid)
			this.DefaultPropertiesSet(18, "gr_activ", _screen.oGlobal.oParam.pa_rsus3)
			this.DefaultPropertiesSet(18, "gr_show", _screen.oGlobal.oParam.pa_rsus3)
			this.DefaultPropertiesSet(20, "gr_activ", .T.) && Balance column as default on
			this.DefaultPropertiesSet(20, "gr_show", .T.) && Show always balance column
			this.DefaultPropertiesSet(21, "gr_activ", _screen.oGlobal.oParam2.pa_sgrpbl)
			this.DefaultPropertiesSet(21, "gr_show", _screen.oGlobal.oParam2.pa_sgrpbl)
			this.DefaultPropertiesSet(22, "gr_activ", g_lShips)
			this.DefaultPropertiesSet(22, "gr_show", g_lShips)
			this.DefaultPropertiesSet(23, "gr_activ", g_lShips)
			this.DefaultPropertiesSet(23, "gr_show", g_lShips)
		
			* Adjust initial column order
			this.DefaultPropertiesSet(25, "gr_order", 12)	&& rs_title
		ENDIF
		
		this.RecordSource = ""
		this.cSourceAlias = "reservatforbrowse"
		this.cMaintainedAlias = "reservat3"
		IF thisform.mode = 54
			DIMENSION this.aColumns(26, ALEN(this.aColumns, 2))
		ELSE
			DIMENSION this.aColumns(27, ALEN(this.aColumns, 2))
		ENDIF
		this.aColumns(1, 4) = IIF(thisform.mode = 54, [rs_arrdate], [STUFF(TRANSFORM(rs_arrdate),7,2,'')])
		this.aColumns(1, 3) = GetLangText("RESERVAT","TH_ARRDATE")
		this.aColumns(2, 4) = IIF(thisform.mode = 54, [rs_depdate], [STUFF(TRANSFORM(rs_depdate),7,2,'')])
		this.aColumns(2, 3) = GetLangText("RESERVAT","TH_DEPDATE")
		this.aColumns(3, 1) = IIF(_screen.oGlobal.lVehicleRentMode,[rs_lstart],[rs_arrtime])
		this.aColumns(3, 3) = GetLangText("RESERVAT","TH_FROM")
		this.aColumns(4, 1) = IIF(_screen.oGlobal.lVehicleRentMode,[rs_lfinish],[rs_deptime])
		this.aColumns(4, 3) = GetLangText("RESERVAT","TH_TO")
		this.aColumns(5, 1) = [rs_rooms]
		this.aColumns(5, 3) = GetLangText("RESERVAT","TH_ROOMS")
		this.aColumns(6, 1) = [Get_rt_roomtyp(rs_roomtyp)]
		this.aColumns(6, 3) = GetLangText("RESERVAT","TH_ROOMTYP")
		this.aColumns(7, 4) = [Get_rm_rmname(rs_roomnum) + TRIM(rs_share)] + IIF(thisform.mode = 54, [], [ + IIF(SysDate() = rs_arrdate AND _screen.oGlobal.oParam.pa_rmstat AND ] + ;
				[DbLookup("room", "tag1", rs_roomnum, "rm_status") = "DIR" AND INLIST(Get_rt_roomtyp(rs_roomtyp,"rt_group"), 1, 4), "!", "")])
		this.aColumns(7, 3) = GetLangText("RESERVAT","TH_ROOMNUM")
		IF _screen.oGlobal.oParam2.pa_autoper
			this.aColumns(8, 4) = [PADL(IIF(rs_autoper,"+","")+ALLTRIM(STR(rs_adults+rs_childs+rs_childs2+rs_childs3)),4)]
		ELSE
			this.aColumns(8, 4) = [PADL(ALLTRIM(STR(rs_adults+rs_childs+rs_childs2+rs_childs3)),4)]
		ENDIF
		this.aColumns(8, 3) = GetLangText("RESERVAT","TH_PERS")
		this.aColumns(9, 1) = [rs_status]
		this.aColumns(9, 3) = GetLangText("RESERVAT","TH_STATUS")
		this.aColumns(10, 1) = [rs_ratecod]
		this.aColumns(10, 3) = GetLangText("RESERVAT","T_RATECODE")
		this.aColumns(11, 1) = [rs_rate]
		this.aColumns(11, 3) = GetLangText("RESERVAT","T_RATE")
		this.aColumns(12, 4) = [IIF(SEEK(rs_reserid,"document","tag2"),"!","") + GetReservatName(thisform.Rsbgrid.RecordSource,"address_fbgrd","apartner_fbgrd")]
		this.aColumns(12, 3) = GetLangText("RESERVAT","TH_LNAME")
		this.aColumns(12, 5) = [IIF(SEEK(rs_reserid,"document","tag2"),RGB(255,0,0),RGB(0,0,0))]
		this.aColumns(12, 13) = [IIF(SEEK(rs_reserid,"document","tag2"),.T.,.F.)]
		this.aColumns(13, 4) = [IIF(rs_noaddr,TRIM(rs_company),TRIM(addrcom_fbgrd.ad_company))]
		this.aColumns(13, 3) = GetLangText("RESERVAT","TH_COMPANY")
		this.aColumns(14, 4) = [TRIM(addrag_fbgrd.ad_company)]
		this.aColumns(14, 3) = GetLangText("RESERVAT","TH_AGENT")
		this.aColumns(15, 1) = [rs_group]
		this.aColumns(15, 3) = GetLangText("RESERVAT","TH_GROUP")
		this.aColumns(15, 5) = [IIF(EMPTY(rs_groupid), RGB(0,0,0), DLookUp("groupres", "gr_groupid = " + SqlCnv(rs_groupid), "gr_color"))]
		
		this.aColumns(16, 1) = [rs_reserid]
		this.aColumns(16, 3) = GetLangText("GROUPBIL","TXT_RESERID")
		
		
		this.aColumns(17, 4) = [IIF(address_fbgrd.ad_vip OR (NOT EMPTY(rs_apid) ] + ;
				[AND SEEK(rs_apid, "apartner_fbgrd", "tag3") ] + ;
				[AND apartner_fbgrd.ap_vip1), "X", "")]
		this.aColumns(17, 3) = GetLangText("RESERVAT","TH_VIP")
		this.aColumns(18, 4) = [IIF(SUBSTR(_screen.oGlobal.oParam.pa_setusre,3,1) = 'C', ] + ;
				[IIF(rs_usrres3='T','#',''), ] + ;
				[IIF(NOT EMPTY(rs_usrres3), rs_usrres3,''))]
		this.aColumns(18, 3) = ALLTRIM(_screen.oGlobal.oParam.pa_usrres3)
		this.aColumns(19, 4) = [thisform.getcolumn18cs(thisform.Rsbgrid.RecordSource)]
		this.aColumns(19, 3) = GetLangText("RESERVAT","TXT_PRICE_SIGNS")
		this.aColumns(20, 4) = [Balance(rs_reserid)]
		this.aColumns(20, 3) = GetLangText("CHKOUT1","TH_BALANCE")
		this.aColumns(21, 4) = [thisform.getdummybill(rs_ratedat)]
		this.aColumns(21, 3) = GetLangText("RESERVAT","TH_BILL_CREATED")
		this.aColumns(22, 4) = [thisform.GetEventName(rs_altid)]
		this.aColumns(22, 3) = GetLangText("EVENT","TXT_EVENT")
		this.aColumns(23, 4) = [thisform.GetBuildingName(rs_altid)]
		this.aColumns(23, 3) = GetLangText("HOTSTAT","T_BUILDING")
		this.aColumns(24, 3) = GetLangText("ACT","TW_ACTIVITIES")
		this.aColumns(24, 4) = [DLookUp("action", "at_reserid = " + SqlCnv(rs_reserid,.T.) + " AND at_compl = " + SqlCnv({},.T.), "at_acttyp")]
		this.aColumns(24,12) = [thisform.OnCellOpen('OPEN_ACTION')]
		this.aColumns(25, 3) = GetLangText("ADDRESS","TXT_TITLE")
		this.aColumns(25, 4) = [IIF(rs_noaddr,TRIM(rs_title),TRIM(address_fbgrd.ad_title))]
		this.aColumns(26, 3) = GetLangText("CHKOUT1","TXT_PAYMETHOD")
		this.aColumns(26, 1) = "rs_paymeth"
		
		IF thisform.mode = 54
			this.aColumns(1, 8) = "tag29"		&& rs_in+DTOS(rs_arrdate)+rs_lname
			this.aColumns(2, 8) = "tag31"		&& rs_in+DTOS(rs_depdate)+rs_rmname+rs_out
			this.aColumns(7, 8) = "tag32"		&& rs_in+rs_rmname+rs_out
			this.aColumns(12, 8) = "tag7"		&& rs_in+rs_lname
			this.aColumns(13, 8) = "tag28"	&& rs_in+rs_company+DTOS(rs_arrdate)
			this.aColumns(14, 8) = "tag4"		&& rs_agent+DTOS(rs_arrdate)
			this.aColumns(15, 8) = "tag30"	&& rs_in+rs_group+DTOS(rs_arrdate)+rs_lname
		ELSE
			this.aColumns(1, 8) = "tag20"		&& DTOS(rs_arrdate)+rs_group+rs_lname	- default order in grid
			this.aColumns(2, 8) = "tag34"		&& DTOS(rs_depdate)+PADL(VAL(rs_rmname),8)+rs_rmname
			IF _screen.oGlobal.lVehicleRentMode
				this.aColumns(3, 8) = "tag37"	&& rs_lstart
				this.aColumns(4, 8) = "tag38"	&& rs_lfinish
			ENDIF
			this.aColumns(7, 8) = "tag36"		&& rs_rmname+DTOS(rs_arrdate)+DTOS(rs_depdate)
			this.aColumns(12, 8) = "tag2"		&& rs_lname
			this.aColumns(13, 8) = "tag3"		&& rs_company+DTOS(rs_arrdate)
			this.aColumns(14, 8) = "tag4"		&& rs_agent+DTOS(rs_arrdate)
			this.aColumns(15, 8) = "tag5"		&& rs_group+DTOS(rs_arrdate)+rs_lname
			this.aColumns(16, 8) = "tag1"		&& rs_reserid
			this.aColumns(27, 3) = GetLangText("RESBRW","TXT_HAS_BILLINS")
			this.aColumns(27, 1) = "IIF(EMPTY(VAL(MLINE(rs_billins,1))),["+GetLangText("COMMON", "TXT_NO")+"],["+GetLangText("COMMON", "TXT_YES")+"])"
		ENDIF
		
		IF thisform.mode <> 54 AND _screen.oGlobal.oParam.pa_plancol
			this.aColumns(9, 5) = StrToMsg("ICASE(rs_status = [OUT], %n1, " + ;
										  "rs_status = [IN],  %n2, " + ;
										  "rs_status = [DEF], %n3, " + ;
										  "rs_status = [OPT], %n4, " + ;
										  "rs_status = [LST], %n5, " + ;
										  "rs_status = [ASG], %n6, " + ;
										  "rs_status = [6PM], %n7, " + ;
										  "rs_status = [TEN], %n8, " + ;
										  "rs_status = [CXL], %n9, " + ;
										  "rs_status = [NS],  %n10, %n11)", ;
										  g_oPredefinedColors.FrOutColor, ;
										  g_oPredefinedColors.FrInColor, ;
										  g_oPredefinedColors.FrDeffiniteColor, ;
										  g_oPredefinedColors.FrOptionColor, ;
										  g_oPredefinedColors.FrWaitingColor, ;
										  g_oPredefinedColors.FrAssignColor, ;
										  g_oPredefinedColors.Fr6PMColor, ;
										  g_oPredefinedColors.FrTENColor, ;
										  g_oPredefinedColors.FrCanceledColor, ;
										  g_oPredefinedColors.FrNoShowColor, g_oPredefinedColors.FrOutColor)
		ENDIF
		
		IF NOT _screen.oGlobal.oParam.pa_norcclr
			this.aColumns(10, 5) = [ProcRatecode("GetRatecodeColor", thisform.Rsbgrid.RecordSource, RGB(0, 0, 0))]
		ENDIF
		
		DODEFAULT(.T.)
		IF thisform.mode <> 54
			this.column9.Tcntgrid1.ControlSource = this.aColumns(9, 1)
			IF _screen.oGlobal.oParam.pa_plancol
				this.column9.DynamicBackColor = StrToMsg("ICASE(rs_status = [OUT], %n1, " + ;
											  "rs_status = [IN],  %n2, " + ;
											  "rs_status = [DEF], %n3, " + ;
											  "rs_status = [OPT], %n4, " + ;
											  "rs_status = [LST], %n5, " + ;
											  "rs_status = [ASG], %n6, " + ;
											  "rs_status = [6PM], %n7, " + ;
											  "rs_status = [TEN], %n8, " + ;
											  "rs_status = [CXL], %n9, " + ;
											  "rs_status = [NS],  %n10, %n11)", ;
											  g_oPredefinedColors.BkOutColor, ;
											  g_oPredefinedColors.BkInColor, ;
											  g_oPredefinedColors.BkDeffiniteColor, ;
											  g_oPredefinedColors.BkOptionColor, ;
											  g_oPredefinedColors.BkWaitingColor, ;
											  g_oPredefinedColors.BkAssignColor, ;
											  g_oPredefinedColors.Bk6PMColor, ;
											  g_oPredefinedColors.BkTENColor, ;
											  g_oPredefinedColors.BkCanceledColor, ;
											  g_oPredefinedColors.BkNoShowColor, g_oPredefinedColors.BkOutColor)
			ENDIF
		ENDIF
		
		SET ORDER TO Tag3 IN apartner_fbgrd
		SET ORDER TO Tag1 IN address_fbgrd
		SET ORDER TO Tag1 IN addrcom_fbgrd
		SET ORDER TO Tag1 IN addrag_fbgrd
		SET RELATION TO rs_apid INTO apartner_fbgrd IN (this.RecordSource) ADDITIVE
		SET RELATION TO rs_addrid INTO address_fbgrd IN (this.RecordSource) ADDITIVE
		SET RELATION TO rs_compid INTO addrcom_fbgrd IN (this.RecordSource) ADDITIVE
		SET RELATION TO rs_agentid INTO addrag_fbgrd IN (this.RecordSource) ADDITIVE
		
		this.SetAll('alignment',2,'theader')
		RETURN .T.
	ENDPROC

	PROCEDURE rsbgrid.MouseUp
		LPARAMETERS nButton, nShift, nXCoord, nYCoord
		
		DO CASE
			CASE nbutton = 1
				this.lUpdateCursorData = .T.
				DODEFAULT(nButton, nShift, nXCoord, nYCoord)
				this.lUpdateCursorData = .F.
			OTHERWISE
				DODEFAULT(nButton, nShift, nXCoord, nYCoord)
		ENDCASE
	ENDPROC

	PROCEDURE rsbgrid.setordering
		LPARAMETERS lp_cSortOrder, lp_lAskOrder
		
		IF UPPER(lp_cSortOrder)="TAG31"
			this.cWhileClause = "rs_depdate>=" + SqlCnv(SysDate())
		ELSE
			this.cWhileClause = ".T."
		ENDIF
		
		RETURN DODEFAULT(lp_cSortOrder, lp_lAskOrder)
	ENDPROC

ENDDEFINE

*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="pickallotform.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS pickallotform AS tform OF "..\libs\main.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleReserData" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleImageList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOK" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: addnode
		*m: checkwhichroomsarefree
		*m: onclose
		*m: onselect
		*p: odata
	*</DefinedPropArrayMethod>

	Caption = "pickallotform"
	ControlBox = .T.
	DoCreate = .T.
	Height = 420
	Icon = ..\bitmap\icons\mac01.ico
	KeyPreview = .T.
	Name = "pickallotform"
	odata = .NULL.
	Width = 408
	WindowType = 1

	ADD OBJECT 'cmdCancel' AS tcommandbutton WITH ;
		Anchor = 9, ;
		Caption = "cmdCancel", ;
		Left = 312, ;
		Name = "cmdCancel", ;
		Top = 48, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdOK' AS tcommandbutton WITH ;
		Anchor = 9, ;
		Caption = "cmdOK", ;
		Left = 312, ;
		Name = "cmdOK", ;
		Top = 12, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\libs\main.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'oleImageList' AS olecontrol WITH ;
		Left = 252, ;
		Name = "oleImageList", ;
		Top = 12, ;
		Visible = .F., ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+////BQAAAAYAAAAHAAAACAAAAAkAAAAKAAAAFAAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAABAAAABUAAAAWAAAAFwAAABgAAAD+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJChXlNFOMoBAwAAAAABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAApigAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAFcAAAAAAAAAAQAAAP7///8DAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMSQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RQEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAABJCgAAABgAAAALAAAASW1hZ2V3aWR0aAAJAAAASQoAAAAYAAAADQAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGAAgAAAAQABAAwMDAAP//AAAB782rAAAFADBKHAAGAAAA/////wUAAIAAAAAADAAAAAENAAAAUABhAHMAdABhAHMAIABsAG8AYwBhAGkAcwABEAAAAEMAYQBpAHgAYQAgAGQAZQAgAGUAbgB0AHIAYQBkAGEAAQ4AAABDAGEAaQB4AGEAIABkAGUAIABzAGEA7QBkAGEAAQ4AAABJAHQAZQBuAHMAIABlAG4AdgBpAGEAZABvAHMAAQ8AAABJAHQAZQBuAHMAIABlAHgAYwBsAHUA7QBkAG8AcxgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA/////f395ubmuLi4nZ2do6OjtbW1yMjI2dnZ5eXl8PDw+Pj4/f39////////////////9PT04LSe7bSUzKCHspB9koV9jImGlZWVp6enu7u7zc3N3d3d6+vr+Pj4/v7+/v7+59HI9cKq/////vj1/ObZ+tbA5byiyJyCpoR1kIJ8jIqJmpqaubm54+Pj+/v7+vr6462Y/fPu//Pv/uff/////////u/q+7ed+q+S96eH3pl9wpF6oJuZ19fX+vr68enm7LGb//////fy/NLC/Mq4/NDB+7ih+7GX+7ii+7ig+7mj+8Cev7Sr5eXl/f395r+x9tDC//n1/dvN/vDq//r2//Dq/7ie/KaH+qWH+7qj+9XFyquX0dDP+Pj4////4qWR+uHX//rz/t7Q/M28/Mu59sOw3p6H+7ad/8Om/+jf676ks6yo5+fn/v7+////4JeA/vHo/uHR/dfG/ure//nx0b+2Qk5hdqbYgLnt8OHbyJd8u7u77+/v////////5I50/+3h/+bU/tjE/cy2/sSr67+yT6rnA7P/D5H+XpTShn98qKio4ODg+/v7////55N4/MWq+7ma+8au/+LR/+jW8trTMdL1AMf/B7P+H474PHmsg4ODtra25eXl+/v79+Tf/fDj+97P8KOH85Ry/MCl/cCniMbMBNz+AMH/DK79I4/5SXighoaGubm56enp/////O3d//bs++nh8aB+/9/G/9vC+c65bNjkAtv/AL//JanwXozCcXN5jIyMxsbG/////////OjX/u/i+7uY/9S0/97D/+XL793ORt3xJdTzi6DITl7aID3ZX2B/qamp//////////38+eXa97OT/93G/+XK/+HE/+DB2eDYfrPMe4fvRGv/EUT/Hj3UtLS0/////////////v797rKg4o555peC8bik+9vI/9vGt3N2gJTwVXr/OGD+Xnbe3Nzc/////////////////////v39+enl7Lqs5J6K435e2aqhubvfg5btoazr3d/p+Pj4BwAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA/////////////////f398/Pz6Ojo5+fn6+vr8fHx+Pj4/f39/////////////////////////v7+/Pz89PT01tbWsrKyqKiosrKyvb29y8vL2tra5eXl7+/v+fn5/v7+////////9/f34uLi2Lmt4LGhx56QsYBxn3ZqkHt1i4aFlZWVpaWlvr6+4ODg+fn5/////f39zdnhmqu2k46R/9/O//fs/u/i+9/O88Sx3aOQv4FvpnFjkoaCwsLC8fHx////9PT0VazcDrz+U6HC+tfH//Dl/dfI/tW9/9zA/+XL//Df+93Mp3tvuLi47u7u/v7+stHlFbLzHcv/dcTS/+bX//Pr/eTc/dG9/s+0/+LJ//jt/eTTr4R4u7u78PDw+/v7b7viEcT+Mcj2tc7I//Pp/uba/dC9/c22/cy1/cmy/smq/drFpH1wubm57+/v5+7zNrnrGMv/S8To693N//38/eDV/dfH/c+7/c+5/Myz/9a689HAf3yCsLCw6+vrvtrrL8n6INH/e8LV//Lm//z7/+ff/+jh/ePa/dfG/ciu/9zF39DCVpe1qqqq6Ojols3oO9j/Ndb+p8PF+e3p9erm89jO+NbK/drO/dnM/dfG/+PSzdvNZKrCqqqq5+fngcfoTeT/Rt3+qry75byo17OmyZyQxLa0/f///////////OznwdrOba7Gra2t6Ojods3tZvP/U9/7l+P2+f32//Hh9MKvzquh////////////8eHbuNfWdq3FsbGx6urqgs3ubOr8aer8atz3huX6z+7x+trJ2L60////////////9ePax9rae6rEwsLC8PDw9fr90Of2sNvwktLscsnrZdLypNfhybes8ufc8+PW4drS3MjA3uDdkrvV4uLi+Pj4/////////////////v7++Pz+4fD5gsTlhPT1gvT2cebxaafIq8bY1uTt+vr6/v7+////////////////////////////1en2h9Dud9jxcs3sz93m9fX1/v7+////////CAAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA////////////////////////////////+vr67u7u6Ojo8fHx/Pz8/////////////////////v7++fn59/f3+vr6/v7+////7e3twsLCrKyswcHB4uLi8vLy+Pj4/f39////////9vb23d3dy8vL1dXV5+fn8vLy3J2K3KSIm3Bjh4eHqampwsLC2NjY8/Pz/////v7+y9rkfqnBg4ySk5OTrKyswL296IRj//jR+d+5qXFekW1jmXtzr6+v5+fn////9/f3Wa7dGr74JrHmQZC4YoCRjXl1+Jhw/ujB//DI/ezF/O3G2a+Qo6Oj5OTk////y97pFrX1KcX5Mdj/Kdn/SbHSw4p7/8Sb/du0/d63/uS9//PMyZp/p6en5ubm/v7+gcDjEsL9NMj3Ref/dcHM7LCL/7+W/Mqk/Mym/dGr/dav/+W+uoZwo6Oj5eXl+Pn5TrvpHMr/Pcz3Wuv6gM3S5sWj/8We/LuV+76Y+8Se/Mmj/9avx410o6Oj5OTk3OnxNcT1KNL/SdH2s8zBn8O8hL6+srSh+saf/LKM+7eS/riQ/bqU15J1ra2t6enpttfrPtX8NdX/VtX04+bU/8ur9cSns6yd1sCi/7aO/6B43KOGqsi9mYB6t7e37u7un9TrT+D+Rdv+cNr04tC89cq4/9bB08i6s7+z/6yB1YVuitDemPf3f5uovLy87+/vjs/tafL/Wub+ft35ydvT7NvQ//Ho3NjPmtTgn6uzjsjch9v0o9/tfaS1xMTE8vLyodXwadr0Z+b6Zdv2ct/6h+P2neLztubvvvb+vfn/vvX/seHwv+TsiKe61dXV+Pj4/f7+8Pj8zub1rNvwk9XubsjsYNHxXNj2bNz3f973lOH4td3uw+DusMfW7u7u/f39////////////////////////9fv9i9HuePj/dfr/XuL5iLDJvNLh8PP1/f39////////////////////////////////4fD5n9jwhdLtjMrn7e3t+vr6////////////CQAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////v7+/Pz89/f37e3t5ubm5eXl5eXl6+vr9fX1+/v7/v7+////////////////////+Pj44+PjzMzMtbW1pqampKSkpaWlsLCwyMjI39/f9fX1////////////////////5N3ss6XFlnHApWvojmLBoGjgkWPHfW+Ni4CXsrKy6Ojo/////v7+9fX16Ojo6Ojot4Txs3H/tXb9vIP/vIH/vIL/t3r+s3H/mmLcmpqa4ODg////9/f31tbWr6+vqampqnXowIr/v4j/v4n/wIr/wIn/v4f/v4n/pW3nmpqa4ODg////ytznPq3gQKLLWYOcmmrYxZT/xJP/xpT/xpX/xZT/xJH/xJD/p3Dmmpqa4ODg/Pz8crvhGr74LtP/Ls/9i3rwzKD/y5//zaL/0qX/zqL/ypz/zZ7/rHjmmpqa4ODg6+/zLrXsHsD4Rt3+RuH/k4r40ar/0an/zqj6tpXexJ7w0ab/t5LkmmzOmpqa4ODguNboIcf8J8f7YtrwX+HympD51rP/2LL/oI63LC4tbGN3wKTgUVJSUTlto6Oj5OTkfMTmM9j/MdD+r9XQ0ryjq4jh3Lz/2rv+sqfBrrGtop2puaPSub20oYPDvb297+/vacXqROL/QNH6wOLd/8qt353A0an/6NL/49L0xbXXybHn2rn+xabqqYjP4eHh+/v7YdTzWu7/V9j7ydnS/9nI/+DNrYri1rP/7+D/79z/4sb/0ar/roHh4eDj+fn5////cczuZ+H3Z+H5iuXzoNvoueTwuebsqL/4s6P5uJn3oYblqI/F4N/h/Pz8////////+fz+4O/4tt3xlNXuasvuWtLzY9z4f9/3k9/2wuPxqMjb39/f9/f3/////////////////////////////f7+4/H6btjyev3/Wtr1l7bJytrl+vr6/v7+////////////////////////////////////wuP1kNXvmM3o8fHx+/v7////////////////////CgAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA////////////////////+vr67Ozs4uLi6enp+Pj4/////////v7+/v7+/////////////////f39+vr6+/v76+vrv7+/oKCgs7Oz4ODg+Pj48vLy4uLi4ODg8PDw/Pz8/////v7+8fHx2tra1dXVfHR1STs/QUBCgYGBwsLC6urqzMzMn5+foKCgyMjI8fHx////+fn5tcnXkKOtkpKSp3Bz2IyRbkxRVlZXs7Ozvbu8W0lNPzY5WltcoaGh4+Pj////2uXrLKzmHrnyN5TAdX+V9KSmrGZqUlFToKCgI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGAFIBAAAQABAAwMDAAP//AAAB782rAAAFADBKHAAGAAAA/////wUAAIAAAAAADAAAAAENAAAAUABhAHMAdABhAHMAIABsAG8AYwBhAGkAcwABEAAAAEMAYQBpAHgAYQAgAGQAZQAgAGUAbgB0AHIAYQBkAGEAAQ4AAABDAGEAaQB4AGEAIABkAGUAIABzAGEA7QBkAGEAAQ4AAABJAHQAZQBuAHMAIABlAG4AdgBpAGEAZABvAHMAAQ8AAABJAHQAZQBuAHMAIABlAHgAYwBsAHUA7QBkAG8AcwABCQAAAFIAYQBzAGMAdQBuAGgAbwBzAAEKAAAARABvAGMAdQBtAGUAbgB0AG8AcwABCQAAAEYAYQB2AG8AcgBpAHQAbwBzAAEFAAAASgBvAGcAbwBzAAEHAAAATQD6AHMAaQBjAGEAcwABBQAAAEYAbwB0AG8AcwABBgAAAFYA7QBkAGUAbwBzAAwAAAABAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAD////////7+/vu7u7m5ubs7Oz39/f9/f3////////////////////////////////////////t7e3CwsKnp6eysrLMzMzj4+Py8vL7+/v////////////////////////////7+/vXmIfXc1Wsa1iLcmuMjIympqbAwMDY2Njr6+v39/f9/f3////////////////w6ObVY0TuiGPxj2vhelm5aFCUaV2Hf32YmJiysrLMzMzj4+Py8vL7+/v+/v7////hs6jcY0DphF/1on70nHfzl3LvimbSclWmZVOLcmuMjIylpaXDw8Pi4uL5+fn9/f3ZinPgb0vohmL3r4r0poH0on30oHv0nXnylXDhf126aVGWbWKPhoS7u7vt7e317+3deVnkfFjpi2b4tY36sYj8sYn4rYf0p4L0pYD0o330nnnvkWywblqmpqbm5ubrzcXmgl/ph2HpkW2xubOoqZ/RqI7rrIj3tY71sYv1rYj0qYT2rIfHf2Snp6fm5ubltKfslG/sj2nql3Kv3d6C5vl7ydyJrrbfr4/7wpr3vJb2t5L3tpHEjHOrq6vo6Ojhoo/xpH7ulnDrpYG34N+L2/R10vWF3/XEqpT2rYXysoz1upTzwJzClH2tra3o6OjjnIT1sozyoHr1uJCN1t+O0eqz5/ug4PPIspz2to3ws43up4Lps5DBmYOwsLDp6enpnYH8xZ73tI70sore0bTF2NHc5+LF4eTl0rL3yKDwtZDxtY/mtJHDnYezs7Pp6enttaXrpYfupYPvn3r2qoL1rYTxs4ztw6D2z6j53LX85r/417Hn1bPKqJLDw8Pu7u7////9+fj13dfx0cfps6Hnn4fqnX7smHPxqIPwqYPwrYjttI7k0LHXs6Dj4+P39/f////////////////////////9+Pbstqj5v5j9xp/6v5nXhGfJrKTo1M76+vr+/v7////////////////////////////89fPrqZPrpojvpoPfsaXv7+/8/Pz///////8CAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////+/v74+Pjr6+vm5ubv7+/7+/v////////////////9/f319fXy8vL4+Pj+/v7+/v7y8vLW1tazs7OmpqbAwMDp6en9/f3////////////x8fHR0dHBwcHPz8/j4+Pl5eW2wLZYpmZUzHVPhleNjY3FxcXx8fH+/v7////7+/vatau8f26OfXmOjo6kpKSOoo83qkpH6XFU9INR535adl2bm5vW1tb4+Pj////w6+rVZknuh2PlfVvBZlFobEsQlycy11M73F9E42xU84JGvmN2fna4uLju7u7+/v7gs6fcYz/si2f2n3v3mHWQh0QiihcNqCAv0k47215F5G1T84JNlFmzs7Ps7Oz7+/vZhW3hcU3qjWj4r4j1poH/oYSpllYHqBciyT4w01A73F9B4WhAoFbExMT09PTz6ebfeVfkfFjpk27ps5L1rYX/so64qWgQtyQZwTAlykEr2lNbpkaFgXfIyMj29vboxr3oiWTphmHkmXiRxM2ZuLnAqZ6fpm4jyD4NuCIWvSsZzj5wq1KgeXLFxcX09PTkrp7vnHbtk2zppoWs6fF43Pt00/NrsaI+yFMs0lAl1U0UzT1zrlqpgXfFxcXy8vLjoo30rIXyn3jotpV60emV1fCa5P2kyMzNr4Gxu3yKzX6Ns2vQso+vi3/Kysr09PTon4b7wpz0q4T1wJm21szJ4ODK7PS80c/2w539uZbyqIXrp4XhvqGtiX7S0tL39/fttKPspITvpYHvoHv3pn7vsYzsu5nyyKP627T527X52bLpzKnew6W8oZnh4eH7+/v////9+vn67ejvyr/tva3noYnolnfxoHvxp4HwqYPwsYvft5jhspbg09D09PT+/v7////////////////////////++/rqp4/8xJ78xJ7qlHHMta/o2dX6+vr+/v7////////////////////////////////45+Pww7PstaDluKvz8/P8/Pz///////////8DAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAD////////////////9/f3x8fHZ2dnJycnLy8vIyMi2tra3t7fY2Nj19fX+/v7////////////5+fns7Ozg4OC0vrRtjm1vgm96iHxFiUtCkE15gXqkpKTY2Nj4+Pj////////8/Pzl5eW7u7uCmYwYmRopyEQxwEwqq0AsuEZU7YJHrmBzenOqqqrf39/6+vr////x8vJlsNc9otgvhWIaxCoozUQy1lM832JC4GhL6Xda+Ys+jUqAgICwsLDi4uL+/v6tz+MVufYlwP8gn5Ew00khxjsixz0tz0s22Fk/3mVK6XRR7X1Dg0uHh4e/v7/6+vpbuOQUwvw1wfwopZNP7nMfxDcTuichxToqzkcz1VQ83GFI6HJO7HpLiFK+vr7g6vAmvfMZwvs/x/wrpKpJ220621UawywWvisdwjUoy0Mx1FA421g6zVBRmFbZ2dmv1Ogly/0ixftY2PhLsNQnm6IsspoislwTsCYTvScXwCoewDI0xWZHkYyoqKjm5uaExeUz1/8nyv172+jXuqG4trCBqbxLmL8mq2Mt0UQisERQz6V99PVfoMOjo6Pj4+NowehE4v80z/2B2uf53cb/yav/yKW8los8p5hj2rOH7vWU//+Z+/txuc2eoKDg4OBVz/NT6P9E1/6c2N/yvaP3z77/3svVu6t+0O2A3/6I5PmF4vai7PCHzNyipabj4+Nd2fZo9P9a2vmh7Prg07/5283/6N3iwrKN0+SM3/WP3/SK2PGy5uyFvdKrra3o6Ohx0/Fp5vlo5/tx4/p12PWb1+S74ufB3+bO/P7G+P6z6/iu5PTF5ex9qsO/v7/u7u7s9PvJ5fS04fGEzetw1fBi1PRc1vZt4/x43PeK3faw6/rH6/bi9PqOudPf39/39/f////////////////////y+PzP5vVz0O55/P9x9f9l6fxprNCxydrU4er4+Pj+/v7////////////////////////////G4/V7z+5y3vNx1e7E1uL09PT9/f3///////8EAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAD7+/vs7OzZ2dnLy8vIyMjCwsKwsLCysrLX19f29vb+/v7////////////////////p6emzu7R1jXZogWhqf2s6fz0rlTV3fXejo6PW1tb19fX+/v7///////////////+BsoZFy2Y+1WI0zVIovkEduTQbxTIkjS5zeXOgoKDLy8vj4+Pv7+/4+Pj9/f3///9Lz25b/I5O8X0952ou1U4iyDwYvi0OuCAchSB6eHKMjIyjo6O5ubnNzc3g4ODx8fFm6I1296Jg13pr0XZC0GIt0UwVwCwXyTgcvzy7tojQnoyrjH6Sg32Li4ulpaXR0dGY77Ydoi1ylkL/rZeXqWocx0VA0mFkwWilwo3/69v/7tz/5tP50rvdoYeti3+/v7+B2Zg+ulCls3j/7OXTrIOUrm7cwJf+1sT/9/P/+vL/8uj+4M/+18D6zLG7k4TIyMjQ5NJsxH3Lx6P/+vX/7N7/4dTIub+WqsH47ub04dn81sT/4c//7NzxyLSvn5jX19f////p7ufm2sj/+PHa0M93p8lApeA/p+JmoclZmsapsr3/9ub/9+zasJ2xpaDj4+P////84dnx2dKUuM5ct+NWxfhex/hcxfZSwPdNv/hRqtzVzc3///jLoZG6s7Ht7e3////99vOFq8VPuedlyfFkxe1lx/Bkx/FhxfFhxfJayfl3ttj45NvCp53Ozs729vb////////r8vZptNhvy+t72vZz0vFvze9szO9qyu9nyO9XwO2XqrvRu7Pr6+v9/f3////////////p8vdyt9h50+2I5fiG4/iE4vmB4PhwzexVps6kuMfv7+/8/Pz////////////////////r8/h2u9mD2+2T7fmL5fVvxOJvocDV29/4+Pj+/v7////////////////////////////q8vd6vNiA1edrs9GeuMns7Oz8/Pz////////////////////////////////////////R4+6NudXE1+P19fX9/f3///////////////////8FAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAD////5+fnj4+PFxcWvr6+kpKSlpaWysrK/v7+7u7uqqqqhoaGjo6O0tLTY2Nj29vb8/Pzj4+PBmI2/hXDJhWvHjHKyj3yScmmXb2W7XUTGaE3Gc1m4a1aGeHWpqang4OD08vHXi3X0oHv6uJL7wZr/47v63LXkf1vcWDXoeFT7pYD9pH78mnbBa1KFhITCwsLow7ntgV3won36vJbypoD90Krxt5Hia0fqdVH5rojwkW3hZ0T0jmr5lXGWa1+srKznsZ/pgFvrlnH3tpDtlnH7yqPtrYfkaUb0kWz9xqDpiGPocU7rfVr6nXi8blijo6Plrpzne1bqjmr1r4nng174wJnqon3vf1v7qYT80qz9x6H1oHvrhGDyjmrHdlylpaXkq5rldVDoiWT0q4XgbEnztI7pm3fujmn9xZ7937j90Kr4uJLzrIbul3PFcFaxsbHkqJfmdlLjeVXxnXjdYz/okmzljmrmhF/+4br+68T93rb90KrxqYTvpYC6e2bIyMjhopHndlLnd1PvlnL2upX2zqjvuZTol3L+8cn//dX+78j93rf4w530q4a8nZTm5ubho5LwhWH9sYz6tZD5uJL7xqD/4Ln6zKb0uZP91rD/+dH/+tP93LbVmYXj4+P6+vrkmYL4ronmgFzjbknobkzxgV31imbximb2mnbPclXFiHTdppHowrTx8fH7+/v////oqo/lf1vWSiffXzvocE/xhWH1i2flakfsfFexbVqwsLDr6+v////////////////qpoz4lnLgYT7eXTrkZ0XteVXwgl7qfVn5nXi9dWDCwsLy8vL////////////////staH9ron5lXHxjWnvjWjxmnX4s4z9tpH7pYDDkoTj4+P7+/v////////////////78/HssZj5p4P6oHv/vpj/0qz+yaL4rorZloPl4+P5+fn////////////////////////////01svxx7TsrpTmpIzmt6Xpz8f29vb9/f3///////////////////////8GAAAAbHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEArJWX2I6Vr3N5QTk7m5ub3d3d/f39hcHgFrj2LdD+LNb/Ksr5U63JY3aHXG6Ce31+kJGUxIiE5JaaYUVKr6+v4uLi8vT2PLbqGMD7QtX7R+D/RuD/Pun/TLDJYpOpQrjfUnuPaHR/iXuAeWJktra25eXlyd7sIsL5IMb7Udr6V+v/W+7/XfP/YbTDbJ+rVvb/Xff/VOD0VoihcGJop6en4+PjlMvnLNH/J87/cdHlqca6gMzPbOXsd8TOq4GJjJiheKiybsLGU6rAZ1lelpaW3d3ddMPnPNz/NNH9jNzm/9q8+cCh2r6mjp+cz3eB0G92ql5khFNYWENIOzM2nJyc4ODgZsjsTub/QtT8od7j8c67/865/82ysMG6nauzo4+XkG15f1ZgY0JGNy4xvLy87+/vY9b0Y/L/V9f4quvy4cu4/ujd/+rgvdfVhOX7gNnvhtXsgrzRgqKuc3Fz2dnZ+/v7ac7wbev7ZuT5c973h+T4nOHyvuTpwOvxv/T9v/X9p+T4suLwotbnsbKy5+fn////7/f7yuP0qtrwjc/sbcvtXdDyWdT1a9v4ft33leH3ruX34fL1nsjg19na9PT0/////////////////////f7+8fj8yOP0Zdv1d/z/bfT+WsLlmrjNwdfm+Pj4/f39////////////////////////////////rtzyhtPud9fvos3k8PDw+/v7////////////CwAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////v7+9vb26+vr6Ojo6+vr8vLy+/v7////////////////////////////////////+vr639/fuLi4qqqqsLCwwcHB3d3d9PT0/v7+////////////////+/v77+/v6Ojo5dfS4rqpw5mIwJmHpIN2hIKBoqKiysrK5+fn9/f3/f39/////v7+7Ozsw8PDrKysuaii//To/+bU/+zd/uXS0Z+Jh3Vujo6OsLCw1tbW9fX1////+vr6iLzbPKraTYuqhZyn0+S4993J+eLS//Pj/+/c67idrXtolH11tbW16+vr////3ufuKLDsJtL/KND/jtDLgNZ258m344Fd7bmX/+vW/+zY/+TGzZJ6t7e37u7u/v7+mMfhFb/7OM/7Str8rta6v+q19cu64JBr7ohkwZ9h3/DD/+fOuoVyzc3N+Pj49/j4UrflG8n/RNL5aOT35d3F8+jS1LurTpXOhHVxVZJTiNOI5b+umY6L19fX/Pz80ePuMMb3J8//V9b0ws69/Ond/dXDqo+GJ4LCJUphJGei1MO0obC1j5KU1NTU+vr6qNHoOtb+NNT/Z9ry8Nm/+u3k77mj8pt605iBo3Jdemps9My3j8vSgJOe0tLS+fn5hcnoUOT/Sdz+h+Ly8NO7//Pq+OPX+9K9/8ms/8aq/72g5NPBj9Xhg5ai1NTU+vr6eMztZ/L/XOH8ovH82t3O+t3L/+jZ5dC9vs7MsMHHw9PTudfZmtbkiZul2tra/Pz8gc/vdO/7aer8ct73geD4oOb0yu3tw+vusvX/tfT/qOr8seHuodLjqrO45ubm/v7+7/f72ez3x+bzrdrwoNrvgM3sYsnvcN35g+v7iOb6kOD3vt3tm8Xe3N7f9fX1////////////////////////////9fr9eNDvfP//c/r/V9Tzm7PDzNvl+vr6/v7+////////////////////////////////yuf2iNTvdNnxjcfk7e3t+vr6////////////DAAAAGx0AAA2AwAAQk02AwAAAAAAADYAAAAoAAAAEAAAABAAAAABABgAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////Pz88vLy5+fn5ubm8fHx/Pz8/////////////////v7++/v7+vr6/f39/////v7+7OzsxsbGqampp6enwsLC5+fn+/v7////////////9vb24ODg09PT3d3d7e3t8fHxlZSVWlBTY01RX1tcioqKuLi44+Pj+vr6/////f390drgj6i3jZCSm5ubtra2qaenLigtlYByy7KceVBXW1RXiIiIvr6+7+/v////7/HzR67gGsH7LqnaTouocYCJWGdxX0M5/8yk/+7E2MKplmZpcmFku7u77u7u////tNTnE7j3LMv8L9f/MNP+NdD1LW2KRSskypB0/9iuwqyUdVBTcF9h2dnZ+Pj4/f39Z7zlFMX/P834S+L/SeD/TO7/NIKTRSwnRzc0gGZYTDg6U1FWnZ2d3d3d/Pz87vP1NbzvHMn+RtD3Xej6Wez/Yv3/O4OTnGRQ35d2VzkzMkZMTJ28iIyOzc3N9/f3xNzsL8z7Jc3/V9Hxvbqnlb65fd3bR36IonFf/8OWxXhcTnh7dfX+cY6fyMjI9fX1mtHqP9n+NNT/adbw/9e7/8ao9sirh3Fpe11W8LeSsXNZVo6TkfLydJGiycnJ9fX1g8jnUeX/SN7/h9zt77+n8cu6/9jAn4F7bEtNbVBNSjMvWYWMpeztdJGiysrK9fX1dM7uavb/WOL9i9713sCq9tXF4dXPjWhr7MCh4KuMTTUzXIOSquTsdpOkzMzM9/f3idHvbuX4a+v8bd74fuH3kKKnqWlr2aqa//HG5LGTZUhInMPNwejvhqK02tra+vr6+fz+3vD4tNvwod/yds3sU5m0c4qdjISKl314bmxxdqK32PH3vt7tv8zV7u7u/v7+////////////////////9/z+5PP6ZsTmdurtdfP5Z+n/iK7Gt9Dh8/T1/Pz8////////////////////////////////zOf3ldvyeNfwjdDp7Ozs+vr6////////////" />

	ADD OBJECT 'oleReserData' AS olecontrol WITH ;
		Anchor = 15, ;
		Height = 420, ;
		Left = 0, ;
		Name = "oleReserData", ;
		Top = 0, ;
		Width = 300, ;
		ZOrderSet = 1
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJChXlNFOMoBAwAAAIACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAA8BAAAAAAAABwAAAAIAAAD+////BAAAAAUAAAAGAAAACQAAAAgAAAD+/////v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAAACHwAAaSsAALE8wWoBAAYAIgAAAD0AMgCNAQAACAAAAJEvFQAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEBAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaNYaADwAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAuQAoAAABMYWJlbEVkaXQACQAAAEkKAAAAAQAAAAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcDAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAwAAABCb3JkZXJTdHlsAAAFAGAxFQAGAAAAAAAAAAUAAIB86hIAAQAAAFwAH97svQEABQDB6hIAA1LjC5GPzhGd4wCqAEu4UQEAAACQAURCAQAFQXJpYWxCAV0gWwB4AxUASMIaADUAbAB7AD0AYwBkAFIAJgBhAEYAIQBaAFoAdQBbAEwAfQAtADkAKwBlAAkAAABJCgAAAAAAAAAAJQB5AEkAeAA5AGoAXQB5AFUANgBgAHsAPQB0ADYAQQBzADIAWgB4AEoAMwBFAFUAKgA0AEMAXQB9AFcAdgBQAHQALABeAD8AVQBbACgAQwAoAHMAcABaAHUAYgBtAC4ANAAlAGIALgBDAHoAMgA9AHgAQwBYAFEAQABBACUAagBQAFAARQBlAC0AKwBtACgAXgBdAE8APQBxAEEAawBBAHMAYQB7AHEALgAhAE8ARABzAEMATgBYAFEAXgB9AEAAMgBbADQAPQBhAEUAMQBTAHYAawBCACgAVAAsAHMAaABtAFgAQwA/ACgAMwBYAFEAYABZAHcAQAA2AF8AQwB0AGUAJQBrAHoAWABeAG4AOABAAGoALQB6AGEAWABdAEgAdwBOAFMAVABxAE0AeABFAD0AQABZAD0AKQApAFcAJQBvACYAcwBpADIAZQA0AHsAJABhAD0ASQBNACUANgA/AGUAdgBhAGwANgB4AHUAcgB3AGMAQgBiAHUAdwAuACUAcgBwAFYAOQArAFQAbgBTAC0AbgAsAGUATABDAFYARgBvAGwAJgAhAGwAMABWAD8A" />
	
	PROCEDURE Activate
		this.oleReserData.SetFocus()
	ENDPROC

	PROCEDURE addnode
		LPARAMETERS tcType, tcKey, tcParentKey, tcCaption
		
		this.oleReserData.Nodes.Add(IIF(EMPTY(tcParentKey), .NULL., tcParentKey), IIF(EMPTY(tcParentKey), .NULL., 4), tcKey, tcCaption, tcType)
	ENDPROC

	PROCEDURE assigncaption
		this.Caption = GetLangText("ROOMPLAN","TXT_PICKALLOTMENT")
		this.cmdOK.Caption = GetLangText("COMMON","TXT_OK")
		this.cmdCancel.Caption = GetLangText("COMMON","TXT_CANCEL")
	ENDPROC

	PROCEDURE checkwhichroomsarefree
		* Check for all rooms are those free
		
		LPARAMETERS lp_cCurName
		LOCAL l_nSelect, l_cSql, l_cRoomNum, l_dFromDate, l_dToDate
		
		l_nSelect = SELECT()
		
		SELECT DISTINCT rm_roomnum FROM (lp_cCurName) INTO CURSOR curtmprooms
		SCAN ALL
			l_cRoomNum = rm_roomnum
			l_dFromDate = this.oData.arrival
			l_dToDate = IIF(this.oData.arrival=this.oData.departure, this.oData.departure, this.oData.departure-1)
			
			IF NOT ProcReservat("CheckIsRoomFree", l_cRoomNum, l_dFromDate, l_dToDate)
				DELETE FOR rm_roomnum = l_cRoomNum IN (lp_cCurName)
			ENDIF
		ENDSCAN
		
		dclose("curtmprooms")
		
		SELECT (l_nSelect)
		
		RETURN .T.
	ENDPROC

	PROCEDURE Init
		LPARAMETERS toData
		LOCAL loParams, lcTempData
		
		this.oData = toData
		this.oleReserData.Imagelist = this.oleImageList
		this.oleImageList.ListImages.Add(, "allott", LOADPICTURE("bitmap\icons\inhouse.ico"))
		this.oleImageList.ListImages.Add(, "current", LOADPICTURE("bitmap\icons\arrivals.ico"))
		this.oleImageList.ListImages.Add(, "type", LOADPICTURE("bitmap\icons\card0316.ico"))
		this.oleImageList.ListImages.Add(, "room", LOADPICTURE("bitmap\icons\secur06.ico"))
		
		loParams = gosqlwrapper.GetParamsObj(this.oData.Arrival, this.oData.Departure)
		SqlCursor(, "curAllotForReservation",, "getallotforreser_sql", loParams,,,.T.) && Get RW cursor
		
		IF NOT USED("curAllotForReservation") OR RECCOUNT() = 0
			RETURN .F.
		ENDIF
		
		this.CheckWhichRoomsAreFree("curAllotForReservation") && Delete all not free rooms
		
		lcTempData = SYS(2015)
		SELECT al_fromdat, al_todat, al_altid, bu_lang, bu_buildng FROM curAllotForReservation ;
			GROUP BY al_fromdat, al_todat, al_altid, bu_lang, bu_buildng ;
			INTO CURSOR &lcTempData
		SCAN
			this.AddNode(IIF(al_altid = this.oData.Allotment, "current", "allott"), "AL"+PADL(al_altid,8,"0"),, TRANSFORM(al_fromdat)+"-"+TRANSFORM(al_todat)+"  "+ALLTRIM(bu_buildng)+"  ("+ALLTRIM(bu_lang)+")")
		ENDSCAN
		
		SELECT al_altid, rt_roomtyp, rd_roomtyp, rd_lang FROM curAllotForReservation ;
			GROUP BY al_altid, rd_roomtyp, rd_lang, rt_roomtyp ;
			INTO CURSOR &lcTempData
		SCAN FOR NOT ISNULL(rt_roomtyp)
			this.AddNode("type", "AL"+PADL(al_altid,8,"0")+"RT"+PADL(rt_roomtyp,4), "AL"+PADL(al_altid,8,"0"), ALLTRIM(rd_roomtyp)+"  ("+ALLTRIM(rd_lang)+")")
		ENDSCAN
		
		SELECT curAllotForReservation
		SCAN FOR NOT ISNULL(rm_roomnum)
			this.AddNode("room", "AL"+PADL(al_altid,8,"0")+"RT"+PADL(rt_roomtyp,4)+"RM"+PADL(rm_roomnum,4), "AL"+PADL(al_altid,8,"0")+"RT"+PADL(rt_roomtyp,4), ALLTRIM(rm_rmname)+"  ("+ALLTRIM(rm_lang)+")")
		ENDSCAN
		
		IF this.oleReserData.Nodes.Count > 0
			this.oleReserData.SelectedItem = this.oleReserData.Nodes(1)
		ENDIF
		
		USE IN &lcTempData
		USE IN curAllotForReservation
		
		this.AssignCaption()
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		DO CASE
			CASE nKeyCode = 27									&& ESC
				this.OnClose()
			CASE nKeyCode = 13									&& Enter
				this.OnSelect()
		ENDCASE
	ENDPROC

	PROCEDURE onclose
		this.Release()
	ENDPROC

	PROCEDURE onselect
		this.oData.Allotment = INT(VAL(SUBSTR(this.oleReserData.SelectedItem.Key, 3, 8)))
		this.oData.Roomtype = ALLTRIM(SUBSTR(this.oleReserData.SelectedItem.Key, 13, 4))
		this.oData.Roomnumber = ALLTRIM(SUBSTR(this.oleReserData.SelectedItem.Key, 19, 4))
		
		this.OnClose()
	ENDPROC

	PROCEDURE cmdCancel.Click
		thisform.OnClose()
	ENDPROC

	PROCEDURE cmdOK.Click
		thisform.OnSelect()
	ENDPROC

ENDDEFINE

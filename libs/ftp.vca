*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="ftp.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS cftp AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="cftp" Parent="" ObjName="cftp" OLEObject="d:\keza\code\main\desk910\common\dll\chilkatftp.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGB4/fdAAs8BAwAAAMAAAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAA/v////7////+///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Qi1k7UK/GSLalYyYaSLBUAAMAAE8DAABPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	*<DefinedPropArrayMethod>
		*m: connectto
		*m: copyfile
		*m: copyfiles
		*m: disconnectfrom
		*m: getconnecterror
		*m: lasterrortext_access
		*m: logaction
		*m: showsendingmessage
		*p: lhidestatus
	*</DefinedPropArrayMethod>

	Height = 100
	lhidestatus = .F.
	Name = "cftp"
	Width = 100
	
	PROCEDURE connectto
		LPARAMETERS lp_cFTPAddress, lp_cUser, lp_cPass, lp_cPassive, lp_cRemDir
		LOCAL l_lSuccess, l_nResponse
		
		IF EMPTY(lp_cFTPAddress)
			this.LogAction("No FTP Server address. Aborting.")
			RETURN .F.
		ENDIF
		
		this.Hostname = lp_cFTPAddress
		this.Username = lp_cUser
		this.Password = lp_cPass
		this.Passive = lp_cPassive
		
		this.LogAction("Connect " + lp_cFTPAddress)
		
		IF this.Connect()=1
			this.ShowSendingMessage()
			l_lSuccess = .T.
			this.LogAction("Connected.")
			IF NOT EMPTY(lp_cRemDir)
				this.LogAction("Changing directory to " + lp_cRemDir)
				l_nResponse = this.ChangeRemoteDir(lp_cRemDir)
				IF l_nResponse = 1
					this.LogAction("Changed.")
					l_lSuccess = .T.
				ELSE
					this.LogAction("Failed.")
					this.LogAction("Disconnecting...")
					this.DisconnectFrom()
					this.LogAction("Disconnected.")
				ENDIF
			ELSE
				l_lSuccess = .T.
			ENDIF
		ELSE
			this.LogAction("Failed. " + this.GetConnectError())
		ENDIF
		
		RETURN l_lSuccess
	ENDPROC

	PROCEDURE copyfile
		LPARAMETERS lp_cLocFile, lp_cRemFile
		LOCAL l_nResponse
		IF EMPTY(lp_cRemFile)
			lp_cRemFile = lp_cLocFile
		ENDIF
		this.LogAction("Sending " + lp_cLocFile)
		l_nResponse = this.PutFile(lp_cLocFile, lp_cRemFile)
		IF l_nResponse = 1
			this.LogAction("Sent.")
			RETURN .T.
		ELSE
			this.LogAction("Failed.")
			RETURN .F.
		ENDIF
	ENDPROC

	PROCEDURE copyfiles
		LPARAMETERS lp_cFilesPattern
		LOCAL l_nResponse
		this.LogAction("Sending " + lp_cFilesPattern)
		l_nResponse = this.MPutFiles(lp_cFilesPattern)
		IF l_nResponse = 1
			this.LogAction("Sent.")
			RETURN .T.
		ELSE
			this.LogAction("Failed.")
			RETURN .F.
		ENDIF
	ENDPROC

	PROCEDURE disconnectfrom
		IF TYPE("this.Parent.LTimeLeft") = "O"
			this.Parent.LTimeLeft.BackColor = RGB(212,208,200)
			this.Parent.LTimeLeft.Caption = ""
			IF this.Parent.LTimeLeft.Visible AND this.lHideStatus
				this.Parent.LTimeLeft.Visible = .F.
				this.lHideStatus = .F.
			ENDIF
		ENDIF
		
		IF this.Disconnect()=1
			RETURN .T.
		ELSE
			RETURN .F.
		ENDIF
	ENDPROC

	PROCEDURE getconnecterror
		RETURN "(1)"
		
		* In this version of activex controll, error codes are not supported!
		
		LOCAL l_nCode, l_cText
		l_nCode = this.ConnectFailReason
		
		DO CASE
			CASE l_nCode = 0
				l_cText = "success"
			CASE l_nCode = 1
				l_cText = "empty hostname"
			CASE l_nCode = 2
				l_cText = "DNS lookup failed"
			CASE l_nCode = 3
				l_cText = "DNS timeout"
			CASE l_nCode = 4
				l_cText = "Aborted by application."
			CASE l_nCode = 5
				l_cText = "Internal failure."
			CASE l_nCode = 6
				l_cText = "Connect Timed Out"
			CASE l_nCode = 7
				l_cText = "Connect Rejected (or failed for some other reason)"
			CASE l_nCode = 100
				l_cText = "Internal schannel error"
			CASE l_nCode = 101
				l_cText = "Failed to create credentials"
			CASE l_nCode = 102
				l_cText = "Failed to send initial message to proxy."
			CASE l_nCode = 103
				l_cText = "Handshake failed."
			CASE l_nCode = 104
				l_cText = "Failed to obtain remote certificate."
			CASE l_nCode = 301
				l_cText = "asynch op in progress"
			CASE l_nCode = 302
				l_cText = "login failure."
			OTHERWISE
				l_cText = "Unknown"
		ENDCASE
		
		RETURN TRANSFORM(l_nCode)+" "+l_cText
	ENDPROC

	PROCEDURE lasterrortext_access
		*To do: Modify this routine for the Access method
		
		RETURN STRTRAN(THIS.LastErrorText,"ChilkatLog:","")
		
	ENDPROC

	PROCEDURE logaction
		LPARAMETERS lp_cText
		*this.Parent.Parent.LogAction(lp_cText)
	ENDPROC

	PROCEDURE showsendingmessage
		*!*	IF TYPE("this.Parent.LTimeLeft") = "O"
		*!*		IF NOT this.Parent.LTimeLeft.Visible
		*!*			this.Parent.LTimeLeft.Visible = .T.
		*!*			this.lHideStatus = .T.
		*!*		ENDIF
		*!*		this.Parent.LTimeLeft.BackColor = 255
		*!*		this.Parent.LTimeLeft.Caption = MakeMyString(GetLangText("CONNECT","TXT_SENDING"),this.Hostname)
		*!*	ENDIF
		
		RETURN .T.
	ENDPROC

ENDDEFINE
